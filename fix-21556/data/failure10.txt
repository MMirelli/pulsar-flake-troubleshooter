[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:49:29,306 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:49:30,246 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:49:30,247 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:49:30,730 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:49:30,731 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:49:30,732 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:49:30,732 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:49:30,733 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:49:30,734 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:49:30,754 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:49:30,755 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:49:30,755 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:49:30,756 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:49:30,756 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:49:30,757 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:49:30,757 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:49:30,758 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:49:30,758 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:49:30,759 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:49:30,759 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:49:30,760 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:49:32,392 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:49:32,393 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:49:32,393 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:49:32,393 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:49:32,729 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:49:32,730 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:49:32,826 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:49:32,915 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:49:32,919 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:49:32,938 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:49:33,040 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:49:33,080 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:49:33,123 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:49:33,424 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:49:33,425 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:49:33,453 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:49:33,515 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40645, TLS: (none), listener: (none)
2024-02-05T18:49:33,877 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38341, TLS: OPENSSL, listener: (none)
2024-02-05T18:49:33,900 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:49:33,905 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:49:33,906 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:49:33,948 - INFO  - [main:Log@170] - Logging initialized @6826ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:49:34,802 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:49:34,838 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:49:34,838 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:49:34,841 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:49:35,667 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:49:36,677 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:49:37,685 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:49:38,001 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:49:38,104 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:49:38,297 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:49:38,298 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:49:38,301 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:49:38,317 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:41867}
2024-02-05T18:49:38,486 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:34631}
2024-02-05T18:49:38,487 - INFO  - [main:Server@415] - Started @11366ms
2024-02-05T18:49:38,487 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41867
2024-02-05T18:49:38,489 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34631
2024-02-05T18:49:38,496 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:49:38,497 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:49:38,695 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41867
2024-02-05T18:49:38,719 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:49:38,728 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:41867 is changing the role from null to Leader
2024-02-05T18:49:38,728 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:41867).
2024-02-05T18:49:38,983 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41867 
2024-02-05T18:49:39,421 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:49:39,449 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:39,559 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:49:39,565 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:49:39,575 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:49:39,579 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:49:39,623 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:49:39,654 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:49:39,680 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:49:39,736 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:49:39,756 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:49:39,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:49:39,767 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:49:39,794 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:39 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 535
2024-02-05T18:49:39,795 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:49:39,946 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]] Connected to server
2024-02-05T18:49:39,984 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:38840] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:49:40,056 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,063 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,113 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:49:40,139 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:38840] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:38840, producerName=test-0-0, producerId=0}
2024-02-05T18:49:40,145 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,147 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:49:40,206 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,208 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-289f020bab] Subscribing to topic on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645], consumerId 0
2024-02-05T18:49:40,220 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf572d69f, L:/127.0.0.1:40645 - R:/127.0.0.1:38840]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-289f020bab. consumerId: 0
2024-02-05T18:49:40,260 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-289f020bab] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:49:40,261 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:49:40,262 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-289f020bab, ackPos=3:-1, readPos=3:0}
2024-02-05T18:49:40,280 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:38840] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-289f020bab
2024-02-05T18:49:40,284 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-289f020bab] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 0
2024-02-05T18:49:40,297 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:49:40,298 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:49:40,300 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:49:40,300 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:49:40,345 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,368 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:49:40,370 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:49:40,372 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:49:40,374 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:40 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 57
2024-02-05T18:49:40,386 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,395 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:49:40,397 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:49:40,398 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:40 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:49:40,399 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:49:40,419 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,421 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,430 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:49:40,437 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:38840] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:38840, producerName=test-0-1, producerId=1}
2024-02-05T18:49:40,438 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,453 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,455 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dfc019a31d] Subscribing to topic on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645], consumerId 1
2024-02-05T18:49:40,457 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf572d69f, L:/127.0.0.1:40645 - R:/127.0.0.1:38840]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-dfc019a31d. consumerId: 1
2024-02-05T18:49:40,481 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dfc019a31d] Created new subscription for 1
2024-02-05T18:49:40,483 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:38840] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-dfc019a31d
2024-02-05T18:49:40,488 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-dfc019a31d] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 1
2024-02-05T18:49:40,506 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,508 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,516 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:49:40,528 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:38840] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:38840, producerName=test-0-2, producerId=2}
2024-02-05T18:49:40,531 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:40,547 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:49:40,573 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:49:40,580 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:41867 started the ownership monitor.
2024-02-05T18:49:40,599 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:40,601 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f3d0abf663] Subscribing to topic on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645], consumerId 2
2024-02-05T18:49:40,603 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf572d69f, L:/127.0.0.1:40645 - R:/127.0.0.1:38840]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f3d0abf663. consumerId: 2
2024-02-05T18:49:40,615 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41867/__change_events
2024-02-05T18:49:40,618 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f3d0abf663] Created new subscription for 2
2024-02-05T18:49:40,618 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:38840] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f3d0abf663
2024-02-05T18:49:40,620 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f3d0abf663] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 2
2024-02-05T18:49:40,621 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:41867 plays the leader now.
2024-02-05T18:49:40,627 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707151780626, reportedAt= 0
2024-02-05T18:49:40,646 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:49:40,651 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:40,652 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:49:40,727 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41867/0x00000000_0xffffffff - localhost:41867.
2024-02-05T18:49:40,730 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41867
2024-02-05T18:49:40,731 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41867/0x00000000_0xffffffff
2024-02-05T18:49:40,731 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41867/0x00000000_0xffffffff - localhost:41867.
2024-02-05T18:49:40,732 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41867/0x00000000_0xffffffff
2024-02-05T18:49:40,736 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41867
2024-02-05T18:49:40,745 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41867/__change_events][reader-e3fd04f0fb] Subscribing to topic on cnx [id: 0xbaf46909, L:/127.0.0.1:38840 - R:localhost/127.0.0.1:40645], consumerId 3
2024-02-05T18:49:40,747 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf572d69f, L:/127.0.0.1:40645 - R:/127.0.0.1:38840]] Subscribing on topic persistent://sla-monitor/test/localhost:41867/__change_events / reader-e3fd04f0fb. consumerId: 3
2024-02-05T18:49:40,753 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41867 doesn't exist.
2024-02-05T18:49:40,757 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41867/persistent/__change_events
2024-02-05T18:49:40,759 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41867/persistent/__change_events'
2024-02-05T18:49:40,765 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:49:40,766 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41867/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:49:40,774 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41867/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:49:40,782 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41867/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:49:40,785 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41867/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41867/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:49:40,786 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41867/__change_events - dedup is disabled
2024-02-05T18:49:40,800 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:49:40,806 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41867/__change_events][reader-e3fd04f0fb] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:49:40,806 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41867/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:49:40,807 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41867/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41867/persistent/__change_events, cursor=reader-e3fd04f0fb, ackPos=7:-1, readPos=7:0}
2024-02-05T18:49:40,809 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:38840] Created subscription on topic persistent://sla-monitor/test/localhost:41867/__change_events / reader-e3fd04f0fb
2024-02-05T18:49:40,810 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41867/__change_events][reader-e3fd04f0fb] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 3
2024-02-05T18:49:40,771 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 41867, tls-port = Optional[34631], broker url= pulsar://localhost:40645, broker tls url= pulsar+ssl://localhost:38341, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40645], brokerServicePortTls=Optional[38341], webServicePort=Optional[41867], webServicePortTls=Optional[34631], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:49:41,299 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:49:41,299 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:49:41,299 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:49:41,299 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:49:41,303 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:49:41,304 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:49:41,309 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:49:41,313 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:49:41,318 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:49:41,318 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:49:41,324 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:49:41,330 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:49:41,334 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:49:41,340 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:49:41,341 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:49:41,349 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:49:41,352 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34181, TLS: (none), listener: (none)
2024-02-05T18:49:41,354 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46435, TLS: OPENSSL, listener: (none)
2024-02-05T18:49:41,357 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:49:41,358 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:49:41,359 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:49:41,371 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:49:41,375 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:49:41,375 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:49:41,376 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:49:41,463 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:49:41,653 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:41,654 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:49:42,255 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:49:42,655 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:42,655 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:49:43,656 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:43,657 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:49:43,666 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:49:43,888 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:49:43,953 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:49:44,071 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:49:44,072 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:49:44,073 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:49:44,076 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:33661}
2024-02-05T18:49:44,104 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:35359}
2024-02-05T18:49:44,105 - INFO  - [main:Server@415] - Started @16984ms
2024-02-05T18:49:44,106 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33661
2024-02-05T18:49:44,108 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:35359
2024-02-05T18:49:44,113 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:49:44,114 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:49:44,144 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33661
2024-02-05T18:49:44,145 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:33661 registry has been created.
2024-02-05T18:49:44,145 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:33661. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:49:44,154 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:33661 is changing the role from null to Follower
2024-02-05T18:49:44,159 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:41867).
2024-02-05T18:49:44,164 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:49:44,181 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33661 
2024-02-05T18:49:44,322 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:49:44,345 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:44,348 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:49:44,350 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:49:44,367 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 40
2024-02-05T18:49:44,369 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33661/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:49:44,384 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x724f9672, L:/127.0.0.1:36490 - R:localhost/127.0.0.1:34181]] Connected to server
2024-02-05T18:49:44,388 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36490] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:49:44,409 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]] Connected to server
2024-02-05T18:49:44,413 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:33670] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:49:44,414 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,428 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33670] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:33670, producerName=test-0-3, producerId=0}
2024-02-05T18:49:44,429 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,443 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-32dd3028d5] Subscribing to topic on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645], consumerId 0
2024-02-05T18:49:44,445 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xd0ef4593, L:/127.0.0.1:40645 - R:/127.0.0.1:33670]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-32dd3028d5. consumerId: 0
2024-02-05T18:49:44,452 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-32dd3028d5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:49:44,452 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:49:44,453 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-32dd3028d5, ackPos=3:-1, readPos=3:0}
2024-02-05T18:49:44,454 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33670] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-32dd3028d5
2024-02-05T18:49:44,456 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-32dd3028d5] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 0
2024-02-05T18:49:44,458 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:49:44,459 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:49:44,484 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:49:44,491 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:44,494 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:49:44,494 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:49:44,499 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33661/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:49:44,500 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:49:44,512 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:49:44,518 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:44,521 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:49:44,522 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:49:44,526 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:49:44,526 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33661/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:49:44,546 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,555 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33670] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:33670, producerName=test-0-4, producerId=1}
2024-02-05T18:49:44,556 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,570 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2f116912a7] Subscribing to topic on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645], consumerId 1
2024-02-05T18:49:44,572 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xd0ef4593, L:/127.0.0.1:40645 - R:/127.0.0.1:33670]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2f116912a7. consumerId: 1
2024-02-05T18:49:44,585 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2f116912a7] Created new subscription for 1
2024-02-05T18:49:44,585 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33670] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2f116912a7
2024-02-05T18:49:44,586 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2f116912a7] Subscribed to topic on localhost/127.0.0.1:40645 -- consumer: 1
2024-02-05T18:49:44,607 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,616 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33670] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:33670, producerName=test-0-5, producerId=2}
2024-02-05T18:49:44,617 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x5355aaad, L:/127.0.0.1:33670 - R:localhost/127.0.0.1:40645]
2024-02-05T18:49:44,620 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:49:44,624 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:49:44,626 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:33661 plays a follower now.
2024-02-05T18:49:44,658 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:49:44,659 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:49:44,660 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33661/__change_events
2024-02-05T18:49:44,687 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33661/0x00000000_0xffffffff - localhost:33661.
2024-02-05T18:49:44,689 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33661
2024-02-05T18:49:44,689 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33661/0x00000000_0xffffffff - localhost:33661.
2024-02-05T18:49:44,689 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33661/0x00000000_0xffffffff
2024-02-05T18:49:44,690 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33661
2024-02-05T18:49:44,690 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33661/0x00000000_0xffffffff
2024-02-05T18:49:44,692 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33661 doesn't exist.
2024-02-05T18:49:44,695 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 33661, tls-port = Optional[35359], broker url= pulsar://localhost:34181, broker tls url= pulsar+ssl://localhost:46435, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34181], brokerServicePortTls=Optional[46435], webServicePort=Optional[33661], webServicePortTls=Optional[35359], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:49:44,699 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33661/__change_events][reader-14bd3039bb] Subscribing to topic on cnx [id: 0x724f9672, L:/127.0.0.1:36490 - R:localhost/127.0.0.1:34181], consumerId 2
2024-02-05T18:49:44,701 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x844ca602, L:/127.0.0.1:34181 - R:/127.0.0.1:36490]] Subscribing on topic persistent://sla-monitor/test/localhost:33661/__change_events / reader-14bd3039bb. consumerId: 2
2024-02-05T18:49:44,710 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33661/persistent/__change_events
2024-02-05T18:49:44,713 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33661/persistent/__change_events'
2024-02-05T18:49:44,726 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:49:44,728 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33661/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:49:44,739 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33661/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:49:44,749 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33661/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:49:44,753 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33661/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33661/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:49:44,755 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33661/__change_events - dedup is disabled
2024-02-05T18:49:44,761 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:49:44,769 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33661/__change_events][reader-14bd3039bb] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:49:44,770 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33661/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:49:44,770 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33661/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33661/persistent/__change_events, cursor=reader-14bd3039bb, ackPos=9:-1, readPos=9:0}
2024-02-05T18:49:44,773 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36490] Created subscription on topic persistent://sla-monitor/test/localhost:33661/__change_events / reader-14bd3039bb
2024-02-05T18:49:44,774 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33661/__change_events][reader-14bd3039bb] Subscribed to topic on localhost/127.0.0.1:34181 -- consumer: 2
2024-02-05T18:49:44,942 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:49:44,944 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:49:44,972 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:49:44,973 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:49:44,997 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:49:44,997 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:49:45,002 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:49:45,005 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:44 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:49:45,028 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:49:45,028 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:49:45,029 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:49:45,030 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:49:45,031 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:49:45,033 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:49:45,047 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:49:45,048 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:49:45,052 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:49:45,055 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:49:45,063 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:49:45,064 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:49:45,064 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:49:45,065 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:49:45,065 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:49:45,068 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:49:45,096 - INFO  - [pulsar-web-30-5:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:49:45,105 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:49:45,106 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:49:45,119 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:49:45,129 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:45,146 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33661 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:49:45,216 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:49:45,192 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41867 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33661, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151785148, versionId=1]. totalHandledRequests:1
2024-02-05T18:49:45,233 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41867 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33661, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151785190, versionId=2]. totalHandledRequests:1
2024-02-05T18:49:45,236 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:49:45,253 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 138
2024-02-05T18:49:45,267 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-bdee6d83c9] Subscribing to topic on cnx [id: 0x724f9672, L:/127.0.0.1:36490 - R:localhost/127.0.0.1:34181], consumerId 3
2024-02-05T18:49:45,269 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x844ca602, L:/127.0.0.1:34181 - R:/127.0.0.1:36490]] Subscribing on topic persistent://public/test/__change_events / reader-bdee6d83c9. consumerId: 3
2024-02-05T18:49:45,278 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:49:45,280 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:49:45,282 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:49:45,291 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:49:45,292 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:49:45,302 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:49:45,308 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:49:45,309 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:49:45,312 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:49:45,317 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41867 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33661, splitServiceUnitToDestBroker=null, force=true, timestamp=1707151785308, versionId=3]. totalHandledRequests:1
2024-02-05T18:49:45,319 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:49:45,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:49:45,322 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:49:45,323 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:49:45,326 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:49:45,342 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:49:45,347 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:49:45,350 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 33.0 ms
2024-02-05T18:49:45,357 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41867 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33661, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151785317, versionId=4]. totalHandledRequests:1
2024-02-05T18:49:45,357 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33661. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:49:45,358 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:36490][persistent://public/test/__change_events][reader-bdee6d83c9] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33661. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:49:45,360 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:49:45,360 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x724f9672, L:/127.0.0.1:36490 - R:localhost/127.0.0.1:34181] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33661. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:49:45,360 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:49:45,361 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 104
2024-02-05T18:49:45,362 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-bdee6d83c9] Failed to subscribe to topic on localhost/127.0.0.1:34181
2024-02-05T18:49:45,362 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:49:45,362 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33661. Please redo the lookup. Request is denied: namespace=public/test","reqId":263893552499532657, "remote":"localhost/127.0.0.1:34181", "local":"/127.0.0.1:36490"}
2024-02-05T18:49:45,362 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33661. Please redo the lookup. Request is denied: namespace=public/test","reqId":263893552499532657, "remote":"localhost/127.0.0.1:34181", "local":"/127.0.0.1:36490"} -- Will try again in 0.1 s
2024-02-05T18:49:45,363 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:49:45 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 271
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@756ef2eb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3831e210] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@756ef2eb, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73d4795a], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3831e210, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55a93a76] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@756ef2eb, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73d4795a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@57526382], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3831e210, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55a93a76, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@60c42a1a] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@756ef2eb, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73d4795a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@57526382, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@308a81f1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3831e210, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55a93a76, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@60c42a1a, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cec671c] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31514d33, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13942fe, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@756ef2eb, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73d4795a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@57526382, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@308a81f1, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68664f70], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf0dc5a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4eed06d0, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3831e210, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@55a93a76, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@60c42a1a, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2cec671c, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29332c9c] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:49:45,462 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:49:45,463 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Reconnecting after connection was closed
2024-02-05T18:49:45,466 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x724f9672, L:/127.0.0.1:36490 - R:localhost/127.0.0.1:34181] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:49:45,467 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":263893552499532658, "remote":"localhost/127.0.0.1:34181", "local":"/127.0.0.1:36490"}
2024-02-05T18:49:45,467 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":263893552499532658, "remote":"localhost/127.0.0.1:34181", "local":"/127.0.0.1:36490"}
2024-02-05T18:49:45,467 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":263893552499532658, "remote":"localhost/127.0.0.1:34181", "local":"/127.0.0.1:36490"} -- Will try again in 0.181 s
2024-02-05T18:49:45,468 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x724f9672, L:/127.0.0.1:36490 ! R:localhost/127.0.0.1:34181] Disconnected
2024-02-05T18:49:45,470 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:49:45,470 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36490
2024-02-05T18:49:45,471 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:49:45,471 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:49:45,472 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:49:45,472 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33661/__change_events, name=reader-14bd3039bb}, consumerId=2, consumerName=30232, address=/127.0.0.1:36490}
2024-02-05T18:49:45,473 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:49:45,474 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33661/__change_events] [reader-14bd3039bb] Closed connection [id: 0x724f9672, L:/127.0.0.1:36490 ! R:localhost/127.0.0.1:34181] -- Will try again in 0.1 s
2024-02-05T18:49:45,473 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33661/__change_events][reader-14bd3039bb] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33661/persistent/__change_events, cursor=reader-14bd3039bb, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:49:45,475 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33661/__change_events][reader-14bd3039bb] Successfully closed dispatcher for reader
2024-02-05T18:49:45,481 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:49:45,483 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:49:45,485 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:49:45,488 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:49:45,491 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:49:45,494 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:49:45,498 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:49:45,500 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:49:45,500 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:49:45,503 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33661
2024-02-05T18:49:45,505 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33661 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:49:45,509 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:33661 registry has been deleted.
2024-02-05T18:49:45,510 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:33661 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:49:45,511 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33661 was invalidated. state Releasing
2024-02-05T18:49:45,512 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:33661 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:49:45,512 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33661. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:49:45,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33661
2024-02-05T18:49:45,514 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33661
2024-02-05T18:49:45,514 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33661 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:49:45,526 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33661/0x00000000_0xffffffff.
2024-02-05T18:49:45,528 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33661/0x00000000_0xffffffff.
2024-02-05T18:49:45,530 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33661/0x00000000_0xffffffff.
2024-02-05T18:49:45,530 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.015 seconds
2024-02-05T18:49:45,532 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:49:45,535 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:49:45,536 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33661/persistent/__change_events] Closing managed ledger
2024-02-05T18:49:45,538 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33661/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:49:45,538 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:49:45,539 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] Disconnected
2024-02-05T18:49:45,539 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:45,539 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:45,540 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:45,540 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-32dd3028d5] Closed connection [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:45,540 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2f116912a7] Closed connection [id: 0x5355aaad, L:/127.0.0.1:33670 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:45,541 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:49:45,541 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:33670
2024-02-05T18:49:45,542 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:49:45,543 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-32dd3028d5}, consumerId=0, consumerName=ffbad, address=/127.0.0.1:33670}
2024-02-05T18:49:45,543 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-32dd3028d5] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-32dd3028d5, ackPos=3:3, readPos=3:4}]
2024-02-05T18:49:45,543 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-32dd3028d5] Successfully closed dispatcher for reader
2024-02-05T18:49:45,544 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-2f116912a7}, consumerId=1, consumerName=5460e, address=/127.0.0.1:33670}
2024-02-05T18:49:45,549 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34181
2024-02-05T18:49:45,550 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:49:45,551 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:49:45,551 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:49:45,552 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-32dd3028d5] Closed Consumer (not connected)
2024-02-05T18:49:45,554 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33661/__change_events] [reader-14bd3039bb] Closed Consumer (not connected)
2024-02-05T18:49:45,553 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-32dd3028d5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-32dd3028d5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:45,554 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2f116912a7] Closed Consumer (not connected)
2024-02-05T18:49:45,554 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-bdee6d83c9] Closed Consumer (not connected)
2024-02-05T18:49:45,554 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33661/__change_events with subscription name reader-14bd3039bb was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33661/__change_events with subscription name reader-14bd3039bb was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:45,556 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2f116912a7 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2f116912a7 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:45,563 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:49:45,563 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:49:45,566 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:49:45,569 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 39.06%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.25%, msgThroughputEMA= 0.00, updatedAt= 1707151785568, reportedAt= 1707151780696
2024-02-05T18:49:45,577 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:33661/__change_events] [reader-14bd3039bb] Reconnecting after timeout
2024-02-05T18:49:45,577 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://sla-monitor/test/localhost:33661/__change_events] [reader-14bd3039bb] Ignoring reconnection request (state: Closed)
2024-02-05T18:49:45,583 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:45,593 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:49:45,593 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:45,664 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:45,665 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:49:46,665 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:46,666 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:49:46,847 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:49:46,848 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:49:46,851 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:49:46,851 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:46,852 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:49:46,852 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:49:47,666 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:47,667 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:49:48,667 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:49:48,668 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:49:48,867 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:49:48,869 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:49:48,869 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:49:48,870 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:49:48,870 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:49:48,870 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:49:48,872 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:49:48,873 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:49:48,875 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:49:48,877 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:49:48,878 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:49:48,879 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:49:48,880 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:49:48,881 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:49:48,881 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:49:48,882 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41867
2024-02-05T18:49:48,883 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41867 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:49:48,890 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41867 was invalidated. state Releasing
2024-02-05T18:49:48,890 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41867. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:49:48,891 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41867
2024-02-05T18:49:48,895 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41867/0x00000000_0xffffffff.
2024-02-05T18:49:48,896 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41867/0x00000000_0xffffffff.
2024-02-05T18:49:48,898 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41867/0x00000000_0xffffffff.
2024-02-05T18:49:48,898 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.007 seconds
2024-02-05T18:49:48,898 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:49:48,899 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:38840
2024-02-05T18:49:48,899 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] Disconnected
2024-02-05T18:49:48,899 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-289f020bab}, consumerId=0, consumerName=f30b2, address=/127.0.0.1:38840}
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-289f020bab] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-289f020bab, ackPos=3:3, readPos=3:4}]
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-289f020bab] Successfully closed dispatcher for reader
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-289f020bab] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-dfc019a31d] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,900 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41867/__change_events, name=reader-e3fd04f0fb}, consumerId=3, consumerName=3924e, address=/127.0.0.1:38840}
2024-02-05T18:49:48,901 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41867/__change_events] [reader-e3fd04f0fb] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,901 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41867/__change_events][reader-e3fd04f0fb] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41867/persistent/__change_events, cursor=reader-e3fd04f0fb, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:49:48,901 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f3d0abf663] Closed connection [id: 0xbaf46909, L:/127.0.0.1:38840 ! R:localhost/127.0.0.1:40645] -- Will try again in 0.1 s
2024-02-05T18:49:48,901 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41867/__change_events][reader-e3fd04f0fb] Successfully closed dispatcher for reader
2024-02-05T18:49:48,901 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-f3d0abf663}, consumerId=2, consumerName=68e24, address=/127.0.0.1:38840}
2024-02-05T18:49:48,902 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-dfc019a31d}, consumerId=1, consumerName=43bad, address=/127.0.0.1:38840}
2024-02-05T18:49:48,902 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:49:48,903 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:49:48,904 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41867/persistent/__change_events] Closing managed ledger
2024-02-05T18:49:48,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:49:48,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41867/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:49:48,910 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:49:48,910 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:49:48,911 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:49:48,915 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40645
2024-02-05T18:49:48,915 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:49:48,915 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:49:48,916 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:49:48,916 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f3d0abf663] Closed Consumer (not connected)
2024-02-05T18:49:48,916 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41867/__change_events] [reader-e3fd04f0fb] Closed Consumer (not connected)
2024-02-05T18:49:48,916 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f3d0abf663 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f3d0abf663 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:48,917 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-289f020bab] Closed Consumer (not connected)
2024-02-05T18:49:48,917 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-dfc019a31d] Closed Consumer (not connected)
2024-02-05T18:49:48,917 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41867/__change_events with subscription name reader-e3fd04f0fb was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41867/__change_events with subscription name reader-e3fd04f0fb was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:48,918 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-289f020bab was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-289f020bab was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:48,918 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-dfc019a31d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-dfc019a31d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:49:48,920 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:49:48,921 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:49:48,921 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:49:48,921 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:49:48,921 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:49:48,922 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:48,922 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:49:48,923 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:50,206 - INFO  - [globalEventExecutor-10-5:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:49:50,206 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:49:50,207 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:49:50,208 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:50,208 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:49:50,208 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:49:50,215 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:49:50,216 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:49:50,219 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:49:50,220 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 67 with name 'Thread[AsyncHttpClient-37-1,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:49:50,220 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:49:50,221 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 189 with name 'Thread[globalEventExecutor-10-5,5,main]'
2024-02-05T18:49:50,221 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:49:50,221 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:49:50,221 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@4968bd4e
2024-02-05T18:49:50,221 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:49:50,221 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:49:50,221 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.69 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  48.848 s
[INFO] Finished at: 2024-02-05T18:49:50+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 1 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:50:21,654 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:50:22,622 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:50:22,624 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:50:23,124 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:50:23,125 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:50:23,126 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:50:23,127 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:50:23,128 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:50:23,129 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:50:23,160 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:50:23,161 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:50:23,162 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:50:23,163 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:50:23,164 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:50:23,164 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:50:23,165 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:50:23,165 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:50:23,166 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:50:23,166 - INFO  - [main:Environment@98] - Client environment:os.memory.free=22MB
2024-02-05T18:50:23,167 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:50:23,167 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:50:24,793 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:50:24,794 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:50:24,794 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:50:24,795 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:50:25,129 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:50:25,130 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:50:25,223 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:50:25,308 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:50:25,311 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:50:25,331 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:50:25,433 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:50:25,477 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:50:25,531 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:50:26,021 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:50:26,021 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:50:26,051 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:50:26,093 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40739, TLS: (none), listener: (none)
2024-02-05T18:50:26,360 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39697, TLS: OPENSSL, listener: (none)
2024-02-05T18:50:26,381 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:50:26,386 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:50:26,387 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:50:26,422 - INFO  - [main:Log@170] - Logging initialized @7023ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:50:27,421 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:50:27,463 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:50:27,463 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:50:27,465 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:50:28,228 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:50:29,415 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:50:30,372 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:50:30,766 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:50:30,877 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:50:31,030 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:50:31,031 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:50:31,035 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:50:31,054 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:34069}
2024-02-05T18:50:31,213 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:40013}
2024-02-05T18:50:31,214 - INFO  - [main:Server@415] - Started @11817ms
2024-02-05T18:50:31,214 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:34069
2024-02-05T18:50:31,215 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:40013
2024-02-05T18:50:31,222 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:50:31,223 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:50:31,394 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:34069
2024-02-05T18:50:31,413 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:50:31,417 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:34069 is changing the role from null to Leader
2024-02-05T18:50:31,420 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34069).
2024-02-05T18:50:31,751 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:34069 
2024-02-05T18:50:32,201 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:50:32,227 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:32,328 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:50:32,333 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:50:32,342 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:50:32,343 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:50:32,375 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:50:32,401 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:50:32,429 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:50:32,491 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:50:32,509 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:50:32,519 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:50:32,523 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:50:32,554 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:32 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 493
2024-02-05T18:50:32,561 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:50:32,703 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]] Connected to server
2024-02-05T18:50:32,730 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:46158] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:50:32,775 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:32,781 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:32,834 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:50:32,869 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46158] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46158, producerName=test-0-0, producerId=0}
2024-02-05T18:50:32,885 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:32,887 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:50:32,954 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:32,956 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-fc28fce4f1] Subscribing to topic on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739], consumerId 0
2024-02-05T18:50:32,966 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x939023e4, L:/127.0.0.1:40739 - R:/127.0.0.1:46158]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-fc28fce4f1. consumerId: 0
2024-02-05T18:50:32,997 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-fc28fce4f1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:50:32,998 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:50:32,998 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-fc28fce4f1, ackPos=3:-1, readPos=3:0}
2024-02-05T18:50:33,018 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:46158] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-fc28fce4f1
2024-02-05T18:50:33,023 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-fc28fce4f1] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 0
2024-02-05T18:50:33,034 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.01 seconds
2024-02-05T18:50:33,036 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:50:33,037 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:50:33,037 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:50:33,078 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,097 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:50:33,099 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:50:33,101 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:50:33,102 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:33 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 49
2024-02-05T18:50:33,113 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,124 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:50:33,125 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:50:33,126 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:33 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:50:33,127 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:50:33,143 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,145 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:33,154 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:50:33,161 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46158] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46158, producerName=test-0-1, producerId=1}
2024-02-05T18:50:33,162 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:33,175 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,177 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4161e0eec5] Subscribing to topic on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739], consumerId 1
2024-02-05T18:50:33,178 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x939023e4, L:/127.0.0.1:40739 - R:/127.0.0.1:46158]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4161e0eec5. consumerId: 1
2024-02-05T18:50:33,199 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4161e0eec5] Created new subscription for 1
2024-02-05T18:50:33,200 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46158] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4161e0eec5
2024-02-05T18:50:33,203 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4161e0eec5] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 1
2024-02-05T18:50:33,219 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,221 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:33,229 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:50:33,236 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46158] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46158, producerName=test-0-2, producerId=2}
2024-02-05T18:50:33,237 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:33,248 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:50:33,267 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:50:33,272 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:34069 started the ownership monitor.
2024-02-05T18:50:33,286 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:33,287 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-63acb08bf7] Subscribing to topic on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739], consumerId 2
2024-02-05T18:50:33,289 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x939023e4, L:/127.0.0.1:40739 - R:/127.0.0.1:46158]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-63acb08bf7. consumerId: 2
2024-02-05T18:50:33,300 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-63acb08bf7] Created new subscription for 2
2024-02-05T18:50:33,300 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46158] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-63acb08bf7
2024-02-05T18:50:33,301 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-63acb08bf7] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 2
2024-02-05T18:50:33,302 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:34069 plays the leader now.
2024-02-05T18:50:33,306 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.49%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.49%, msgThroughputEMA= 0.00, updatedAt= 1707151833305, reportedAt= 0
2024-02-05T18:50:33,316 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:34069/__change_events
2024-02-05T18:50:33,318 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:50:33,323 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:33,326 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:50:33,396 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:34069/0x00000000_0xffffffff - localhost:34069.
2024-02-05T18:50:33,398 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:34069
2024-02-05T18:50:33,398 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:34069/0x00000000_0xffffffff
2024-02-05T18:50:33,400 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:34069/0x00000000_0xffffffff - localhost:34069.
2024-02-05T18:50:33,401 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:34069
2024-02-05T18:50:33,401 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:34069/0x00000000_0xffffffff
2024-02-05T18:50:33,405 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:34069/__change_events][reader-4f81e50fcf] Subscribing to topic on cnx [id: 0x8dbfb52b, L:/127.0.0.1:46158 - R:localhost/127.0.0.1:40739], consumerId 3
2024-02-05T18:50:33,407 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x939023e4, L:/127.0.0.1:40739 - R:/127.0.0.1:46158]] Subscribing on topic persistent://sla-monitor/test/localhost:34069/__change_events / reader-4f81e50fcf. consumerId: 3
2024-02-05T18:50:33,414 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:34069/persistent/__change_events
2024-02-05T18:50:33,415 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:34069 doesn't exist.
2024-02-05T18:50:33,418 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:34069/persistent/__change_events'
2024-02-05T18:50:33,424 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:50:33,425 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:34069/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:50:33,433 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:34069/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:50:33,443 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:34069/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:50:33,449 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:34069/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:34069/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:50:33,451 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:34069/__change_events - dedup is disabled
2024-02-05T18:50:33,464 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:50:33,470 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:34069/__change_events][reader-4f81e50fcf] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:50:33,470 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:34069/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:50:33,470 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:34069/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34069/persistent/__change_events, cursor=reader-4f81e50fcf, ackPos=7:-1, readPos=7:0}
2024-02-05T18:50:33,473 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:46158] Created subscription on topic persistent://sla-monitor/test/localhost:34069/__change_events / reader-4f81e50fcf
2024-02-05T18:50:33,474 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:34069/__change_events][reader-4f81e50fcf] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 3
2024-02-05T18:50:33,428 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 34069, tls-port = Optional[40013], broker url= pulsar://localhost:40739, broker tls url= pulsar+ssl://localhost:39697, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40739], brokerServicePortTls=Optional[39697], webServicePort=Optional[34069], webServicePortTls=Optional[40013], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:50:34,005 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:50:34,006 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:50:34,006 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:50:34,006 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:50:34,011 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:50:34,012 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:50:34,016 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:50:34,023 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:50:34,028 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:50:34,028 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:50:34,038 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:50:34,043 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:50:34,046 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:50:34,057 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:50:34,058 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:50:34,062 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:50:34,065 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33773, TLS: (none), listener: (none)
2024-02-05T18:50:34,067 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40467, TLS: OPENSSL, listener: (none)
2024-02-05T18:50:34,072 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:50:34,073 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:50:34,074 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:50:34,089 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:50:34,092 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:50:34,093 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:50:34,093 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:50:34,173 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:50:34,327 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:34,327 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:50:34,905 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:50:35,328 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:35,328 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:50:36,238 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:50:36,329 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:36,329 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:50:36,479 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:50:36,536 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:50:36,615 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:50:36,617 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:50:36,618 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:50:36,622 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:39007}
2024-02-05T18:50:36,642 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:39789}
2024-02-05T18:50:36,643 - INFO  - [main:Server@415] - Started @17245ms
2024-02-05T18:50:36,643 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39007
2024-02-05T18:50:36,646 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39789
2024-02-05T18:50:36,651 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:50:36,655 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:50:36,673 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39007
2024-02-05T18:50:36,674 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:39007 registry has been created.
2024-02-05T18:50:36,674 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:39007. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:50:36,678 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:39007 is changing the role from null to Follower
2024-02-05T18:50:36,682 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34069).
2024-02-05T18:50:36,684 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:50:36,700 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39007 
2024-02-05T18:50:36,817 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:36 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 48
2024-02-05T18:50:36,838 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:36,841 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:50:36,843 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:50:36,858 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:36 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 37
2024-02-05T18:50:36,860 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39007/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:50:36,869 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x5f57e664, L:/127.0.0.1:49044 - R:localhost/127.0.0.1:33773]] Connected to server
2024-02-05T18:50:36,875 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:49044] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:50:36,894 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]] Connected to server
2024-02-05T18:50:36,900 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:46162] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:50:36,902 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:36,914 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46162] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46162, producerName=test-0-3, producerId=0}
2024-02-05T18:50:36,915 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:36,929 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6527c1af40] Subscribing to topic on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739], consumerId 0
2024-02-05T18:50:36,931 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x664354fa, L:/127.0.0.1:40739 - R:/127.0.0.1:46162]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6527c1af40. consumerId: 0
2024-02-05T18:50:36,936 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6527c1af40] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:50:36,937 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:50:36,937 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6527c1af40, ackPos=3:-1, readPos=3:0}
2024-02-05T18:50:36,939 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46162] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6527c1af40
2024-02-05T18:50:36,941 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6527c1af40] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 0
2024-02-05T18:50:36,944 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:50:36,945 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:50:36,976 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:36 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:50:36,987 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:36,989 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:50:36,990 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:50:36,994 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:36 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:50:36,995 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39007/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:50:37,007 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:50:37,015 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:37,018 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:50:37,018 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:50:37,022 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:50:37,022 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39007/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:50:37,041 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:37,055 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46162] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46162, producerName=test-0-4, producerId=1}
2024-02-05T18:50:37,057 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:37,070 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ab4c3116d3] Subscribing to topic on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739], consumerId 1
2024-02-05T18:50:37,072 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x664354fa, L:/127.0.0.1:40739 - R:/127.0.0.1:46162]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ab4c3116d3. consumerId: 1
2024-02-05T18:50:37,085 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ab4c3116d3] Created new subscription for 1
2024-02-05T18:50:37,086 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46162] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ab4c3116d3
2024-02-05T18:50:37,087 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ab4c3116d3] Subscribed to topic on localhost/127.0.0.1:40739 -- consumer: 1
2024-02-05T18:50:37,099 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:37,105 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46162] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46162, producerName=test-0-5, producerId=2}
2024-02-05T18:50:37,106 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x4cf662bc, L:/127.0.0.1:46162 - R:localhost/127.0.0.1:40739]
2024-02-05T18:50:37,108 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:50:37,111 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:50:37,112 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:39007 plays a follower now.
2024-02-05T18:50:37,134 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39007/__change_events
2024-02-05T18:50:37,156 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39007/0x00000000_0xffffffff - localhost:39007.
2024-02-05T18:50:37,157 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39007/0x00000000_0xffffffff
2024-02-05T18:50:37,158 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39007
2024-02-05T18:50:37,159 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39007/0x00000000_0xffffffff - localhost:39007.
2024-02-05T18:50:37,160 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39007/0x00000000_0xffffffff
2024-02-05T18:50:37,161 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39007
2024-02-05T18:50:37,164 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39007 doesn't exist.
2024-02-05T18:50:37,165 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39007/__change_events][reader-c2d1d4cfee] Subscribing to topic on cnx [id: 0x5f57e664, L:/127.0.0.1:49044 - R:localhost/127.0.0.1:33773], consumerId 2
2024-02-05T18:50:37,166 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 39007, tls-port = Optional[39789], broker url= pulsar://localhost:33773, broker tls url= pulsar+ssl://localhost:40467, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33773], brokerServicePortTls=Optional[40467], webServicePort=Optional[39007], webServicePortTls=Optional[39789], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:50:37,167 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x32cc3c45, L:/127.0.0.1:33773 - R:/127.0.0.1:49044]] Subscribing on topic persistent://sla-monitor/test/localhost:39007/__change_events / reader-c2d1d4cfee. consumerId: 2
2024-02-05T18:50:37,174 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39007/persistent/__change_events
2024-02-05T18:50:37,176 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39007/persistent/__change_events'
2024-02-05T18:50:37,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:50:37,199 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39007/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:50:37,206 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39007/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:50:37,211 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39007/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:50:37,217 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39007/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39007/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:50:37,218 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39007/__change_events - dedup is disabled
2024-02-05T18:50:37,226 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:50:37,234 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39007/__change_events][reader-c2d1d4cfee] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:50:37,234 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39007/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:50:37,235 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39007/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39007/persistent/__change_events, cursor=reader-c2d1d4cfee, ackPos=9:-1, readPos=9:0}
2024-02-05T18:50:37,238 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:49044] Created subscription on topic persistent://sla-monitor/test/localhost:39007/__change_events / reader-c2d1d4cfee
2024-02-05T18:50:37,239 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39007/__change_events][reader-c2d1d4cfee] Subscribed to topic on localhost/127.0.0.1:33773 -- consumer: 2
2024-02-05T18:50:37,330 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:50:37,331 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:50:37,384 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:50:37,385 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:50:37,414 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:50:37,417 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:50:37,439 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:50:37,439 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:50:37,444 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:50:37,445 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:50:37,474 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:50:37,474 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:50:37,475 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:50:37,476 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:50:37,476 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:50:37,479 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:50:37,489 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:50:37,489 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:50:37,494 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:50:37,495 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:50:37,509 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:50:37,509 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:50:37,509 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:50:37,510 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:50:37,510 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:50:37,519 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:50:37,545 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:50:37,559 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:50:37,560 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:50:37,574 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:50:37,586 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:37,606 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:39007 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:50:37,674 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:50:37,649 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34069 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:39007, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151837608, versionId=1]. totalHandledRequests:1
2024-02-05T18:50:37,697 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34069 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39007, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151837649, versionId=2]. totalHandledRequests:1
2024-02-05T18:50:37,709 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-91d0a67f31] Subscribing to topic on cnx [id: 0x5f57e664, L:/127.0.0.1:49044 - R:localhost/127.0.0.1:33773], consumerId 3
2024-02-05T18:50:37,711 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x32cc3c45, L:/127.0.0.1:33773 - R:/127.0.0.1:49044]] Subscribing on topic persistent://public/test/__change_events / reader-91d0a67f31. consumerId: 3
2024-02-05T18:50:37,717 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:50:37,724 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:50:37,727 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 157
2024-02-05T18:50:37,727 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:50:37,732 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:50:37,733 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:50:37,741 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:50:37,744 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:50:37,746 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:50:37,753 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:50:37,756 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:50:37,764 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:50:37,773 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-91d0a67f31] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:50:37,774 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:50:37,774 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-91d0a67f31, ackPos=11:-1, readPos=11:0}
2024-02-05T18:50:37,778 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:49044] Created subscription on topic persistent://public/test/__change_events / reader-91d0a67f31
2024-02-05T18:50:37,779 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-91d0a67f31] Subscribed to topic on localhost/127.0.0.1:33773 -- consumer: 3
2024-02-05T18:50:37,798 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34069 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39007, splitServiceUnitToDestBroker=null, force=true, timestamp=1707151837788, versionId=3]. totalHandledRequests:1
2024-02-05T18:50:37,801 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:50:37,804 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:50:37,804 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:50:37,805 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-91d0a67f31}, consumerId=3, consumerName=be185, address=/127.0.0.1:49044}
2024-02-05T18:50:37,808 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:33773] Broker notification of Closed consumer: 3
2024-02-05T18:50:37,808 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-91d0a67f31] Closed connection [id: 0x5f57e664, L:/127.0.0.1:49044 - R:localhost/127.0.0.1:33773] -- Will try again in 0.1 s
2024-02-05T18:50:37,809 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-91d0a67f31}, consumerId=3, consumerName=be185, address=/127.0.0.1:49044}
2024-02-05T18:50:37,810 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-91d0a67f31] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-91d0a67f31, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:50:37,810 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-91d0a67f31] Successfully closed dispatcher for reader
2024-02-05T18:50:37,812 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-91d0a67f31] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-91d0a67f31, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:50:37,812 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-91d0a67f31] Successfully disconnected and closed subscription
2024-02-05T18:50:37,814 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:50:37,822 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:50:37,830 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:50:37,832 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-91d0a67f31] Closed Consumer (not connected)
2024-02-05T18:50:37,834 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-91d0a67f31 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-91d0a67f31 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:37,835 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 35.0 ms
2024-02-05T18:50:37,843 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34069 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39007, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151837799, versionId=4]. totalHandledRequests:1
2024-02-05T18:50:37,844 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:50:37,844 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:50:37,845 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 113
2024-02-05T18:50:37,846 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:50:37,847 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:50:37 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 306
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:50:37,911 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-91d0a67f31] Reconnecting after timeout
2024-02-05T18:50:37,912 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-91d0a67f31] Ignoring reconnection request (state: Closed)
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27e8b1b9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48d524ce] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27e8b1b9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54022416], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48d524ce, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25c5e312] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27e8b1b9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54022416, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4742fb6a], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48d524ce, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25c5e312, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26d04418] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27e8b1b9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54022416, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4742fb6a, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63b7e640], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48d524ce, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25c5e312, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26d04418, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@69605457] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42eb061d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@62dfd290, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27e8b1b9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54022416, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4742fb6a, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63b7e640, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@39297bba], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f881b59, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3da983ff, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48d524ce, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25c5e312, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26d04418, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@69605457, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1dfd0803] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:50:37,961 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:50:37,969 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:50:37,970 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:50:37,970 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:50:37,973 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:50:37,975 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:50:37,985 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:50:37,989 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:50:37,991 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:50:37,993 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:50:37,996 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:50:37,998 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:50:38,002 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:50:38,004 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:50:38,004 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:50:38,006 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39007
2024-02-05T18:50:38,009 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39007 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:50:38,018 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:39007 registry has been deleted.
2024-02-05T18:50:38,019 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:39007 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:50:38,021 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:39007 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:50:38,022 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39007
2024-02-05T18:50:38,023 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39007 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:50:38,024 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39007 was invalidated. state Releasing
2024-02-05T18:50:38,026 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39007. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:50:38,027 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39007
2024-02-05T18:50:38,038 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39007/0x00000000_0xffffffff.
2024-02-05T18:50:38,039 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39007/0x00000000_0xffffffff.
2024-02-05T18:50:38,041 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39007/0x00000000_0xffffffff.
2024-02-05T18:50:38,041 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:50:38,043 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:50:38,050 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] Disconnected
2024-02-05T18:50:38,051 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:38,052 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:38,052 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:38,053 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:46162
2024-02-05T18:50:38,053 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6527c1af40] Closed connection [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:38,054 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x5f57e664, L:/127.0.0.1:49044 ! R:localhost/127.0.0.1:33773] Disconnected
2024-02-05T18:50:38,055 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:49044
2024-02-05T18:50:38,055 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-6527c1af40}, consumerId=0, consumerName=1d070, address=/127.0.0.1:46162}
2024-02-05T18:50:38,055 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39007/__change_events, name=reader-c2d1d4cfee}, consumerId=2, consumerName=c676b, address=/127.0.0.1:49044}
2024-02-05T18:50:38,055 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6527c1af40] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6527c1af40, ackPos=3:3, readPos=3:4}]
2024-02-05T18:50:38,055 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6527c1af40] Successfully closed dispatcher for reader
2024-02-05T18:50:38,056 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39007/__change_events] [reader-c2d1d4cfee] Closed connection [id: 0x5f57e664, L:/127.0.0.1:49044 ! R:localhost/127.0.0.1:33773] -- Will try again in 0.1 s
2024-02-05T18:50:38,056 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-ab4c3116d3}, consumerId=1, consumerName=b5a22, address=/127.0.0.1:46162}
2024-02-05T18:50:38,053 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ab4c3116d3] Closed connection [id: 0x4cf662bc, L:/127.0.0.1:46162 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:38,059 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39007/__change_events][reader-c2d1d4cfee] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39007/persistent/__change_events, cursor=reader-c2d1d4cfee, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:50:38,059 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39007/__change_events][reader-c2d1d4cfee] Successfully closed dispatcher for reader
2024-02-05T18:50:38,064 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:50:38,064 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39007/persistent/__change_events] Closing managed ledger
2024-02-05T18:50:38,067 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39007/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:50:38,067 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:50:38,069 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:50:38,070 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:50:38,078 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33773
2024-02-05T18:50:38,079 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:50:38,081 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:50:38,081 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:50:38,082 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6527c1af40] Closed Consumer (not connected)
2024-02-05T18:50:38,084 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ab4c3116d3] Closed Consumer (not connected)
2024-02-05T18:50:38,084 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6527c1af40 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6527c1af40 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:38,084 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39007/__change_events] [reader-c2d1d4cfee] Closed Consumer (not connected)
2024-02-05T18:50:38,084 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ab4c3116d3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ab4c3116d3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:38,085 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39007/__change_events with subscription name reader-c2d1d4cfee was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39007/__change_events with subscription name reader-c2d1d4cfee was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:38,091 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:50:38,092 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:50:38,095 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:50:38,096 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:38,105 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:50:38,105 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:38,264 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 39.84%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.03%, msgThroughputEMA= 0.00, updatedAt= 1707151838263, reportedAt= 1707151833363
2024-02-05T18:50:38,333 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:38,333 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:50:39,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:39,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:50:39,365 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:50:39,365 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:50:39,367 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:50:39,368 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:39,369 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:50:39,369 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:50:40,335 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:40,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:50:41,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:50:41,337 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:50:41,383 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:50:41,384 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:50:41,385 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:50:41,385 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:50:41,385 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:50:41,385 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:50:41,387 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:50:41,389 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:50:41,390 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:50:41,392 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:50:41,393 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:50:41,394 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:50:41,396 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:50:41,396 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:50:41,397 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:50:41,398 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:34069
2024-02-05T18:50:41,400 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:34069 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:50:41,409 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:34069 was invalidated. state Releasing
2024-02-05T18:50:41,409 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:34069. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:50:41,410 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:34069
2024-02-05T18:50:41,414 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:34069/0x00000000_0xffffffff.
2024-02-05T18:50:41,415 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:34069/0x00000000_0xffffffff.
2024-02-05T18:50:41,418 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:34069/0x00000000_0xffffffff.
2024-02-05T18:50:41,419 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.009 seconds
2024-02-05T18:50:41,420 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:50:41,421 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:46158
2024-02-05T18:50:41,421 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:50:41,421 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:50:41,421 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-fc28fce4f1}, consumerId=0, consumerName=c23f9, address=/127.0.0.1:46158}
2024-02-05T18:50:41,422 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:34069/persistent/__change_events] Closing managed ledger
2024-02-05T18:50:41,422 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-fc28fce4f1] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-fc28fce4f1, ackPos=3:3, readPos=3:4}]
2024-02-05T18:50:41,422 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] Disconnected
2024-02-05T18:50:41,423 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-fc28fce4f1] Successfully closed dispatcher for reader
2024-02-05T18:50:41,423 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,423 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:34069/__change_events, name=reader-4f81e50fcf}, consumerId=3, consumerName=2bad7, address=/127.0.0.1:46158}
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-fc28fce4f1] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:34069/__change_events][reader-4f81e50fcf] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34069/persistent/__change_events, cursor=reader-4f81e50fcf, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:50:41,424 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4161e0eec5] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:34069/__change_events][reader-4f81e50fcf] Successfully closed dispatcher for reader
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:34069/__change_events] [reader-4f81e50fcf] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-63acb08bf7] Closed connection [id: 0x8dbfb52b, L:/127.0.0.1:46158 ! R:localhost/127.0.0.1:40739] -- Will try again in 0.1 s
2024-02-05T18:50:41,424 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-63acb08bf7}, consumerId=2, consumerName=60619, address=/127.0.0.1:46158}
2024-02-05T18:50:41,425 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:34069/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:50:41,425 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-4161e0eec5}, consumerId=1, consumerName=98a15, address=/127.0.0.1:46158}
2024-02-05T18:50:41,425 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:50:41,425 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:50:41,426 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:50:41,431 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40739
2024-02-05T18:50:41,431 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:50:41,431 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:50:41,432 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:50:41,432 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-fc28fce4f1] Closed Consumer (not connected)
2024-02-05T18:50:41,432 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-63acb08bf7] Closed Consumer (not connected)
2024-02-05T18:50:41,432 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:34069/__change_events] [reader-4f81e50fcf] Closed Consumer (not connected)
2024-02-05T18:50:41,432 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-fc28fce4f1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-fc28fce4f1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:41,433 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4161e0eec5] Closed Consumer (not connected)
2024-02-05T18:50:41,433 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-63acb08bf7 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-63acb08bf7 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:41,433 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34069/__change_events with subscription name reader-4f81e50fcf was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34069/__change_events with subscription name reader-4f81e50fcf was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:41,434 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4161e0eec5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4161e0eec5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:50:41,437 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:50:41,437 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:50:41,437 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:50:41,437 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:50:41,438 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:50:41,438 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:41,440 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:50:41,440 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:42,830 - INFO  - [globalEventExecutor-10-5:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:50:42,830 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:50:42,833 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:50:42,833 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:42,833 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:50:42,833 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:50:42,841 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:50:42,842 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:50:42,846 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:50:42,847 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:50:42,847 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 67 with name 'Thread[AsyncHttpClient-37-1,5,main]'
2024-02-05T18:50:42,847 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:50:42,847 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 189 with name 'Thread[globalEventExecutor-10-5,5,main]'
2024-02-05T18:50:42,848 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:50:42,849 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:50:42,849 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@159e8432
2024-02-05T18:50:42,849 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:50:42,849 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:50:42,850 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 23.021 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  49.357 s
[INFO] Finished at: 2024-02-05T18:50:43+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 2 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:51:14,776 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:51:15,744 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:51:15,746 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:51:16,223 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:51:16,224 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:51:16,225 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:51:16,226 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:51:16,227 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:51:16,227 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:51:16,264 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:51:16,265 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:51:16,266 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:51:16,267 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:51:16,267 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:51:16,268 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:51:16,269 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:51:16,269 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:51:16,270 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:51:16,271 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:51:16,278 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:51:16,280 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:51:18,014 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:51:18,015 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:51:18,016 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:51:18,016 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:51:18,384 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:51:18,385 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:51:18,449 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:51:18,531 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:51:18,534 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:51:18,551 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:51:18,678 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:51:18,714 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:51:18,753 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:51:19,023 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:51:19,024 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:51:19,051 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:51:19,102 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37797, TLS: (none), listener: (none)
2024-02-05T18:51:19,459 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42043, TLS: OPENSSL, listener: (none)
2024-02-05T18:51:19,479 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:51:19,484 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:51:19,484 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:51:19,516 - INFO  - [main:Log@170] - Logging initialized @7158ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:51:20,437 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:51:20,473 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:51:20,474 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:51:20,476 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:51:21,324 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:51:22,500 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:51:23,513 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:51:23,880 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:51:23,980 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:51:24,169 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:51:24,170 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:51:24,173 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:51:24,187 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:39351}
2024-02-05T18:51:24,336 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:34651}
2024-02-05T18:51:24,337 - INFO  - [main:Server@415] - Started @11980ms
2024-02-05T18:51:24,337 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39351
2024-02-05T18:51:24,338 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34651
2024-02-05T18:51:24,345 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:51:24,346 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:51:24,535 - INFO  - [main:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39351
2024-02-05T18:51:24,554 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:51:24,558 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39351 is changing the role from null to Leader
2024-02-05T18:51:24,562 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39351).
2024-02-05T18:51:24,853 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39351 
2024-02-05T18:51:25,291 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:51:25,323 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:25,435 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:51:25,439 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:51:25,451 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:51:25,454 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:51:25,485 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:51:25,514 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:51:25,539 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:51:25,595 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:51:25,615 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:51:25,625 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:51:25,628 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:51:25,656 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:51:25,661 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 514
2024-02-05T18:51:25,809 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]] Connected to server
2024-02-05T18:51:25,848 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:49654] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:51:25,903 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:25,910 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:25,960 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:51:25,989 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49654] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:49654, producerName=test-0-0, producerId=0}
2024-02-05T18:51:25,999 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:26,001 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:51:26,054 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,056 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c75044e6cd] Subscribing to topic on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797], consumerId 0
2024-02-05T18:51:26,067 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xde6414d7, L:/127.0.0.1:37797 - R:/127.0.0.1:49654]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c75044e6cd. consumerId: 0
2024-02-05T18:51:26,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c75044e6cd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:51:26,103 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:51:26,104 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c75044e6cd, ackPos=3:-1, readPos=3:0}
2024-02-05T18:51:26,122 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49654] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c75044e6cd
2024-02-05T18:51:26,127 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c75044e6cd] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 0
2024-02-05T18:51:26,143 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:51:26,144 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:51:26,146 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:51:26,146 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:51:26,188 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,209 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:51:26,210 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:51:26,213 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:51:26,213 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:51:26,227 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,237 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:51:26,238 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:51:26,239 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:51:26,240 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:51:26,261 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,262 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:26,270 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:51:26,276 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49654] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:49654, producerName=test-0-1, producerId=1}
2024-02-05T18:51:26,277 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:26,289 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,291 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-61d0554021] Subscribing to topic on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797], consumerId 1
2024-02-05T18:51:26,293 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xde6414d7, L:/127.0.0.1:37797 - R:/127.0.0.1:49654]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-61d0554021. consumerId: 1
2024-02-05T18:51:26,316 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-61d0554021] Created new subscription for 1
2024-02-05T18:51:26,317 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49654] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-61d0554021
2024-02-05T18:51:26,318 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-61d0554021] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 1
2024-02-05T18:51:26,338 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,340 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:26,344 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:51:26,351 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49654] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:49654, producerName=test-0-2, producerId=2}
2024-02-05T18:51:26,352 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:26,364 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:51:26,380 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:51:26,385 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39351 started the ownership monitor.
2024-02-05T18:51:26,401 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:26,403 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-632bbbb276] Subscribing to topic on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797], consumerId 2
2024-02-05T18:51:26,405 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xde6414d7, L:/127.0.0.1:37797 - R:/127.0.0.1:49654]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-632bbbb276. consumerId: 2
2024-02-05T18:51:26,419 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-632bbbb276] Created new subscription for 2
2024-02-05T18:51:26,419 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49654] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-632bbbb276
2024-02-05T18:51:26,420 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-632bbbb276] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 2
2024-02-05T18:51:26,421 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39351 plays the leader now.
2024-02-05T18:51:26,425 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707151886424, reportedAt= 0
2024-02-05T18:51:26,425 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39351/__change_events
2024-02-05T18:51:26,448 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:51:26,452 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:26,453 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:51:26,496 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39351/0x00000000_0xffffffff - localhost:39351.
2024-02-05T18:51:26,499 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39351
2024-02-05T18:51:26,499 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39351/0x00000000_0xffffffff
2024-02-05T18:51:26,500 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39351/0x00000000_0xffffffff - localhost:39351.
2024-02-05T18:51:26,504 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39351/__change_events][reader-4d8531168d] Subscribing to topic on cnx [id: 0x1276ff3a, L:/127.0.0.1:49654 - R:localhost/127.0.0.1:37797], consumerId 3
2024-02-05T18:51:26,504 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39351/0x00000000_0xffffffff
2024-02-05T18:51:26,506 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39351
2024-02-05T18:51:26,507 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xde6414d7, L:/127.0.0.1:37797 - R:/127.0.0.1:49654]] Subscribing on topic persistent://sla-monitor/test/localhost:39351/__change_events / reader-4d8531168d. consumerId: 3
2024-02-05T18:51:26,516 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39351/persistent/__change_events
2024-02-05T18:51:26,519 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39351/persistent/__change_events'
2024-02-05T18:51:26,525 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:51:26,526 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39351/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:51:26,528 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39351 doesn't exist.
2024-02-05T18:51:26,534 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39351/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:51:26,540 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39351/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:51:26,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39351/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39351/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:51:26,549 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39351/__change_events - dedup is disabled
2024-02-05T18:51:26,560 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:51:26,573 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39351/__change_events][reader-4d8531168d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:51:26,574 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39351/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:51:26,574 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39351/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39351/persistent/__change_events, cursor=reader-4d8531168d, ackPos=7:-1, readPos=7:0}
2024-02-05T18:51:26,576 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:49654] Created subscription on topic persistent://sla-monitor/test/localhost:39351/__change_events / reader-4d8531168d
2024-02-05T18:51:26,577 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39351/__change_events][reader-4d8531168d] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 3
2024-02-05T18:51:26,544 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 39351, tls-port = Optional[34651], broker url= pulsar://localhost:37797, broker tls url= pulsar+ssl://localhost:42043, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37797], brokerServicePortTls=Optional[42043], webServicePort=Optional[39351], webServicePortTls=Optional[34651], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:51:27,099 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:51:27,099 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:51:27,099 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:51:27,100 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:51:27,104 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:51:27,106 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:51:27,111 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:51:27,115 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:51:27,121 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:51:27,122 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:51:27,128 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:51:27,131 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:51:27,133 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:51:27,141 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:51:27,141 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:51:27,146 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:51:27,149 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33805, TLS: (none), listener: (none)
2024-02-05T18:51:27,151 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39857, TLS: OPENSSL, listener: (none)
2024-02-05T18:51:27,156 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:51:27,157 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:51:27,157 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:51:27,170 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:51:27,175 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:51:27,175 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:51:27,175 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:51:27,257 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/,null,AVAILABLE}
2024-02-05T18:51:27,454 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:27,455 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:51:27,967 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/admin,null,AVAILABLE}
2024-02-05T18:51:28,455 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:28,456 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:51:29,343 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin/v2,null,AVAILABLE}
2024-02-05T18:51:29,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:29,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:51:29,596 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v3,null,AVAILABLE}
2024-02-05T18:51:29,667 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/lookup,null,AVAILABLE}
2024-02-05T18:51:29,760 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/topics,null,AVAILABLE}
2024-02-05T18:51:29,762 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/metrics,null,AVAILABLE}
2024-02-05T18:51:29,762 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7537f638{/static,null,AVAILABLE}
2024-02-05T18:51:29,764 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{HTTP/1.1, (http/1.1)}{0.0.0.0:33965}
2024-02-05T18:51:29,771 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3af4b14e{SSL, (ssl, http/1.1)}{0.0.0.0:38629}
2024-02-05T18:51:29,771 - INFO  - [main:Server@415] - Started @17415ms
2024-02-05T18:51:29,772 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33965
2024-02-05T18:51:29,774 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:38629
2024-02-05T18:51:29,776 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:51:29,777 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:51:29,791 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33965
2024-02-05T18:51:29,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:33965 registry has been created.
2024-02-05T18:51:29,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:33965. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:51:29,796 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:33965 is changing the role from null to Follower
2024-02-05T18:51:29,801 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39351).
2024-02-05T18:51:29,806 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:51:29,824 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33965 
2024-02-05T18:51:29,936 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:29 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 51
2024-02-05T18:51:29,959 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:29,961 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:51:29,963 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:51:29,975 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:29 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 33
2024-02-05T18:51:29,980 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33965/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:51:29,992 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x9cf57b0c, L:/127.0.0.1:50806 - R:localhost/127.0.0.1:33805]] Connected to server
2024-02-05T18:51:29,997 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:50806] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:51:30,017 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]] Connected to server
2024-02-05T18:51:30,022 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:49656] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:51:30,023 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,033 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49656] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:49656, producerName=test-0-3, producerId=0}
2024-02-05T18:51:30,034 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,047 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-3545b5d9f1] Subscribing to topic on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797], consumerId 0
2024-02-05T18:51:30,048 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xcc8e7452, L:/127.0.0.1:37797 - R:/127.0.0.1:49656]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-3545b5d9f1. consumerId: 0
2024-02-05T18:51:30,055 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-3545b5d9f1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:51:30,055 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:51:30,056 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-3545b5d9f1, ackPos=3:-1, readPos=3:0}
2024-02-05T18:51:30,058 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49656] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-3545b5d9f1
2024-02-05T18:51:30,059 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-3545b5d9f1] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 0
2024-02-05T18:51:30,062 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:51:30,063 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:51:30,091 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:51:30,102 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:30,106 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:51:30,106 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:51:30,111 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:51:30,111 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33965/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:51:30,126 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:51:30,131 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:30,134 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:51:30,135 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:51:30,138 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:51:30,139 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:33965/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:51:30,161 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,171 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49656] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:49656, producerName=test-0-4, producerId=1}
2024-02-05T18:51:30,173 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,185 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-5f7f5b3ec9] Subscribing to topic on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797], consumerId 1
2024-02-05T18:51:30,187 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xcc8e7452, L:/127.0.0.1:37797 - R:/127.0.0.1:49656]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-5f7f5b3ec9. consumerId: 1
2024-02-05T18:51:30,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-5f7f5b3ec9] Created new subscription for 1
2024-02-05T18:51:30,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49656] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-5f7f5b3ec9
2024-02-05T18:51:30,199 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-5f7f5b3ec9] Subscribed to topic on localhost/127.0.0.1:37797 -- consumer: 1
2024-02-05T18:51:30,216 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,223 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49656] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:49656, producerName=test-0-5, producerId=2}
2024-02-05T18:51:30,224 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x341494e9, L:/127.0.0.1:49656 - R:localhost/127.0.0.1:37797]
2024-02-05T18:51:30,225 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:51:30,228 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:51:30,229 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:33965 plays a follower now.
2024-02-05T18:51:30,247 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33965/__change_events
2024-02-05T18:51:30,272 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33965/0x00000000_0xffffffff - localhost:33965.
2024-02-05T18:51:30,273 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33965
2024-02-05T18:51:30,273 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33965/0x00000000_0xffffffff
2024-02-05T18:51:30,274 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33965/0x00000000_0xffffffff - localhost:33965.
2024-02-05T18:51:30,275 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33965/0x00000000_0xffffffff
2024-02-05T18:51:30,281 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33965/__change_events][reader-4b98684558] Subscribing to topic on cnx [id: 0x9cf57b0c, L:/127.0.0.1:50806 - R:localhost/127.0.0.1:33805], consumerId 2
2024-02-05T18:51:30,280 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33965
2024-02-05T18:51:30,283 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x968ffc24, L:/127.0.0.1:33805 - R:/127.0.0.1:50806]] Subscribing on topic persistent://sla-monitor/test/localhost:33965/__change_events / reader-4b98684558. consumerId: 2
2024-02-05T18:51:30,284 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33965 doesn't exist.
2024-02-05T18:51:30,287 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 33965, tls-port = Optional[38629], broker url= pulsar://localhost:33805, broker tls url= pulsar+ssl://localhost:39857, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33805], brokerServicePortTls=Optional[39857], webServicePort=Optional[33965], webServicePortTls=Optional[38629], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:51:30,292 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33965/persistent/__change_events
2024-02-05T18:51:30,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33965/persistent/__change_events'
2024-02-05T18:51:30,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:51:30,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33965/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:51:30,315 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33965/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:51:30,325 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33965/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:51:30,331 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33965/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33965/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:51:30,332 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33965/__change_events - dedup is disabled
2024-02-05T18:51:30,338 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:51:30,346 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33965/__change_events][reader-4b98684558] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:51:30,347 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33965/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:51:30,347 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33965/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33965/persistent/__change_events, cursor=reader-4b98684558, ackPos=9:-1, readPos=9:0}
2024-02-05T18:51:30,349 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:50806] Created subscription on topic persistent://sla-monitor/test/localhost:33965/__change_events / reader-4b98684558
2024-02-05T18:51:30,350 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33965/__change_events][reader-4b98684558] Subscribed to topic on localhost/127.0.0.1:33805 -- consumer: 2
2024-02-05T18:51:30,458 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:51:30,459 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:51:30,522 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:51:30,524 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:51:30,553 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:51:30,554 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:51:30,583 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:51:30,583 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:51:30,588 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:51:30,589 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:51:30,613 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:51:30,613 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:51:30,614 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:51:30,616 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:51:30,617 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:51:30,622 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:51:30,632 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:51:30,632 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:51:30,638 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:51:30,639 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:51:30,648 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:51:30,648 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:51:30,648 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:51:30,649 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:51:30,651 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:51:30,654 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:51:30,682 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:51:30,695 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:51:30,695 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:51:30,709 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:51:30,719 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:30,740 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33965 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:51:30,815 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:51:30,789 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39351 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33965, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151890742, versionId=1]. totalHandledRequests:1
2024-02-05T18:51:30,825 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39351 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33965, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151890789, versionId=2]. totalHandledRequests:1
2024-02-05T18:51:30,829 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:51:30,838 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 132
2024-02-05T18:51:30,851 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:51:30,881 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39351 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33965, splitServiceUnitToDestBroker=null, force=true, timestamp=1707151890873, versionId=3]. totalHandledRequests:1
2024-02-05T18:51:30,885 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-26f3fb6de0] Subscribing to topic on cnx [id: 0x9cf57b0c, L:/127.0.0.1:50806 - R:localhost/127.0.0.1:33805], consumerId 3
2024-02-05T18:51:30,887 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x968ffc24, L:/127.0.0.1:33805 - R:/127.0.0.1:50806]] Subscribing on topic persistent://public/test/__change_events / reader-26f3fb6de0. consumerId: 3
2024-02-05T18:51:30,894 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 8.0 ms
2024-02-05T18:51:30,902 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39351 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33965, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151890885, versionId=4]. totalHandledRequests:1
2024-02-05T18:51:30,904 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33965. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:51:30,905 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:50806][persistent://public/test/__change_events][reader-26f3fb6de0] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33965. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:51:30,907 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:51:30,907 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x9cf57b0c, L:/127.0.0.1:50806 - R:localhost/127.0.0.1:33805] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33965. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:51:30,909 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:51:30,910 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-26f3fb6de0] Failed to subscribe to topic on localhost/127.0.0.1:33805
2024-02-05T18:51:30,910 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33965. Please redo the lookup. Request is denied: namespace=public/test","reqId":1621634799463487748, "remote":"localhost/127.0.0.1:33805", "local":"/127.0.0.1:50806"}
2024-02-05T18:51:30,910 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:33965. Please redo the lookup. Request is denied: namespace=public/test","reqId":1621634799463487748, "remote":"localhost/127.0.0.1:33805", "local":"/127.0.0.1:50806"} -- Will try again in 0.1 s
2024-02-05T18:51:30,911 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:51:30,912 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 68
2024-02-05T18:51:30,912 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:51:30 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 234
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26681136], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@579d6bb6] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26681136, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cd3f83b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@579d6bb6, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@9318b3d] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:51:31,011 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:51:31,012 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Reconnecting after connection was closed
2024-02-05T18:51:31,014 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x9cf57b0c, L:/127.0.0.1:50806 - R:localhost/127.0.0.1:33805] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:51:31,015 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":1621634799463487749, "remote":"localhost/127.0.0.1:33805", "local":"/127.0.0.1:50806"}
2024-02-05T18:51:31,016 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":1621634799463487749, "remote":"localhost/127.0.0.1:33805", "local":"/127.0.0.1:50806"}
2024-02-05T18:51:31,016 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":1621634799463487749, "remote":"localhost/127.0.0.1:33805", "local":"/127.0.0.1:50806"} -- Will try again in 0.189 s
2024-02-05T18:51:31,016 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:50806
2024-02-05T18:51:31,016 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x9cf57b0c, L:/127.0.0.1:50806 ! R:localhost/127.0.0.1:33805] Disconnected
2024-02-05T18:51:31,018 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33965/__change_events, name=reader-4b98684558}, consumerId=2, consumerName=c7987, address=/127.0.0.1:50806}
2024-02-05T18:51:31,019 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33965/__change_events] [reader-4b98684558] Closed connection [id: 0x9cf57b0c, L:/127.0.0.1:50806 ! R:localhost/127.0.0.1:33805] -- Will try again in 0.1 s
2024-02-05T18:51:31,019 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33965/__change_events][reader-4b98684558] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33965/persistent/__change_events, cursor=reader-4b98684558, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:51:31,020 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33965/__change_events][reader-4b98684558] Successfully closed dispatcher for reader
2024-02-05T18:51:31,023 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:51:31,024 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3af4b14e{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:51:31,024 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:51:31,026 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7537f638{/static,null,STOPPED}
2024-02-05T18:51:31,029 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/metrics,null,STOPPED}
2024-02-05T18:51:31,039 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/topics,null,STOPPED}
2024-02-05T18:51:31,042 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/lookup,null,STOPPED}
2024-02-05T18:51:31,044 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v3,null,STOPPED}
2024-02-05T18:51:31,046 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin/v2,null,STOPPED}
2024-02-05T18:51:31,049 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/admin,null,STOPPED}
2024-02-05T18:51:31,051 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/,null,STOPPED}
2024-02-05T18:51:31,054 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:51:31,056 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:51:31,057 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:51:31,058 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33965
2024-02-05T18:51:31,059 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33965 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:51:31,066 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:33965 registry has been deleted.
2024-02-05T18:51:31,067 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:33965 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:51:31,067 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33965 was invalidated. state Releasing
2024-02-05T18:51:31,069 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33965. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:51:31,070 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:33965 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:51:31,070 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33965
2024-02-05T18:51:31,070 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33965
2024-02-05T18:51:31,072 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33965 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:51:31,093 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33965/0x00000000_0xffffffff.
2024-02-05T18:51:31,095 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33965/0x00000000_0xffffffff.
2024-02-05T18:51:31,097 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33965/0x00000000_0xffffffff.
2024-02-05T18:51:31,098 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.027 seconds
2024-02-05T18:51:31,099 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:51:31,105 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] Disconnected
2024-02-05T18:51:31,105 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:31,106 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:31,106 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:31,106 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-3545b5d9f1] Closed connection [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:31,106 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-5f7f5b3ec9] Closed connection [id: 0x341494e9, L:/127.0.0.1:49656 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:31,107 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:49656
2024-02-05T18:51:31,109 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-3545b5d9f1}, consumerId=0, consumerName=47e2e, address=/127.0.0.1:49656}
2024-02-05T18:51:31,109 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-3545b5d9f1] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-3545b5d9f1, ackPos=3:3, readPos=3:4}]
2024-02-05T18:51:31,109 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-3545b5d9f1] Successfully closed dispatcher for reader
2024-02-05T18:51:31,110 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-5f7f5b3ec9}, consumerId=1, consumerName=00111, address=/127.0.0.1:49656}
2024-02-05T18:51:31,114 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:51:31,115 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33965/persistent/__change_events] Closing managed ledger
2024-02-05T18:51:31,124 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:33965/__change_events] [reader-4b98684558] Reconnecting after timeout
2024-02-05T18:51:31,126 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33965/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:51:31,126 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:51:31,128 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:51:31,130 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:51:31,136 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33805
2024-02-05T18:51:31,137 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:51:31,139 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:51:31,139 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:51:31,140 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-26f3fb6de0] Closed Consumer (not connected)
2024-02-05T18:51:31,141 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-5f7f5b3ec9] Closed Consumer (not connected)
2024-02-05T18:51:31,142 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-5f7f5b3ec9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-5f7f5b3ec9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:31,143 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-3545b5d9f1] Closed Consumer (not connected)
2024-02-05T18:51:31,143 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-3545b5d9f1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-3545b5d9f1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:31,144 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33965/__change_events] [reader-4b98684558] Closed Consumer (not connected)
2024-02-05T18:51:31,144 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33965/__change_events with subscription name reader-4b98684558 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33965/__change_events with subscription name reader-4b98684558 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:31,152 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:51:31,152 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:51:31,156 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:51:31,157 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:31,166 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:51:31,166 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:31,212 - WARN  - [pulsar-io-64-2:ConnectionPool@304] - Failed to open connection to localhost/<unresolved>:33805 : java.nio.channels.ClosedChannelException
2024-02-05T18:51:31,212 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:33965/__change_events] [reader-4b98684558] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: java.util.concurrent.CompletionException: java.nio.channels.ClosedChannelException
2024-02-05T18:51:31,212 - INFO  - [pulsar-io-64-2:ConnectionHandler@132] - [persistent://sla-monitor/test/localhost:33965/__change_events] [reader-4b98684558] Ignoring reconnection request (state: Closed)
2024-02-05T18:51:31,378 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 37.11%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.23%, msgThroughputEMA= 0.00, updatedAt= 1707151891377, reportedAt= 1707151886486
2024-02-05T18:51:31,464 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:31,464 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:51:32,465 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:32,465 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:51:32,517 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:51:32,517 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:51:32,520 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:51:32,520 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:32,521 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:51:32,521 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:51:33,466 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:33,466 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:51:34,467 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:51:34,467 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:51:34,536 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:51:34,537 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:51:34,537 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:51:34,538 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:51:34,538 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:51:34,538 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:51:34,540 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:51:34,542 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:51:34,543 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:51:34,544 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:51:34,546 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:51:34,547 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:51:34,548 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:51:34,548 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:51:34,548 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:51:34,549 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39351
2024-02-05T18:51:34,551 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39351 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:51:34,559 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39351 was invalidated. state Releasing
2024-02-05T18:51:34,560 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39351. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:51:34,560 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39351
2024-02-05T18:51:34,564 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39351/0x00000000_0xffffffff.
2024-02-05T18:51:34,565 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39351/0x00000000_0xffffffff.
2024-02-05T18:51:34,566 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39351/0x00000000_0xffffffff.
2024-02-05T18:51:34,566 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.005 seconds
2024-02-05T18:51:34,567 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:51:34,568 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:49654
2024-02-05T18:51:34,568 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-c75044e6cd}, consumerId=0, consumerName=82d62, address=/127.0.0.1:49654}
2024-02-05T18:51:34,568 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] Disconnected
2024-02-05T18:51:34,568 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c75044e6cd] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c75044e6cd, ackPos=3:3, readPos=3:4}]
2024-02-05T18:51:34,568 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c75044e6cd] Successfully closed dispatcher for reader
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39351/__change_events, name=reader-4d8531168d}, consumerId=3, consumerName=207ef, address=/127.0.0.1:49654}
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c75044e6cd] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-61d0554021] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39351/__change_events][reader-4d8531168d] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39351/persistent/__change_events, cursor=reader-4d8531168d, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39351/__change_events] [reader-4d8531168d] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39351/__change_events][reader-4d8531168d] Successfully closed dispatcher for reader
2024-02-05T18:51:34,569 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-632bbbb276] Closed connection [id: 0x1276ff3a, L:/127.0.0.1:49654 ! R:localhost/127.0.0.1:37797] -- Will try again in 0.1 s
2024-02-05T18:51:34,570 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-632bbbb276}, consumerId=2, consumerName=7e498, address=/127.0.0.1:49654}
2024-02-05T18:51:34,570 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-61d0554021}, consumerId=1, consumerName=36f7f, address=/127.0.0.1:49654}
2024-02-05T18:51:34,571 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:51:34,571 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:51:34,572 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39351/persistent/__change_events] Closing managed ledger
2024-02-05T18:51:34,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39351/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:51:34,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:51:34,575 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:51:34,575 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:51:34,576 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:51:34,580 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37797
2024-02-05T18:51:34,580 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:51:34,581 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:51:34,581 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:51:34,581 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-632bbbb276] Closed Consumer (not connected)
2024-02-05T18:51:34,581 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-61d0554021] Closed Consumer (not connected)
2024-02-05T18:51:34,581 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39351/__change_events] [reader-4d8531168d] Closed Consumer (not connected)
2024-02-05T18:51:34,581 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-632bbbb276 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-632bbbb276 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:34,582 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-61d0554021 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-61d0554021 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:34,582 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c75044e6cd] Closed Consumer (not connected)
2024-02-05T18:51:34,582 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39351/__change_events with subscription name reader-4d8531168d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39351/__change_events with subscription name reader-4d8531168d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:34,583 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c75044e6cd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c75044e6cd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:51:34,591 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:51:34,591 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:51:34,591 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:51:34,591 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:51:34,592 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:51:34,595 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:34,596 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:51:34,596 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:35,974 - INFO  - [globalEventExecutor-10-5:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:51:35,975 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:51:35,976 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:51:35,977 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:35,978 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:51:35,978 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:51:35,990 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:51:35,990 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:51:35,994 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:51:35,994 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:51:35,994 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 67 with name 'Thread[AsyncHttpClient-37-1,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 189 with name 'Thread[globalEventExecutor-10-5,5,main]'
2024-02-05T18:51:35,995 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:51:35,995 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:51:35,996 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@7a72fc23
2024-02-05T18:51:35,996 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:51:35,996 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:51:35,996 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 23.106 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  49.794 s
[INFO] Finished at: 2024-02-05T18:51:36+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 3 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:52:07,421 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:52:08,376 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:52:08,378 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:52:08,860 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:52:08,861 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:52:08,862 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:52:08,863 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:52:08,863 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:52:08,864 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:52:08,888 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:52:08,889 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:52:08,889 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:52:08,890 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:52:08,890 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:52:08,891 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:52:08,891 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:52:08,892 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:52:08,892 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:52:08,893 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:52:08,893 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:52:08,894 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:52:10,501 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:52:10,501 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:52:10,502 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:52:10,502 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:52:10,864 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:52:10,865 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:52:10,940 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:52:11,013 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:52:11,016 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:52:11,032 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:52:11,132 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:52:11,175 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:52:11,215 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:52:11,645 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:52:11,646 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:52:11,683 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:52:11,763 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33789, TLS: (none), listener: (none)
2024-02-05T18:52:12,082 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42021, TLS: OPENSSL, listener: (none)
2024-02-05T18:52:12,105 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:52:12,111 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:52:12,112 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:52:12,151 - INFO  - [main:Log@170] - Logging initialized @7004ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:52:13,035 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:52:13,069 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:52:13,069 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:52:13,072 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:52:13,890 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:52:15,118 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:52:16,380 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:52:16,791 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:52:16,937 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:52:17,095 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:52:17,096 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:52:17,099 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:52:17,115 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:38203}
2024-02-05T18:52:17,247 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:33603}
2024-02-05T18:52:17,248 - INFO  - [main:Server@415] - Started @12104ms
2024-02-05T18:52:17,248 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38203
2024-02-05T18:52:17,249 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33603
2024-02-05T18:52:17,255 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:52:17,256 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:52:17,414 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38203
2024-02-05T18:52:17,434 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:52:17,438 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:38203 is changing the role from null to Leader
2024-02-05T18:52:17,441 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38203).
2024-02-05T18:52:17,769 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38203 
2024-02-05T18:52:18,237 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:52:18,267 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:18,370 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:52:18,374 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:52:18,386 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:52:18,389 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:52:18,436 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:52:18,467 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:52:18,495 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:52:18,571 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:52:18,596 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:52:18,611 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:52:18,614 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:52:18,650 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:52:18,656 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:18 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 563
2024-02-05T18:52:18,831 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]] Connected to server
2024-02-05T18:52:18,866 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:54100] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:52:18,923 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:18,932 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,003 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:52:19,038 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:54100] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:54100, producerName=test-0-0, producerId=0}
2024-02-05T18:52:19,048 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,050 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:52:19,101 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,102 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8981e422c0] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 0
2024-02-05T18:52:19,115 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8981e422c0. consumerId: 0
2024-02-05T18:52:19,155 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8981e422c0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:19,157 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:52:19,157 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8981e422c0, ackPos=3:-1, readPos=3:0}
2024-02-05T18:52:19,182 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8981e422c0
2024-02-05T18:52:19,188 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8981e422c0] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 0
2024-02-05T18:52:19,210 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.02 seconds
2024-02-05T18:52:19,211 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:52:19,213 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:52:19,213 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:52:19,249 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,267 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:52:19,268 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:52:19,270 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:52:19,270 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 44
2024-02-05T18:52:19,281 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,294 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:52:19,295 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:52:19,297 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:52:19,298 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:52:19,320 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,322 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,330 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:52:19,337 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:54100] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:54100, producerName=test-0-1, producerId=1}
2024-02-05T18:52:19,339 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,354 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,356 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d229d2cfaf] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 1
2024-02-05T18:52:19,358 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d229d2cfaf. consumerId: 1
2024-02-05T18:52:19,381 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d229d2cfaf] Created new subscription for 1
2024-02-05T18:52:19,382 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d229d2cfaf
2024-02-05T18:52:19,383 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d229d2cfaf] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 1
2024-02-05T18:52:19,401 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,403 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,410 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:52:19,416 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:54100] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:54100, producerName=test-0-2, producerId=2}
2024-02-05T18:52:19,418 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:19,433 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:52:19,461 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:52:19,467 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:38203 started the ownership monitor.
2024-02-05T18:52:19,486 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:19,488 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-3d22e7d934] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 2
2024-02-05T18:52:19,491 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-3d22e7d934. consumerId: 2
2024-02-05T18:52:19,506 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-3d22e7d934] Created new subscription for 2
2024-02-05T18:52:19,506 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-3d22e7d934
2024-02-05T18:52:19,507 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-3d22e7d934] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 2
2024-02-05T18:52:19,508 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:38203 plays the leader now.
2024-02-05T18:52:19,512 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707151939511, reportedAt= 0
2024-02-05T18:52:19,512 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38203/__change_events
2024-02-05T18:52:19,536 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:52:19,541 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:19,542 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:52:19,614 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38203/0x00000000_0xffffffff - localhost:38203.
2024-02-05T18:52:19,616 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38203
2024-02-05T18:52:19,616 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38203/0x00000000_0xffffffff
2024-02-05T18:52:19,617 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38203/0x00000000_0xffffffff - localhost:38203.
2024-02-05T18:52:19,619 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38203/0x00000000_0xffffffff
2024-02-05T18:52:19,620 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38203
2024-02-05T18:52:19,635 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38203 doesn't exist.
2024-02-05T18:52:19,636 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38203/__change_events][reader-d4eeb49fd8] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 3
2024-02-05T18:52:19,639 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic persistent://sla-monitor/test/localhost:38203/__change_events / reader-d4eeb49fd8. consumerId: 3
2024-02-05T18:52:19,646 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38203/persistent/__change_events
2024-02-05T18:52:19,649 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38203/persistent/__change_events'
2024-02-05T18:52:19,655 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:52:19,656 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38203/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:52:19,664 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38203/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:52:19,670 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38203/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:52:19,675 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38203/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38203/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:52:19,676 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38203/__change_events - dedup is disabled
2024-02-05T18:52:19,690 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:52:19,696 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38203/__change_events][reader-d4eeb49fd8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:19,697 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38203/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:52:19,697 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38203/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38203/persistent/__change_events, cursor=reader-d4eeb49fd8, ackPos=7:-1, readPos=7:0}
2024-02-05T18:52:19,703 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic persistent://sla-monitor/test/localhost:38203/__change_events / reader-d4eeb49fd8
2024-02-05T18:52:19,704 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38203/__change_events][reader-d4eeb49fd8] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 3
2024-02-05T18:52:19,659 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 38203, tls-port = Optional[33603], broker url= pulsar://localhost:33789, broker tls url= pulsar+ssl://localhost:42021, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33789], brokerServicePortTls=Optional[42021], webServicePort=Optional[38203], webServicePortTls=Optional[33603], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:52:20,313 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:52:20,314 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:52:20,314 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:52:20,314 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:52:20,319 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:52:20,319 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:52:20,326 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:52:20,330 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:52:20,336 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:52:20,337 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:52:20,345 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:52:20,348 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:52:20,364 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:52:20,381 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:52:20,381 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:52:20,391 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:52:20,402 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42659, TLS: (none), listener: (none)
2024-02-05T18:52:20,404 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36495, TLS: OPENSSL, listener: (none)
2024-02-05T18:52:20,409 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:52:20,410 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:52:20,411 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:52:20,426 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:52:20,428 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:52:20,429 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:52:20,429 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:52:20,516 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:52:20,542 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:20,543 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:52:21,122 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:52:21,544 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:21,545 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:52:22,329 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:52:22,546 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:22,546 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:52:22,562 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:52:22,647 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:52:22,754 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:52:22,755 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:52:22,756 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:52:22,757 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:39169}
2024-02-05T18:52:22,767 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:36067}
2024-02-05T18:52:22,768 - INFO  - [main:Server@415] - Started @17624ms
2024-02-05T18:52:22,769 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39169
2024-02-05T18:52:22,773 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:36067
2024-02-05T18:52:22,778 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:52:22,779 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:52:22,822 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:39169 registry has been created.
2024-02-05T18:52:22,822 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39169
2024-02-05T18:52:22,823 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:39169. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:52:22,830 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:39169 is changing the role from null to Follower
2024-02-05T18:52:22,833 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38203).
2024-02-05T18:52:22,838 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:52:22,853 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39169 
2024-02-05T18:52:22,981 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:22 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 50
2024-02-05T18:52:23,004 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,007 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:52:23,008 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:52:23,023 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:22 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 36
2024-02-05T18:52:23,025 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39169/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:52:23,035 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xd0ce578b, L:/127.0.0.1:35852 - R:localhost/127.0.0.1:42659]] Connected to server
2024-02-05T18:52:23,040 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:35852] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:52:23,058 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]] Connected to server
2024-02-05T18:52:23,062 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:39982] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:52:23,063 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,075 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39982] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:39982, producerName=test-0-3, producerId=0}
2024-02-05T18:52:23,077 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,091 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-006cae0e75] Subscribing to topic on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789], consumerId 0
2024-02-05T18:52:23,093 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xa50ca241, L:/127.0.0.1:33789 - R:/127.0.0.1:39982]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-006cae0e75. consumerId: 0
2024-02-05T18:52:23,099 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-006cae0e75] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:23,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:52:23,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-006cae0e75, ackPos=3:-1, readPos=3:0}
2024-02-05T18:52:23,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39982] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-006cae0e75
2024-02-05T18:52:23,104 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-006cae0e75] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 0
2024-02-05T18:52:23,106 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:52:23,107 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:52:23,138 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:52:23,142 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,145 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:52:23,145 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:52:23,150 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39169/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:52:23,150 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:52:23,165 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:52:23,173 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,176 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:52:23,177 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:52:23,181 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:39169/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:52:23,181 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:52:23,200 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,208 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39982] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:39982, producerName=test-0-4, producerId=1}
2024-02-05T18:52:23,209 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,222 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0af5b10839] Subscribing to topic on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789], consumerId 1
2024-02-05T18:52:23,224 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xa50ca241, L:/127.0.0.1:33789 - R:/127.0.0.1:39982]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0af5b10839. consumerId: 1
2024-02-05T18:52:23,237 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0af5b10839] Created new subscription for 1
2024-02-05T18:52:23,237 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39982] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0af5b10839
2024-02-05T18:52:23,238 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0af5b10839] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 1
2024-02-05T18:52:23,255 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,270 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39982] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:39982, producerName=test-0-5, producerId=2}
2024-02-05T18:52:23,271 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x425248c6, L:/127.0.0.1:39982 - R:localhost/127.0.0.1:33789]
2024-02-05T18:52:23,273 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:52:23,277 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:52:23,279 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:39169 plays a follower now.
2024-02-05T18:52:23,304 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39169/__change_events
2024-02-05T18:52:23,328 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39169/0x00000000_0xffffffff - localhost:39169.
2024-02-05T18:52:23,330 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39169/0x00000000_0xffffffff
2024-02-05T18:52:23,332 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39169
2024-02-05T18:52:23,334 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39169/0x00000000_0xffffffff - localhost:39169.
2024-02-05T18:52:23,335 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39169
2024-02-05T18:52:23,335 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39169/0x00000000_0xffffffff
2024-02-05T18:52:23,339 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39169 doesn't exist.
2024-02-05T18:52:23,340 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39169/__change_events][reader-0d4cfaa02b] Subscribing to topic on cnx [id: 0xd0ce578b, L:/127.0.0.1:35852 - R:localhost/127.0.0.1:42659], consumerId 2
2024-02-05T18:52:23,342 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xdb3a0c6e, L:/127.0.0.1:42659 - R:/127.0.0.1:35852]] Subscribing on topic persistent://sla-monitor/test/localhost:39169/__change_events / reader-0d4cfaa02b. consumerId: 2
2024-02-05T18:52:23,342 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 39169, tls-port = Optional[36067], broker url= pulsar://localhost:42659, broker tls url= pulsar+ssl://localhost:36495, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[42659], brokerServicePortTls=Optional[36495], webServicePort=Optional[39169], webServicePortTls=Optional[36067], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:52:23,349 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39169/persistent/__change_events
2024-02-05T18:52:23,352 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39169/persistent/__change_events'
2024-02-05T18:52:23,376 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:52:23,378 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39169/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:52:23,383 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39169/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:52:23,387 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39169/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:52:23,393 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39169/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39169/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:52:23,394 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39169/__change_events - dedup is disabled
2024-02-05T18:52:23,401 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:52:23,408 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39169/__change_events][reader-0d4cfaa02b] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:23,408 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39169/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:52:23,409 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39169/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39169/persistent/__change_events, cursor=reader-0d4cfaa02b, ackPos=9:-1, readPos=9:0}
2024-02-05T18:52:23,412 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:35852] Created subscription on topic persistent://sla-monitor/test/localhost:39169/__change_events / reader-0d4cfaa02b
2024-02-05T18:52:23,413 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39169/__change_events][reader-0d4cfaa02b] Subscribed to topic on localhost/127.0.0.1:42659 -- consumer: 2
2024-02-05T18:52:23,535 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:52:23,536 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:52:23,547 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:52:23,548 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:52:23,565 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:52:23,567 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:52:23,590 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:52:23,591 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:52:23,595 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:52:23,597 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:52:23,621 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:52:23,622 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:52:23,622 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:52:23,623 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:52:23,624 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:52:23,626 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:52:23,640 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:52:23,641 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:52:23,645 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:52:23,647 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:52:23,660 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:52:23,661 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:52:23,661 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:52:23,667 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:52:23,674 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:52:23,677 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:52:23,697 - INFO  - [pulsar-web-30-8:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:52:23,709 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:52:23,709 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:52:23,723 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:52:23,733 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,748 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38203 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:52:23,798 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38203, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943750, versionId=1]. totalHandledRequests:1
2024-02-05T18:52:23,830 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38203, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943817, versionId=2]. totalHandledRequests:1
2024-02-05T18:52:23,833 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,854 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:52:23,861 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:52:23,863 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:52:23,884 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38203, splitServiceUnitToDestBroker=null, force=true, timestamp=1707151943844, versionId=3]. totalHandledRequests:1
2024-02-05T18:52:23,891 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:52:23,895 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:23,904 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38203, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943884, versionId=4]. totalHandledRequests:1
2024-02-05T18:52:23,907 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:52:23,907 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:52:23,907 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38203. Skipping this broker. Phase one
2024-02-05T18:52:23,908 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:38203. Skipping this broker. Phase two
2024-02-05T18:52:23,908 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38203 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:52:23,909 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 189
2024-02-05T18:52:23,910 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:52:23,911 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:52:23 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 218
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:52:23,928 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38203, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943908, versionId=5]. totalHandledRequests:2
2024-02-05T18:52:23,981 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38203, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943928, versionId=6]. totalHandledRequests:2
2024-02-05T18:52:23,983 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:52:23,986 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-67824c3d94] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 4
2024-02-05T18:52:23,988 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic persistent://public/test/__change_events / reader-67824c3d94. consumerId: 4
2024-02-05T18:52:24,001 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a5d6ed2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2fdddbe5] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a5d6ed2, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@873bd36], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2fdddbe5, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29a6786e] 
2024-02-05T18:52:24,008 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:52:24,015 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:52:24,016 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:52:24,026 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:52:24,030 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:52:24,037 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:52:24,040 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:52:24,042 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-4091d3af9b] Subscribing to topic on cnx [id: 0xac5f9982, L:/127.0.0.1:54100 - R:localhost/127.0.0.1:33789], consumerId 5
2024-02-05T18:52:24,044 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:52:24,047 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x832ce516, L:/127.0.0.1:33789 - R:/127.0.0.1:54100]] Subscribing on topic persistent://public/test/__change_events / reader-4091d3af9b. consumerId: 5
2024-02-05T18:52:24,053 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:52:24,059 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:52:24,060 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:52:24,061 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-67824c3d94] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:24,061 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:52:24,061 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-67824c3d94, ackPos=11:-1, readPos=11:0}
2024-02-05T18:52:24,065 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic persistent://public/test/__change_events / reader-67824c3d94
2024-02-05T18:52:24,066 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-67824c3d94] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 4
2024-02-05T18:52:24,071 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:54100] Closing consumer: consumerId=4
2024-02-05T18:52:24,073 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:52:24,073 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-67824c3d94}, consumerId=4, consumerName=3b536, address=/127.0.0.1:54100}
2024-02-05T18:52:24,074 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-67824c3d94] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-67824c3d94, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:52:24,075 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:52:24,076 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:52:24,078 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-67824c3d94] Successfully closed dispatcher for reader
2024-02-05T18:52:24,080 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:52:24,083 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:52:24,092 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:54100] Closed consumer, consumerId=4
2024-02-05T18:52:24,094 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-67824c3d94] Closed consumer
2024-02-05T18:52:24,096 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:52:24,098 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:52:24,100 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:52:24,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-4091d3af9b] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:52:24,101 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:52:24,101 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4091d3af9b, ackPos=11:-1, readPos=11:0}
2024-02-05T18:52:24,102 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:52:24,103 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54100] Created subscription on topic persistent://public/test/__change_events / reader-4091d3af9b
2024-02-05T18:52:24,104 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-4091d3af9b] Subscribed to topic on localhost/127.0.0.1:33789 -- consumer: 5
2024-02-05T18:52:24,106 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:54100] Closing consumer: consumerId=5
2024-02-05T18:52:24,106 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:52:24,106 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4091d3af9b}, consumerId=5, consumerName=d074a, address=/127.0.0.1:54100}
2024-02-05T18:52:24,106 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4091d3af9b] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4091d3af9b, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:52:24,107 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-4091d3af9b] Successfully closed dispatcher for reader
2024-02-05T18:52:24,108 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:54100] Closed consumer, consumerId=5
2024-02-05T18:52:24,109 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-4091d3af9b] Closed consumer
2024-02-05T18:52:24,109 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:52:24,111 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:52:24,114 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:52:24,120 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:52:24,122 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:52:24,122 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:52:24,124 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39169
2024-02-05T18:52:24,126 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39169 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:52:24,133 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39169 was invalidated. state Releasing
2024-02-05T18:52:24,135 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:39169 registry has been deleted.
2024-02-05T18:52:24,135 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:39169 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:52:24,138 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39169. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:52:24,138 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:39169 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:52:24,138 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39169
2024-02-05T18:52:24,139 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39169
2024-02-05T18:52:24,140 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39169 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:52:24,149 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39169/0x00000000_0xffffffff.
2024-02-05T18:52:24,151 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39169/0x00000000_0xffffffff.
2024-02-05T18:52:24,152 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39169/0x00000000_0xffffffff.
2024-02-05T18:52:24,153 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:52:24,154 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:52:24,160 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:35852
2024-02-05T18:52:24,161 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xd0ce578b, L:/127.0.0.1:35852 ! R:localhost/127.0.0.1:42659] Disconnected
2024-02-05T18:52:24,163 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] Disconnected
2024-02-05T18:52:24,163 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39169/__change_events] [reader-0d4cfaa02b] Closed connection [id: 0xd0ce578b, L:/127.0.0.1:35852 ! R:localhost/127.0.0.1:42659] -- Will try again in 0.1 s
2024-02-05T18:52:24,163 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:24,164 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:24,164 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:24,164 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-006cae0e75] Closed connection [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:24,164 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0af5b10839] Closed connection [id: 0x425248c6, L:/127.0.0.1:39982 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:24,166 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39169/__change_events, name=reader-0d4cfaa02b}, consumerId=2, consumerName=fbd5e, address=/127.0.0.1:35852}
2024-02-05T18:52:24,166 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:39982
2024-02-05T18:52:24,166 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39169/__change_events][reader-0d4cfaa02b] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39169/persistent/__change_events, cursor=reader-0d4cfaa02b, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:52:24,167 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39169/__change_events][reader-0d4cfaa02b] Successfully closed dispatcher for reader
2024-02-05T18:52:24,168 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-006cae0e75}, consumerId=0, consumerName=1d1bf, address=/127.0.0.1:39982}
2024-02-05T18:52:24,168 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-006cae0e75] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-006cae0e75, ackPos=3:5, readPos=3:6}]
2024-02-05T18:52:24,168 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-006cae0e75] Successfully closed dispatcher for reader
2024-02-05T18:52:24,169 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-0af5b10839}, consumerId=1, consumerName=849b0, address=/127.0.0.1:39982}
2024-02-05T18:52:24,171 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:52:24,171 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39169/persistent/__change_events] Closing managed ledger
2024-02-05T18:52:24,177 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39169/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:52:24,178 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:52:24,180 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:52:24,182 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:52:24,197 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:42659
2024-02-05T18:52:24,198 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:52:24,200 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:52:24,200 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:52:24,203 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-006cae0e75] Closed Consumer (not connected)
2024-02-05T18:52:24,205 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-006cae0e75 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-006cae0e75 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:24,209 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0af5b10839] Closed Consumer (not connected)
2024-02-05T18:52:24,209 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0af5b10839 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0af5b10839 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:24,210 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39169/__change_events] [reader-0d4cfaa02b] Closed Consumer (not connected)
2024-02-05T18:52:24,211 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39169/__change_events with subscription name reader-0d4cfaa02b was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39169/__change_events with subscription name reader-0d4cfaa02b was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:24,220 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:52:24,221 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:52:24,226 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:52:24,227 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:24,236 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:52:24,237 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:24,455 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:52:24,456 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 44.53%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.53%, msgThroughputEMA= 0.00, updatedAt= 1707151944455, reportedAt= 0
2024-02-05T18:52:24,549 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:24,549 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:52:25,483 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:52:25,484 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:52:25,486 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:52:25,486 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:25,486 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:52:25,487 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:52:25,550 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:25,551 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:52:26,552 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:52:26,552 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:52:27,502 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:52:27,504 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:52:27,504 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:52:27,505 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:52:27,505 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:52:27,505 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:52:27,507 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:52:27,512 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:52:27,514 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:52:27,516 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:52:27,517 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:52:27,519 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:52:27,522 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:52:27,523 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:52:27,523 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:52:27,524 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38203
2024-02-05T18:52:27,526 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38203, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151943928, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:52:32,537 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38203 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:52:32,544 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38203 was invalidated. state Releasing
2024-02-05T18:52:32,544 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38203. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:52:32,544 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38203
2024-02-05T18:52:32,547 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38203/0x00000000_0xffffffff.
2024-02-05T18:52:32,548 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38203/0x00000000_0xffffffff.
2024-02-05T18:52:32,549 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38203/0x00000000_0xffffffff.
2024-02-05T18:52:32,556 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38203, splitServiceUnitToDestBroker=null, force=true, timestamp=1707151952550, versionId=7]. totalHandledRequests:10
2024-02-05T18:52:32,557 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:52:32,559 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:52:32,560 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:52:32,561 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:52:32,564 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:52:32,568 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:52:32,569 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:52:32,576 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38203 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38203, splitServiceUnitToDestBroker=null, force=false, timestamp=1707151952556, versionId=8]. totalHandledRequests:4
2024-02-05T18:52:32,576 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:52:32,577 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.032 seconds
2024-02-05T18:52:32,577 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:52:32,578 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:52:32,578 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:52:32,579 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38203/persistent/__change_events] Closing managed ledger
2024-02-05T18:52:32,580 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:54100
2024-02-05T18:52:32,581 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-8981e422c0}, consumerId=0, consumerName=5a6f6, address=/127.0.0.1:54100}
2024-02-05T18:52:32,581 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8981e422c0] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8981e422c0, ackPos=3:5, readPos=3:8}]
2024-02-05T18:52:32,581 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8981e422c0] Successfully closed dispatcher for reader
2024-02-05T18:52:32,582 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38203/__change_events, name=reader-d4eeb49fd8}, consumerId=3, consumerName=6a86c, address=/127.0.0.1:54100}
2024-02-05T18:52:32,582 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] Disconnected
2024-02-05T18:52:32,583 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38203/__change_events][reader-d4eeb49fd8] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38203/persistent/__change_events, cursor=reader-d4eeb49fd8, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:52:32,583 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38203/__change_events][reader-d4eeb49fd8] Successfully closed dispatcher for reader
2024-02-05T18:52:32,583 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,583 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,583 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,584 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8981e422c0] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,584 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d229d2cfaf] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,584 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38203/__change_events] [reader-d4eeb49fd8] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,584 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-3d22e7d934] Closed connection [id: 0xac5f9982, L:/127.0.0.1:54100 ! R:localhost/127.0.0.1:33789] -- Will try again in 0.1 s
2024-02-05T18:52:32,584 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:52:32,584 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38203/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:52:32,585 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:52:32,585 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-3d22e7d934}, consumerId=2, consumerName=ef24f, address=/127.0.0.1:54100}
2024-02-05T18:52:32,585 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d229d2cfaf}, consumerId=1, consumerName=13842, address=/127.0.0.1:54100}
2024-02-05T18:52:32,586 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:52:32,586 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:52:32,587 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:54100] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:52:32,593 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33789
2024-02-05T18:52:32,593 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:52:32,593 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:52:32,594 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:52:32,594 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-3d22e7d934] Closed Consumer (not connected)
2024-02-05T18:52:32,594 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38203/__change_events] [reader-d4eeb49fd8] Closed Consumer (not connected)
2024-02-05T18:52:32,594 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d229d2cfaf] Closed Consumer (not connected)
2024-02-05T18:52:32,594 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-3d22e7d934 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-3d22e7d934 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:32,594 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8981e422c0] Closed Consumer (not connected)
2024-02-05T18:52:32,595 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38203/__change_events with subscription name reader-d4eeb49fd8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38203/__change_events with subscription name reader-d4eeb49fd8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:32,595 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d229d2cfaf was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d229d2cfaf was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:32,596 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8981e422c0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8981e422c0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:52:32,599 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:52:32,599 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:52:32,599 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:52:32,599 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:52:32,600 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:52:32,600 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:32,602 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:52:32,602 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:33,892 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:52:33,892 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:52:33,893 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:52:33,894 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:33,894 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:52:33,894 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:52:33,903 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:52:33,903 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:52:33,907 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:52:33,907 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:52:33,907 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:52:33,907 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:52:33,907 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:52:33,907 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:52:33,908 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:52:33,908 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:52:33,908 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@339e62bb
2024-02-05T18:52:33,908 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:52:33,909 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:52:33,909 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.354 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  54.718 s
[INFO] Finished at: 2024-02-05T18:52:34+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 4 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:53:05,341 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:53:06,302 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:53:06,304 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:53:06,792 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:53:06,792 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:53:06,793 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:53:06,794 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:53:06,794 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:53:06,795 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:53:06,813 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:53:06,814 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:53:06,815 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:53:06,816 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:53:06,816 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:53:06,817 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:53:06,817 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:53:06,818 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:53:06,819 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:53:06,819 - INFO  - [main:Environment@98] - Client environment:os.memory.free=40MB
2024-02-05T18:53:06,820 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:53:06,820 - INFO  - [main:Environment@98] - Client environment:os.memory.total=128MB
2024-02-05T18:53:08,260 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:53:08,261 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:53:08,261 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:53:08,262 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:53:08,618 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:53:08,619 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:53:08,708 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:53:08,786 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:53:08,789 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:53:08,805 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:53:08,905 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:53:08,943 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:53:08,985 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:53:09,340 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:53:09,341 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:53:09,372 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:53:09,431 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:32931, TLS: (none), listener: (none)
2024-02-05T18:53:09,742 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:41911, TLS: OPENSSL, listener: (none)
2024-02-05T18:53:09,764 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:53:09,769 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:53:09,770 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:53:09,811 - INFO  - [main:Log@170] - Logging initialized @6917ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:53:10,794 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:53:10,830 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:53:10,830 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:53:10,832 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:53:11,583 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:53:12,641 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:53:13,932 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:53:14,315 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:53:14,422 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:53:14,596 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:53:14,597 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:53:14,599 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:53:14,615 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:38879}
2024-02-05T18:53:14,771 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:40009}
2024-02-05T18:53:14,771 - INFO  - [main:Server@415] - Started @11879ms
2024-02-05T18:53:14,773 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38879
2024-02-05T18:53:14,775 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:40009
2024-02-05T18:53:14,783 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:53:14,783 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:53:14,965 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38879
2024-02-05T18:53:14,980 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:53:14,983 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:38879 is changing the role from null to Leader
2024-02-05T18:53:14,986 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38879).
2024-02-05T18:53:15,298 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38879 
2024-02-05T18:53:15,751 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:53:15,779 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:15,891 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:53:15,895 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:53:15,906 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:53:15,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:53:15,960 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:53:15,999 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:53:16,040 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:53:16,110 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:53:16,131 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:53:16,145 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:53:16,148 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:53:16,182 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:53:16,195 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:15 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 553
2024-02-05T18:53:16,339 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]] Connected to server
2024-02-05T18:53:16,381 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:33614] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:53:16,452 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,463 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,526 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:53:16,565 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:33614] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:33614, producerName=test-0-0, producerId=0}
2024-02-05T18:53:16,576 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,578 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:53:16,641 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,644 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0d5528ce6d] Subscribing to topic on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931], consumerId 0
2024-02-05T18:53:16,658 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc9bd9f11, L:/127.0.0.1:32931 - R:/127.0.0.1:33614]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0d5528ce6d. consumerId: 0
2024-02-05T18:53:16,697 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0d5528ce6d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:16,698 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:53:16,699 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0d5528ce6d, ackPos=3:-1, readPos=3:0}
2024-02-05T18:53:16,727 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33614] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0d5528ce6d
2024-02-05T18:53:16,734 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0d5528ce6d] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 0
2024-02-05T18:53:16,753 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.018 seconds
2024-02-05T18:53:16,755 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:53:16,756 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:53:16,757 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:53:16,801 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,827 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:53:16,828 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:53:16,830 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:16 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:53:16,831 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:53:16,842 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,850 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:53:16,851 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:53:16,853 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:16 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:53:16,854 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:53:16,879 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,881 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,890 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:53:16,897 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:33614] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:33614, producerName=test-0-1, producerId=1}
2024-02-05T18:53:16,898 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,915 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,917 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c8822fe344] Subscribing to topic on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931], consumerId 1
2024-02-05T18:53:16,919 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc9bd9f11, L:/127.0.0.1:32931 - R:/127.0.0.1:33614]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c8822fe344. consumerId: 1
2024-02-05T18:53:16,942 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c8822fe344] Created new subscription for 1
2024-02-05T18:53:16,943 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33614] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c8822fe344
2024-02-05T18:53:16,944 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c8822fe344] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 1
2024-02-05T18:53:16,962 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:16,963 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,971 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:53:16,976 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:33614] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:33614, producerName=test-0-2, producerId=2}
2024-02-05T18:53:16,978 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:16,990 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:53:17,007 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:53:17,014 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:38879 started the ownership monitor.
2024-02-05T18:53:17,033 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:17,037 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-16c77c7b78] Subscribing to topic on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931], consumerId 2
2024-02-05T18:53:17,039 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc9bd9f11, L:/127.0.0.1:32931 - R:/127.0.0.1:33614]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-16c77c7b78. consumerId: 2
2024-02-05T18:53:17,053 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-16c77c7b78] Created new subscription for 2
2024-02-05T18:53:17,053 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38879/__change_events
2024-02-05T18:53:17,054 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33614] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-16c77c7b78
2024-02-05T18:53:17,054 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-16c77c7b78] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 2
2024-02-05T18:53:17,055 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:38879 plays the leader now.
2024-02-05T18:53:17,059 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707151997058, reportedAt= 0
2024-02-05T18:53:17,080 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:53:17,085 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:17,086 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:53:17,155 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38879/0x00000000_0xffffffff - localhost:38879.
2024-02-05T18:53:17,158 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38879
2024-02-05T18:53:17,158 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38879/0x00000000_0xffffffff
2024-02-05T18:53:17,159 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38879/0x00000000_0xffffffff - localhost:38879.
2024-02-05T18:53:17,160 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38879
2024-02-05T18:53:17,160 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38879/0x00000000_0xffffffff
2024-02-05T18:53:17,172 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38879/__change_events][reader-b9678506ce] Subscribing to topic on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931], consumerId 3
2024-02-05T18:53:17,181 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38879 doesn't exist.
2024-02-05T18:53:17,187 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc9bd9f11, L:/127.0.0.1:32931 - R:/127.0.0.1:33614]] Subscribing on topic persistent://sla-monitor/test/localhost:38879/__change_events / reader-b9678506ce. consumerId: 3
2024-02-05T18:53:17,202 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38879/persistent/__change_events
2024-02-05T18:53:17,204 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38879/persistent/__change_events'
2024-02-05T18:53:17,212 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:53:17,213 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38879/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:53:17,219 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38879/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:53:17,226 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38879/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:53:17,231 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38879/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38879/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:53:17,232 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38879/__change_events - dedup is disabled
2024-02-05T18:53:17,246 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:53:17,253 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38879/__change_events][reader-b9678506ce] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:17,253 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38879/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:53:17,254 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38879/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38879/persistent/__change_events, cursor=reader-b9678506ce, ackPos=7:-1, readPos=7:0}
2024-02-05T18:53:17,258 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:33614] Created subscription on topic persistent://sla-monitor/test/localhost:38879/__change_events / reader-b9678506ce
2024-02-05T18:53:17,260 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38879/__change_events][reader-b9678506ce] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 3
2024-02-05T18:53:17,200 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 38879, tls-port = Optional[40009], broker url= pulsar://localhost:32931, broker tls url= pulsar+ssl://localhost:41911, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[32931], brokerServicePortTls=Optional[41911], webServicePort=Optional[38879], webServicePortTls=Optional[40009], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:53:17,789 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:53:17,790 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:53:17,790 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:53:17,791 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:53:17,796 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:53:17,797 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:53:17,805 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:53:17,811 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:53:17,820 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:53:17,820 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:53:17,830 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:53:17,837 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:53:17,841 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:53:17,854 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:53:17,855 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:53:17,863 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:53:17,867 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46719, TLS: (none), listener: (none)
2024-02-05T18:53:17,869 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40059, TLS: OPENSSL, listener: (none)
2024-02-05T18:53:17,875 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:53:17,877 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:53:17,877 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:53:17,892 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:53:17,896 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:53:17,897 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:53:17,897 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:53:17,988 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:53:18,088 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:18,088 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:53:18,673 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:53:19,089 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:19,089 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:53:19,937 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:53:20,090 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:20,091 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:53:20,221 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:53:20,312 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:53:20,416 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:53:20,417 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:53:20,417 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:53:20,419 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:41817}
2024-02-05T18:53:20,429 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:43103}
2024-02-05T18:53:20,430 - INFO  - [main:Server@415] - Started @17538ms
2024-02-05T18:53:20,430 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41817
2024-02-05T18:53:20,432 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43103
2024-02-05T18:53:20,437 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:53:20,438 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:53:20,454 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41817
2024-02-05T18:53:20,456 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:41817 registry has been created.
2024-02-05T18:53:20,457 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:41817. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:53:20,460 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:41817 is changing the role from null to Follower
2024-02-05T18:53:20,463 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38879).
2024-02-05T18:53:20,469 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:53:20,503 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41817 
2024-02-05T18:53:20,627 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 66
2024-02-05T18:53:20,650 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:20,653 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:53:20,654 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:53:20,666 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 32
2024-02-05T18:53:20,670 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41817/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:53:20,680 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xeb3c0b1d, L:/127.0.0.1:32868 - R:localhost/127.0.0.1:46719]] Connected to server
2024-02-05T18:53:20,685 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:32868] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:53:20,701 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]] Connected to server
2024-02-05T18:53:20,704 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:33630] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:53:20,705 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,714 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33630] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:33630, producerName=test-0-3, producerId=0}
2024-02-05T18:53:20,716 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,729 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0eaaa3a53d] Subscribing to topic on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931], consumerId 0
2024-02-05T18:53:20,731 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xf55ab11a, L:/127.0.0.1:32931 - R:/127.0.0.1:33630]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0eaaa3a53d. consumerId: 0
2024-02-05T18:53:20,741 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0eaaa3a53d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:20,742 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:53:20,742 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0eaaa3a53d, ackPos=3:-1, readPos=3:0}
2024-02-05T18:53:20,747 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33630] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0eaaa3a53d
2024-02-05T18:53:20,748 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0eaaa3a53d] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 0
2024-02-05T18:53:20,751 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:53:20,752 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:53:20,780 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:53:20,789 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:20,792 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:53:20,793 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:53:20,797 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:53:20,798 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41817/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:53:20,808 - INFO  - [pulsar-web-84-8:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 6
2024-02-05T18:53:20,814 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:20,818 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:53:20,819 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:53:20,823 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:20 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:53:20,824 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:41817/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:53:20,839 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,848 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33630] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:33630, producerName=test-0-4, producerId=1}
2024-02-05T18:53:20,849 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,862 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-af544e66e9] Subscribing to topic on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931], consumerId 1
2024-02-05T18:53:20,866 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xf55ab11a, L:/127.0.0.1:32931 - R:/127.0.0.1:33630]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-af544e66e9. consumerId: 1
2024-02-05T18:53:20,877 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-af544e66e9] Created new subscription for 1
2024-02-05T18:53:20,878 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33630] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-af544e66e9
2024-02-05T18:53:20,879 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-af544e66e9] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 1
2024-02-05T18:53:20,893 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,901 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:33630] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:33630, producerName=test-0-5, producerId=2}
2024-02-05T18:53:20,902 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x2163cdd1, L:/127.0.0.1:33630 - R:localhost/127.0.0.1:32931]
2024-02-05T18:53:20,904 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:53:20,907 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:53:20,909 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:41817 plays a follower now.
2024-02-05T18:53:20,929 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41817/__change_events
2024-02-05T18:53:20,991 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41817/0x00000000_0xffffffff - localhost:41817.
2024-02-05T18:53:20,992 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41817
2024-02-05T18:53:20,992 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41817/0x00000000_0xffffffff
2024-02-05T18:53:20,995 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41817/0x00000000_0xffffffff - localhost:41817.
2024-02-05T18:53:20,996 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41817/0x00000000_0xffffffff
2024-02-05T18:53:20,996 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41817
2024-02-05T18:53:21,000 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41817 doesn't exist.
2024-02-05T18:53:21,000 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41817/__change_events][reader-79ef4408f1] Subscribing to topic on cnx [id: 0xeb3c0b1d, L:/127.0.0.1:32868 - R:localhost/127.0.0.1:46719], consumerId 2
2024-02-05T18:53:21,003 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0x0e2a9b16, L:/127.0.0.1:46719 - R:/127.0.0.1:32868]] Subscribing on topic persistent://sla-monitor/test/localhost:41817/__change_events / reader-79ef4408f1. consumerId: 2
2024-02-05T18:53:21,006 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 41817, tls-port = Optional[43103], broker url= pulsar://localhost:46719, broker tls url= pulsar+ssl://localhost:40059, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[46719], brokerServicePortTls=Optional[40059], webServicePort=Optional[41817], webServicePortTls=Optional[43103], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:53:21,014 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41817/persistent/__change_events
2024-02-05T18:53:21,017 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41817/persistent/__change_events'
2024-02-05T18:53:21,026 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:53:21,028 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41817/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:53:21,033 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41817/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:53:21,037 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41817/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:53:21,039 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41817/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41817/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:53:21,040 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41817/__change_events - dedup is disabled
2024-02-05T18:53:21,051 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:53:21,058 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41817/__change_events][reader-79ef4408f1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:21,059 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41817/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:53:21,059 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41817/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41817/persistent/__change_events, cursor=reader-79ef4408f1, ackPos=9:-1, readPos=9:0}
2024-02-05T18:53:21,061 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:32868] Created subscription on topic persistent://sla-monitor/test/localhost:41817/__change_events / reader-79ef4408f1
2024-02-05T18:53:21,062 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41817/__change_events][reader-79ef4408f1] Subscribed to topic on localhost/127.0.0.1:46719 -- consumer: 2
2024-02-05T18:53:21,092 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:53:21,092 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:53:21,216 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:53:21,217 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:53:21,246 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:53:21,251 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:53:21,276 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:53:21,277 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:53:21,281 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:53:21,282 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:53:21,307 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:53:21,309 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:53:21,310 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:53:21,308 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:53:21,311 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:53:21,314 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:53:21,326 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:53:21,326 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:53:21,331 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:53:21,335 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:53:21,351 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:53:21,352 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:53:21,353 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:53:21,355 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:53:21,356 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:53:21,361 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:53:21,405 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:53:21,420 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:53:21,421 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:53:21,437 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:53:21,449 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:21,468 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38879 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:53:21,511 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38879, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001471, versionId=1]. totalHandledRequests:1
2024-02-05T18:53:21,539 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38879, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001526, versionId=2]. totalHandledRequests:1
2024-02-05T18:53:21,542 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:21,571 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:53:21,572 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:53:21,576 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:53:21,603 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38879, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152001559, versionId=3]. totalHandledRequests:1
2024-02-05T18:53:21,610 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:21,611 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:53:21,622 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38879, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001603, versionId=4]. totalHandledRequests:1
2024-02-05T18:53:21,625 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:53:21,625 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:53:21,626 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38879. Skipping this broker. Phase one
2024-02-05T18:53:21,626 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:38879. Skipping this broker. Phase two
2024-02-05T18:53:21,626 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:41817 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:53:21,627 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 194
2024-02-05T18:53:21,627 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:53:21,629 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:53:21 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 228
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:53:21,639 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:41817, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001627, versionId=5]. totalHandledRequests:2
2024-02-05T18:53:21,642 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:41817, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001634, versionId=6]. totalHandledRequests:2
2024-02-05T18:53:21,647 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0xd0f6c523, L:/127.0.0.1:41738 - R:localhost/127.0.0.1:46719]] Connected to server
2024-02-05T18:53:21,649 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:53:21,650 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:41738] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:53:21,651 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fe81c5a6c7] Subscribing to topic on cnx [id: 0xd0f6c523, L:/127.0.0.1:41738 - R:localhost/127.0.0.1:46719], consumerId 4
2024-02-05T18:53:21,653 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x2352a0ec, L:/127.0.0.1:46719 - R:/127.0.0.1:41738]] Subscribing on topic persistent://public/test/__change_events / reader-fe81c5a6c7. consumerId: 4
2024-02-05T18:53:21,664 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:53:21,667 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:53:21,706 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:53:21,707 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:53:21,717 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:53:21,725 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:53:21,726 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a71e7470fd] Subscribing to topic on cnx [id: 0xeb3c0b1d, L:/127.0.0.1:32868 - R:localhost/127.0.0.1:46719], consumerId 3
2024-02-05T18:53:21,728 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:53:21,731 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:53:21,731 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0x0e2a9b16, L:/127.0.0.1:46719 - R:/127.0.0.1:32868]] Subscribing on topic persistent://public/test/__change_events / reader-a71e7470fd. consumerId: 3
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a5d6ed2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2fdddbe5] 
2024-02-05T18:53:21,741 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2027e75e, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@bdf8d51, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31507a5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@572e84fe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@585ffac2, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a5d6ed2, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@873bd36], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16a0f1b2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e5275dd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@206c30a7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6a6fff5b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@19f70066, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2fdddbe5, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29a6786e] 
2024-02-05T18:53:21,745 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:53:21,749 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fe81c5a6c7] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:21,749 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:53:21,749 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fe81c5a6c7, ackPos=11:-1, readPos=11:0}
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:53:21,759 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:41738] Created subscription on topic persistent://public/test/__change_events / reader-fe81c5a6c7
2024-02-05T18:53:21,761 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fe81c5a6c7] Subscribed to topic on localhost/127.0.0.1:46719 -- consumer: 4
2024-02-05T18:53:21,765 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:41738] Closing consumer: consumerId=4
2024-02-05T18:53:21,766 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fe81c5a6c7}, consumerId=4, consumerName=3fd28, address=/127.0.0.1:41738}
2024-02-05T18:53:21,767 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fe81c5a6c7] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fe81c5a6c7, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:53:21,769 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fe81c5a6c7] Successfully closed dispatcher for reader
2024-02-05T18:53:21,772 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:41738] Closed consumer, consumerId=4
2024-02-05T18:53:21,773 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:53:21,774 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:53:21,775 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-fe81c5a6c7] Closed consumer
2024-02-05T18:53:21,783 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:53:21,784 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:53:21,784 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:53:21,786 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:53:21,787 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:53:21,789 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a71e7470fd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:21,789 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:53:21,789 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a71e7470fd, ackPos=11:-1, readPos=11:0}
2024-02-05T18:53:21,792 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:32868] Created subscription on topic persistent://public/test/__change_events / reader-a71e7470fd
2024-02-05T18:53:21,795 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a71e7470fd] Subscribed to topic on localhost/127.0.0.1:46719 -- consumer: 3
2024-02-05T18:53:21,799 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:53:21,803 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:53:21,806 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:53:21,809 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:53:21,812 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:53:21,814 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:53:21,818 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:53:21,820 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:53:21,820 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:53:21,821 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:21,823 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38879. Skipping this broker. Phase one
2024-02-05T18:53:21,823 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:41817, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152001634, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38879, sourceBroker=localhost:41817, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152001823, versionId=7]
2024-02-05T18:53:21,831 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38879, sourceBroker=localhost:41817, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152001823, versionId=7]. totalHandledRequests:6
2024-02-05T18:53:21,832 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:38879 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:38879, sourceBroker=localhost:41817, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152001823, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:53:21,832 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:53:21,833 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:53:21,835 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a71e7470fd}, consumerId=3, consumerName=a7617, address=/127.0.0.1:32868}
2024-02-05T18:53:21,836 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a71e7470fd}, consumerId=3, consumerName=a7617, address=/127.0.0.1:32868}
2024-02-05T18:53:21,836 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a71e7470fd] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a71e7470fd, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:53:21,836 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:46719] Broker notification of Closed consumer: 3
2024-02-05T18:53:21,836 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a71e7470fd] Successfully closed dispatcher for reader
2024-02-05T18:53:21,836 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-a71e7470fd] Closed connection [id: 0xeb3c0b1d, L:/127.0.0.1:32868 - R:localhost/127.0.0.1:46719] -- Will try again in 0.1 s
2024-02-05T18:53:21,838 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a71e7470fd] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a71e7470fd, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:53:21,838 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-a71e7470fd] Successfully disconnected and closed subscription
2024-02-05T18:53:21,839 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:53:21,839 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:53:21,840 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:53:21,847 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:53:21,854 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:53:21,855 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a71e7470fd] Closed Consumer (not connected)
2024-02-05T18:53:21,856 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a71e7470fd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a71e7470fd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:21,857 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 25.0 ms
2024-02-05T18:53:21,863 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:53:21,866 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-f5fc74b78d] Subscribing to topic on cnx [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931], consumerId 5
2024-02-05T18:53:21,872 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc9bd9f11, L:/127.0.0.1:32931 - R:/127.0.0.1:33614]] Subscribing on topic persistent://public/test/__change_events / reader-f5fc74b78d. consumerId: 5
2024-02-05T18:53:21,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:53:21,887 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:53:21,888 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:53:21,893 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:53:21,894 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:53:21,895 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:53:21,899 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:53:21,900 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:53:21,900 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:53:21,904 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:53:21,914 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-f5fc74b78d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:53:21,914 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:53:21,915 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5fc74b78d, ackPos=14:-1, readPos=14:0}
2024-02-05T18:53:21,916 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:33614] Created subscription on topic persistent://public/test/__change_events / reader-f5fc74b78d
2024-02-05T18:53:21,917 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-f5fc74b78d] Subscribed to topic on localhost/127.0.0.1:32931 -- consumer: 5
2024-02-05T18:53:21,939 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-a71e7470fd] Reconnecting after timeout
2024-02-05T18:53:21,939 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-a71e7470fd] Ignoring reconnection request (state: Closed)
2024-02-05T18:53:22,004 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:53:22,005 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 39.65%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 39.65%, msgThroughputEMA= 0.00, updatedAt= 1707152002004, reportedAt= 0
2024-02-05T18:53:22,093 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:53:22,093 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:53:23,094 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:53:23,095 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:53:24,095 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:53:24,096 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:53:24,933 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 3109.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:53:24,939 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41817 was invalidated. state Releasing
2024-02-05T18:53:24,942 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41817. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:53:24,942 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:41817 registry has been deleted.
2024-02-05T18:53:24,942 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41817 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:53:24,944 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41817
2024-02-05T18:53:24,946 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41817 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:53:24,946 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:24,948 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:53:24,954 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41817/0x00000000_0xffffffff.
2024-02-05T18:53:24,956 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41817/0x00000000_0xffffffff.
2024-02-05T18:53:24,957 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41817/0x00000000_0xffffffff.
2024-02-05T18:53:24,957 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:53:24,960 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:53:24,964 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:32868
2024-02-05T18:53:24,963 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:53:24,965 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41817/persistent/__change_events] Closing managed ledger
2024-02-05T18:53:24,966 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xeb3c0b1d, L:/127.0.0.1:32868 ! R:localhost/127.0.0.1:46719] Disconnected
2024-02-05T18:53:24,963 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] Disconnected
2024-02-05T18:53:24,968 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:33630
2024-02-05T18:53:24,968 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:24,968 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:24,968 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41817/__change_events, name=reader-79ef4408f1}, consumerId=2, consumerName=ddffd, address=/127.0.0.1:32868}
2024-02-05T18:53:24,968 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41817/__change_events][reader-79ef4408f1] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41817/persistent/__change_events, cursor=reader-79ef4408f1, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-0eaaa3a53d}, consumerId=0, consumerName=74c39, address=/127.0.0.1:33630}
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41817/__change_events][reader-79ef4408f1] Successfully closed dispatcher for reader
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0eaaa3a53d] Closed connection [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0eaaa3a53d] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0eaaa3a53d, ackPos=3:6, readPos=3:7}]
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-af544e66e9] Closed connection [id: 0x2163cdd1, L:/127.0.0.1:33630 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:24,970 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41817/__change_events] [reader-79ef4408f1] Closed connection [id: 0xeb3c0b1d, L:/127.0.0.1:32868 ! R:localhost/127.0.0.1:46719] -- Will try again in 0.1 s
2024-02-05T18:53:24,970 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0xd0f6c523, L:/127.0.0.1:41738 ! R:localhost/127.0.0.1:46719] Disconnected
2024-02-05T18:53:24,969 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0eaaa3a53d] Successfully closed dispatcher for reader
2024-02-05T18:53:24,971 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-af544e66e9}, consumerId=1, consumerName=93ad7, address=/127.0.0.1:33630}
2024-02-05T18:53:24,974 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41817/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:53:24,975 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:53:24,975 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:41738
2024-02-05T18:53:24,977 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:53:24,978 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:53:24,984 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:46719
2024-02-05T18:53:24,985 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:53:24,986 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:53:24,986 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:53:24,987 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-af544e66e9] Closed Consumer (not connected)
2024-02-05T18:53:24,988 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0eaaa3a53d] Closed Consumer (not connected)
2024-02-05T18:53:24,987 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-af544e66e9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-af544e66e9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:24,988 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41817/__change_events] [reader-79ef4408f1] Closed Consumer (not connected)
2024-02-05T18:53:24,988 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0eaaa3a53d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0eaaa3a53d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:24,989 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41817/__change_events with subscription name reader-79ef4408f1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41817/__change_events with subscription name reader-79ef4408f1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:24,994 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:53:24,994 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:53:24,997 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:53:24,998 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:25,005 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:53:25,006 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:25,100 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:25,100 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41817 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:53:25,101 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41817 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:53:25,101 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:41817]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:53:25,101 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:25,102 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:53:26,102 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:26,102 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41817 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:53:26,103 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41817 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:53:26,103 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:41817]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:53:26,103 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:26,104 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:53:26,280 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:53:26,281 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:53:26,283 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:53:26,283 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:26,284 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:53:26,284 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:53:27,004 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.21%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 39.80%, msgThroughputEMA= 0.00, updatedAt= 1707152007004, reportedAt= 1707152002011
2024-02-05T18:53:27,103 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:27,104 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41817 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:53:27,104 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41817 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:53:27,105 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:41817]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:53:27,105 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:27,106 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:53:28,105 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:53:28,106 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:41817 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:53:28,106 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:41817 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:53:28,107 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:41817]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:53:28,107 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41817
2024-02-05T18:53:28,108 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41817 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:53:28,299 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:53:28,300 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:53:28,300 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:53:28,300 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:53:28,301 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:53:28,301 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:53:28,302 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:53:28,304 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:53:28,305 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:53:28,306 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:53:28,308 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:53:28,309 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:53:28,310 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:53:28,311 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:53:28,311 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:53:28,311 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38879
2024-02-05T18:53:28,313 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38879, sourceBroker=localhost:41817, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152001823, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:53:33,323 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38879 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:53:33,330 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38879 was invalidated. state Releasing
2024-02-05T18:53:33,330 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38879. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:53:33,331 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38879
2024-02-05T18:53:33,333 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38879/0x00000000_0xffffffff.
2024-02-05T18:53:33,334 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38879/0x00000000_0xffffffff.
2024-02-05T18:53:33,335 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38879/0x00000000_0xffffffff.
2024-02-05T18:53:33,343 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38879, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152013336, versionId=8]. totalHandledRequests:10
2024-02-05T18:53:33,344 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:53:33,344 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f5fc74b78d}, consumerId=5, consumerName=0484c, address=/127.0.0.1:33614}
2024-02-05T18:53:33,344 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f5fc74b78d}, consumerId=5, consumerName=0484c, address=/127.0.0.1:33614}
2024-02-05T18:53:33,344 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:32931] Broker notification of Closed consumer: 5
2024-02-05T18:53:33,344 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f5fc74b78d] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5fc74b78d, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:53:33,345 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-f5fc74b78d] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 - R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,345 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-f5fc74b78d] Successfully closed dispatcher for reader
2024-02-05T18:53:33,345 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f5fc74b78d] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5fc74b78d, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:53:33,345 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-f5fc74b78d] Successfully disconnected and closed subscription
2024-02-05T18:53:33,345 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:53:33,345 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:53:33,346 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:53:33,350 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:53:33,352 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:53:33,353 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-f5fc74b78d] Closed Consumer (not connected)
2024-02-05T18:53:33,353 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T18:53:33,353 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f5fc74b78d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f5fc74b78d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:33,361 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38879 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38879, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152013343, versionId=9]. totalHandledRequests:4
2024-02-05T18:53:33,361 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:53:33,361 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.03 seconds
2024-02-05T18:53:33,361 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:53:33,362 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:53:33,362 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:53:33,362 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:53:33,363 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38879/persistent/__change_events] Closing managed ledger
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:33614
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] Disconnected
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-0d5528ce6d}, consumerId=0, consumerName=2b7de, address=/127.0.0.1:33614}
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0d5528ce6d] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0d5528ce6d, ackPos=3:6, readPos=3:9}]
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,364 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0d5528ce6d] Successfully closed dispatcher for reader
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0d5528ce6d] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c8822fe344] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38879/__change_events] [reader-b9678506ce] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,365 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-16c77c7b78] Closed connection [id: 0xf9786635, L:/127.0.0.1:33614 ! R:localhost/127.0.0.1:32931] -- Will try again in 0.1 s
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38879/__change_events, name=reader-b9678506ce}, consumerId=3, consumerName=3c50a, address=/127.0.0.1:33614}
2024-02-05T18:53:33,365 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38879/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:53:33,365 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38879/__change_events][reader-b9678506ce] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38879/persistent/__change_events, cursor=reader-b9678506ce, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:53:33,366 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38879/__change_events][reader-b9678506ce] Successfully closed dispatcher for reader
2024-02-05T18:53:33,366 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:53:33,366 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-16c77c7b78}, consumerId=2, consumerName=531c4, address=/127.0.0.1:33614}
2024-02-05T18:53:33,367 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-c8822fe344}, consumerId=1, consumerName=462e7, address=/127.0.0.1:33614}
2024-02-05T18:53:33,367 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:53:33,368 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:53:33,372 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:32931
2024-02-05T18:53:33,372 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:53:33,372 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:53:33,373 - ERROR - [main:TopBundleLoadDataReporter@112] - Failed to clean broker load data.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$1.sendComplete(ProducerImpl.java:362) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsg.sendComplete(ProducerImpl.java:1517) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.lambda$failPendingMessages$18(ProducerImpl.java:2061) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.ArrayDeque.forEach(ArrayDeque.java:888) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsgQueue.forEach(ProducerImpl.java:1608) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.failPendingMessages(ProducerImpl.java:2051) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1104) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAsync(ProducerImpl.java:1071) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4706) ~[?:?]
	at java.util.Collections$SetFromMap.forEach(Collections.java:5700) ~[?:?]
	at org.apache.pulsar.client.impl.PulsarClientImpl.closeAsync(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.close(PulsarClientImpl.java:720) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:532) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$RodAjuRG.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:419) ~[classes/:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$RodAjuRG.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext$StartableCustomBuilder.lambda$initializePulsarServices$0(PulsarTestContext.java:664) ~[test-classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext.close(PulsarTestContext.java:194) ~[test-classes/:?]
	at org.apache.pulsar.broker.auth.MockedPulsarServiceBaseTest.internalCleanup(MockedPulsarServiceBaseTest.java:247) ~[test-classes/:?]
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.cleanup(ExtensibleLoadManagerImplTest.java:197) ~[test-classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.invokeAfterClassMethods(TestMethodWorker.java:222) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:131) ~[testng-7.7.1.jar:7.7.1]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at org.testng.TestRunner.privateRun(TestRunner.java:829) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestRunner.run(TestRunner.java:602) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:437) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:431) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:391) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.run(SuiteRunner.java:330) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1256) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1176) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuites(TestNG.java:1099) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.run(TestNG.java:1067) ~[testng-7.7.1.jar:7.7.1]
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:155) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:102) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeLazy(TestNGDirectoryTestSuite.java:117) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:86) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:137) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.1.0.jar:3.1.0]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1101) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 76 more
2024-02-05T18:53:33,375 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:53:33,376 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0d5528ce6d] Closed Consumer (not connected)
2024-02-05T18:53:33,376 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0d5528ce6d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0d5528ce6d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:33,377 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-16c77c7b78] Closed Consumer (not connected)
2024-02-05T18:53:33,377 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-16c77c7b78 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-16c77c7b78 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:33,378 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c8822fe344] Closed Consumer (not connected)
2024-02-05T18:53:33,378 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c8822fe344 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c8822fe344 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:33,378 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38879/__change_events] [reader-b9678506ce] Closed Consumer (not connected)
2024-02-05T18:53:33,379 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38879/__change_events with subscription name reader-b9678506ce was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38879/__change_events with subscription name reader-b9678506ce was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:53:33,381 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:53:33,381 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:53:33,381 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:53:33,381 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:53:33,382 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:53:33,382 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:33,384 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:53:33,384 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:34,769 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:53:34,770 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:53:34,771 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:53:34,773 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:34,773 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:53:34,773 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:53:34,781 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:53:34,781 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:53:34,786 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:53:34,786 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:53:34,786 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:53:34,787 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:53:34,788 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:53:34,788 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:53:34,788 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:53:34,788 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@51a4feef
2024-02-05T18:53:34,788 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:53:34,789 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:53:34,789 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.248 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  57.550 s
[INFO] Finished at: 2024-02-05T18:53:35+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 5 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:54:06,382 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:54:07,471 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:54:07,473 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:54:07,941 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:54:07,942 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:54:07,943 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:54:07,944 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:54:07,945 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:54:07,945 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:54:07,962 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:54:07,963 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:54:07,964 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:54:07,965 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:54:07,965 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:54:07,966 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:54:07,967 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:54:07,967 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:54:07,968 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:54:07,968 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:54:07,969 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:54:07,970 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:54:09,517 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:54:09,518 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:54:09,518 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:54:09,519 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:54:09,841 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:54:09,842 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:54:09,925 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:54:10,002 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:54:10,005 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:54:10,022 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:54:10,132 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:54:10,171 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:54:10,208 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:54:10,506 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:54:10,507 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:54:10,540 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:54:10,618 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37535, TLS: (none), listener: (none)
2024-02-05T18:54:10,919 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46819, TLS: OPENSSL, listener: (none)
2024-02-05T18:54:10,948 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:54:10,953 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:54:10,954 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:54:10,992 - INFO  - [main:Log@170] - Logging initialized @6905ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:54:11,984 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:54:12,013 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:54:12,014 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:54:12,016 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:54:12,786 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:54:14,030 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:54:15,208 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:54:15,528 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:54:15,653 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:54:15,807 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:54:15,809 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:54:15,810 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:54:15,825 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:41971}
2024-02-05T18:54:15,976 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:44639}
2024-02-05T18:54:15,977 - INFO  - [main:Server@415] - Started @11892ms
2024-02-05T18:54:15,977 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:41971
2024-02-05T18:54:15,979 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44639
2024-02-05T18:54:15,990 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:54:15,991 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:54:16,128 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:41971
2024-02-05T18:54:16,146 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:54:16,150 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:41971 is changing the role from null to Leader
2024-02-05T18:54:16,153 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:41971).
2024-02-05T18:54:16,482 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:41971 
2024-02-05T18:54:16,944 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:54:16,980 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:17,106 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:54:17,112 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:54:17,126 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:54:17,131 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:54:17,181 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:54:17,212 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:54:17,248 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:54:17,320 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:54:17,347 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:54:17,359 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:54:17,362 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:54:17,399 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 615
2024-02-05T18:54:17,402 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:54:17,552 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]] Connected to server
2024-02-05T18:54:17,594 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:60506] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:54:17,672 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:17,683 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:17,755 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:54:17,787 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:60506] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:60506, producerName=test-0-0, producerId=0}
2024-02-05T18:54:17,794 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:17,796 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:54:17,852 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:17,853 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6618b0a3f1] Subscribing to topic on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535], consumerId 0
2024-02-05T18:54:17,867 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4519124, L:/127.0.0.1:37535 - R:/127.0.0.1:60506]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6618b0a3f1. consumerId: 0
2024-02-05T18:54:17,907 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6618b0a3f1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:17,908 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:54:17,909 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6618b0a3f1, ackPos=3:-1, readPos=3:0}
2024-02-05T18:54:17,933 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:60506] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6618b0a3f1
2024-02-05T18:54:17,939 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6618b0a3f1] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 0
2024-02-05T18:54:17,954 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:54:17,956 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:54:17,957 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:54:17,958 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:54:18,002 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,026 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:54:18,027 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:54:18,030 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 57
2024-02-05T18:54:18,030 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:54:18,043 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,054 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:54:18,055 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:54:18,060 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:54:18,060 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:18 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:54:18,083 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,085 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:18,092 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:54:18,100 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:60506] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:60506, producerName=test-0-1, producerId=1}
2024-02-05T18:54:18,103 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:18,119 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,121 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-35143ac562] Subscribing to topic on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535], consumerId 1
2024-02-05T18:54:18,123 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4519124, L:/127.0.0.1:37535 - R:/127.0.0.1:60506]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-35143ac562. consumerId: 1
2024-02-05T18:54:18,146 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-35143ac562] Created new subscription for 1
2024-02-05T18:54:18,147 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:60506] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-35143ac562
2024-02-05T18:54:18,152 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-35143ac562] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 1
2024-02-05T18:54:18,172 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,174 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:18,182 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:54:18,189 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:60506] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:60506, producerName=test-0-2, producerId=2}
2024-02-05T18:54:18,191 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:18,205 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:54:18,227 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:54:18,232 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:41971 started the ownership monitor.
2024-02-05T18:54:18,252 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:18,254 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f92619528c] Subscribing to topic on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535], consumerId 2
2024-02-05T18:54:18,257 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4519124, L:/127.0.0.1:37535 - R:/127.0.0.1:60506]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f92619528c. consumerId: 2
2024-02-05T18:54:18,272 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:41971/__change_events
2024-02-05T18:54:18,272 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f92619528c] Created new subscription for 2
2024-02-05T18:54:18,272 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:60506] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f92619528c
2024-02-05T18:54:18,273 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f92619528c] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 2
2024-02-05T18:54:18,274 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:41971 plays the leader now.
2024-02-05T18:54:18,279 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.88%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.88%, msgThroughputEMA= 0.00, updatedAt= 1707152058278, reportedAt= 0
2024-02-05T18:54:18,300 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:54:18,310 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:18,311 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:54:18,360 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:41971/0x00000000_0xffffffff - localhost:41971.
2024-02-05T18:54:18,362 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:41971/0x00000000_0xffffffff
2024-02-05T18:54:18,368 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:41971
2024-02-05T18:54:18,369 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:41971/0x00000000_0xffffffff - localhost:41971.
2024-02-05T18:54:18,370 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:41971/0x00000000_0xffffffff
2024-02-05T18:54:18,372 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:41971
2024-02-05T18:54:18,372 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:41971/__change_events][reader-908e8753ed] Subscribing to topic on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535], consumerId 3
2024-02-05T18:54:18,374 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4519124, L:/127.0.0.1:37535 - R:/127.0.0.1:60506]] Subscribing on topic persistent://sla-monitor/test/localhost:41971/__change_events / reader-908e8753ed. consumerId: 3
2024-02-05T18:54:18,383 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:41971/persistent/__change_events
2024-02-05T18:54:18,386 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:41971/persistent/__change_events'
2024-02-05T18:54:18,388 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:41971 doesn't exist.
2024-02-05T18:54:18,393 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:54:18,394 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:41971/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:54:18,401 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:41971/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:54:18,409 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:41971/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:54:18,412 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:41971/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:41971/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:54:18,414 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:41971/__change_events - dedup is disabled
2024-02-05T18:54:18,431 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:54:18,437 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:41971/__change_events][reader-908e8753ed] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:18,437 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:41971/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:54:18,438 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:41971/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41971/persistent/__change_events, cursor=reader-908e8753ed, ackPos=7:-1, readPos=7:0}
2024-02-05T18:54:18,450 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:60506] Created subscription on topic persistent://sla-monitor/test/localhost:41971/__change_events / reader-908e8753ed
2024-02-05T18:54:18,451 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:41971/__change_events][reader-908e8753ed] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 3
2024-02-05T18:54:18,404 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 41971, tls-port = Optional[44639], broker url= pulsar://localhost:37535, broker tls url= pulsar+ssl://localhost:46819, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37535], brokerServicePortTls=Optional[46819], webServicePort=Optional[41971], webServicePortTls=Optional[44639], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:54:19,073 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:54:19,073 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:54:19,073 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:54:19,074 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:54:19,079 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:54:19,080 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:54:19,087 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:54:19,093 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:54:19,103 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:54:19,104 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:54:19,112 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:54:19,118 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:54:19,124 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:54:19,138 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:54:19,138 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:54:19,142 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:54:19,145 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33075, TLS: (none), listener: (none)
2024-02-05T18:54:19,146 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46021, TLS: OPENSSL, listener: (none)
2024-02-05T18:54:19,150 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:54:19,152 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:54:19,152 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:54:19,166 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:54:19,170 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:54:19,170 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:54:19,170 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:54:19,251 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:54:19,320 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:19,320 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:54:19,825 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:54:20,321 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:20,322 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:54:21,031 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:54:21,283 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:54:21,323 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:21,323 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:54:21,354 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:54:21,447 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:54:21,448 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:54:21,448 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:54:21,450 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:36051}
2024-02-05T18:54:21,460 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:34047}
2024-02-05T18:54:21,461 - INFO  - [main:Server@415] - Started @17376ms
2024-02-05T18:54:21,461 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36051
2024-02-05T18:54:21,463 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34047
2024-02-05T18:54:21,468 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:54:21,469 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:54:21,489 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:36051 registry has been created.
2024-02-05T18:54:21,490 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:36051. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:54:21,490 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36051
2024-02-05T18:54:21,494 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:36051 is changing the role from null to Follower
2024-02-05T18:54:21,497 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:41971).
2024-02-05T18:54:21,503 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:54:21,521 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36051 
2024-02-05T18:54:21,636 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 54
2024-02-05T18:54:21,656 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:21,660 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:54:21,661 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:54:21,675 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 33
2024-02-05T18:54:21,678 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36051/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:54:21,687 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x7ab27bfd, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:33075]] Connected to server
2024-02-05T18:54:21,693 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:59776] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:54:21,711 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]] Connected to server
2024-02-05T18:54:21,714 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:39852] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:54:21,716 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,727 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39852] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:39852, producerName=test-0-3, producerId=0}
2024-02-05T18:54:21,729 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,744 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-537164f606] Subscribing to topic on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535], consumerId 0
2024-02-05T18:54:21,746 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x45489c80, L:/127.0.0.1:37535 - R:/127.0.0.1:39852]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-537164f606. consumerId: 0
2024-02-05T18:54:21,752 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-537164f606] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:21,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:54:21,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-537164f606, ackPos=3:-1, readPos=3:0}
2024-02-05T18:54:21,756 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39852] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-537164f606
2024-02-05T18:54:21,757 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-537164f606] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 0
2024-02-05T18:54:21,763 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.005 seconds
2024-02-05T18:54:21,765 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:54:21,788 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:54:21,791 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:21,793 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:54:21,794 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:54:21,797 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:54:21,797 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36051/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:54:21,809 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:54:21,815 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:21,818 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:54:21,819 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:54:21,823 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:54:21,823 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36051/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:54:21,839 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,847 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39852] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:39852, producerName=test-0-4, producerId=1}
2024-02-05T18:54:21,849 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,862 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0d40c1456a] Subscribing to topic on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535], consumerId 1
2024-02-05T18:54:21,864 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x45489c80, L:/127.0.0.1:37535 - R:/127.0.0.1:39852]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0d40c1456a. consumerId: 1
2024-02-05T18:54:21,876 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0d40c1456a] Created new subscription for 1
2024-02-05T18:54:21,876 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39852] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0d40c1456a
2024-02-05T18:54:21,877 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0d40c1456a] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 1
2024-02-05T18:54:21,895 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,904 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39852] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:39852, producerName=test-0-5, producerId=2}
2024-02-05T18:54:21,906 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xdf8aab07, L:/127.0.0.1:39852 - R:localhost/127.0.0.1:37535]
2024-02-05T18:54:21,907 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:54:21,910 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:54:21,912 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:36051 plays a follower now.
2024-02-05T18:54:21,933 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36051/__change_events
2024-02-05T18:54:21,965 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36051/0x00000000_0xffffffff - localhost:36051.
2024-02-05T18:54:21,970 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36051
2024-02-05T18:54:21,970 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36051/0x00000000_0xffffffff
2024-02-05T18:54:21,971 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36051/0x00000000_0xffffffff - localhost:36051.
2024-02-05T18:54:21,972 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36051
2024-02-05T18:54:21,972 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36051/0x00000000_0xffffffff
2024-02-05T18:54:21,974 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36051 doesn't exist.
2024-02-05T18:54:21,976 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36051/__change_events][reader-bcdad2ce9f] Subscribing to topic on cnx [id: 0x7ab27bfd, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:33075], consumerId 2
2024-02-05T18:54:21,976 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 36051, tls-port = Optional[34047], broker url= pulsar://localhost:33075, broker tls url= pulsar+ssl://localhost:46021, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33075], brokerServicePortTls=Optional[46021], webServicePort=Optional[36051], webServicePortTls=Optional[34047], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:54:21,981 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x6f006b1d, L:/127.0.0.1:33075 - R:/127.0.0.1:59776]] Subscribing on topic persistent://sla-monitor/test/localhost:36051/__change_events / reader-bcdad2ce9f. consumerId: 2
2024-02-05T18:54:21,998 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36051/persistent/__change_events
2024-02-05T18:54:22,001 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36051/persistent/__change_events'
2024-02-05T18:54:22,011 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:54:22,013 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36051/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:54:22,021 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36051/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:54:22,026 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36051/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:54:22,032 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36051/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36051/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:54:22,034 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36051/__change_events - dedup is disabled
2024-02-05T18:54:22,041 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:54:22,094 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36051/__change_events][reader-bcdad2ce9f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:22,094 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36051/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:54:22,095 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36051/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36051/persistent/__change_events, cursor=reader-bcdad2ce9f, ackPos=9:-1, readPos=9:0}
2024-02-05T18:54:22,097 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:59776] Created subscription on topic persistent://sla-monitor/test/localhost:36051/__change_events / reader-bcdad2ce9f
2024-02-05T18:54:22,099 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36051/__change_events][reader-bcdad2ce9f] Subscribed to topic on localhost/127.0.0.1:33075 -- consumer: 2
2024-02-05T18:54:22,189 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:54:22,191 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:54:22,219 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:54:22,220 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:54:22,244 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:54:22,245 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:54:22,249 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:54:22,251 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:54:22,280 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:54:22,280 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:54:22,281 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:54:22,282 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:54:22,284 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:54:22,285 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:54:22,299 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:54:22,299 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:54:22,304 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:54:22,305 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:54:22,320 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:54:22,320 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:54:22,321 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:54:22,322 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:54:22,323 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:54:22,324 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:54:22,324 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:54:22,325 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:54:22,361 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:54:22,377 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:54:22,377 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:54:22,393 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:54:22,409 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:22,427 - INFO  - [ForkJoinPool.commonPool-worker-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:41971 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:54:22,479 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:41971, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062431, versionId=1]. totalHandledRequests:1
2024-02-05T18:54:22,512 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:41971, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062501, versionId=2]. totalHandledRequests:1
2024-02-05T18:54:22,516 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:22,534 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:54:22,536 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:54:22,539 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:54:22,562 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:41971, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152062524, versionId=3]. totalHandledRequests:1
2024-02-05T18:54:22,569 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:22,570 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:54:22,579 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:41971, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062563, versionId=4]. totalHandledRequests:1
2024-02-05T18:54:22,580 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:54:22,581 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:54:22,583 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:41971. Skipping this broker. Phase one
2024-02-05T18:54:22,583 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:54:22,583 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:41971. Skipping this broker. Phase two
2024-02-05T18:54:22,584 - INFO  - [ForkJoinPool.commonPool-worker-2:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36051 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:54:22,584 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 228
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:54:22,591 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:54:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 202
2024-02-05T18:54:22,601 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36051, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062584, versionId=5]. totalHandledRequests:2
2024-02-05T18:54:22,612 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:54:22,612 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36051, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062594, versionId=6]. totalHandledRequests:2
2024-02-05T18:54:22,615 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x8cc17f06, L:/127.0.0.1:59784 - R:localhost/127.0.0.1:33075]] Connected to server
2024-02-05T18:54:22,619 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:59784] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:54:22,622 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-71a984077a] Subscribing to topic on cnx [id: 0x8cc17f06, L:/127.0.0.1:59784 - R:localhost/127.0.0.1:33075], consumerId 4
2024-02-05T18:54:22,624 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x688c6b50, L:/127.0.0.1:33075 - R:/127.0.0.1:59784]] Subscribing on topic persistent://public/test/__change_events / reader-71a984077a. consumerId: 4
2024-02-05T18:54:22,673 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:54:22,676 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:54:22,683 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:54:22,684 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2] 
2024-02-05T18:54:22,691 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24d80e45], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10fdf166] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24d80e45, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@187b9da3], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10fdf166, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c8c2b2b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24d80e45, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@187b9da3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6842a6d9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10fdf166, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c8c2b2b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17cb1c76] 
2024-02-05T18:54:22,696 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24d80e45, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@187b9da3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6842a6d9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@53191da9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10fdf166, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c8c2b2b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17cb1c76, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3ea1a192] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f5024f2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@558bb0ba, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@24d80e45, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@187b9da3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6842a6d9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@53191da9, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@43a8acf1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@fc76ac2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1a11ce41, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10fdf166, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c8c2b2b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17cb1c76, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3ea1a192, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c4f305e] 
2024-02-05T18:54:22,702 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:54:22,704 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:54:22,713 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-6a7863ddad] Subscribing to topic on cnx [id: 0x7ab27bfd, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:33075], consumerId 3
2024-02-05T18:54:22,714 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:54:22,715 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x6f006b1d, L:/127.0.0.1:33075 - R:/127.0.0.1:59776]] Subscribing on topic persistent://public/test/__change_events / reader-6a7863ddad. consumerId: 3
2024-02-05T18:54:22,721 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:54:22,722 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-71a984077a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:22,723 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:54:22,723 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-71a984077a, ackPos=11:-1, readPos=11:0}
2024-02-05T18:54:22,725 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:59784] Created subscription on topic persistent://public/test/__change_events / reader-71a984077a
2024-02-05T18:54:22,726 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-71a984077a] Subscribed to topic on localhost/127.0.0.1:33075 -- consumer: 4
2024-02-05T18:54:22,732 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:59784] Closing consumer: consumerId=4
2024-02-05T18:54:22,732 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-71a984077a}, consumerId=4, consumerName=4f35d, address=/127.0.0.1:59784}
2024-02-05T18:54:22,733 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-71a984077a] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-71a984077a, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:54:22,734 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-71a984077a] Successfully closed dispatcher for reader
2024-02-05T18:54:22,749 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-6a7863ddad] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:22,750 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:54:22,750 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6a7863ddad, ackPos=11:-1, readPos=11:0}
2024-02-05T18:54:22,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:59776] Created subscription on topic persistent://public/test/__change_events / reader-6a7863ddad
2024-02-05T18:54:22,755 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:59784] Closed consumer, consumerId=4
2024-02-05T18:54:22,756 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-71a984077a] Closed consumer
2024-02-05T18:54:22,758 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-6a7863ddad] Subscribed to topic on localhost/127.0.0.1:33075 -- consumer: 3
2024-02-05T18:54:22,757 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:54:22,775 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:54:22,781 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:54:22,782 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:54:22,782 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:54:22,783 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:54:22,785 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:54:22,794 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:54:22,796 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:54:22,798 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:54:22,801 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:54:22,803 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:54:22,806 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:54:22,814 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:54:22,816 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:54:22,817 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:54:22,819 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36051
2024-02-05T18:54:22,822 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:41971. Skipping this broker. Phase one
2024-02-05T18:54:22,823 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36051, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152062594, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:41971, sourceBroker=localhost:36051, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152062823, versionId=7]
2024-02-05T18:54:22,831 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:41971, sourceBroker=localhost:36051, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152062823, versionId=7]. totalHandledRequests:6
2024-02-05T18:54:22,832 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:41971 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:41971, sourceBroker=localhost:36051, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152062823, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:54:22,832 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:54:22,833 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:54:22,834 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-6a7863ddad}, consumerId=3, consumerName=3cd22, address=/127.0.0.1:59776}
2024-02-05T18:54:22,835 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-6a7863ddad}, consumerId=3, consumerName=3cd22, address=/127.0.0.1:59776}
2024-02-05T18:54:22,835 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:33075] Broker notification of Closed consumer: 3
2024-02-05T18:54:22,835 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-6a7863ddad] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6a7863ddad, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:54:22,836 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-6a7863ddad] Successfully closed dispatcher for reader
2024-02-05T18:54:22,836 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-6a7863ddad] Closed connection [id: 0x7ab27bfd, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:33075] -- Will try again in 0.1 s
2024-02-05T18:54:22,836 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-6a7863ddad] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6a7863ddad, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:54:22,837 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-6a7863ddad] Successfully disconnected and closed subscription
2024-02-05T18:54:22,837 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:54:22,838 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:54:22,839 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:54:22,846 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:54:22,855 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:54:22,856 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-6a7863ddad] Closed Consumer (not connected)
2024-02-05T18:54:22,857 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 25.0 ms
2024-02-05T18:54:22,856 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-6a7863ddad was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-6a7863ddad was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:22,862 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:54:22,864 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-28f328062d] Subscribing to topic on cnx [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535], consumerId 5
2024-02-05T18:54:22,867 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4519124, L:/127.0.0.1:37535 - R:/127.0.0.1:60506]] Subscribing on topic persistent://public/test/__change_events / reader-28f328062d. consumerId: 5
2024-02-05T18:54:22,877 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:54:22,884 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:54:22,884 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:54:22,889 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:54:22,891 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:54:22,892 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:54:22,896 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:54:22,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:54:22,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:54:22,902 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:54:22,910 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-28f328062d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:54:22,910 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:54:22,910 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-28f328062d, ackPos=14:-1, readPos=14:0}
2024-02-05T18:54:22,912 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:60506] Created subscription on topic persistent://public/test/__change_events / reader-28f328062d
2024-02-05T18:54:22,913 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-28f328062d] Subscribed to topic on localhost/127.0.0.1:37535 -- consumer: 5
2024-02-05T18:54:22,938 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-6a7863ddad] Reconnecting after timeout
2024-02-05T18:54:22,939 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-6a7863ddad] Ignoring reconnection request (state: Closed)
2024-02-05T18:54:23,222 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:54:23,223 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 45.90%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 45.90%, msgThroughputEMA= 0.00, updatedAt= 1707152063222, reportedAt= 0
2024-02-05T18:54:23,325 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:54:23,326 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:54:24,326 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:54:24,327 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:54:25,328 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:54:25,328 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:54:25,931 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36051 in 3110.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:54:25,937 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:36051 registry has been deleted.
2024-02-05T18:54:25,938 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36051 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:54:25,938 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36051 was invalidated. state Releasing
2024-02-05T18:54:25,940 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36051. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:54:25,940 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36051 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:54:25,941 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36051
2024-02-05T18:54:25,941 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36051
2024-02-05T18:54:25,942 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36051 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:54:25,952 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36051/0x00000000_0xffffffff.
2024-02-05T18:54:25,953 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36051/0x00000000_0xffffffff.
2024-02-05T18:54:25,955 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36051/0x00000000_0xffffffff.
2024-02-05T18:54:25,955 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:54:25,957 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:54:25,962 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x7ab27bfd, L:/127.0.0.1:59776 ! R:localhost/127.0.0.1:33075] Disconnected
2024-02-05T18:54:25,962 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:59776
2024-02-05T18:54:25,962 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:54:25,963 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36051/persistent/__change_events] Closing managed ledger
2024-02-05T18:54:25,964 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36051/__change_events, name=reader-bcdad2ce9f}, consumerId=2, consumerName=1968e, address=/127.0.0.1:59776}
2024-02-05T18:54:25,965 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] Disconnected
2024-02-05T18:54:25,966 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:25,966 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:25,966 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:25,966 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-537164f606] Closed connection [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:25,967 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0d40c1456a] Closed connection [id: 0xdf8aab07, L:/127.0.0.1:39852 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:25,967 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:39852
2024-02-05T18:54:25,964 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36051/__change_events][reader-bcdad2ce9f] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36051/persistent/__change_events, cursor=reader-bcdad2ce9f, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:54:25,967 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36051/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:54:25,967 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36051/__change_events][reader-bcdad2ce9f] Successfully closed dispatcher for reader
2024-02-05T18:54:25,969 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-537164f606}, consumerId=0, consumerName=8b954, address=/127.0.0.1:39852}
2024-02-05T18:54:25,969 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-537164f606] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-537164f606, ackPos=3:6, readPos=3:7}]
2024-02-05T18:54:25,969 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x8cc17f06, L:/127.0.0.1:59784 ! R:localhost/127.0.0.1:33075] Disconnected
2024-02-05T18:54:25,969 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-537164f606] Successfully closed dispatcher for reader
2024-02-05T18:54:25,965 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36051/__change_events] [reader-bcdad2ce9f] Closed connection [id: 0x7ab27bfd, L:/127.0.0.1:59776 ! R:localhost/127.0.0.1:33075] -- Will try again in 0.1 s
2024-02-05T18:54:25,970 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:54:25,970 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-0d40c1456a}, consumerId=1, consumerName=5b569, address=/127.0.0.1:39852}
2024-02-05T18:54:25,973 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:59784
2024-02-05T18:54:25,973 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:54:25,974 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:54:25,980 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33075
2024-02-05T18:54:25,981 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:54:25,983 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:54:25,983 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:54:25,984 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36051/__change_events] [reader-bcdad2ce9f] Closed Consumer (not connected)
2024-02-05T18:54:25,984 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36051/__change_events with subscription name reader-bcdad2ce9f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36051/__change_events with subscription name reader-bcdad2ce9f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:25,986 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-537164f606] Closed Consumer (not connected)
2024-02-05T18:54:25,987 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-537164f606 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-537164f606 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:25,988 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0d40c1456a] Closed Consumer (not connected)
2024-02-05T18:54:25,988 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0d40c1456a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0d40c1456a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:25,994 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:54:25,994 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:54:25,997 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:54:25,998 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:26,008 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:54:26,008 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:26,331 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:26,332 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36051 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:54:26,332 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36051 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:54:26,332 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36051]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:54:26,332 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36051
2024-02-05T18:54:26,333 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36051 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:54:27,278 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:54:27,278 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:54:27,280 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:54:27,281 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:27,281 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:54:27,282 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:54:27,333 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:27,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36051 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:54:27,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36051 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:54:27,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36051]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:54:27,335 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36051
2024-02-05T18:54:27,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36051 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:54:28,223 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 47.46%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.05%, msgThroughputEMA= 0.00, updatedAt= 1707152068222, reportedAt= 1707152063227
2024-02-05T18:54:28,335 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:54:28,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36051 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:54:28,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36051 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:54:28,337 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:36051]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:54:28,337 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36051
2024-02-05T18:54:28,339 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36051 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:54:29,297 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:54:29,298 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:54:29,299 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:54:29,299 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:54:29,299 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:54:29,300 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:54:29,301 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:54:29,302 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:54:29,304 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:54:29,305 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:54:29,306 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:54:29,308 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:54:29,309 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:54:29,309 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:54:29,309 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:54:29,310 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:41971
2024-02-05T18:54:29,311 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:41971, sourceBroker=localhost:36051, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152062823, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:54:34,322 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:41971 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:54:34,332 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:41971 was invalidated. state Releasing
2024-02-05T18:54:34,332 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:41971. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:54:34,333 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:41971
2024-02-05T18:54:34,335 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:41971/0x00000000_0xffffffff.
2024-02-05T18:54:34,336 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:41971/0x00000000_0xffffffff.
2024-02-05T18:54:34,346 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:41971, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152074337, versionId=8]. totalHandledRequests:10
2024-02-05T18:54:34,347 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:54:34,347 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:54:34,348 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:54:34,348 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-28f328062d}, consumerId=5, consumerName=81e71, address=/127.0.0.1:60506}
2024-02-05T18:54:34,348 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-28f328062d}, consumerId=5, consumerName=81e71, address=/127.0.0.1:60506}
2024-02-05T18:54:34,348 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:37535] Broker notification of Closed consumer: 5
2024-02-05T18:54:34,348 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-28f328062d] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-28f328062d, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:54:34,348 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-28f328062d] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 - R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,348 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-28f328062d] Successfully closed dispatcher for reader
2024-02-05T18:54:34,349 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-28f328062d] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-28f328062d, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:54:34,349 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-28f328062d] Successfully disconnected and closed subscription
2024-02-05T18:54:34,349 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:54:34,351 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:54:34,352 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:54:34,353 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-28f328062d] Closed Consumer (not connected)
2024-02-05T18:54:34,353 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 6.0 ms
2024-02-05T18:54:34,353 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-28f328062d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-28f328062d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:34,360 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:41971 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:41971, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152074346, versionId=9]. totalHandledRequests:4
2024-02-05T18:54:34,360 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:54:34,361 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:41971/0x00000000_0xffffffff.
2024-02-05T18:54:34,362 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.028 seconds
2024-02-05T18:54:34,362 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:54:34,362 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:54:34,363 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:54:34,363 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:60506
2024-02-05T18:54:34,363 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:54:34,363 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-6618b0a3f1}, consumerId=0, consumerName=40e70, address=/127.0.0.1:60506}
2024-02-05T18:54:34,363 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:41971/persistent/__change_events] Closing managed ledger
2024-02-05T18:54:34,363 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6618b0a3f1] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6618b0a3f1, ackPos=3:6, readPos=3:9}]
2024-02-05T18:54:34,364 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6618b0a3f1] Successfully closed dispatcher for reader
2024-02-05T18:54:34,364 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:54:34,364 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:41971/__change_events, name=reader-908e8753ed}, consumerId=3, consumerName=966ba, address=/127.0.0.1:60506}
2024-02-05T18:54:34,364 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:41971/__change_events][reader-908e8753ed] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:41971/persistent/__change_events, cursor=reader-908e8753ed, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:41971/__change_events][reader-908e8753ed] Successfully closed dispatcher for reader
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] Disconnected
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-f92619528c}, consumerId=2, consumerName=4bbba, address=/127.0.0.1:60506}
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6618b0a3f1] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-35143ac562}, consumerId=1, consumerName=4845e, address=/127.0.0.1:60506}
2024-02-05T18:54:34,365 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-35143ac562] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,366 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:41971/__change_events] [reader-908e8753ed] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,366 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f92619528c] Closed connection [id: 0x46396158, L:/127.0.0.1:60506 ! R:localhost/127.0.0.1:37535] -- Will try again in 0.1 s
2024-02-05T18:54:34,366 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:54:34,366 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:41971/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:54:34,367 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:54:34,367 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:54:34,367 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:54:34,370 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37535
2024-02-05T18:54:34,371 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6618b0a3f1] Closed Consumer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:41971/__change_events] [reader-908e8753ed] Closed Consumer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-35143ac562] Closed Consumer (not connected)
2024-02-05T18:54:34,371 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f92619528c] Closed Consumer (not connected)
2024-02-05T18:54:34,371 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6618b0a3f1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6618b0a3f1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:34,372 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41971/__change_events with subscription name reader-908e8753ed was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:41971/__change_events with subscription name reader-908e8753ed was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:34,373 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-35143ac562 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-35143ac562 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:34,373 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f92619528c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f92619528c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:54:34,377 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:54:34,377 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:54:34,378 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:54:34,378 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:54:34,379 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:54:34,379 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:34,379 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:54:34,380 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:35,766 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:54:35,767 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:54:35,768 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:54:35,769 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:35,769 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:54:35,769 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:54:35,776 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:54:35,777 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:54:35,780 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:54:35,781 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:54:35,781 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:54:35,782 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:54:35,782 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@11efc5da
2024-02-05T18:54:35,782 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:54:35,782 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:54:35,782 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.244 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  57.632 s
[INFO] Finished at: 2024-02-05T18:54:36+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 6 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:55:06,446 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:55:07,462 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:55:07,463 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:55:07,912 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:55:07,913 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:55:07,914 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:55:07,914 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:55:07,915 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:55:07,916 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:55:07,931 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:55:07,932 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:55:07,933 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:55:07,933 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:55:07,934 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:55:07,935 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:55:07,935 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:55:07,936 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:55:07,936 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:55:07,937 - INFO  - [main:Environment@98] - Client environment:os.memory.free=24MB
2024-02-05T18:55:07,938 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:55:07,938 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:55:09,458 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:55:09,458 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:55:09,459 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:55:09,459 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:55:09,760 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:55:09,762 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:55:09,842 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:55:09,923 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:55:09,927 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:55:09,944 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:55:10,061 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:55:10,105 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:55:10,150 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:55:10,531 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:55:10,532 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:55:10,566 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:55:10,622 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45187, TLS: (none), listener: (none)
2024-02-05T18:55:10,923 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45953, TLS: OPENSSL, listener: (none)
2024-02-05T18:55:10,946 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:55:10,951 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:55:10,951 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:55:10,988 - INFO  - [main:Log@170] - Logging initialized @6833ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:55:11,910 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:55:11,953 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:55:11,954 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:55:11,957 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:55:12,748 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:55:13,915 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:55:15,098 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:55:15,501 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:55:15,619 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:55:15,780 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:55:15,781 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:55:15,784 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:55:15,805 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:33245}
2024-02-05T18:55:15,936 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:44323}
2024-02-05T18:55:15,936 - INFO  - [main:Server@415] - Started @11783ms
2024-02-05T18:55:15,936 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33245
2024-02-05T18:55:15,938 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44323
2024-02-05T18:55:15,945 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:55:15,946 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:55:16,099 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33245
2024-02-05T18:55:16,114 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:55:16,117 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:33245 is changing the role from null to Leader
2024-02-05T18:55:16,121 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33245).
2024-02-05T18:55:16,371 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33245 
2024-02-05T18:55:16,806 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:55:16,838 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:16,950 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:55:16,954 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:55:16,962 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:55:16,963 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:55:16,994 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:55:17,021 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:55:17,049 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:55:17,102 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:55:17,120 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:55:17,130 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:55:17,133 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:55:17,159 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:55:17,161 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 491
2024-02-05T18:55:17,311 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]] Connected to server
2024-02-05T18:55:17,349 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:37010] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:55:17,422 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,432 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,485 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:55:17,516 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37010] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:37010, producerName=test-0-0, producerId=0}
2024-02-05T18:55:17,519 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,521 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:55:17,575 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,578 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c62a3160d9] Subscribing to topic on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187], consumerId 0
2024-02-05T18:55:17,589 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x070f8857, L:/127.0.0.1:45187 - R:/127.0.0.1:37010]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c62a3160d9. consumerId: 0
2024-02-05T18:55:17,625 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c62a3160d9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:17,626 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:55:17,626 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c62a3160d9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:55:17,646 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37010] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c62a3160d9
2024-02-05T18:55:17,651 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c62a3160d9] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 0
2024-02-05T18:55:17,662 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.01 seconds
2024-02-05T18:55:17,664 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:55:17,665 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:55:17,666 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:55:17,700 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,721 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:55:17,722 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:55:17,725 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:55:17,727 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 50
2024-02-05T18:55:17,741 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,756 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:55:17,758 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:55:17,759 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:55:17,760 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:55:17,784 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,786 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,795 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:55:17,802 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37010] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:37010, producerName=test-0-1, producerId=1}
2024-02-05T18:55:17,804 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,821 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,823 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b513346d39] Subscribing to topic on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187], consumerId 1
2024-02-05T18:55:17,825 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x070f8857, L:/127.0.0.1:45187 - R:/127.0.0.1:37010]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b513346d39. consumerId: 1
2024-02-05T18:55:17,856 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b513346d39] Created new subscription for 1
2024-02-05T18:55:17,857 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37010] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b513346d39
2024-02-05T18:55:17,858 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b513346d39] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 1
2024-02-05T18:55:17,879 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,881 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,890 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:55:17,897 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37010] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:37010, producerName=test-0-2, producerId=2}
2024-02-05T18:55:17,898 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:17,915 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:55:17,942 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:55:17,950 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:33245 started the ownership monitor.
2024-02-05T18:55:17,965 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:17,967 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-8d1e186e00] Subscribing to topic on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187], consumerId 2
2024-02-05T18:55:17,969 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x070f8857, L:/127.0.0.1:45187 - R:/127.0.0.1:37010]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-8d1e186e00. consumerId: 2
2024-02-05T18:55:17,979 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33245/__change_events
2024-02-05T18:55:17,985 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-8d1e186e00] Created new subscription for 2
2024-02-05T18:55:17,986 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37010] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-8d1e186e00
2024-02-05T18:55:17,987 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-8d1e186e00] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 2
2024-02-05T18:55:17,988 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:33245 plays the leader now.
2024-02-05T18:55:17,993 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.52%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.52%, msgThroughputEMA= 0.00, updatedAt= 1707152117992, reportedAt= 0
2024-02-05T18:55:18,019 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:55:18,023 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:18,025 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:55:18,068 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33245/0x00000000_0xffffffff - localhost:33245.
2024-02-05T18:55:18,071 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33245
2024-02-05T18:55:18,071 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33245/0x00000000_0xffffffff
2024-02-05T18:55:18,072 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33245/0x00000000_0xffffffff - localhost:33245.
2024-02-05T18:55:18,073 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33245
2024-02-05T18:55:18,073 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33245/0x00000000_0xffffffff
2024-02-05T18:55:18,093 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33245 doesn't exist.
2024-02-05T18:55:18,119 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33245/__change_events][reader-2817aa0a64] Subscribing to topic on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187], consumerId 3
2024-02-05T18:55:18,122 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x070f8857, L:/127.0.0.1:45187 - R:/127.0.0.1:37010]] Subscribing on topic persistent://sla-monitor/test/localhost:33245/__change_events / reader-2817aa0a64. consumerId: 3
2024-02-05T18:55:18,131 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33245/persistent/__change_events
2024-02-05T18:55:18,136 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33245/persistent/__change_events'
2024-02-05T18:55:18,144 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:55:18,145 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33245/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:55:18,154 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33245/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:55:18,160 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33245/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:55:18,164 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33245/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33245/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:55:18,167 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33245/__change_events - dedup is disabled
2024-02-05T18:55:18,180 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:55:18,190 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33245/__change_events][reader-2817aa0a64] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:18,191 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33245/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:55:18,191 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33245/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33245/persistent/__change_events, cursor=reader-2817aa0a64, ackPos=7:-1, readPos=7:0}
2024-02-05T18:55:18,193 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:37010] Created subscription on topic persistent://sla-monitor/test/localhost:33245/__change_events / reader-2817aa0a64
2024-02-05T18:55:18,195 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33245/__change_events][reader-2817aa0a64] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 3
2024-02-05T18:55:18,111 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 33245, tls-port = Optional[44323], broker url= pulsar://localhost:45187, broker tls url= pulsar+ssl://localhost:45953, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[45187], brokerServicePortTls=Optional[45953], webServicePort=Optional[33245], webServicePortTls=Optional[44323], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:55:18,775 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:55:18,776 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:55:18,776 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:55:18,776 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:55:18,782 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:55:18,783 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:55:18,788 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:55:18,792 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:55:18,800 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:55:18,800 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:55:18,809 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:55:18,814 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:55:18,818 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:55:18,828 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:55:18,829 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:55:18,834 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:55:18,837 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40359, TLS: (none), listener: (none)
2024-02-05T18:55:18,839 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42211, TLS: OPENSSL, listener: (none)
2024-02-05T18:55:18,843 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:55:18,844 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:55:18,845 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:55:18,863 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:55:18,866 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:55:18,867 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:55:18,867 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:55:19,016 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:55:19,025 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:19,026 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:55:19,675 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:55:20,028 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:20,029 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:55:20,738 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:55:20,936 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:55:21,001 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:55:21,035 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:21,036 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:55:21,069 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:55:21,070 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:55:21,071 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:55:21,075 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:32993}
2024-02-05T18:55:21,103 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:34745}
2024-02-05T18:55:21,109 - INFO  - [main:Server@415] - Started @16951ms
2024-02-05T18:55:21,109 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:32993
2024-02-05T18:55:21,111 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34745
2024-02-05T18:55:21,114 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:55:21,115 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:55:21,139 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:32993
2024-02-05T18:55:21,139 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:32993 registry has been created.
2024-02-05T18:55:21,140 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:32993. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:55:21,144 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:32993 is changing the role from null to Follower
2024-02-05T18:55:21,148 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33245).
2024-02-05T18:55:21,154 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:55:21,180 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:32993 
2024-02-05T18:55:21,337 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 51
2024-02-05T18:55:21,359 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:21,361 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:55:21,363 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:55:21,372 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:55:21,376 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:32993/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:55:21,386 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x7f2f0fb7, L:/127.0.0.1:51608 - R:localhost/127.0.0.1:40359]] Connected to server
2024-02-05T18:55:21,390 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:51608] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:55:21,406 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]] Connected to server
2024-02-05T18:55:21,410 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:34720] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:55:21,411 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,422 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34720] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:34720, producerName=test-0-3, producerId=0}
2024-02-05T18:55:21,423 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,434 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-58a3f3b0c9] Subscribing to topic on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187], consumerId 0
2024-02-05T18:55:21,436 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xfd69b258, L:/127.0.0.1:45187 - R:/127.0.0.1:34720]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-58a3f3b0c9. consumerId: 0
2024-02-05T18:55:21,442 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-58a3f3b0c9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:21,442 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:55:21,442 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-58a3f3b0c9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:55:21,444 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34720] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-58a3f3b0c9
2024-02-05T18:55:21,445 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-58a3f3b0c9] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 0
2024-02-05T18:55:21,449 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:55:21,449 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:55:21,474 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:55:21,484 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:21,486 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:55:21,486 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:55:21,489 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:55:21,490 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:32993/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:55:21,500 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 6
2024-02-05T18:55:21,507 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:21,509 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:55:21,510 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:55:21,513 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:55:21,514 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:32993/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:55:21,531 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,540 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34720] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:34720, producerName=test-0-4, producerId=1}
2024-02-05T18:55:21,542 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,553 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-285b38d077] Subscribing to topic on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187], consumerId 1
2024-02-05T18:55:21,556 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xfd69b258, L:/127.0.0.1:45187 - R:/127.0.0.1:34720]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-285b38d077. consumerId: 1
2024-02-05T18:55:21,568 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-285b38d077] Created new subscription for 1
2024-02-05T18:55:21,568 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34720] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-285b38d077
2024-02-05T18:55:21,569 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-285b38d077] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 1
2024-02-05T18:55:21,584 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,592 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34720] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:34720, producerName=test-0-5, producerId=2}
2024-02-05T18:55:21,593 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187]
2024-02-05T18:55:21,595 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:55:21,598 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:55:21,600 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:32993 plays a follower now.
2024-02-05T18:55:21,619 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:32993/__change_events
2024-02-05T18:55:21,635 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:32993/0x00000000_0xffffffff - localhost:32993.
2024-02-05T18:55:21,636 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:32993/0x00000000_0xffffffff
2024-02-05T18:55:21,637 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:32993
2024-02-05T18:55:21,638 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:32993/0x00000000_0xffffffff - localhost:32993.
2024-02-05T18:55:21,639 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:32993/0x00000000_0xffffffff
2024-02-05T18:55:21,640 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:32993
2024-02-05T18:55:21,642 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:32993 doesn't exist.
2024-02-05T18:55:21,644 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:32993/__change_events][reader-25c82c8fc6] Subscribing to topic on cnx [id: 0x7f2f0fb7, L:/127.0.0.1:51608 - R:localhost/127.0.0.1:40359], consumerId 2
2024-02-05T18:55:21,646 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xc439e0b0, L:/127.0.0.1:40359 - R:/127.0.0.1:51608]] Subscribing on topic persistent://sla-monitor/test/localhost:32993/__change_events / reader-25c82c8fc6. consumerId: 2
2024-02-05T18:55:21,645 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 32993, tls-port = Optional[34745], broker url= pulsar://localhost:40359, broker tls url= pulsar+ssl://localhost:42211, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40359], brokerServicePortTls=Optional[42211], webServicePort=Optional[32993], webServicePortTls=Optional[34745], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:55:21,655 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:32993/persistent/__change_events
2024-02-05T18:55:21,658 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:32993/persistent/__change_events'
2024-02-05T18:55:21,668 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:55:21,669 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:32993/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:55:21,678 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:32993/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:55:21,682 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:32993/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:55:21,688 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:32993/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:32993/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:55:21,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:32993/__change_events - dedup is disabled
2024-02-05T18:55:21,696 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:55:21,704 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:32993/__change_events][reader-25c82c8fc6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:21,705 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:32993/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:55:21,705 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:32993/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:32993/persistent/__change_events, cursor=reader-25c82c8fc6, ackPos=9:-1, readPos=9:0}
2024-02-05T18:55:21,707 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:51608] Created subscription on topic persistent://sla-monitor/test/localhost:32993/__change_events / reader-25c82c8fc6
2024-02-05T18:55:21,709 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:32993/__change_events][reader-25c82c8fc6] Subscribed to topic on localhost/127.0.0.1:40359 -- consumer: 2
2024-02-05T18:55:21,841 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:55:21,842 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:55:21,875 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:55:21,876 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:55:21,901 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:55:21,901 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:55:21,906 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:55:21,907 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:55:21,931 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:55:21,932 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:55:21,933 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:55:21,934 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:55:21,935 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:55:21,939 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:55:21,951 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:55:21,951 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:55:21,956 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:55:21,957 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:55:21,971 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:55:21,971 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:55:21,972 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:55:21,972 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:21 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:55:21,974 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:55:21,977 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:55:22,004 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:55:22,014 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:55:22,016 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:55:22,029 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:55:22,036 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:55:22,037 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:55:22,039 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:22,058 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:32993 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:55:22,128 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:55:22,100 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:32993, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122060, versionId=1]. totalHandledRequests:1
2024-02-05T18:55:22,155 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:32993, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122102, versionId=2]. totalHandledRequests:1
2024-02-05T18:55:22,159 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:22,167 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 141
2024-02-05T18:55:22,179 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:55:22,185 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-4d397014d6] Subscribing to topic on cnx [id: 0x7f2f0fb7, L:/127.0.0.1:51608 - R:localhost/127.0.0.1:40359], consumerId 3
2024-02-05T18:55:22,187 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xc439e0b0, L:/127.0.0.1:40359 - R:/127.0.0.1:51608]] Subscribing on topic persistent://public/test/__change_events / reader-4d397014d6. consumerId: 3
2024-02-05T18:55:22,194 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:55:22,197 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:55:22,207 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:55:22,209 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:55:22,213 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:32993, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152122203, versionId=3]. totalHandledRequests:1
2024-02-05T18:55:22,215 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:55:22,218 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:55:22,222 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:55:22,223 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:55:22,226 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:55:22,229 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:55:22,230 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:55:22,231 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:55:22,243 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:55:22,244 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:55:22,255 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:55:22,259 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 45.0 ms
2024-02-05T18:55:22,268 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:32993, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122213, versionId=4]. totalHandledRequests:1
2024-02-05T18:55:22,268 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:32993. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:55:22,269 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:51608][persistent://public/test/__change_events][reader-4d397014d6] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:32993. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:55:22,270 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:55:22,271 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x7f2f0fb7, L:/127.0.0.1:51608 - R:localhost/127.0.0.1:40359] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:32993. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:55:22,271 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:55:22,272 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:22 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 101
2024-02-05T18:55:22,273 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:55:22,273 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-4d397014d6] Failed to subscribe to topic on localhost/127.0.0.1:40359
2024-02-05T18:55:22,273 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-4d397014d6] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:32993. Please redo the lookup. Request is denied: namespace=public/test","reqId":1289666450785184138, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:51608"}
2024-02-05T18:55:22,273 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-4d397014d6] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:32993. Please redo the lookup. Request is denied: namespace=public/test","reqId":1289666450785184138, "remote":"localhost/127.0.0.1:40359", "local":"/127.0.0.1:51608"} -- Will try again in 0.1 s
2024-02-05T18:55:22,274 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:55:22 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 274
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@40af8eef], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a2c338] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@40af8eef, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@336b5ebd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a2c338, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47a4a77d] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@40af8eef, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@336b5ebd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc09190], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a2c338, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47a4a77d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6fef26d3] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@40af8eef, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@336b5ebd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc09190, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6981325], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a2c338, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47a4a77d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6fef26d3, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@64e5c3c4] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@223e53be, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1b5555a4, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@40af8eef, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@336b5ebd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc09190, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6981325, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bd682d9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c99dad8, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@105c9cf9, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a2c338, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47a4a77d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6fef26d3, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@64e5c3c4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@d99f6ce] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:55:22,376 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-4d397014d6] Reconnecting after connection was closed
2024-02-05T18:55:22,382 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:55:22,385 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:32993. Skipping this broker. Phase one
2024-02-05T18:55:22,385 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33245. Skipping this broker. Phase one
2024-02-05T18:55:22,386 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33245 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:55:22,394 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33245, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122386, versionId=5]. totalHandledRequests:8
2024-02-05T18:55:22,399 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:55:22,400 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:55:22,401 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:55:22,402 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:55:22,403 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:55:22,409 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33245, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122394, versionId=6]. totalHandledRequests:6
2024-02-05T18:55:22,416 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-4d397014d6] Subscribing to topic on cnx [id: 0x84d6411d, L:/127.0.0.1:34720 - R:localhost/127.0.0.1:45187], consumerId 3
2024-02-05T18:55:22,421 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:55:22,420 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xfd69b258, L:/127.0.0.1:45187 - R:/127.0.0.1:34720]] Subscribing on topic persistent://public/test/__change_events / reader-4d397014d6. consumerId: 3
2024-02-05T18:55:22,424 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:55:22,427 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:55:22,428 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:55:22,431 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:55:22,435 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:55:22,441 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:55:22,446 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:55:22,447 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:55:22,452 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:55:22,453 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:55:22,454 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:55:22,460 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:55:22,464 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:55:22,464 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:55:22,465 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:55:22,466 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:32993
2024-02-05T18:55:22,471 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:55:22,472 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:55:22,474 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:55:22,475 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:55:22,475 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:55:22,480 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:55:22,488 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-4d397014d6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:22,488 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:55:22,488 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4d397014d6, ackPos=13:-1, readPos=13:0}
2024-02-05T18:55:22,490 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34720] Created subscription on topic persistent://public/test/__change_events / reader-4d397014d6
2024-02-05T18:55:22,491 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:32993 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:55:22,492 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-4d397014d6] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 3
2024-02-05T18:55:22,495 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:32993 registry has been deleted.
2024-02-05T18:55:22,495 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:32993 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:55:22,498 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:32993 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:55:22,498 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:34720] Closing consumer: consumerId=3
2024-02-05T18:55:22,499 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:32993
2024-02-05T18:55:22,498 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-4d397014d6}, consumerId=3, consumerName=65847, address=/127.0.0.1:34720}
2024-02-05T18:55:22,501 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:32993 was invalidated. state Releasing
2024-02-05T18:55:22,502 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-4d397014d6] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-4d397014d6, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:55:22,503 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:32993. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:55:22,503 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:55:22,503 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:32993 in 3.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:55:22,505 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:32993
2024-02-05T18:55:22,511 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Subscribing to topic on cnx [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187], consumerId 4
2024-02-05T18:55:22,512 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-4d397014d6] Successfully closed dispatcher for reader
2024-02-05T18:55:22,514 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x070f8857, L:/127.0.0.1:45187 - R:/127.0.0.1:37010]] Subscribing on topic persistent://public/test/__change_events / reader-aa2f30b1c2. consumerId: 4
2024-02-05T18:55:22,518 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:34720] Closed consumer, consumerId=3
2024-02-05T18:55:22,519 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-4d397014d6] Closed consumer
2024-02-05T18:55:22,519 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:55:22,524 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:32993/0x00000000_0xffffffff.
2024-02-05T18:55:22,524 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:55:22,524 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:55:22,524 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-aa2f30b1c2, ackPos=13:-1, readPos=13:0}
2024-02-05T18:55:22,526 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37010] Created subscription on topic persistent://public/test/__change_events / reader-aa2f30b1c2
2024-02-05T18:55:22,526 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:32993/0x00000000_0xffffffff.
2024-02-05T18:55:22,527 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Subscribed to topic on localhost/127.0.0.1:45187 -- consumer: 4
2024-02-05T18:55:22,531 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:32993/0x00000000_0xffffffff.
2024-02-05T18:55:22,531 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.026 seconds
2024-02-05T18:55:22,533 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:55:22,537 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] Disconnected
2024-02-05T18:55:22,540 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x7f2f0fb7, L:/127.0.0.1:51608 ! R:localhost/127.0.0.1:40359] Disconnected
2024-02-05T18:55:22,541 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:34720
2024-02-05T18:55:22,541 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:32993/__change_events] [reader-25c82c8fc6] Closed connection [id: 0x7f2f0fb7, L:/127.0.0.1:51608 ! R:localhost/127.0.0.1:40359] -- Will try again in 0.1 s
2024-02-05T18:55:22,542 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:51608
2024-02-05T18:55:22,543 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:32993/__change_events, name=reader-25c82c8fc6}, consumerId=2, consumerName=fc77a, address=/127.0.0.1:51608}
2024-02-05T18:55:22,543 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:32993/__change_events][reader-25c82c8fc6] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:32993/persistent/__change_events, cursor=reader-25c82c8fc6, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:55:22,544 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:32993/__change_events][reader-25c82c8fc6] Successfully closed dispatcher for reader
2024-02-05T18:55:22,545 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:22,545 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:22,546 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:22,546 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-58a3f3b0c9] Closed connection [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:22,546 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-285b38d077] Closed connection [id: 0x84d6411d, L:/127.0.0.1:34720 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:22,549 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-58a3f3b0c9}, consumerId=0, consumerName=bd8c4, address=/127.0.0.1:34720}
2024-02-05T18:55:22,549 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-58a3f3b0c9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-58a3f3b0c9, ackPos=3:5, readPos=3:6}]
2024-02-05T18:55:22,549 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-58a3f3b0c9] Successfully closed dispatcher for reader
2024-02-05T18:55:22,550 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-285b38d077}, consumerId=1, consumerName=8beeb, address=/127.0.0.1:34720}
2024-02-05T18:55:22,550 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:55:22,552 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:32993/persistent/__change_events] Closing managed ledger
2024-02-05T18:55:22,553 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:32993/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:55:22,554 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:55:22,555 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:55:22,556 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:55:22,561 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40359
2024-02-05T18:55:22,562 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:55:22,564 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:55:22,564 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:55:22,565 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-58a3f3b0c9] Closed Consumer (not connected)
2024-02-05T18:55:22,566 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-58a3f3b0c9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-58a3f3b0c9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:22,569 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-285b38d077] Closed Consumer (not connected)
2024-02-05T18:55:22,570 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-285b38d077 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-285b38d077 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:22,570 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:32993/__change_events] [reader-25c82c8fc6] Closed Consumer (not connected)
2024-02-05T18:55:22,571 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:32993/__change_events with subscription name reader-25c82c8fc6 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:32993/__change_events with subscription name reader-25c82c8fc6 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:22,580 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:55:22,581 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:55:22,584 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:55:22,585 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:22,591 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:55:22,591 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:22,935 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:55:22,937 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 45.51%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 45.51%, msgThroughputEMA= 0.00, updatedAt= 1707152122935, reportedAt= 0
2024-02-05T18:55:23,038 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:23,038 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:55:23,853 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:55:23,854 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:55:23,856 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:55:23,857 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:23,857 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:55:23,857 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:55:24,039 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:24,039 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:55:25,040 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:55:25,040 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:55:25,872 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:55:25,874 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:55:25,874 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:55:25,874 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:55:25,874 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:55:25,875 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:55:25,877 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:55:25,878 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:55:25,879 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:55:25,881 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:55:25,882 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:55:25,883 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:55:25,885 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:55:25,885 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:55:25,886 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:55:25,886 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33245
2024-02-05T18:55:25,888 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33245, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152122394, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:55:30,899 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33245 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:55:30,909 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33245 was invalidated. state Releasing
2024-02-05T18:55:30,909 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33245. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:55:30,910 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33245
2024-02-05T18:55:30,913 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33245/0x00000000_0xffffffff.
2024-02-05T18:55:30,921 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33245, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152130914, versionId=7]. totalHandledRequests:10
2024-02-05T18:55:30,921 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:55:30,922 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:55:30,922 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:55:30,923 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-aa2f30b1c2}, consumerId=4, consumerName=5b8a4, address=/127.0.0.1:37010}
2024-02-05T18:55:30,924 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-aa2f30b1c2}, consumerId=4, consumerName=5b8a4, address=/127.0.0.1:37010}
2024-02-05T18:55:30,924 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:45187] Broker notification of Closed consumer: 4
2024-02-05T18:55:30,924 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-aa2f30b1c2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:55:30,924 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-aa2f30b1c2] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 - R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,924 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Successfully closed dispatcher for reader
2024-02-05T18:55:30,925 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-aa2f30b1c2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:55:30,925 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-aa2f30b1c2] Successfully disconnected and closed subscription
2024-02-05T18:55:30,925 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:55:30,929 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:55:30,930 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:55:30,930 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-aa2f30b1c2] Closed Consumer (not connected)
2024-02-05T18:55:30,931 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:55:30,931 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-aa2f30b1c2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-aa2f30b1c2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:30,938 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33245 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33245, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152130921, versionId=8]. totalHandledRequests:4
2024-02-05T18:55:30,938 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:55:30,941 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33245/0x00000000_0xffffffff.
2024-02-05T18:55:30,942 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33245/0x00000000_0xffffffff.
2024-02-05T18:55:30,942 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.032 seconds
2024-02-05T18:55:30,943 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:37010
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] Disconnected
2024-02-05T18:55:30,944 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-c62a3160d9}, consumerId=0, consumerName=4b4d2, address=/127.0.0.1:37010}
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,944 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33245/persistent/__change_events] Closing managed ledger
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c62a3160d9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c62a3160d9, ackPos=3:5, readPos=3:8}]
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c62a3160d9] Successfully closed dispatcher for reader
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,944 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c62a3160d9] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,945 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b513346d39] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,945 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:55:30,945 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33245/__change_events, name=reader-2817aa0a64}, consumerId=3, consumerName=97ca3, address=/127.0.0.1:37010}
2024-02-05T18:55:30,945 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33245/__change_events][reader-2817aa0a64] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33245/persistent/__change_events, cursor=reader-2817aa0a64, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:55:30,945 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33245/__change_events] [reader-2817aa0a64] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,945 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33245/__change_events][reader-2817aa0a64] Successfully closed dispatcher for reader
2024-02-05T18:55:30,946 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-8d1e186e00] Closed connection [id: 0x229c2668, L:/127.0.0.1:37010 ! R:localhost/127.0.0.1:45187] -- Will try again in 0.1 s
2024-02-05T18:55:30,946 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-8d1e186e00}, consumerId=2, consumerName=4039c, address=/127.0.0.1:37010}
2024-02-05T18:55:30,946 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-b513346d39}, consumerId=1, consumerName=8534e, address=/127.0.0.1:37010}
2024-02-05T18:55:30,949 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33245/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:55:30,950 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:55:30,950 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:55:30,952 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:55:30,953 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:55:30,957 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:45187
2024-02-05T18:55:30,957 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:55:30,958 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:55:30,958 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:55:30,958 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-8d1e186e00] Closed Consumer (not connected)
2024-02-05T18:55:30,958 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33245/__change_events] [reader-2817aa0a64] Closed Consumer (not connected)
2024-02-05T18:55:30,959 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b513346d39] Closed Consumer (not connected)
2024-02-05T18:55:30,959 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c62a3160d9] Closed Consumer (not connected)
2024-02-05T18:55:30,959 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-8d1e186e00 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-8d1e186e00 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:30,959 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33245/__change_events with subscription name reader-2817aa0a64 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33245/__change_events with subscription name reader-2817aa0a64 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:30,962 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b513346d39 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b513346d39 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:30,962 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c62a3160d9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c62a3160d9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:55:30,965 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:55:30,965 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:55:30,965 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:55:30,966 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:55:30,966 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:55:30,968 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:30,970 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:55:30,970 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:32,350 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:55:32,351 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:55:32,353 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:55:32,353 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:32,353 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:55:32,353 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:55:32,361 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:55:32,361 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:55:32,365 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:55:32,365 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:55:32,365 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:55:32,366 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:55:32,366 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:55:32,367 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@339e62bb
2024-02-05T18:55:32,367 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:55:32,367 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:55:32,367 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 27.706 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  53.371 s
[INFO] Finished at: 2024-02-05T18:55:32+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 7 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:56:03,975 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:56:04,929 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:56:04,931 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:56:05,427 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:56:05,428 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:56:05,429 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:56:05,429 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:56:05,430 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:56:05,431 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:56:05,449 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:56:05,449 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:56:05,450 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:56:05,451 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:56:05,451 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:56:05,452 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:56:05,452 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:56:05,453 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:56:05,453 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:56:05,454 - INFO  - [main:Environment@98] - Client environment:os.memory.free=20MB
2024-02-05T18:56:05,455 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:56:05,455 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:56:07,061 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:56:07,062 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:56:07,063 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:56:07,063 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:56:07,407 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:56:07,408 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:56:07,502 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:56:07,595 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:56:07,600 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:56:07,635 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:56:07,747 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:56:07,788 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:56:07,835 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:56:08,276 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:56:08,277 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:56:08,308 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:56:08,365 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37741, TLS: (none), listener: (none)
2024-02-05T18:56:08,647 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36305, TLS: OPENSSL, listener: (none)
2024-02-05T18:56:08,668 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:56:08,673 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:56:08,674 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:56:08,708 - INFO  - [main:Log@170] - Logging initialized @7007ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:56:09,763 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:56:09,800 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:56:09,801 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:56:09,803 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:56:10,658 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:56:11,825 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:56:13,075 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:56:13,442 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:56:13,578 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:56:13,705 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:56:13,707 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:56:13,709 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:56:13,724 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:43479}
2024-02-05T18:56:13,881 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:42655}
2024-02-05T18:56:13,882 - INFO  - [main:Server@415] - Started @12184ms
2024-02-05T18:56:13,882 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:43479
2024-02-05T18:56:13,884 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:42655
2024-02-05T18:56:13,892 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:56:13,893 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:56:14,071 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:43479
2024-02-05T18:56:14,091 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:56:14,094 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:43479 is changing the role from null to Leader
2024-02-05T18:56:14,098 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43479).
2024-02-05T18:56:14,412 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:43479 
2024-02-05T18:56:14,838 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:56:14,869 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:14,985 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:56:14,991 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:56:15,004 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:56:15,010 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:56:15,061 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:56:15,098 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:56:15,132 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:56:15,216 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:56:15,242 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:56:15,253 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:56:15,256 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:56:15,290 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:14 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 574
2024-02-05T18:56:15,297 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:56:15,464 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]] Connected to server
2024-02-05T18:56:15,499 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:49102] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:56:15,560 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,569 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:15,637 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:56:15,668 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49102] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:49102, producerName=test-0-0, producerId=0}
2024-02-05T18:56:15,676 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:15,678 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:56:15,723 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,725 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9e8732b802] Subscribing to topic on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741], consumerId 0
2024-02-05T18:56:15,738 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27b1e5fa, L:/127.0.0.1:37741 - R:/127.0.0.1:49102]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9e8732b802. consumerId: 0
2024-02-05T18:56:15,777 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9e8732b802] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:15,778 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:56:15,778 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9e8732b802, ackPos=3:-1, readPos=3:0}
2024-02-05T18:56:15,804 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:49102] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9e8732b802
2024-02-05T18:56:15,809 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9e8732b802] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 0
2024-02-05T18:56:15,832 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.021 seconds
2024-02-05T18:56:15,833 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:56:15,837 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:56:15,838 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:56:15,882 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,902 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:56:15,904 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:56:15,906 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:56:15,906 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 54
2024-02-05T18:56:15,920 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,932 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:56:15,933 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:56:15,935 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:56:15,936 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:56:15,959 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,960 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:15,971 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:56:15,978 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49102] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:49102, producerName=test-0-1, producerId=1}
2024-02-05T18:56:15,980 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:15,996 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:15,998 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73418f88ea] Subscribing to topic on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741], consumerId 1
2024-02-05T18:56:16,000 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27b1e5fa, L:/127.0.0.1:37741 - R:/127.0.0.1:49102]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73418f88ea. consumerId: 1
2024-02-05T18:56:16,026 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73418f88ea] Created new subscription for 1
2024-02-05T18:56:16,027 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49102] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-73418f88ea
2024-02-05T18:56:16,032 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-73418f88ea] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 1
2024-02-05T18:56:16,053 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:16,055 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:16,061 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:56:16,068 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:49102] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:49102, producerName=test-0-2, producerId=2}
2024-02-05T18:56:16,070 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:16,086 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:56:16,110 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:56:16,116 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:43479 started the ownership monitor.
2024-02-05T18:56:16,137 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:16,138 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0b18e13939] Subscribing to topic on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741], consumerId 2
2024-02-05T18:56:16,140 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27b1e5fa, L:/127.0.0.1:37741 - R:/127.0.0.1:49102]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-0b18e13939. consumerId: 2
2024-02-05T18:56:16,150 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:43479/__change_events
2024-02-05T18:56:16,153 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0b18e13939] Created new subscription for 2
2024-02-05T18:56:16,153 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49102] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-0b18e13939
2024-02-05T18:56:16,154 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0b18e13939] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 2
2024-02-05T18:56:16,155 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:43479 plays the leader now.
2024-02-05T18:56:16,160 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.49%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.49%, msgThroughputEMA= 0.00, updatedAt= 1707152176159, reportedAt= 0
2024-02-05T18:56:16,186 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:56:16,192 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:16,193 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:56:16,274 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:43479/__change_events][reader-a4f608fecf] Subscribing to topic on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741], consumerId 3
2024-02-05T18:56:16,277 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27b1e5fa, L:/127.0.0.1:37741 - R:/127.0.0.1:49102]] Subscribing on topic persistent://sla-monitor/test/localhost:43479/__change_events / reader-a4f608fecf. consumerId: 3
2024-02-05T18:56:16,280 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:43479/0x00000000_0xffffffff - localhost:43479.
2024-02-05T18:56:16,284 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:43479
2024-02-05T18:56:16,284 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:43479/0x00000000_0xffffffff
2024-02-05T18:56:16,285 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:43479/0x00000000_0xffffffff - localhost:43479.
2024-02-05T18:56:16,287 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:43479/0x00000000_0xffffffff
2024-02-05T18:56:16,289 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:43479
2024-02-05T18:56:16,289 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:43479/persistent/__change_events
2024-02-05T18:56:16,291 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:43479/persistent/__change_events'
2024-02-05T18:56:16,300 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:56:16,301 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:43479/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:56:16,303 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:43479 doesn't exist.
2024-02-05T18:56:16,305 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:43479/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:56:16,313 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:43479/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:56:16,316 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:43479/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:43479/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:56:16,319 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:43479/__change_events - dedup is disabled
2024-02-05T18:56:16,334 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:56:16,344 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:43479/__change_events][reader-a4f608fecf] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:16,345 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:43479/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:56:16,345 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:43479/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43479/persistent/__change_events, cursor=reader-a4f608fecf, ackPos=7:-1, readPos=7:0}
2024-02-05T18:56:16,349 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:49102] Created subscription on topic persistent://sla-monitor/test/localhost:43479/__change_events / reader-a4f608fecf
2024-02-05T18:56:16,350 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:43479/__change_events][reader-a4f608fecf] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 3
2024-02-05T18:56:16,321 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 43479, tls-port = Optional[42655], broker url= pulsar://localhost:37741, broker tls url= pulsar+ssl://localhost:36305, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37741], brokerServicePortTls=Optional[36305], webServicePort=Optional[43479], webServicePortTls=Optional[42655], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:56:17,009 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:56:17,010 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:56:17,010 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:56:17,010 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:56:17,019 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:56:17,019 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:56:17,027 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:56:17,032 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:56:17,044 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:56:17,045 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:56:17,054 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:56:17,057 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:56:17,061 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:56:17,072 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:56:17,073 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:56:17,081 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:56:17,095 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33147, TLS: (none), listener: (none)
2024-02-05T18:56:17,099 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36247, TLS: OPENSSL, listener: (none)
2024-02-05T18:56:17,108 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:56:17,110 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:56:17,110 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:56:17,124 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:56:17,129 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:56:17,129 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:56:17,130 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:56:17,194 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:17,195 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:56:17,246 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:56:17,795 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:56:18,196 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:18,197 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:56:19,006 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:56:19,198 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:19,198 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:56:19,239 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:56:19,310 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:56:19,448 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:56:19,451 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:56:19,451 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:56:19,453 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:37153}
2024-02-05T18:56:19,462 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:36795}
2024-02-05T18:56:19,462 - INFO  - [main:Server@415] - Started @17764ms
2024-02-05T18:56:19,463 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:37153
2024-02-05T18:56:19,465 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:36795
2024-02-05T18:56:19,472 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:56:19,475 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:56:19,491 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:37153
2024-02-05T18:56:19,493 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:37153 registry has been created.
2024-02-05T18:56:19,493 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:37153. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:56:19,496 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:37153 is changing the role from null to Follower
2024-02-05T18:56:19,500 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43479).
2024-02-05T18:56:19,507 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:56:19,521 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:37153 
2024-02-05T18:56:19,648 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:56:19,676 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:19,679 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:56:19,681 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:56:19,700 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 43
2024-02-05T18:56:19,702 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37153/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:56:19,717 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x1805280b, L:/127.0.0.1:49378 - R:localhost/127.0.0.1:33147]] Connected to server
2024-02-05T18:56:19,722 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:49378] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:56:19,753 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]] Connected to server
2024-02-05T18:56:19,758 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:49118] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:56:19,759 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,771 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49118] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:49118, producerName=test-0-3, producerId=0}
2024-02-05T18:56:19,772 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,785 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a02cabd04f] Subscribing to topic on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741], consumerId 0
2024-02-05T18:56:19,788 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2de7a5d0, L:/127.0.0.1:37741 - R:/127.0.0.1:49118]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-a02cabd04f. consumerId: 0
2024-02-05T18:56:19,794 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a02cabd04f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:19,795 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:56:19,796 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-a02cabd04f, ackPos=3:-1, readPos=3:0}
2024-02-05T18:56:19,798 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49118] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-a02cabd04f
2024-02-05T18:56:19,799 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a02cabd04f] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 0
2024-02-05T18:56:19,802 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:56:19,803 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:56:19,830 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:56:19,838 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:19,841 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:56:19,841 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:56:19,846 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:56:19,846 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37153/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:56:19,861 - INFO  - [pulsar-web-84-4:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:56:19,868 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:19,871 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:56:19,871 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:56:19,875 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:19 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:56:19,876 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37153/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:56:19,893 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,901 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49118] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:49118, producerName=test-0-4, producerId=1}
2024-02-05T18:56:19,903 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,922 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cdcfb04ab5] Subscribing to topic on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741], consumerId 1
2024-02-05T18:56:19,923 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2de7a5d0, L:/127.0.0.1:37741 - R:/127.0.0.1:49118]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-cdcfb04ab5. consumerId: 1
2024-02-05T18:56:19,936 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cdcfb04ab5] Created new subscription for 1
2024-02-05T18:56:19,936 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49118] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-cdcfb04ab5
2024-02-05T18:56:19,937 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cdcfb04ab5] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 1
2024-02-05T18:56:19,956 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,969 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:49118] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:49118, producerName=test-0-5, producerId=2}
2024-02-05T18:56:19,970 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741]
2024-02-05T18:56:19,972 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:56:19,974 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:56:19,976 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:37153 plays a follower now.
2024-02-05T18:56:19,998 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:37153/__change_events
2024-02-05T18:56:20,030 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:37153/0x00000000_0xffffffff - localhost:37153.
2024-02-05T18:56:20,032 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:37153
2024-02-05T18:56:20,032 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:37153/0x00000000_0xffffffff
2024-02-05T18:56:20,032 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:37153/0x00000000_0xffffffff - localhost:37153.
2024-02-05T18:56:20,038 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:37153/__change_events][reader-4b23292c3d] Subscribing to topic on cnx [id: 0x1805280b, L:/127.0.0.1:49378 - R:localhost/127.0.0.1:33147], consumerId 2
2024-02-05T18:56:20,038 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:37153
2024-02-05T18:56:20,039 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:37153/0x00000000_0xffffffff
2024-02-05T18:56:20,040 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xa80ffff3, L:/127.0.0.1:33147 - R:/127.0.0.1:49378]] Subscribing on topic persistent://sla-monitor/test/localhost:37153/__change_events / reader-4b23292c3d. consumerId: 2
2024-02-05T18:56:20,043 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:37153 doesn't exist.
2024-02-05T18:56:20,045 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 37153, tls-port = Optional[36795], broker url= pulsar://localhost:33147, broker tls url= pulsar+ssl://localhost:36247, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33147], brokerServicePortTls=Optional[36247], webServicePort=Optional[37153], webServicePortTls=Optional[36795], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:56:20,052 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:37153/persistent/__change_events
2024-02-05T18:56:20,055 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:37153/persistent/__change_events'
2024-02-05T18:56:20,066 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:56:20,068 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:37153/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:56:20,075 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:37153/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:56:20,079 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:37153/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:56:20,082 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:37153/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:37153/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:56:20,083 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:37153/__change_events - dedup is disabled
2024-02-05T18:56:20,093 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:56:20,102 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:37153/__change_events][reader-4b23292c3d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:20,103 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:37153/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:56:20,103 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:37153/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37153/persistent/__change_events, cursor=reader-4b23292c3d, ackPos=9:-1, readPos=9:0}
2024-02-05T18:56:20,105 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:49378] Created subscription on topic persistent://sla-monitor/test/localhost:37153/__change_events / reader-4b23292c3d
2024-02-05T18:56:20,106 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:37153/__change_events][reader-4b23292c3d] Subscribed to topic on localhost/127.0.0.1:33147 -- consumer: 2
2024-02-05T18:56:20,199 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:56:20,199 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:56:20,267 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:56:20,269 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:56:20,297 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:56:20,299 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:56:20,322 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:56:20,324 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:56:20,328 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:56:20,331 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:56:20,358 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:56:20,358 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:56:20,359 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:56:20,360 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:56:20,362 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:56:20,363 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:56:20,377 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:56:20,378 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:56:20,382 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:56:20,385 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:56:20,397 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:56:20,398 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:56:20,398 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:56:20,400 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:56:20,402 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:56:20,406 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:56:20,436 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:56:20,446 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:56:20,446 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:56:20,462 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:56:20,474 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:20,495 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:37153 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:56:20,574 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:56:20,546 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:37153, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180497, versionId=1]. totalHandledRequests:1
2024-02-05T18:56:20,595 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:37153, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180548, versionId=2]. totalHandledRequests:1
2024-02-05T18:56:20,598 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:20,610 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 151
2024-02-05T18:56:20,631 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:56:20,643 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e79e3a362d] Subscribing to topic on cnx [id: 0x1805280b, L:/127.0.0.1:49378 - R:localhost/127.0.0.1:33147], consumerId 3
2024-02-05T18:56:20,645 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xa80ffff3, L:/127.0.0.1:33147 - R:/127.0.0.1:49378]] Subscribing on topic persistent://public/test/__change_events / reader-e79e3a362d. consumerId: 3
2024-02-05T18:56:20,662 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:56:20,665 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:56:20,667 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:37153, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152180657, versionId=3]. totalHandledRequests:1
2024-02-05T18:56:20,672 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:56:20,673 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:56:20,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:56:20,681 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:56:20,686 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:56:20,691 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:56:20,694 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:56:20,697 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:56:20,697 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:56:20,699 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:56:20,709 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:56:20,710 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:56:20,718 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:56:20,722 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 51.0 ms
2024-02-05T18:56:20,731 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:37153, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180670, versionId=4]. totalHandledRequests:1
2024-02-05T18:56:20,732 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:37153. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:56:20,733 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:49378][persistent://public/test/__change_events][reader-e79e3a362d] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:37153. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:56:20,735 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:56:20,736 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x1805280b, L:/127.0.0.1:49378 - R:localhost/127.0.0.1:33147] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:37153. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:56:20,736 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:56:20,737 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 117
2024-02-05T18:56:20,738 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-e79e3a362d] Failed to subscribe to topic on localhost/127.0.0.1:33147
2024-02-05T18:56:20,738 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:56:20,738 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-e79e3a362d] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:37153. Please redo the lookup. Request is denied: namespace=public/test","reqId":4131459958063800964, "remote":"localhost/127.0.0.1:33147", "local":"/127.0.0.1:49378"}
2024-02-05T18:56:20,738 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-e79e3a362d] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:37153. Please redo the lookup. Request is denied: namespace=public/test","reqId":4131459958063800964, "remote":"localhost/127.0.0.1:33147", "local":"/127.0.0.1:49378"} -- Will try again in 0.1 s
2024-02-05T18:56:20,740 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:56:20 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 306
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52974d7a], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3adebf70] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52974d7a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46f324e6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3adebf70, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@234a8822] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52974d7a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46f324e6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bdefdac], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3adebf70, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@234a8822, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b4fe98] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52974d7a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46f324e6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bdefdac, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bbf2efc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3adebf70, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@234a8822, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b4fe98, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c43b631] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@49142e1d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@123ddd90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52974d7a, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46f324e6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bdefdac, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bbf2efc, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@104c0d88], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22d4191, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a1be8e2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3adebf70, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@234a8822, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b4fe98, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2c43b631, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@332f6127] 
2024-02-05T18:56:20,840 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-e79e3a362d] Reconnecting after connection was closed
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:56:20,853 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:37153. Skipping this broker. Phase one
2024-02-05T18:56:20,853 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43479. Skipping this broker. Phase one
2024-02-05T18:56:20,853 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:43479 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:56:20,862 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:43479, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180853, versionId=5]. totalHandledRequests:8
2024-02-05T18:56:20,873 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:56:20,876 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43479, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180862, versionId=6]. totalHandledRequests:6
2024-02-05T18:56:20,879 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:56:20,881 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e79e3a362d] Subscribing to topic on cnx [id: 0x958b3a5a, L:/127.0.0.1:49118 - R:localhost/127.0.0.1:37741], consumerId 3
2024-02-05T18:56:20,883 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:56:20,883 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:56:20,884 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:56:20,885 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:56:20,885 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2de7a5d0, L:/127.0.0.1:37741 - R:/127.0.0.1:49118]] Subscribing on topic persistent://public/test/__change_events / reader-e79e3a362d. consumerId: 3
2024-02-05T18:56:20,886 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:56:20,887 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:56:20,888 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:56:20,892 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:56:20,899 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:56:20,900 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:56:20,910 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:56:20,915 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:56:20,915 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:56:20,916 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:56:20,917 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:56:20,920 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:56:20,921 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:56:20,921 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:56:20,921 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:56:20,926 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:56:20,927 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:56:20,929 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:56:20,930 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fc22c86644] Subscribing to topic on cnx [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741], consumerId 4
2024-02-05T18:56:20,931 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:56:20,932 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27b1e5fa, L:/127.0.0.1:37741 - R:/127.0.0.1:49102]] Subscribing on topic persistent://public/test/__change_events / reader-fc22c86644. consumerId: 4
2024-02-05T18:56:20,934 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-e79e3a362d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:20,934 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:56:20,935 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e79e3a362d, ackPos=13:-1, readPos=13:0}
2024-02-05T18:56:20,937 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49118] Created subscription on topic persistent://public/test/__change_events / reader-e79e3a362d
2024-02-05T18:56:20,937 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-e79e3a362d] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 3
2024-02-05T18:56:20,938 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:56:20,942 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:49118] Closing consumer: consumerId=3
2024-02-05T18:56:20,942 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-e79e3a362d}, consumerId=3, consumerName=8b58f, address=/127.0.0.1:49118}
2024-02-05T18:56:20,942 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-e79e3a362d] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e79e3a362d, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:56:20,944 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-e79e3a362d] Successfully closed dispatcher for reader
2024-02-05T18:56:20,944 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fc22c86644] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:56:20,944 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:56:20,944 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fc22c86644, ackPos=13:-1, readPos=13:0}
2024-02-05T18:56:20,946 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:49118] Closed consumer, consumerId=3
2024-02-05T18:56:20,947 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-e79e3a362d] Closed consumer
2024-02-05T18:56:20,949 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:56:20,949 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:49102] Created subscription on topic persistent://public/test/__change_events / reader-fc22c86644
2024-02-05T18:56:20,950 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fc22c86644] Subscribed to topic on localhost/127.0.0.1:37741 -- consumer: 4
2024-02-05T18:56:20,951 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:56:20,953 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:56:20,953 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:56:20,955 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37153
2024-02-05T18:56:20,957 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37153 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:56:20,966 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:37153 was invalidated. state Releasing
2024-02-05T18:56:20,968 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:37153 registry has been deleted.
2024-02-05T18:56:20,968 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:37153 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:56:20,969 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:37153. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:56:20,971 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:37153 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:56:20,971 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:37153
2024-02-05T18:56:20,971 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37153
2024-02-05T18:56:20,973 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37153 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:56:20,983 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:37153/0x00000000_0xffffffff.
2024-02-05T18:56:20,985 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:37153/0x00000000_0xffffffff.
2024-02-05T18:56:20,986 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:37153/0x00000000_0xffffffff.
2024-02-05T18:56:20,986 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.014 seconds
2024-02-05T18:56:20,987 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:56:20,992 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] Disconnected
2024-02-05T18:56:20,992 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:49378
2024-02-05T18:56:20,993 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:56:20,993 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x1805280b, L:/127.0.0.1:49378 ! R:localhost/127.0.0.1:33147] Disconnected
2024-02-05T18:56:20,993 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:49118
2024-02-05T18:56:20,994 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:37153/__change_events, name=reader-4b23292c3d}, consumerId=2, consumerName=f3690, address=/127.0.0.1:49378}
2024-02-05T18:56:20,994 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:37153/__change_events] [reader-4b23292c3d] Closed connection [id: 0x1805280b, L:/127.0.0.1:49378 ! R:localhost/127.0.0.1:33147] -- Will try again in 0.1 s
2024-02-05T18:56:20,994 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:37153/__change_events][reader-4b23292c3d] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37153/persistent/__change_events, cursor=reader-4b23292c3d, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:56:20,995 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:37153/__change_events][reader-4b23292c3d] Successfully closed dispatcher for reader
2024-02-05T18:56:20,995 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-a02cabd04f}, consumerId=0, consumerName=788d0, address=/127.0.0.1:49118}
2024-02-05T18:56:20,995 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a02cabd04f] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-a02cabd04f, ackPos=3:5, readPos=3:6}]
2024-02-05T18:56:20,995 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a02cabd04f] Successfully closed dispatcher for reader
2024-02-05T18:56:20,996 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-cdcfb04ab5}, consumerId=1, consumerName=b7fa9, address=/127.0.0.1:49118}
2024-02-05T18:56:20,998 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:20,998 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:20,998 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:20,999 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-a02cabd04f] Closed connection [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:20,999 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-cdcfb04ab5] Closed connection [id: 0x958b3a5a, L:/127.0.0.1:49118 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:21,000 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:37153/persistent/__change_events] Closing managed ledger
2024-02-05T18:56:21,006 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:37153/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:56:21,006 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:56:21,008 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:56:21,010 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:56:21,023 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33147
2024-02-05T18:56:21,024 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:56:21,026 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:56:21,026 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:56:21,027 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-cdcfb04ab5] Closed Consumer (not connected)
2024-02-05T18:56:21,028 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:37153/__change_events] [reader-4b23292c3d] Closed Consumer (not connected)
2024-02-05T18:56:21,028 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-cdcfb04ab5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-cdcfb04ab5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:21,028 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-a02cabd04f] Closed Consumer (not connected)
2024-02-05T18:56:21,029 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37153/__change_events with subscription name reader-4b23292c3d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37153/__change_events with subscription name reader-4b23292c3d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:21,030 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-a02cabd04f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-a02cabd04f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:21,036 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:56:21,036 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:56:21,041 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:56:21,041 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:21,050 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:56:21,050 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:21,105 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:56:21,106 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 48.05%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 48.05%, msgThroughputEMA= 0.00, updatedAt= 1707152181104, reportedAt= 0
2024-02-05T18:56:21,205 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:21,206 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:56:22,206 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:22,207 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:56:22,304 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:56:22,305 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:56:22,308 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:56:22,308 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:22,309 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:56:22,309 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:56:23,207 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:23,208 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:56:24,209 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:56:24,209 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:56:24,326 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:56:24,327 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:56:24,327 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:56:24,327 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:56:24,328 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:56:24,328 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:56:24,329 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:56:24,331 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:56:24,332 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:56:24,334 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:56:24,335 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:56:24,336 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:56:24,338 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:56:24,338 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:56:24,339 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:56:24,339 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43479
2024-02-05T18:56:24,341 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43479, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152180862, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:56:29,352 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43479 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:56:29,361 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:43479 was invalidated. state Releasing
2024-02-05T18:56:29,361 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:43479. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:56:29,362 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:43479
2024-02-05T18:56:29,367 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:43479/0x00000000_0xffffffff.
2024-02-05T18:56:29,376 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:43479, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152189369, versionId=7]. totalHandledRequests:10
2024-02-05T18:56:29,378 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:56:29,378 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:56:29,379 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:56:29,380 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fc22c86644}, consumerId=4, consumerName=5563c, address=/127.0.0.1:49102}
2024-02-05T18:56:29,381 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fc22c86644}, consumerId=4, consumerName=5563c, address=/127.0.0.1:49102}
2024-02-05T18:56:29,381 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fc22c86644] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fc22c86644, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:56:29,381 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:37741] Broker notification of Closed consumer: 4
2024-02-05T18:56:29,381 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fc22c86644] Successfully closed dispatcher for reader
2024-02-05T18:56:29,381 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-fc22c86644] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 - R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,382 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fc22c86644] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fc22c86644, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:56:29,382 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-fc22c86644] Successfully disconnected and closed subscription
2024-02-05T18:56:29,382 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:56:29,386 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:56:29,387 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:56:29,388 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-fc22c86644] Closed Consumer (not connected)
2024-02-05T18:56:29,389 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:56:29,389 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-fc22c86644 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-fc22c86644 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:29,396 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43479 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:43479, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152189376, versionId=8]. totalHandledRequests:4
2024-02-05T18:56:29,397 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:56:29,398 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:43479/0x00000000_0xffffffff.
2024-02-05T18:56:29,400 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:43479/0x00000000_0xffffffff.
2024-02-05T18:56:29,400 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.038 seconds
2024-02-05T18:56:29,400 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:56:29,401 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:49102
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] Disconnected
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-9e8732b802}, consumerId=0, consumerName=77f1b, address=/127.0.0.1:49102}
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9e8732b802] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9e8732b802, ackPos=3:5, readPos=3:8}]
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9e8732b802] Successfully closed dispatcher for reader
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9e8732b802] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73418f88ea] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,403 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:43479/__change_events] [reader-a4f608fecf] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,403 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-0b18e13939] Closed connection [id: 0x5efb68fd, L:/127.0.0.1:49102 ! R:localhost/127.0.0.1:37741] -- Will try again in 0.1 s
2024-02-05T18:56:29,403 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:43479/__change_events, name=reader-a4f608fecf}, consumerId=3, consumerName=49f3d, address=/127.0.0.1:49102}
2024-02-05T18:56:29,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:43479/__change_events][reader-a4f608fecf] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43479/persistent/__change_events, cursor=reader-a4f608fecf, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:56:29,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:43479/__change_events][reader-a4f608fecf] Successfully closed dispatcher for reader
2024-02-05T18:56:29,404 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-0b18e13939}, consumerId=2, consumerName=4b3e1, address=/127.0.0.1:49102}
2024-02-05T18:56:29,404 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-73418f88ea}, consumerId=1, consumerName=cb35a, address=/127.0.0.1:49102}
2024-02-05T18:56:29,405 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:56:29,406 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:56:29,406 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:43479/persistent/__change_events] Closing managed ledger
2024-02-05T18:56:29,411 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:56:29,411 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:43479/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:56:29,412 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:56:29,413 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:56:29,414 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:56:29,418 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37741
2024-02-05T18:56:29,418 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:56:29,419 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:56:29,419 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:56:29,419 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:43479/__change_events] [reader-a4f608fecf] Closed Consumer (not connected)
2024-02-05T18:56:29,419 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9e8732b802] Closed Consumer (not connected)
2024-02-05T18:56:29,420 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-0b18e13939] Closed Consumer (not connected)
2024-02-05T18:56:29,420 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-73418f88ea] Closed Consumer (not connected)
2024-02-05T18:56:29,420 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43479/__change_events with subscription name reader-a4f608fecf was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43479/__change_events with subscription name reader-a4f608fecf was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:29,420 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9e8732b802 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9e8732b802 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:29,421 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-0b18e13939 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-0b18e13939 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:29,421 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73418f88ea was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-73418f88ea was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:56:29,426 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:56:29,426 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:56:29,427 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:56:29,427 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:56:29,427 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:56:29,428 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:29,429 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:56:29,429 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:30,709 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:56:30,709 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:56:30,711 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:56:30,711 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:30,711 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:56:30,711 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:56:30,719 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:56:30,719 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:56:30,725 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:56:30,725 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:56:30,726 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:56:30,727 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:56:30,727 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:56:30,727 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:56:30,727 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:56:30,727 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@784df46e
2024-02-05T18:56:30,728 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:56:30,728 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:56:30,728 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.6 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  55.013 s
[INFO] Finished at: 2024-02-05T18:56:31+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 8 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:57:01,656 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:57:02,661 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:57:02,662 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:57:03,126 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:57:03,127 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:57:03,128 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:57:03,128 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:57:03,129 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:57:03,130 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:57:03,160 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:57:03,161 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:57:03,161 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:57:03,162 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:57:03,162 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:57:03,162 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:57:03,163 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:57:03,163 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:57:03,164 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:57:03,164 - INFO  - [main:Environment@98] - Client environment:os.memory.free=34MB
2024-02-05T18:57:03,165 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:57:03,165 - INFO  - [main:Environment@98] - Client environment:os.memory.total=130MB
2024-02-05T18:57:04,808 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:57:04,808 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:57:04,809 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:57:04,809 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:57:05,149 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:57:05,151 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:57:05,250 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:57:05,332 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:57:05,335 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:57:05,353 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:57:05,452 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:57:05,494 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:57:05,533 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:57:05,819 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:57:05,820 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:57:05,850 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:57:05,894 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43167, TLS: (none), listener: (none)
2024-02-05T18:57:06,230 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44213, TLS: OPENSSL, listener: (none)
2024-02-05T18:57:06,252 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:57:06,257 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:57:06,258 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:57:06,292 - INFO  - [main:Log@170] - Logging initialized @6982ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:57:07,233 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:57:07,273 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:57:07,274 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:57:07,276 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:57:08,094 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:57:09,276 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:57:10,554 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:57:10,935 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:57:11,061 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:57:11,215 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:57:11,220 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:57:11,222 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:57:11,245 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:45477}
2024-02-05T18:57:11,400 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:32855}
2024-02-05T18:57:11,401 - INFO  - [main:Server@415] - Started @12094ms
2024-02-05T18:57:11,401 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45477
2024-02-05T18:57:11,402 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:32855
2024-02-05T18:57:11,409 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:57:11,410 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:57:11,539 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45477
2024-02-05T18:57:11,559 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:57:11,562 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:45477 is changing the role from null to Leader
2024-02-05T18:57:11,566 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45477).
2024-02-05T18:57:11,824 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45477 
2024-02-05T18:57:12,261 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:57:12,297 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:12,410 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:57:12,414 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:57:12,425 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:57:12,428 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:57:12,477 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:57:12,510 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:57:12,539 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:57:12,604 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:57:12,624 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:57:12,635 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:57:12,638 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:57:12,658 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:57:12,671 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 545
2024-02-05T18:57:12,812 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]] Connected to server
2024-02-05T18:57:12,844 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:50398] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:57:12,906 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:12,913 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:12,961 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:57:12,993 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50398] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50398, producerName=test-0-0, producerId=0}
2024-02-05T18:57:13,003 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:13,005 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:57:13,069 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,070 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45a42aec27] Subscribing to topic on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167], consumerId 0
2024-02-05T18:57:13,081 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x540a33ea, L:/127.0.0.1:43167 - R:/127.0.0.1:50398]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-45a42aec27. consumerId: 0
2024-02-05T18:57:13,114 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45a42aec27] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:13,115 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:57:13,116 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-45a42aec27, ackPos=3:-1, readPos=3:0}
2024-02-05T18:57:13,142 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50398] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-45a42aec27
2024-02-05T18:57:13,148 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45a42aec27] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 0
2024-02-05T18:57:13,163 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:57:13,164 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:57:13,165 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:57:13,165 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:57:13,228 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,257 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:57:13,258 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:57:13,260 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:57:13,261 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 68
2024-02-05T18:57:13,272 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,281 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:57:13,282 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:57:13,285 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:57:13,288 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:57:13,305 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,307 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:13,314 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:57:13,327 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50398] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50398, producerName=test-0-1, producerId=1}
2024-02-05T18:57:13,332 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:13,346 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,348 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43ef590c07] Subscribing to topic on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167], consumerId 1
2024-02-05T18:57:13,350 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x540a33ea, L:/127.0.0.1:43167 - R:/127.0.0.1:50398]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-43ef590c07. consumerId: 1
2024-02-05T18:57:13,373 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43ef590c07] Created new subscription for 1
2024-02-05T18:57:13,374 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50398] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-43ef590c07
2024-02-05T18:57:13,375 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43ef590c07] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 1
2024-02-05T18:57:13,397 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,399 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:13,412 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:57:13,422 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50398] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50398, producerName=test-0-2, producerId=2}
2024-02-05T18:57:13,423 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:13,439 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:57:13,460 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:57:13,465 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:45477 started the ownership monitor.
2024-02-05T18:57:13,483 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:13,486 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e46ded954f] Subscribing to topic on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167], consumerId 2
2024-02-05T18:57:13,488 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x540a33ea, L:/127.0.0.1:43167 - R:/127.0.0.1:50398]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-e46ded954f. consumerId: 2
2024-02-05T18:57:13,503 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45477/__change_events
2024-02-05T18:57:13,505 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e46ded954f] Created new subscription for 2
2024-02-05T18:57:13,506 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50398] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-e46ded954f
2024-02-05T18:57:13,507 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e46ded954f] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 2
2024-02-05T18:57:13,508 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:45477 plays the leader now.
2024-02-05T18:57:13,515 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.30%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.30%, msgThroughputEMA= 0.00, updatedAt= 1707152233514, reportedAt= 0
2024-02-05T18:57:13,535 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:57:13,540 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:13,544 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 3.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:57:13,597 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45477/0x00000000_0xffffffff - localhost:45477.
2024-02-05T18:57:13,599 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45477
2024-02-05T18:57:13,599 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45477/0x00000000_0xffffffff
2024-02-05T18:57:13,600 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45477/0x00000000_0xffffffff - localhost:45477.
2024-02-05T18:57:13,600 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45477
2024-02-05T18:57:13,600 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45477/0x00000000_0xffffffff
2024-02-05T18:57:13,614 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45477/__change_events][reader-04ccc00c7f] Subscribing to topic on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167], consumerId 3
2024-02-05T18:57:13,616 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45477 doesn't exist.
2024-02-05T18:57:13,617 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x540a33ea, L:/127.0.0.1:43167 - R:/127.0.0.1:50398]] Subscribing on topic persistent://sla-monitor/test/localhost:45477/__change_events / reader-04ccc00c7f. consumerId: 3
2024-02-05T18:57:13,625 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45477/persistent/__change_events
2024-02-05T18:57:13,629 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45477/persistent/__change_events'
2024-02-05T18:57:13,638 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:57:13,639 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45477/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:57:13,648 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45477/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:57:13,655 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45477/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:57:13,659 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45477/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45477/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:57:13,661 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45477/__change_events - dedup is disabled
2024-02-05T18:57:13,671 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:57:13,680 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45477/__change_events][reader-04ccc00c7f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:13,681 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45477/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:57:13,681 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45477/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45477/persistent/__change_events, cursor=reader-04ccc00c7f, ackPos=7:-1, readPos=7:0}
2024-02-05T18:57:13,684 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50398] Created subscription on topic persistent://sla-monitor/test/localhost:45477/__change_events / reader-04ccc00c7f
2024-02-05T18:57:13,685 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45477/__change_events][reader-04ccc00c7f] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 3
2024-02-05T18:57:13,633 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 45477, tls-port = Optional[32855], broker url= pulsar://localhost:43167, broker tls url= pulsar+ssl://localhost:44213, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[43167], brokerServicePortTls=Optional[44213], webServicePort=Optional[45477], webServicePortTls=Optional[32855], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:57:14,245 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:57:14,245 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:57:14,245 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:57:14,246 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:57:14,252 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:57:14,252 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:57:14,258 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:57:14,263 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:57:14,271 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:57:14,272 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:57:14,280 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:57:14,283 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:57:14,286 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:57:14,295 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:57:14,296 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:57:14,305 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:57:14,312 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36635, TLS: (none), listener: (none)
2024-02-05T18:57:14,314 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43813, TLS: OPENSSL, listener: (none)
2024-02-05T18:57:14,318 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:57:14,319 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:57:14,323 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:57:14,340 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:57:14,344 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:57:14,344 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:57:14,345 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:57:14,433 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/,null,AVAILABLE}
2024-02-05T18:57:14,545 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:14,546 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:57:15,134 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/admin,null,AVAILABLE}
2024-02-05T18:57:15,547 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:15,547 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:57:16,314 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin/v2,null,AVAILABLE}
2024-02-05T18:57:16,548 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:16,549 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:57:16,579 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v3,null,AVAILABLE}
2024-02-05T18:57:16,675 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/lookup,null,AVAILABLE}
2024-02-05T18:57:16,791 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/topics,null,AVAILABLE}
2024-02-05T18:57:16,793 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/metrics,null,AVAILABLE}
2024-02-05T18:57:16,794 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7537f638{/static,null,AVAILABLE}
2024-02-05T18:57:16,796 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{HTTP/1.1, (http/1.1)}{0.0.0.0:45587}
2024-02-05T18:57:16,809 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3af4b14e{SSL, (ssl, http/1.1)}{0.0.0.0:45167}
2024-02-05T18:57:16,810 - INFO  - [main:Server@415] - Started @17503ms
2024-02-05T18:57:16,810 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45587
2024-02-05T18:57:16,812 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45167
2024-02-05T18:57:16,816 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:57:16,817 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:57:16,833 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45587
2024-02-05T18:57:16,833 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:45587 registry has been created.
2024-02-05T18:57:16,834 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:45587. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:57:16,838 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:45587 is changing the role from null to Follower
2024-02-05T18:57:16,842 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45477).
2024-02-05T18:57:16,848 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:57:16,865 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45587 
2024-02-05T18:57:16,978 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 50
2024-02-05T18:57:16,999 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,002 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:57:17,004 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:57:17,019 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 37
2024-02-05T18:57:17,022 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:45587/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:57:17,035 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xa042b0c4, L:/127.0.0.1:36176 - R:localhost/127.0.0.1:36635]] Connected to server
2024-02-05T18:57:17,044 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36176] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:57:17,063 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]] Connected to server
2024-02-05T18:57:17,070 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:50414] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:57:17,072 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,088 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50414] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50414, producerName=test-0-3, producerId=0}
2024-02-05T18:57:17,090 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,103 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-dc62f6e889] Subscribing to topic on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167], consumerId 0
2024-02-05T18:57:17,105 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x995696cb, L:/127.0.0.1:43167 - R:/127.0.0.1:50414]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-dc62f6e889. consumerId: 0
2024-02-05T18:57:17,111 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-dc62f6e889] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:17,111 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:57:17,111 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-dc62f6e889, ackPos=3:-1, readPos=3:0}
2024-02-05T18:57:17,115 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50414] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-dc62f6e889
2024-02-05T18:57:17,118 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-dc62f6e889] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 0
2024-02-05T18:57:17,121 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:57:17,121 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:57:17,151 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:57:17,158 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,161 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:57:17,162 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:57:17,167 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:57:17,167 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:45587/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:57:17,184 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:57:17,191 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,194 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:57:17,195 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:57:17,199 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:57:17,200 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:45587/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:57:17,221 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,230 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50414] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50414, producerName=test-0-4, producerId=1}
2024-02-05T18:57:17,232 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,246 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b01949884a] Subscribing to topic on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167], consumerId 1
2024-02-05T18:57:17,247 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x995696cb, L:/127.0.0.1:43167 - R:/127.0.0.1:50414]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b01949884a. consumerId: 1
2024-02-05T18:57:17,260 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b01949884a] Created new subscription for 1
2024-02-05T18:57:17,260 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50414] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b01949884a
2024-02-05T18:57:17,261 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b01949884a] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 1
2024-02-05T18:57:17,280 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,289 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50414] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50414, producerName=test-0-5, producerId=2}
2024-02-05T18:57:17,291 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x90ae9c50, L:/127.0.0.1:50414 - R:localhost/127.0.0.1:43167]
2024-02-05T18:57:17,293 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:57:17,297 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:57:17,298 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:45587 plays a follower now.
2024-02-05T18:57:17,334 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45587/__change_events
2024-02-05T18:57:17,380 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45587/0x00000000_0xffffffff - localhost:45587.
2024-02-05T18:57:17,386 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45587/__change_events][reader-1bfacfa9fb] Subscribing to topic on cnx [id: 0xa042b0c4, L:/127.0.0.1:36176 - R:localhost/127.0.0.1:36635], consumerId 2
2024-02-05T18:57:17,387 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45587/0x00000000_0xffffffff
2024-02-05T18:57:17,388 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45587
2024-02-05T18:57:17,388 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x820fbb0f, L:/127.0.0.1:36635 - R:/127.0.0.1:36176]] Subscribing on topic persistent://sla-monitor/test/localhost:45587/__change_events / reader-1bfacfa9fb. consumerId: 2
2024-02-05T18:57:17,389 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45587/0x00000000_0xffffffff - localhost:45587.
2024-02-05T18:57:17,390 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45587/0x00000000_0xffffffff
2024-02-05T18:57:17,394 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45587
2024-02-05T18:57:17,399 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45587 doesn't exist.
2024-02-05T18:57:17,399 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45587/persistent/__change_events
2024-02-05T18:57:17,402 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45587/persistent/__change_events'
2024-02-05T18:57:17,401 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 45587, tls-port = Optional[45167], broker url= pulsar://localhost:36635, broker tls url= pulsar+ssl://localhost:43813, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36635], brokerServicePortTls=Optional[43813], webServicePort=Optional[45587], webServicePortTls=Optional[45167], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:57:17,411 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:57:17,412 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45587/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:57:17,421 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45587/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:57:17,427 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45587/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:57:17,433 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45587/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45587/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:57:17,434 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45587/__change_events - dedup is disabled
2024-02-05T18:57:17,440 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:57:17,448 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45587/__change_events][reader-1bfacfa9fb] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:17,448 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45587/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:57:17,449 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45587/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45587/persistent/__change_events, cursor=reader-1bfacfa9fb, ackPos=9:-1, readPos=9:0}
2024-02-05T18:57:17,450 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36176] Created subscription on topic persistent://sla-monitor/test/localhost:45587/__change_events / reader-1bfacfa9fb
2024-02-05T18:57:17,452 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45587/__change_events][reader-1bfacfa9fb] Subscribed to topic on localhost/127.0.0.1:36635 -- consumer: 2
2024-02-05T18:57:17,553 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:57:17,554 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:57:17,622 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:57:17,624 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:57:17,652 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:57:17,653 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:57:17,678 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:57:17,681 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:57:17,687 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:57:17,688 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:57:17,718 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:57:17,718 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:57:17,718 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:57:17,719 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:57:17,720 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:57:17,722 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:57:17,732 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:57:17,732 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:57:17,737 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:57:17,738 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:57:17,752 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:57:17,752 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:57:17,752 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:57:17,753 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:57:17,753 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:57:17,761 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:57:17,792 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:57:17,804 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:57:17,804 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:57:17,822 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:57:17,832 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,850 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45477 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:57:17,900 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45477, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152237852, versionId=1]. totalHandledRequests:1
2024-02-05T18:57:17,930 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45477, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152237920, versionId=2]. totalHandledRequests:1
2024-02-05T18:57:17,934 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,958 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:57:17,965 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:57:17,966 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:57:17,988 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45477, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152237947, versionId=3]. totalHandledRequests:1
2024-02-05T18:57:17,996 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:17,999 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 9.0 ms
2024-02-05T18:57:18,011 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45477, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152237989, versionId=4]. totalHandledRequests:1
2024-02-05T18:57:18,012 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:57:18,013 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:57:18,015 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45477. Skipping this broker. Phase one
2024-02-05T18:57:18,015 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:57:18,015 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:45477. Skipping this broker. Phase two
2024-02-05T18:57:18,015 - INFO  - [ForkJoinPool.commonPool-worker-2:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45587 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:57:18,016 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 229
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:57:18,027 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:57:17 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 209
2024-02-05T18:57:18,028 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45587, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152238016, versionId=5]. totalHandledRequests:2
2024-02-05T18:57:18,039 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45587, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152238031, versionId=6]. totalHandledRequests:2
2024-02-05T18:57:18,042 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0xd5eda31c, L:/127.0.0.1:36182 - R:localhost/127.0.0.1:36635]] Connected to server
2024-02-05T18:57:18,047 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:57:18,097 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:36182] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:57:18,098 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-e581b28edc] Subscribing to topic on cnx [id: 0xd5eda31c, L:/127.0.0.1:36182 - R:localhost/127.0.0.1:36635], consumerId 4
2024-02-05T18:57:18,100 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0xbe24886c, L:/127.0.0.1:36635 - R:/127.0.0.1:36182]] Subscribing on topic persistent://public/test/__change_events / reader-e581b28edc. consumerId: 4
2024-02-05T18:57:18,114 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:57:18,117 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:57:18,123 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:57:18,124 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f9473e9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a810b6d] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4f552056, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f9473e9, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21e49afd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a810b6d, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17951464] 
2024-02-05T18:57:18,132 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:57:18,134 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-54e8837cb1] Subscribing to topic on cnx [id: 0xa042b0c4, L:/127.0.0.1:36176 - R:localhost/127.0.0.1:36635], consumerId 3
2024-02-05T18:57:18,136 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:57:18,136 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x820fbb0f, L:/127.0.0.1:36635 - R:/127.0.0.1:36176]] Subscribing on topic persistent://public/test/__change_events / reader-54e8837cb1. consumerId: 3
2024-02-05T18:57:18,137 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:57:18,139 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:57:18,147 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:57:18,154 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-54e8837cb1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:18,155 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:57:18,155 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-54e8837cb1, ackPos=11:-1, readPos=11:0}
2024-02-05T18:57:18,161 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36176] Created subscription on topic persistent://public/test/__change_events / reader-54e8837cb1
2024-02-05T18:57:18,162 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-54e8837cb1] Subscribed to topic on localhost/127.0.0.1:36635 -- consumer: 3
2024-02-05T18:57:18,178 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:57:18,182 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-e581b28edc] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:18,183 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:57:18,183 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e581b28edc, ackPos=11:-1, readPos=11:0}
2024-02-05T18:57:18,186 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36182] Created subscription on topic persistent://public/test/__change_events / reader-e581b28edc
2024-02-05T18:57:18,187 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-e581b28edc] Subscribed to topic on localhost/127.0.0.1:36635 -- consumer: 4
2024-02-05T18:57:18,189 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:57:18,191 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:36182] Closing consumer: consumerId=4
2024-02-05T18:57:18,192 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-e581b28edc}, consumerId=4, consumerName=416ff, address=/127.0.0.1:36182}
2024-02-05T18:57:18,193 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-e581b28edc] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-e581b28edc, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:57:18,194 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-e581b28edc] Successfully closed dispatcher for reader
2024-02-05T18:57:18,197 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3af4b14e{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:57:18,197 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:57:18,199 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7537f638{/static,null,STOPPED}
2024-02-05T18:57:18,200 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/metrics,null,STOPPED}
2024-02-05T18:57:18,202 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:36182] Closed consumer, consumerId=4
2024-02-05T18:57:18,203 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-e581b28edc] Closed consumer
2024-02-05T18:57:18,205 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:57:18,209 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/topics,null,STOPPED}
2024-02-05T18:57:18,211 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/lookup,null,STOPPED}
2024-02-05T18:57:18,214 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v3,null,STOPPED}
2024-02-05T18:57:18,217 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin/v2,null,STOPPED}
2024-02-05T18:57:18,219 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/admin,null,STOPPED}
2024-02-05T18:57:18,222 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/,null,STOPPED}
2024-02-05T18:57:18,225 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:57:18,227 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:57:18,227 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:57:18,229 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:18,233 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45477. Skipping this broker. Phase one
2024-02-05T18:57:18,234 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45587, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152238031, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45477, sourceBroker=localhost:45587, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152238234, versionId=7]
2024-02-05T18:57:18,243 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45477, sourceBroker=localhost:45587, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152238234, versionId=7]. totalHandledRequests:6
2024-02-05T18:57:18,244 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:45477 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:45477, sourceBroker=localhost:45587, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152238234, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:57:18,245 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:57:18,248 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:57:18,250 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-54e8837cb1}, consumerId=3, consumerName=ab946, address=/127.0.0.1:36176}
2024-02-05T18:57:18,251 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-54e8837cb1}, consumerId=3, consumerName=ab946, address=/127.0.0.1:36176}
2024-02-05T18:57:18,252 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:36635] Broker notification of Closed consumer: 3
2024-02-05T18:57:18,252 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-54e8837cb1] Closed connection [id: 0xa042b0c4, L:/127.0.0.1:36176 - R:localhost/127.0.0.1:36635] -- Will try again in 0.1 s
2024-02-05T18:57:18,252 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-54e8837cb1] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-54e8837cb1, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:57:18,252 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-54e8837cb1] Successfully closed dispatcher for reader
2024-02-05T18:57:18,254 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-54e8837cb1] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-54e8837cb1, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:57:18,256 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-54e8837cb1] Successfully disconnected and closed subscription
2024-02-05T18:57:18,257 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:57:18,258 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:57:18,259 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:57:18,267 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:57:18,275 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:57:18,280 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-54e8837cb1] Closed Consumer (not connected)
2024-02-05T18:57:18,282 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-54e8837cb1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-54e8837cb1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:18,283 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 36.0 ms
2024-02-05T18:57:18,298 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:57:18,301 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-7928b2c661] Subscribing to topic on cnx [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167], consumerId 5
2024-02-05T18:57:18,305 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x540a33ea, L:/127.0.0.1:43167 - R:/127.0.0.1:50398]] Subscribing on topic persistent://public/test/__change_events / reader-7928b2c661. consumerId: 5
2024-02-05T18:57:18,316 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:57:18,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:57:18,323 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:57:18,332 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:57:18,333 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:57:18,334 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:57:18,338 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:57:18,339 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:57:18,339 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:57:18,344 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:57:18,353 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-7928b2c661] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:57:18,353 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:57:18,353 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7928b2c661, ackPos=13:-1, readPos=13:0}
2024-02-05T18:57:18,354 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-54e8837cb1] Reconnecting after timeout
2024-02-05T18:57:18,354 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-54e8837cb1] Ignoring reconnection request (state: Closed)
2024-02-05T18:57:18,355 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50398] Created subscription on topic persistent://public/test/__change_events / reader-7928b2c661
2024-02-05T18:57:18,356 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-7928b2c661] Subscribed to topic on localhost/127.0.0.1:43167 -- consumer: 5
2024-02-05T18:57:18,456 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:57:18,457 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 42.97%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 42.97%, msgThroughputEMA= 0.00, updatedAt= 1707152238456, reportedAt= 0
2024-02-05T18:57:18,555 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:57:18,555 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:57:19,556 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:57:19,556 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:57:20,557 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:57:20,558 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:57:21,349 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 3117.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:57:21,354 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:45587 registry has been deleted.
2024-02-05T18:57:21,354 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:45587 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:57:21,357 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45587 was invalidated. state Releasing
2024-02-05T18:57:21,358 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:45587 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:57:21,359 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:21,359 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45587. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:57:21,360 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:57:21,360 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45587
2024-02-05T18:57:21,373 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45587/0x00000000_0xffffffff.
2024-02-05T18:57:21,375 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45587/0x00000000_0xffffffff.
2024-02-05T18:57:21,376 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45587/0x00000000_0xffffffff.
2024-02-05T18:57:21,377 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.016 seconds
2024-02-05T18:57:21,378 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:57:21,382 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36176
2024-02-05T18:57:21,383 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45587/__change_events, name=reader-1bfacfa9fb}, consumerId=2, consumerName=4037a, address=/127.0.0.1:36176}
2024-02-05T18:57:21,383 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:57:21,384 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45587/persistent/__change_events] Closing managed ledger
2024-02-05T18:57:21,385 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xa042b0c4, L:/127.0.0.1:36176 ! R:localhost/127.0.0.1:36635] Disconnected
2024-02-05T18:57:21,385 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45587/__change_events][reader-1bfacfa9fb] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45587/persistent/__change_events, cursor=reader-1bfacfa9fb, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:57:21,385 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45587/__change_events][reader-1bfacfa9fb] Successfully closed dispatcher for reader
2024-02-05T18:57:21,387 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45587/__change_events] [reader-1bfacfa9fb] Closed connection [id: 0xa042b0c4, L:/127.0.0.1:36176 ! R:localhost/127.0.0.1:36635] -- Will try again in 0.1 s
2024-02-05T18:57:21,387 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45587/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:57:21,389 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:57:21,390 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] Disconnected
2024-02-05T18:57:21,390 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:21,391 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:21,391 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:21,394 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-dc62f6e889] Closed connection [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:21,394 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b01949884a] Closed connection [id: 0x90ae9c50, L:/127.0.0.1:50414 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:21,393 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0xd5eda31c, L:/127.0.0.1:36182 ! R:localhost/127.0.0.1:36635] Disconnected
2024-02-05T18:57:21,393 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:50414
2024-02-05T18:57:21,392 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:57:21,397 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:57:21,396 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-dc62f6e889}, consumerId=0, consumerName=e4db2, address=/127.0.0.1:50414}
2024-02-05T18:57:21,403 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-dc62f6e889] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-dc62f6e889, ackPos=3:6, readPos=3:7}]
2024-02-05T18:57:21,403 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-dc62f6e889] Successfully closed dispatcher for reader
2024-02-05T18:57:21,408 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36635
2024-02-05T18:57:21,409 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:57:21,410 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-b01949884a}, consumerId=1, consumerName=c62e5, address=/127.0.0.1:50414}
2024-02-05T18:57:21,411 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:57:21,412 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:57:21,412 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-dc62f6e889] Closed Consumer (not connected)
2024-02-05T18:57:21,402 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:36182
2024-02-05T18:57:21,414 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-dc62f6e889 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-dc62f6e889 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:21,415 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b01949884a] Closed Consumer (not connected)
2024-02-05T18:57:21,416 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45587/__change_events] [reader-1bfacfa9fb] Closed Consumer (not connected)
2024-02-05T18:57:21,416 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b01949884a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b01949884a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:21,417 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45587/__change_events with subscription name reader-1bfacfa9fb was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45587/__change_events with subscription name reader-1bfacfa9fb was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:21,422 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:57:21,422 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:57:21,424 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:57:21,425 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:21,431 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:57:21,431 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:21,563 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:21,564 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:45587 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:57:21,564 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:45587 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:57:21,565 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:45587]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:57:21,565 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:21,566 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:57:22,565 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:22,566 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:45587 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:57:22,566 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:45587 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:57:22,567 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:45587]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:57:22,567 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:22,569 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:57:22,717 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:57:22,718 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:57:22,720 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:57:22,722 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:22,722 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:57:22,723 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:57:23,457 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 44.14%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.09%, msgThroughputEMA= 0.00, updatedAt= 1707152243455, reportedAt= 1707152238461
2024-02-05T18:57:23,567 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:23,568 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:45587 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:57:23,568 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:45587 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:57:23,568 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:45587]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:57:23,569 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:23,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:57:24,569 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:57:24,569 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:45587 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:57:24,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:45587 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:57:24,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:45587]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:57:24,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45587
2024-02-05T18:57:24,572 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45587 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:57:24,738 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:57:24,739 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:57:24,740 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:57:24,740 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:57:24,740 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:57:24,741 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:57:24,742 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:57:24,743 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:57:24,745 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:57:24,746 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:57:24,747 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:57:24,748 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:57:24,750 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:57:24,751 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:57:24,751 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:57:24,752 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45477
2024-02-05T18:57:24,754 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45477, sourceBroker=localhost:45587, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152238234, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:57:29,765 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45477 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:57:29,774 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45477 was invalidated. state Releasing
2024-02-05T18:57:29,774 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45477. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:57:29,774 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45477
2024-02-05T18:57:29,785 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45477, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152249778, versionId=8]. totalHandledRequests:10
2024-02-05T18:57:29,786 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:57:29,787 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:57:29,787 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:57:29,787 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7928b2c661}, consumerId=5, consumerName=9f875, address=/127.0.0.1:50398}
2024-02-05T18:57:29,787 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7928b2c661}, consumerId=5, consumerName=9f875, address=/127.0.0.1:50398}
2024-02-05T18:57:29,787 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7928b2c661] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7928b2c661, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:57:29,787 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:43167] Broker notification of Closed consumer: 5
2024-02-05T18:57:29,788 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-7928b2c661] Successfully closed dispatcher for reader
2024-02-05T18:57:29,788 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-7928b2c661] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 - R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,788 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7928b2c661] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7928b2c661, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:57:29,788 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-7928b2c661] Successfully disconnected and closed subscription
2024-02-05T18:57:29,788 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:57:29,794 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:57:29,795 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:57:29,796 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-7928b2c661] Closed Consumer (not connected)
2024-02-05T18:57:29,796 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T18:57:29,796 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7928b2c661 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7928b2c661 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:29,804 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45477 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45477, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152249785, versionId=9]. totalHandledRequests:4
2024-02-05T18:57:29,804 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:57:29,805 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45477/0x00000000_0xffffffff.
2024-02-05T18:57:29,806 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:57:29,806 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45477/0x00000000_0xffffffff.
2024-02-05T18:57:29,808 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45477/0x00000000_0xffffffff.
2024-02-05T18:57:29,808 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.033 seconds
2024-02-05T18:57:29,808 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:57:29,808 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:57:29,809 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:50398
2024-02-05T18:57:29,809 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:57:29,809 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:57:29,809 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-45a42aec27}, consumerId=0, consumerName=fd5b8, address=/127.0.0.1:50398}
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] Disconnected
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45a42aec27] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-45a42aec27, ackPos=3:6, readPos=3:9}]
2024-02-05T18:57:29,810 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45477/persistent/__change_events] Closing managed ledger
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45a42aec27] Successfully closed dispatcher for reader
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45a42aec27] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,810 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45477/__change_events, name=reader-04ccc00c7f}, consumerId=3, consumerName=ed43a, address=/127.0.0.1:50398}
2024-02-05T18:57:29,811 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-43ef590c07] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,811 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45477/__change_events] [reader-04ccc00c7f] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,811 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45477/__change_events][reader-04ccc00c7f] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45477/persistent/__change_events, cursor=reader-04ccc00c7f, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:57:29,811 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-e46ded954f] Closed connection [id: 0x663b1258, L:/127.0.0.1:50398 ! R:localhost/127.0.0.1:43167] -- Will try again in 0.1 s
2024-02-05T18:57:29,811 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45477/__change_events][reader-04ccc00c7f] Successfully closed dispatcher for reader
2024-02-05T18:57:29,812 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-e46ded954f}, consumerId=2, consumerName=4dbfa, address=/127.0.0.1:50398}
2024-02-05T18:57:29,812 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-43ef590c07}, consumerId=1, consumerName=b7509, address=/127.0.0.1:50398}
2024-02-05T18:57:29,814 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:57:29,814 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45477/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:57:29,814 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:57:29,815 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:57:29,816 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:57:29,819 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:43167
2024-02-05T18:57:29,820 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45477/__change_events] [reader-04ccc00c7f] Closed Consumer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-e46ded954f] Closed Consumer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45a42aec27] Closed Consumer (not connected)
2024-02-05T18:57:29,820 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-43ef590c07] Closed Consumer (not connected)
2024-02-05T18:57:29,820 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45477/__change_events with subscription name reader-04ccc00c7f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45477/__change_events with subscription name reader-04ccc00c7f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:29,821 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-e46ded954f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-e46ded954f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:29,822 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-45a42aec27 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-45a42aec27 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:29,822 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-43ef590c07 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-43ef590c07 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:57:29,824 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:57:29,825 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:57:29,825 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:57:29,825 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:57:29,825 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:57:29,825 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:29,826 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:57:29,826 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:31,214 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:57:31,215 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:57:31,217 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:57:31,217 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:31,217 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:57:31,217 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:57:31,226 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:57:31,226 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:57:31,230 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:57:31,230 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:57:31,230 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 192 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:57:31,231 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:57:31,231 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:57:31,232 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@465d9cce
2024-02-05T18:57:31,232 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:57:31,232 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:57:31,232 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.328 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  57.094 s
[INFO] Finished at: 2024-02-05T18:57:31+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 9 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:58:00,649 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:58:01,670 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:58:01,672 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:58:02,077 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:58:02,078 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:58:02,078 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:58:02,079 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:58:02,080 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:58:02,080 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:58:02,098 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:58:02,099 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:58:02,099 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:58:02,100 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:58:02,100 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:58:02,101 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:58:02,101 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:58:02,102 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:58:02,103 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:58:02,103 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:58:02,103 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:58:02,104 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:58:03,691 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:58:03,692 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:58:03,693 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:58:03,693 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:58:04,037 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:58:04,038 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:58:04,134 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:58:04,235 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:58:04,239 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:58:04,260 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:58:04,391 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:58:04,432 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:58:04,476 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:58:04,811 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:58:04,812 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:58:04,847 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:58:04,905 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:41481, TLS: (none), listener: (none)
2024-02-05T18:58:05,231 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34185, TLS: OPENSSL, listener: (none)
2024-02-05T18:58:05,251 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:58:05,256 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:58:05,257 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:58:05,286 - INFO  - [main:Log@170] - Logging initialized @6931ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:58:06,254 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:58:06,284 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:58:06,285 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:58:06,288 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:58:07,126 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:58:08,122 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:58:09,432 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:58:09,835 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:58:09,927 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:58:10,110 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:58:10,111 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:58:10,112 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:58:10,125 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:38075}
2024-02-05T18:58:10,268 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:39111}
2024-02-05T18:58:10,269 - INFO  - [main:Server@415] - Started @11916ms
2024-02-05T18:58:10,269 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38075
2024-02-05T18:58:10,270 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39111
2024-02-05T18:58:10,277 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:58:10,278 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:58:10,444 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38075
2024-02-05T18:58:10,459 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:58:10,463 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:38075 is changing the role from null to Leader
2024-02-05T18:58:10,465 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38075).
2024-02-05T18:58:10,722 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38075 
2024-02-05T18:58:11,156 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:58:11,184 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:11,303 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:58:11,309 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:58:11,318 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:58:11,323 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:58:11,370 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:58:11,402 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:58:11,439 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:58:11,515 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:58:11,540 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:58:11,551 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:58:11,554 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:58:11,583 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:58:11,597 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:11 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 558
2024-02-05T18:58:11,784 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]] Connected to server
2024-02-05T18:58:11,827 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:48878] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:58:11,888 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:11,895 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:11,965 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:58:11,994 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48878] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48878, producerName=test-0-0, producerId=0}
2024-02-05T18:58:12,002 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:12,004 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:58:12,059 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,060 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8686b50a9a] Subscribing to topic on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481], consumerId 0
2024-02-05T18:58:12,071 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9e7c9888, L:/127.0.0.1:41481 - R:/127.0.0.1:48878]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8686b50a9a. consumerId: 0
2024-02-05T18:58:12,109 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8686b50a9a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:12,110 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:58:12,110 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8686b50a9a, ackPos=3:-1, readPos=3:0}
2024-02-05T18:58:12,139 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:48878] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-8686b50a9a
2024-02-05T18:58:12,145 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8686b50a9a] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 0
2024-02-05T18:58:12,162 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.015 seconds
2024-02-05T18:58:12,163 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:58:12,165 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:58:12,165 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:58:12,206 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,229 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:58:12,231 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:58:12,233 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:58:12,234 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:58:12,246 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,257 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:58:12,259 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:58:12,261 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:58:12,261 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:58:12,282 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,284 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:12,294 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:58:12,301 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48878] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48878, producerName=test-0-1, producerId=1}
2024-02-05T18:58:12,302 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:12,319 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,320 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0b495f2bba] Subscribing to topic on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481], consumerId 1
2024-02-05T18:58:12,322 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9e7c9888, L:/127.0.0.1:41481 - R:/127.0.0.1:48878]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0b495f2bba. consumerId: 1
2024-02-05T18:58:12,346 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0b495f2bba] Created new subscription for 1
2024-02-05T18:58:12,348 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48878] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-0b495f2bba
2024-02-05T18:58:12,352 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-0b495f2bba] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 1
2024-02-05T18:58:12,371 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,372 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:12,379 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:58:12,385 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:48878] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48878, producerName=test-0-2, producerId=2}
2024-02-05T18:58:12,386 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:12,399 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:58:12,419 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:58:12,423 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:38075 started the ownership monitor.
2024-02-05T18:58:12,441 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:12,442 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29a34657a7] Subscribing to topic on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481], consumerId 2
2024-02-05T18:58:12,444 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9e7c9888, L:/127.0.0.1:41481 - R:/127.0.0.1:48878]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-29a34657a7. consumerId: 2
2024-02-05T18:58:12,455 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29a34657a7] Created new subscription for 2
2024-02-05T18:58:12,456 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48878] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-29a34657a7
2024-02-05T18:58:12,457 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29a34657a7] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 2
2024-02-05T18:58:12,457 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:38075 plays the leader now.
2024-02-05T18:58:12,461 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.52%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.52%, msgThroughputEMA= 0.00, updatedAt= 1707152292460, reportedAt= 0
2024-02-05T18:58:12,465 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38075/__change_events
2024-02-05T18:58:12,479 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:58:12,492 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:12,494 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:58:12,564 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38075/0x00000000_0xffffffff - localhost:38075.
2024-02-05T18:58:12,567 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38075
2024-02-05T18:58:12,567 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38075/0x00000000_0xffffffff
2024-02-05T18:58:12,568 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38075/0x00000000_0xffffffff - localhost:38075.
2024-02-05T18:58:12,569 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38075/0x00000000_0xffffffff
2024-02-05T18:58:12,571 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38075
2024-02-05T18:58:12,579 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38075/__change_events][reader-b76b0bffc4] Subscribing to topic on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481], consumerId 3
2024-02-05T18:58:12,581 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9e7c9888, L:/127.0.0.1:41481 - R:/127.0.0.1:48878]] Subscribing on topic persistent://sla-monitor/test/localhost:38075/__change_events / reader-b76b0bffc4. consumerId: 3
2024-02-05T18:58:12,587 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38075 doesn't exist.
2024-02-05T18:58:12,591 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38075/persistent/__change_events
2024-02-05T18:58:12,595 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38075/persistent/__change_events'
2024-02-05T18:58:12,600 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:58:12,601 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38075/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:58:12,608 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38075/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:58:12,614 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38075/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:58:12,619 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38075/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38075/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:58:12,621 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38075/__change_events - dedup is disabled
2024-02-05T18:58:12,636 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:58:12,649 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38075/__change_events][reader-b76b0bffc4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:12,650 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38075/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:58:12,651 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38075/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38075/persistent/__change_events, cursor=reader-b76b0bffc4, ackPos=7:-1, readPos=7:0}
2024-02-05T18:58:12,654 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:48878] Created subscription on topic persistent://sla-monitor/test/localhost:38075/__change_events / reader-b76b0bffc4
2024-02-05T18:58:12,658 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38075/__change_events][reader-b76b0bffc4] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 3
2024-02-05T18:58:12,605 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 38075, tls-port = Optional[39111], broker url= pulsar://localhost:41481, broker tls url= pulsar+ssl://localhost:34185, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[41481], brokerServicePortTls=Optional[34185], webServicePort=Optional[38075], webServicePortTls=Optional[39111], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:58:13,222 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:58:13,222 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:58:13,222 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:58:13,222 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:58:13,228 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:58:13,228 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:58:13,233 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:58:13,236 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:58:13,242 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:58:13,243 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:58:13,248 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:58:13,255 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:58:13,258 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:58:13,266 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:58:13,266 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:58:13,270 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:58:13,273 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:35157, TLS: (none), listener: (none)
2024-02-05T18:58:13,275 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:39463, TLS: OPENSSL, listener: (none)
2024-02-05T18:58:13,279 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:58:13,280 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:58:13,280 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:58:13,293 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:58:13,297 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:58:13,298 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:58:13,298 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:58:13,373 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6b909973{/,null,AVAILABLE}
2024-02-05T18:58:13,495 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:13,495 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:58:14,065 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/admin,null,AVAILABLE}
2024-02-05T18:58:14,496 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:14,497 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:58:15,227 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/admin/v2,null,AVAILABLE}
2024-02-05T18:58:15,422 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/admin/v3,null,AVAILABLE}
2024-02-05T18:58:15,476 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/lookup,null,AVAILABLE}
2024-02-05T18:58:15,498 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:15,498 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:58:15,549 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/topics,null,AVAILABLE}
2024-02-05T18:58:15,552 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4a842e8a{/metrics,null,AVAILABLE}
2024-02-05T18:58:15,553 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@458044df{/static,null,AVAILABLE}
2024-02-05T18:58:15,558 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@1de78f97{HTTP/1.1, (http/1.1)}{0.0.0.0:36423}
2024-02-05T18:58:15,579 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@1a4eb392{SSL, (ssl, http/1.1)}{0.0.0.0:37223}
2024-02-05T18:58:15,580 - INFO  - [main:Server@415] - Started @17227ms
2024-02-05T18:58:15,581 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36423
2024-02-05T18:58:15,583 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37223
2024-02-05T18:58:15,587 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:58:15,589 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:58:15,605 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36423
2024-02-05T18:58:15,607 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:36423 registry has been created.
2024-02-05T18:58:15,607 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:36423. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:58:15,610 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:36423 is changing the role from null to Follower
2024-02-05T18:58:15,615 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38075).
2024-02-05T18:58:15,620 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:58:15,637 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36423 
2024-02-05T18:58:15,752 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 58
2024-02-05T18:58:15,774 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:15,776 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:58:15,778 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:58:15,794 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 36
2024-02-05T18:58:15,797 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36423/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:58:15,812 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xfee7a9a8, L:/127.0.0.1:60698 - R:localhost/127.0.0.1:35157]] Connected to server
2024-02-05T18:58:15,819 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:60698] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:58:15,839 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]] Connected to server
2024-02-05T18:58:15,842 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:48884] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:58:15,843 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:15,855 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48884] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48884, producerName=test-0-3, producerId=0}
2024-02-05T18:58:15,856 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:15,869 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-248a8e5e75] Subscribing to topic on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481], consumerId 0
2024-02-05T18:58:15,871 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x716ddc28, L:/127.0.0.1:41481 - R:/127.0.0.1:48884]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-248a8e5e75. consumerId: 0
2024-02-05T18:58:15,876 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-248a8e5e75] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:15,877 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:58:15,877 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-248a8e5e75, ackPos=3:-1, readPos=3:0}
2024-02-05T18:58:15,879 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48884] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-248a8e5e75
2024-02-05T18:58:15,880 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-248a8e5e75] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 0
2024-02-05T18:58:15,883 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:58:15,884 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:58:15,912 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:58:15,919 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:15,922 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:58:15,922 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:58:15,927 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:58:15,927 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36423/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:58:15,942 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:58:15,948 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:15,951 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:58:15,951 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:58:15,955 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:15 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:58:15,956 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36423/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:58:15,972 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:15,980 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48884] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48884, producerName=test-0-4, producerId=1}
2024-02-05T18:58:15,981 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:15,994 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1a5d26fcfa] Subscribing to topic on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481], consumerId 1
2024-02-05T18:58:15,996 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x716ddc28, L:/127.0.0.1:41481 - R:/127.0.0.1:48884]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1a5d26fcfa. consumerId: 1
2024-02-05T18:58:16,009 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1a5d26fcfa] Created new subscription for 1
2024-02-05T18:58:16,010 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48884] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1a5d26fcfa
2024-02-05T18:58:16,011 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1a5d26fcfa] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 1
2024-02-05T18:58:16,032 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:16,042 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48884] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48884, producerName=test-0-5, producerId=2}
2024-02-05T18:58:16,043 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481]
2024-02-05T18:58:16,047 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:58:16,051 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:58:16,053 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:36423 plays a follower now.
2024-02-05T18:58:16,076 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36423/__change_events
2024-02-05T18:58:16,101 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36423/0x00000000_0xffffffff - localhost:36423.
2024-02-05T18:58:16,105 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36423/__change_events][reader-9fc2bb235f] Subscribing to topic on cnx [id: 0xfee7a9a8, L:/127.0.0.1:60698 - R:localhost/127.0.0.1:35157], consumerId 2
2024-02-05T18:58:16,107 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0x5c866a29, L:/127.0.0.1:35157 - R:/127.0.0.1:60698]] Subscribing on topic persistent://sla-monitor/test/localhost:36423/__change_events / reader-9fc2bb235f. consumerId: 2
2024-02-05T18:58:16,112 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36423/0x00000000_0xffffffff
2024-02-05T18:58:16,112 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36423
2024-02-05T18:58:16,116 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36423/persistent/__change_events
2024-02-05T18:58:16,114 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36423/0x00000000_0xffffffff - localhost:36423.
2024-02-05T18:58:16,118 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36423
2024-02-05T18:58:16,118 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36423/0x00000000_0xffffffff
2024-02-05T18:58:16,119 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36423/persistent/__change_events'
2024-02-05T18:58:16,120 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36423 doesn't exist.
2024-02-05T18:58:16,122 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 36423, tls-port = Optional[37223], broker url= pulsar://localhost:35157, broker tls url= pulsar+ssl://localhost:39463, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[35157], brokerServicePortTls=Optional[39463], webServicePort=Optional[36423], webServicePortTls=Optional[37223], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:58:16,129 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:58:16,130 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36423/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:58:16,145 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36423/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:58:16,150 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36423/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:58:16,156 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36423/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36423/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:58:16,157 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36423/__change_events - dedup is disabled
2024-02-05T18:58:16,168 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:58:16,176 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36423/__change_events][reader-9fc2bb235f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:16,176 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36423/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:58:16,176 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36423/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36423/persistent/__change_events, cursor=reader-9fc2bb235f, ackPos=9:-1, readPos=9:0}
2024-02-05T18:58:16,179 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:60698] Created subscription on topic persistent://sla-monitor/test/localhost:36423/__change_events / reader-9fc2bb235f
2024-02-05T18:58:16,181 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36423/__change_events][reader-9fc2bb235f] Subscribed to topic on localhost/127.0.0.1:35157 -- consumer: 2
2024-02-05T18:58:16,328 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:58:16,332 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:58:16,363 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:58:16,365 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:58:16,388 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:58:16,390 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:58:16,394 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:58:16,395 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:58:16,418 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:58:16,419 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:58:16,420 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:58:16,420 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:58:16,421 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:58:16,423 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:58:16,432 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:58:16,432 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:58:16,437 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:58:16,438 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:58:16,448 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:58:16,448 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:58:16,449 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:58:16,450 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T18:58:16,455 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:58:16,458 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:58:16,484 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:58:16,494 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:58:16,494 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:58:16,499 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:58:16,499 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:58:16,508 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:58:16,518 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:16,534 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36423 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:58:16,597 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:58:16,580 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36423, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296536, versionId=1]. totalHandledRequests:1
2024-02-05T18:58:16,602 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36423, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296580, versionId=2]. totalHandledRequests:1
2024-02-05T18:58:16,605 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:16,620 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 115
2024-02-05T18:58:16,639 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:58:16,669 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36423, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152296660, versionId=3]. totalHandledRequests:1
2024-02-05T18:58:16,674 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-6d7edc87a4] Subscribing to topic on cnx [id: 0xfee7a9a8, L:/127.0.0.1:60698 - R:localhost/127.0.0.1:35157], consumerId 3
2024-02-05T18:58:16,676 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0x5c866a29, L:/127.0.0.1:35157 - R:/127.0.0.1:60698]] Subscribing on topic persistent://public/test/__change_events / reader-6d7edc87a4. consumerId: 3
2024-02-05T18:58:16,679 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 6.0 ms
2024-02-05T18:58:16,689 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36423, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296673, versionId=4]. totalHandledRequests:1
2024-02-05T18:58:16,689 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36423. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:58:16,690 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:60698][persistent://public/test/__change_events][reader-6d7edc87a4] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36423. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:58:16,694 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xfee7a9a8, L:/127.0.0.1:60698 - R:localhost/127.0.0.1:35157] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36423. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:58:16,695 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:58:16,696 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:58:16,696 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-6d7edc87a4] Failed to subscribe to topic on localhost/127.0.0.1:35157
2024-02-05T18:58:16,696 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-6d7edc87a4] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36423. Please redo the lookup. Request is denied: namespace=public/test","reqId":2887998790855352441, "remote":"localhost/127.0.0.1:35157", "local":"/127.0.0.1:60698"}
2024-02-05T18:58:16,697 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-6d7edc87a4] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36423. Please redo the lookup. Request is denied: namespace=public/test","reqId":2887998790855352441, "remote":"localhost/127.0.0.1:35157", "local":"/127.0.0.1:60698"} -- Will try again in 0.1 s
2024-02-05T18:58:16,698 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:58:16,699 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 219
2024-02-05T18:58:16,700 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:58:16 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 70
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26681136], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@579d6bb6] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5af9b514, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7bc73ecd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@34a28e21, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a86f105, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f669c72, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@26681136, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cd3f83b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6389fe53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@23e4de5c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18f58580, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f15c237, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b8bdf9b, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@579d6bb6, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@9318b3d] 
2024-02-05T18:58:16,800 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-6d7edc87a4] Reconnecting after connection was closed
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:58:16,813 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36423. Skipping this broker. Phase one
2024-02-05T18:58:16,813 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38075. Skipping this broker. Phase one
2024-02-05T18:58:16,815 - INFO  - [pulsar-io-64-4:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38075 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:58:16,824 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38075, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296816, versionId=5]. totalHandledRequests:8
2024-02-05T18:58:16,837 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-6d7edc87a4] Subscribing to topic on cnx [id: 0x20b57fde, L:/127.0.0.1:48884 - R:localhost/127.0.0.1:41481], consumerId 3
2024-02-05T18:58:16,838 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x716ddc28, L:/127.0.0.1:41481 - R:/127.0.0.1:48884]] Subscribing on topic persistent://public/test/__change_events / reader-6d7edc87a4. consumerId: 3
2024-02-05T18:58:16,838 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38075, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296825, versionId=6]. totalHandledRequests:6
2024-02-05T18:58:16,841 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:58:16,843 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:58:16,845 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:58:16,847 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:58:16,848 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:58:16,849 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:58:16,853 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@1de78f97{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:58:16,853 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@1a4eb392{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:58:16,854 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:58:16,854 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:58:16,855 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:58:16,855 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@458044df{/static,null,STOPPED}
2024-02-05T18:58:16,856 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4a842e8a{/metrics,null,STOPPED}
2024-02-05T18:58:16,863 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:58:16,865 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/topics,null,STOPPED}
2024-02-05T18:58:16,868 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/lookup,null,STOPPED}
2024-02-05T18:58:16,868 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:58:16,875 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:58:16,878 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:58:16,886 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:58:16,887 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/admin/v3,null,STOPPED}
2024-02-05T18:58:16,891 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/admin/v2,null,STOPPED}
2024-02-05T18:58:16,895 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-6d7edc87a4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:16,896 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:58:16,896 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6d7edc87a4, ackPos=11:-1, readPos=11:0}
2024-02-05T18:58:16,901 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:58:16,903 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-31e0787a0f] Subscribing to topic on cnx [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481], consumerId 4
2024-02-05T18:58:16,905 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:48884] Created subscription on topic persistent://public/test/__change_events / reader-6d7edc87a4
2024-02-05T18:58:16,906 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-6d7edc87a4] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 3
2024-02-05T18:58:16,908 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x9e7c9888, L:/127.0.0.1:41481 - R:/127.0.0.1:48878]] Subscribing on topic persistent://public/test/__change_events / reader-31e0787a0f. consumerId: 4
2024-02-05T18:58:16,911 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:48884] Closing consumer: consumerId=3
2024-02-05T18:58:16,911 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-6d7edc87a4}, consumerId=3, consumerName=d3513, address=/127.0.0.1:48884}
2024-02-05T18:58:16,912 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-6d7edc87a4] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6d7edc87a4, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:58:16,913 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/admin,null,STOPPED}
2024-02-05T18:58:16,913 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-6d7edc87a4] Successfully closed dispatcher for reader
2024-02-05T18:58:16,915 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-31e0787a0f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:58:16,916 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:58:16,916 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-31e0787a0f, ackPos=11:-1, readPos=11:0}
2024-02-05T18:58:16,919 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48878] Created subscription on topic persistent://public/test/__change_events / reader-31e0787a0f
2024-02-05T18:58:16,920 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-31e0787a0f] Subscribed to topic on localhost/127.0.0.1:41481 -- consumer: 4
2024-02-05T18:58:16,924 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:48884] Closed consumer, consumerId=3
2024-02-05T18:58:16,924 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6b909973{/,null,STOPPED}
2024-02-05T18:58:16,925 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-6d7edc87a4] Closed consumer
2024-02-05T18:58:16,926 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:58:16,929 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:58:16,932 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:58:16,932 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:58:16,933 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36423
2024-02-05T18:58:16,935 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36423 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:58:16,941 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36423 was invalidated. state Releasing
2024-02-05T18:58:16,941 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:36423 registry has been deleted.
2024-02-05T18:58:16,942 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36423 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:58:16,943 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36423. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:58:16,944 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36423
2024-02-05T18:58:16,945 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36423 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:58:16,946 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36423
2024-02-05T18:58:16,951 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36423 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:58:16,958 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36423/0x00000000_0xffffffff.
2024-02-05T18:58:16,960 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36423/0x00000000_0xffffffff.
2024-02-05T18:58:16,961 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36423/0x00000000_0xffffffff.
2024-02-05T18:58:16,962 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:58:16,963 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:58:16,968 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] Disconnected
2024-02-05T18:58:16,968 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:58:16,970 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:48884
2024-02-05T18:58:16,970 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36423/persistent/__change_events] Closing managed ledger
2024-02-05T18:58:16,970 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xfee7a9a8, L:/127.0.0.1:60698 ! R:localhost/127.0.0.1:35157] Disconnected
2024-02-05T18:58:16,972 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:60698
2024-02-05T18:58:16,972 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36423/__change_events, name=reader-9fc2bb235f}, consumerId=2, consumerName=07286, address=/127.0.0.1:60698}
2024-02-05T18:58:16,973 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36423/__change_events][reader-9fc2bb235f] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36423/persistent/__change_events, cursor=reader-9fc2bb235f, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:58:16,973 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36423/__change_events][reader-9fc2bb235f] Successfully closed dispatcher for reader
2024-02-05T18:58:16,975 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:16,975 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36423/__change_events] [reader-9fc2bb235f] Closed connection [id: 0xfee7a9a8, L:/127.0.0.1:60698 ! R:localhost/127.0.0.1:35157] -- Will try again in 0.1 s
2024-02-05T18:58:16,976 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:16,976 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:16,976 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-248a8e5e75] Closed connection [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:16,976 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1a5d26fcfa] Closed connection [id: 0x20b57fde, L:/127.0.0.1:48884 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:16,979 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-248a8e5e75}, consumerId=0, consumerName=fb591, address=/127.0.0.1:48884}
2024-02-05T18:58:16,979 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-248a8e5e75] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-248a8e5e75, ackPos=3:5, readPos=3:6}]
2024-02-05T18:58:16,980 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36423/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:58:16,983 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:58:16,984 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-248a8e5e75] Successfully closed dispatcher for reader
2024-02-05T18:58:16,985 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-1a5d26fcfa}, consumerId=1, consumerName=d93e1, address=/127.0.0.1:48884}
2024-02-05T18:58:16,986 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:58:16,988 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:58:16,996 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:35157
2024-02-05T18:58:16,997 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:58:16,999 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:58:16,999 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:58:17,000 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1a5d26fcfa] Closed Consumer (not connected)
2024-02-05T18:58:17,001 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1a5d26fcfa was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1a5d26fcfa was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:17,003 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-248a8e5e75] Closed Consumer (not connected)
2024-02-05T18:58:17,004 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-248a8e5e75 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-248a8e5e75 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:17,005 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36423/__change_events] [reader-9fc2bb235f] Closed Consumer (not connected)
2024-02-05T18:58:17,005 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36423/__change_events with subscription name reader-9fc2bb235f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36423/__change_events with subscription name reader-9fc2bb235f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:17,014 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:58:17,014 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:58:17,018 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:58:17,019 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:17,029 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:58:17,029 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:17,416 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:58:17,416 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 44.53%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.53%, msgThroughputEMA= 0.00, updatedAt= 1707152297416, reportedAt= 0
2024-02-05T18:58:17,503 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:17,503 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:58:18,288 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:58:18,289 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:58:18,291 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:58:18,292 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:18,292 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:58:18,292 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:58:18,504 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:18,504 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:58:19,505 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:58:19,505 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:58:20,312 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:58:20,314 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:58:20,314 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:58:20,314 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:58:20,315 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:58:20,315 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:58:20,317 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:58:20,318 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:58:20,320 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:58:20,323 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:58:20,325 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:58:20,327 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:58:20,328 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:58:20,330 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:58:20,330 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:58:20,331 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38075
2024-02-05T18:58:20,334 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38075, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152296825, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:58:25,346 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38075 in 5012.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:58:25,354 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38075 was invalidated. state Releasing
2024-02-05T18:58:25,354 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38075. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:58:25,354 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38075
2024-02-05T18:58:25,367 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38075, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152305360, versionId=7]. totalHandledRequests:10
2024-02-05T18:58:25,368 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:58:25,370 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:58:25,371 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:58:25,372 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-31e0787a0f}, consumerId=4, consumerName=cfa88, address=/127.0.0.1:48878}
2024-02-05T18:58:25,372 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-31e0787a0f}, consumerId=4, consumerName=cfa88, address=/127.0.0.1:48878}
2024-02-05T18:58:25,372 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-31e0787a0f] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-31e0787a0f, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:58:25,372 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:41481] Broker notification of Closed consumer: 4
2024-02-05T18:58:25,373 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-31e0787a0f] Successfully closed dispatcher for reader
2024-02-05T18:58:25,373 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-31e0787a0f] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 - R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,373 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-31e0787a0f] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-31e0787a0f, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:58:25,374 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-31e0787a0f] Successfully disconnected and closed subscription
2024-02-05T18:58:25,375 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:58:25,379 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:58:25,384 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:58:25,385 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-31e0787a0f] Closed Consumer (not connected)
2024-02-05T18:58:25,385 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 17.0 ms
2024-02-05T18:58:25,385 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-31e0787a0f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-31e0787a0f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:25,393 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38075 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38075, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152305367, versionId=8]. totalHandledRequests:4
2024-02-05T18:58:25,394 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:58:25,395 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38075/0x00000000_0xffffffff.
2024-02-05T18:58:25,397 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38075/0x00000000_0xffffffff.
2024-02-05T18:58:25,399 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38075/0x00000000_0xffffffff.
2024-02-05T18:58:25,400 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.044 seconds
2024-02-05T18:58:25,400 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:58:25,401 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:48878
2024-02-05T18:58:25,401 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] Disconnected
2024-02-05T18:58:25,401 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,401 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-8686b50a9a}, consumerId=0, consumerName=e56ca, address=/127.0.0.1:48878}
2024-02-05T18:58:25,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8686b50a9a] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0b495f2bba] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,402 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8686b50a9a] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-8686b50a9a, ackPos=3:6, readPos=3:8}]
2024-02-05T18:58:25,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-8686b50a9a] Successfully closed dispatcher for reader
2024-02-05T18:58:25,403 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38075/__change_events] [reader-b76b0bffc4] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,403 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-29a34657a7] Closed connection [id: 0x7a9ce5b1, L:/127.0.0.1:48878 ! R:localhost/127.0.0.1:41481] -- Will try again in 0.1 s
2024-02-05T18:58:25,403 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38075/__change_events, name=reader-b76b0bffc4}, consumerId=3, consumerName=1da9c, address=/127.0.0.1:48878}
2024-02-05T18:58:25,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38075/__change_events][reader-b76b0bffc4] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38075/persistent/__change_events, cursor=reader-b76b0bffc4, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:58:25,404 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38075/__change_events][reader-b76b0bffc4] Successfully closed dispatcher for reader
2024-02-05T18:58:25,404 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-29a34657a7}, consumerId=2, consumerName=52bb0, address=/127.0.0.1:48878}
2024-02-05T18:58:25,404 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-0b495f2bba}, consumerId=1, consumerName=607a6, address=/127.0.0.1:48878}
2024-02-05T18:58:25,405 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:58:25,405 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:58:25,406 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38075/persistent/__change_events] Closing managed ledger
2024-02-05T18:58:25,409 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38075/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:58:25,409 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:58:25,409 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:58:25,411 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:58:25,411 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:58:25,415 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:41481
2024-02-05T18:58:25,416 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:58:25,416 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:58:25,416 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:58:25,417 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38075/__change_events] [reader-b76b0bffc4] Closed Consumer (not connected)
2024-02-05T18:58:25,417 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-8686b50a9a] Closed Consumer (not connected)
2024-02-05T18:58:25,417 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-29a34657a7] Closed Consumer (not connected)
2024-02-05T18:58:25,417 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38075/__change_events with subscription name reader-b76b0bffc4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38075/__change_events with subscription name reader-b76b0bffc4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:25,417 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-0b495f2bba] Closed Consumer (not connected)
2024-02-05T18:58:25,418 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8686b50a9a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-8686b50a9a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:25,418 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-29a34657a7 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-29a34657a7 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:25,419 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0b495f2bba was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-0b495f2bba was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:58:25,422 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:58:25,423 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:58:25,423 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:58:25,423 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:58:25,423 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:58:25,424 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:25,425 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:58:25,425 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:26,807 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:58:26,807 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:58:26,808 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:58:26,809 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:26,809 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:58:26,809 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:58:26,816 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:58:26,817 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:58:26,821 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:58:26,822 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:58:26,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:58:26,823 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:58:26,823 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:58:26,823 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:58:26,823 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@155c2a47
2024-02-05T18:58:26,824 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:58:26,824 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:58:26,824 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.006 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  52.344 s
[INFO] Finished at: 2024-02-05T18:58:27+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 10 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:58:57,205 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:58:58,180 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:58:58,182 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:58:58,667 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:58:58,668 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:58:58,669 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:58:58,670 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:58:58,670 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:58:58,671 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:58:58,703 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:58:58,703 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:58:58,704 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:58:58,705 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:58:58,705 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:58:58,706 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:58:58,706 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:58:58,707 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:58:58,707 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:58:58,708 - INFO  - [main:Environment@98] - Client environment:os.memory.free=20MB
2024-02-05T18:58:58,708 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:58:58,709 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:59:00,385 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:59:00,385 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:59:00,386 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:59:00,386 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:59:00,695 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:59:00,696 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:59:00,776 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:59:00,856 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:59:00,858 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:59:00,875 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:59:00,986 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:59:01,026 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:59:01,072 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:59:01,452 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:59:01,453 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:59:01,487 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:59:01,542 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38709, TLS: (none), listener: (none)
2024-02-05T18:59:01,832 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45979, TLS: OPENSSL, listener: (none)
2024-02-05T18:59:01,853 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:59:01,857 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:01,857 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:01,883 - INFO  - [main:Log@170] - Logging initialized @6969ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:59:02,788 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:59:02,817 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:59:02,817 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:59:02,819 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:59:03,554 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:59:04,794 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:59:05,877 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:59:06,321 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:59:06,446 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:59:06,615 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:59:06,616 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:59:06,618 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:59:06,633 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:38993}
2024-02-05T18:59:06,772 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:41857}
2024-02-05T18:59:06,773 - INFO  - [main:Server@415] - Started @11860ms
2024-02-05T18:59:06,773 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38993
2024-02-05T18:59:06,774 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:41857
2024-02-05T18:59:06,781 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:59:06,782 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:59:06,920 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38993
2024-02-05T18:59:06,935 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:59:06,938 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:38993 is changing the role from null to Leader
2024-02-05T18:59:06,941 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38993).
2024-02-05T18:59:07,238 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38993 
2024-02-05T18:59:07,687 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:59:07,719 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:07,833 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:59:07,840 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:59:07,849 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:59:07,855 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:59:07,890 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:59:07,923 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:59:07,951 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:59:08,025 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:59:08,046 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:59:08,059 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:59:08,063 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:59:08,098 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:59:08,108 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:07 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 564
2024-02-05T18:59:08,260 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]] Connected to server
2024-02-05T18:59:08,300 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:56934] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:59:08,372 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,381 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,454 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:59:08,496 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56934] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:56934, producerName=test-0-0, producerId=0}
2024-02-05T18:59:08,506 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,508 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:59:08,595 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,597 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6fc9e0c174] Subscribing to topic on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709], consumerId 0
2024-02-05T18:59:08,610 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4caf22b, L:/127.0.0.1:38709 - R:/127.0.0.1:56934]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6fc9e0c174. consumerId: 0
2024-02-05T18:59:08,650 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6fc9e0c174] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:08,652 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:59:08,652 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6fc9e0c174, ackPos=3:-1, readPos=3:0}
2024-02-05T18:59:08,669 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56934] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6fc9e0c174
2024-02-05T18:59:08,673 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6fc9e0c174] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 0
2024-02-05T18:59:08,684 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.01 seconds
2024-02-05T18:59:08,685 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:59:08,686 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:59:08,687 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:59:08,731 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,748 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:59:08,749 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:59:08,751 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 52
2024-02-05T18:59:08,751 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:59:08,764 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,773 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:59:08,774 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:59:08,776 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:59:08,776 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:59:08,793 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,795 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,806 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:59:08,812 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56934] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:56934, producerName=test-0-1, producerId=1}
2024-02-05T18:59:08,814 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,825 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,827 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cca5f43945] Subscribing to topic on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709], consumerId 1
2024-02-05T18:59:08,831 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4caf22b, L:/127.0.0.1:38709 - R:/127.0.0.1:56934]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-cca5f43945. consumerId: 1
2024-02-05T18:59:08,855 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cca5f43945] Created new subscription for 1
2024-02-05T18:59:08,856 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56934] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-cca5f43945
2024-02-05T18:59:08,858 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-cca5f43945] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 1
2024-02-05T18:59:08,877 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,879 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,885 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:59:08,893 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56934] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:56934, producerName=test-0-2, producerId=2}
2024-02-05T18:59:08,895 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:08,909 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:59:08,933 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:59:08,939 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:38993 started the ownership monitor.
2024-02-05T18:59:08,957 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:08,959 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-ad9b484a0c] Subscribing to topic on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709], consumerId 2
2024-02-05T18:59:08,961 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4caf22b, L:/127.0.0.1:38709 - R:/127.0.0.1:56934]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-ad9b484a0c. consumerId: 2
2024-02-05T18:59:08,974 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38993/__change_events
2024-02-05T18:59:08,974 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-ad9b484a0c] Created new subscription for 2
2024-02-05T18:59:08,974 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56934] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-ad9b484a0c
2024-02-05T18:59:08,975 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-ad9b484a0c] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 2
2024-02-05T18:59:08,976 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:38993 plays the leader now.
2024-02-05T18:59:08,981 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.88%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.88%, msgThroughputEMA= 0.00, updatedAt= 1707152348980, reportedAt= 0
2024-02-05T18:59:09,013 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:59:09,021 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:09,023 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:59:09,078 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38993/0x00000000_0xffffffff - localhost:38993.
2024-02-05T18:59:09,081 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38993
2024-02-05T18:59:09,082 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38993/0x00000000_0xffffffff - localhost:38993.
2024-02-05T18:59:09,082 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38993/0x00000000_0xffffffff
2024-02-05T18:59:09,082 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38993/0x00000000_0xffffffff
2024-02-05T18:59:09,086 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38993
2024-02-05T18:59:09,091 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38993/__change_events][reader-f484410fcd] Subscribing to topic on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709], consumerId 3
2024-02-05T18:59:09,094 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4caf22b, L:/127.0.0.1:38709 - R:/127.0.0.1:56934]] Subscribing on topic persistent://sla-monitor/test/localhost:38993/__change_events / reader-f484410fcd. consumerId: 3
2024-02-05T18:59:09,099 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38993 doesn't exist.
2024-02-05T18:59:09,103 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38993/persistent/__change_events
2024-02-05T18:59:09,105 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38993/persistent/__change_events'
2024-02-05T18:59:09,111 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:59:09,112 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38993/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:59:09,120 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38993/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:59:09,128 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38993/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:59:09,133 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38993/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38993/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:59:09,134 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38993/__change_events - dedup is disabled
2024-02-05T18:59:09,145 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:59:09,152 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38993/__change_events][reader-f484410fcd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:09,152 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38993/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:59:09,152 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38993/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38993/persistent/__change_events, cursor=reader-f484410fcd, ackPos=7:-1, readPos=7:0}
2024-02-05T18:59:09,154 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:56934] Created subscription on topic persistent://sla-monitor/test/localhost:38993/__change_events / reader-f484410fcd
2024-02-05T18:59:09,156 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38993/__change_events][reader-f484410fcd] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 3
2024-02-05T18:59:09,129 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 38993, tls-port = Optional[41857], broker url= pulsar://localhost:38709, broker tls url= pulsar+ssl://localhost:45979, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[38709], brokerServicePortTls=Optional[45979], webServicePort=Optional[38993], webServicePortTls=Optional[41857], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:59:09,838 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:59:09,839 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:59:09,839 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:59:09,839 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:59:09,845 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:59:09,845 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:59:09,853 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:59:09,858 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:59:09,865 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:59:09,866 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:59:09,873 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:59:09,880 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:59:09,884 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:59:09,893 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:59:09,893 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:59:09,900 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:59:09,903 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36141, TLS: (none), listener: (none)
2024-02-05T18:59:09,905 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43207, TLS: OPENSSL, listener: (none)
2024-02-05T18:59:09,909 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:59:09,910 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:09,911 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:09,927 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:59:09,931 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:59:09,931 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:59:09,931 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:59:10,011 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/,null,AVAILABLE}
2024-02-05T18:59:10,024 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:10,024 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:59:10,620 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/admin,null,AVAILABLE}
2024-02-05T18:59:11,025 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:11,025 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:59:11,745 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/admin/v2,null,AVAILABLE}
2024-02-05T18:59:11,964 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v3,null,AVAILABLE}
2024-02-05T18:59:12,026 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:12,027 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:59:12,042 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/lookup,null,AVAILABLE}
2024-02-05T18:59:12,131 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/topics,null,AVAILABLE}
2024-02-05T18:59:12,133 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/metrics,null,AVAILABLE}
2024-02-05T18:59:12,135 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@4a842e8a{/static,null,AVAILABLE}
2024-02-05T18:59:12,139 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{HTTP/1.1, (http/1.1)}{0.0.0.0:42387}
2024-02-05T18:59:12,166 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@1de78f97{SSL, (ssl, http/1.1)}{0.0.0.0:43695}
2024-02-05T18:59:12,170 - INFO  - [main:Server@415] - Started @17255ms
2024-02-05T18:59:12,171 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42387
2024-02-05T18:59:12,173 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43695
2024-02-05T18:59:12,177 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:59:12,177 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:59:12,194 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42387
2024-02-05T18:59:12,195 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42387 registry has been created.
2024-02-05T18:59:12,196 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42387. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:59:12,200 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42387 is changing the role from null to Follower
2024-02-05T18:59:12,204 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:38993).
2024-02-05T18:59:12,206 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:59:12,222 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42387 
2024-02-05T18:59:12,345 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:59:12,365 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:12,367 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:59:12,369 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:59:12,382 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:59:12,386 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42387/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:59:12,399 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xf3184c69, L:/127.0.0.1:40418 - R:localhost/127.0.0.1:36141]] Connected to server
2024-02-05T18:59:12,405 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:40418] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:59:12,420 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]] Connected to server
2024-02-05T18:59:12,425 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:47010] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:59:12,426 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,438 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:47010] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:47010, producerName=test-0-3, producerId=0}
2024-02-05T18:59:12,440 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,454 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-60e310ea4a] Subscribing to topic on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709], consumerId 0
2024-02-05T18:59:12,456 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x98a731ee, L:/127.0.0.1:38709 - R:/127.0.0.1:47010]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-60e310ea4a. consumerId: 0
2024-02-05T18:59:12,461 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-60e310ea4a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:12,462 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:59:12,462 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-60e310ea4a, ackPos=3:-1, readPos=3:0}
2024-02-05T18:59:12,464 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:47010] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-60e310ea4a
2024-02-05T18:59:12,465 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-60e310ea4a] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 0
2024-02-05T18:59:12,468 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:59:12,469 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:59:12,496 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:59:12,504 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:12,507 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:59:12,508 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:59:12,512 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:59:12,513 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42387/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:59:12,527 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:59:12,534 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:12,537 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:59:12,538 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:59:12,542 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42387/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:59:12,543 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:59:12,559 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,567 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:47010] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:47010, producerName=test-0-4, producerId=1}
2024-02-05T18:59:12,568 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,581 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-12b6b77108] Subscribing to topic on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709], consumerId 1
2024-02-05T18:59:12,582 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x98a731ee, L:/127.0.0.1:38709 - R:/127.0.0.1:47010]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-12b6b77108. consumerId: 1
2024-02-05T18:59:12,593 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-12b6b77108] Created new subscription for 1
2024-02-05T18:59:12,594 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:47010] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-12b6b77108
2024-02-05T18:59:12,595 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-12b6b77108] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 1
2024-02-05T18:59:12,612 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,620 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:47010] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:47010, producerName=test-0-5, producerId=2}
2024-02-05T18:59:12,621 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709]
2024-02-05T18:59:12,624 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:59:12,628 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:59:12,630 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42387 plays a follower now.
2024-02-05T18:59:12,652 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42387/__change_events
2024-02-05T18:59:12,675 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42387/0x00000000_0xffffffff - localhost:42387.
2024-02-05T18:59:12,677 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42387
2024-02-05T18:59:12,677 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42387/0x00000000_0xffffffff
2024-02-05T18:59:12,678 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42387/0x00000000_0xffffffff - localhost:42387.
2024-02-05T18:59:12,680 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42387/0x00000000_0xffffffff
2024-02-05T18:59:12,682 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42387/__change_events][reader-60aa724485] Subscribing to topic on cnx [id: 0xf3184c69, L:/127.0.0.1:40418 - R:localhost/127.0.0.1:36141], consumerId 2
2024-02-05T18:59:12,684 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42387
2024-02-05T18:59:12,684 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xc2163cff, L:/127.0.0.1:36141 - R:/127.0.0.1:40418]] Subscribing on topic persistent://sla-monitor/test/localhost:42387/__change_events / reader-60aa724485. consumerId: 2
2024-02-05T18:59:12,686 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42387 doesn't exist.
2024-02-05T18:59:12,688 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 42387, tls-port = Optional[43695], broker url= pulsar://localhost:36141, broker tls url= pulsar+ssl://localhost:43207, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36141], brokerServicePortTls=Optional[43207], webServicePort=Optional[42387], webServicePortTls=Optional[43695], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:59:12,690 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42387/persistent/__change_events
2024-02-05T18:59:12,693 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42387/persistent/__change_events'
2024-02-05T18:59:12,704 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:59:12,706 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42387/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:59:12,713 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42387/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:59:12,718 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42387/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:59:12,727 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42387/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42387/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:59:12,729 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42387/__change_events - dedup is disabled
2024-02-05T18:59:12,738 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:59:12,745 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42387/__change_events][reader-60aa724485] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:12,745 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42387/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:59:12,746 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42387/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42387/persistent/__change_events, cursor=reader-60aa724485, ackPos=9:-1, readPos=9:0}
2024-02-05T18:59:12,748 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:40418] Created subscription on topic persistent://sla-monitor/test/localhost:42387/__change_events / reader-60aa724485
2024-02-05T18:59:12,750 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42387/__change_events][reader-60aa724485] Subscribed to topic on localhost/127.0.0.1:36141 -- consumer: 2
2024-02-05T18:59:12,886 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:59:12,889 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:59:12,916 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:59:12,917 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:59:12,946 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:59:12,946 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:59:12,951 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:59:12,953 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:59:12,977 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:59:12,977 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:59:12,978 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:59:12,980 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:59:12,982 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:59:12,982 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:59:12,996 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:59:12,996 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:59:13,001 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:59:13,002 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:12 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:59:13,016 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:59:13,016 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:59:13,017 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:59:13,017 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:59:13,019 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:13 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:59:13,022 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:59:13,030 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:59:13,031 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:59:13,060 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:59:13,070 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:59:13,070 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:59:13,084 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:59:13,095 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:13,114 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42387 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:59:13,184 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:59:13,164 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42387, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353116, versionId=1]. totalHandledRequests:1
2024-02-05T18:59:13,210 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42387, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353167, versionId=2]. totalHandledRequests:1
2024-02-05T18:59:13,213 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:13,237 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-24d3efac25] Subscribing to topic on cnx [id: 0xf3184c69, L:/127.0.0.1:40418 - R:localhost/127.0.0.1:36141], consumerId 3
2024-02-05T18:59:13,239 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xc2163cff, L:/127.0.0.1:36141 - R:/127.0.0.1:40418]] Subscribing on topic persistent://public/test/__change_events / reader-24d3efac25. consumerId: 3
2024-02-05T18:59:13,244 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:13 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 163
2024-02-05T18:59:13,251 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:59:13,253 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:59:13,256 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:59:13,261 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:59:13,262 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:59:13,268 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:59:13,273 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:59:13,274 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:59:13,277 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:59:13,287 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:59:13,294 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:42387, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152353283, versionId=3]. totalHandledRequests:1
2024-02-05T18:59:13,301 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:59:13,304 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:59:13,305 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:59:13,307 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:59:13,314 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:59:13,321 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:59:13,324 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 25.0 ms
2024-02-05T18:59:13,332 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:42387, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353298, versionId=4]. totalHandledRequests:1
2024-02-05T18:59:13,335 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42387. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:59:13,336 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:40418][persistent://public/test/__change_events][reader-24d3efac25] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42387. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:59:13,339 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:59:13,339 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xf3184c69, L:/127.0.0.1:40418 - R:localhost/127.0.0.1:36141] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42387. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:59:13,340 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:59:13,342 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:13 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 94
2024-02-05T18:59:13,342 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-24d3efac25] Failed to subscribe to topic on localhost/127.0.0.1:36141
2024-02-05T18:59:13,342 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-24d3efac25] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42387. Please redo the lookup. Request is denied: namespace=public/test","reqId":2496546505976127535, "remote":"localhost/127.0.0.1:36141", "local":"/127.0.0.1:40418"}
2024-02-05T18:59:13,343 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-24d3efac25] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42387. Please redo the lookup. Request is denied: namespace=public/test","reqId":2496546505976127535, "remote":"localhost/127.0.0.1:36141", "local":"/127.0.0.1:40418"} -- Will try again in 0.1 s
2024-02-05T18:59:13,343 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:59:13,344 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:59:13 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 288
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7a88e52f] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8720d2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7a88e52f, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3aa5d017] 
2024-02-05T18:59:13,452 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-24d3efac25] Reconnecting after connection was closed
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:59:13,469 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:59:13,472 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:42387. Skipping this broker. Phase one
2024-02-05T18:59:13,473 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38993. Skipping this broker. Phase one
2024-02-05T18:59:13,473 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38993 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:59:13,481 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38993, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353473, versionId=5]. totalHandledRequests:8
2024-02-05T18:59:13,486 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:59:13,488 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@1de78f97{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:59:13,489 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:59:13,491 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@4a842e8a{/static,null,STOPPED}
2024-02-05T18:59:13,492 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/metrics,null,STOPPED}
2024-02-05T18:59:13,496 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38993, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353482, versionId=6]. totalHandledRequests:6
2024-02-05T18:59:13,497 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-24d3efac25] Subscribing to topic on cnx [id: 0x3c6f261c, L:/127.0.0.1:47010 - R:localhost/127.0.0.1:38709], consumerId 3
2024-02-05T18:59:13,499 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:59:13,499 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x98a731ee, L:/127.0.0.1:38709 - R:/127.0.0.1:47010]] Subscribing on topic persistent://public/test/__change_events / reader-24d3efac25. consumerId: 3
2024-02-05T18:59:13,505 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:59:13,508 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:59:13,508 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:59:13,515 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:59:13,516 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:59:13,521 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/topics,null,STOPPED}
2024-02-05T18:59:13,523 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/lookup,null,STOPPED}
2024-02-05T18:59:13,528 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v3,null,STOPPED}
2024-02-05T18:59:13,530 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/admin/v2,null,STOPPED}
2024-02-05T18:59:13,531 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:59:13,534 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/admin,null,STOPPED}
2024-02-05T18:59:13,535 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:59:13,537 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:59:13,537 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/,null,STOPPED}
2024-02-05T18:59:13,543 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:59:13,546 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:59:13,546 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:59:13,547 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42387
2024-02-05T18:59:13,547 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:59:13,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:59:13,549 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42387 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:59:13,549 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:59:13,560 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42387 was invalidated. state Releasing
2024-02-05T18:59:13,561 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:59:13,562 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42387. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:59:13,564 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42387 registry has been deleted.
2024-02-05T18:59:13,565 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42387 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:59:13,572 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-24d3efac25] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:13,573 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:59:13,573 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-24d3efac25, ackPos=13:-1, readPos=13:0}
2024-02-05T18:59:13,575 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42387 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:59:13,575 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42387
2024-02-05T18:59:13,576 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:47010] Created subscription on topic persistent://public/test/__change_events / reader-24d3efac25
2024-02-05T18:59:13,577 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-24d3efac25] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 3
2024-02-05T18:59:13,577 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42387
2024-02-05T18:59:13,578 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42387 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:59:13,582 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:47010] Closing consumer: consumerId=3
2024-02-05T18:59:13,582 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-24d3efac25}, consumerId=3, consumerName=56cad, address=/127.0.0.1:47010}
2024-02-05T18:59:13,583 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-24d3efac25] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-24d3efac25, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:59:13,584 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-24d3efac25] Successfully closed dispatcher for reader
2024-02-05T18:59:13,591 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:47010] Closed consumer, consumerId=3
2024-02-05T18:59:13,593 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:59:13,594 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-24d3efac25] Closed consumer
2024-02-05T18:59:13,595 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:59:13,596 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42387/0x00000000_0xffffffff.
2024-02-05T18:59:13,597 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a321714d64] Subscribing to topic on cnx [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709], consumerId 4
2024-02-05T18:59:13,599 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xd4caf22b, L:/127.0.0.1:38709 - R:/127.0.0.1:56934]] Subscribing on topic persistent://public/test/__change_events / reader-a321714d64. consumerId: 4
2024-02-05T18:59:13,604 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42387/0x00000000_0xffffffff.
2024-02-05T18:59:13,605 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a321714d64] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:59:13,605 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42387/0x00000000_0xffffffff.
2024-02-05T18:59:13,606 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.026 seconds
2024-02-05T18:59:13,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:59:13,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a321714d64, ackPos=13:-1, readPos=13:0}
2024-02-05T18:59:13,607 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:59:13,609 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56934] Created subscription on topic persistent://public/test/__change_events / reader-a321714d64
2024-02-05T18:59:13,613 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a321714d64] Subscribed to topic on localhost/127.0.0.1:38709 -- consumer: 4
2024-02-05T18:59:13,618 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] Disconnected
2024-02-05T18:59:13,620 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:13,620 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:13,620 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:13,621 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-60e310ea4a] Closed connection [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:13,621 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-12b6b77108] Closed connection [id: 0x3c6f261c, L:/127.0.0.1:47010 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:13,626 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:47010
2024-02-05T18:59:13,628 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-60e310ea4a}, consumerId=0, consumerName=ed226, address=/127.0.0.1:47010}
2024-02-05T18:59:13,628 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-60e310ea4a] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-60e310ea4a, ackPos=3:5, readPos=3:6}]
2024-02-05T18:59:13,629 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-60e310ea4a] Successfully closed dispatcher for reader
2024-02-05T18:59:13,629 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-12b6b77108}, consumerId=1, consumerName=a5cf5, address=/127.0.0.1:47010}
2024-02-05T18:59:13,633 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xf3184c69, L:/127.0.0.1:40418 ! R:localhost/127.0.0.1:36141] Disconnected
2024-02-05T18:59:13,633 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42387/__change_events] [reader-60aa724485] Closed connection [id: 0xf3184c69, L:/127.0.0.1:40418 ! R:localhost/127.0.0.1:36141] -- Will try again in 0.1 s
2024-02-05T18:59:13,633 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:40418
2024-02-05T18:59:13,634 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42387/__change_events, name=reader-60aa724485}, consumerId=2, consumerName=b99de, address=/127.0.0.1:40418}
2024-02-05T18:59:13,634 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42387/__change_events][reader-60aa724485] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42387/persistent/__change_events, cursor=reader-60aa724485, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:59:13,634 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42387/__change_events][reader-60aa724485] Successfully closed dispatcher for reader
2024-02-05T18:59:13,638 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:59:13,639 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42387/persistent/__change_events] Closing managed ledger
2024-02-05T18:59:13,644 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42387/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:59:13,644 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:59:13,647 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:59:13,648 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:59:13,659 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36141
2024-02-05T18:59:13,660 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:59:13,661 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:59:13,661 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:59:13,662 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42387/__change_events] [reader-60aa724485] Closed Consumer (not connected)
2024-02-05T18:59:13,662 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42387/__change_events with subscription name reader-60aa724485 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42387/__change_events with subscription name reader-60aa724485 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:13,662 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-12b6b77108] Closed Consumer (not connected)
2024-02-05T18:59:13,664 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-12b6b77108 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-12b6b77108 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:13,665 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-60e310ea4a] Closed Consumer (not connected)
2024-02-05T18:59:13,666 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-60e310ea4a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-60e310ea4a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:13,673 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:59:13,673 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:59:13,676 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:59:13,677 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:13,684 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:59:13,684 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:13,929 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:59:13,930 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 46.68%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.68%, msgThroughputEMA= 0.00, updatedAt= 1707152353928, reportedAt= 0
2024-02-05T18:59:14,031 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:14,033 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:59:14,942 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:59:14,943 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:59:14,945 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:59:14,945 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:14,946 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:59:14,946 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:59:15,034 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:15,034 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:59:16,036 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:59:16,036 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:59:16,960 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:59:16,961 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:59:16,962 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:59:16,962 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:59:16,963 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:59:16,963 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:59:16,964 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:59:16,966 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:59:16,967 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:59:16,969 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:59:16,970 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:59:16,972 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:59:16,972 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:59:16,973 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:59:16,973 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:59:16,974 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38993
2024-02-05T18:59:16,976 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38993, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152353482, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:59:21,987 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38993 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:59:21,995 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38993 was invalidated. state Releasing
2024-02-05T18:59:21,995 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38993. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:59:21,996 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38993
2024-02-05T18:59:22,005 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38993, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152361999, versionId=7]. totalHandledRequests:10
2024-02-05T18:59:22,006 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:59:22,006 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:59:22,007 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:59:22,007 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a321714d64}, consumerId=4, consumerName=46204, address=/127.0.0.1:56934}
2024-02-05T18:59:22,008 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a321714d64}, consumerId=4, consumerName=46204, address=/127.0.0.1:56934}
2024-02-05T18:59:22,008 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:38709] Broker notification of Closed consumer: 4
2024-02-05T18:59:22,008 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a321714d64] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a321714d64, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:59:22,009 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-a321714d64] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 - R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,009 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a321714d64] Successfully closed dispatcher for reader
2024-02-05T18:59:22,009 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a321714d64] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a321714d64, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:59:22,009 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-a321714d64] Successfully disconnected and closed subscription
2024-02-05T18:59:22,010 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:59:22,015 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:59:22,016 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:59:22,017 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a321714d64] Closed Consumer (not connected)
2024-02-05T18:59:22,017 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 11.0 ms
2024-02-05T18:59:22,017 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a321714d64 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a321714d64 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:22,024 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:38993 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38993, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152362005, versionId=8]. totalHandledRequests:4
2024-02-05T18:59:22,024 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:59:22,025 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38993/0x00000000_0xffffffff.
2024-02-05T18:59:22,026 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38993/0x00000000_0xffffffff.
2024-02-05T18:59:22,027 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38993/0x00000000_0xffffffff.
2024-02-05T18:59:22,027 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.031 seconds
2024-02-05T18:59:22,027 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:59:22,028 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:56934
2024-02-05T18:59:22,028 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] Disconnected
2024-02-05T18:59:22,028 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-6fc9e0c174}, consumerId=0, consumerName=2c734, address=/127.0.0.1:56934}
2024-02-05T18:59:22,029 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6fc9e0c174] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6fc9e0c174, ackPos=3:5, readPos=3:8}]
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6fc9e0c174] Successfully closed dispatcher for reader
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6fc9e0c174] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-cca5f43945] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38993/persistent/__change_events] Closing managed ledger
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38993/__change_events] [reader-f484410fcd] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,029 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38993/__change_events, name=reader-f484410fcd}, consumerId=3, consumerName=0b0d9, address=/127.0.0.1:56934}
2024-02-05T18:59:22,030 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-ad9b484a0c] Closed connection [id: 0x5291c05a, L:/127.0.0.1:56934 ! R:localhost/127.0.0.1:38709] -- Will try again in 0.1 s
2024-02-05T18:59:22,030 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38993/__change_events][reader-f484410fcd] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38993/persistent/__change_events, cursor=reader-f484410fcd, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:59:22,030 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38993/__change_events][reader-f484410fcd] Successfully closed dispatcher for reader
2024-02-05T18:59:22,030 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:59:22,030 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-ad9b484a0c}, consumerId=2, consumerName=68423, address=/127.0.0.1:56934}
2024-02-05T18:59:22,030 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-cca5f43945}, consumerId=1, consumerName=0146e, address=/127.0.0.1:56934}
2024-02-05T18:59:22,035 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38993/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:59:22,035 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:59:22,035 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:59:22,036 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:59:22,040 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:38709
2024-02-05T18:59:22,040 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:59:22,040 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:59:22,040 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:59:22,040 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6fc9e0c174] Closed Consumer (not connected)
2024-02-05T18:59:22,041 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-ad9b484a0c] Closed Consumer (not connected)
2024-02-05T18:59:22,041 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38993/__change_events] [reader-f484410fcd] Closed Consumer (not connected)
2024-02-05T18:59:22,041 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-cca5f43945] Closed Consumer (not connected)
2024-02-05T18:59:22,041 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6fc9e0c174 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6fc9e0c174 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:22,041 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-ad9b484a0c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-ad9b484a0c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:22,042 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38993/__change_events with subscription name reader-f484410fcd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38993/__change_events with subscription name reader-f484410fcd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:22,042 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-cca5f43945 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-cca5f43945 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:59:22,045 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:59:22,045 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:59:22,046 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:59:22,046 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:59:22,046 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:59:22,046 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:22,047 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:59:22,048 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:23,433 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:59:23,434 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:59:23,435 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:59:23,435 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:23,435 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:59:23,436 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:59:23,443 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:59:23,444 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:59:23,448 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:59:23,448 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:59:23,448 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:59:23,448 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:59:23,448 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:59:23,448 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:59:23,449 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:59:23,449 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:59:23,449 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:59:23,449 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:59:23,449 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:59:23,449 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:59:23,449 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@339e62bb
2024-02-05T18:59:23,449 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:59:23,449 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:59:23,450 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.114 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  53.503 s
[INFO] Finished at: 2024-02-05T18:59:23+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 11 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:59:54,014 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:59:54,968 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:59:54,970 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:59:55,459 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:59:55,460 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:59:55,461 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:59:55,461 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:59:55,462 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:59:55,463 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:59:55,493 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:59:55,494 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:59:55,494 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:59:55,495 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:59:55,496 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:59:55,496 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:59:55,497 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:59:55,497 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:59:55,498 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:59:55,498 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:59:55,499 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:59:55,499 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:59:57,038 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:59:57,039 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:59:57,040 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:59:57,040 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:59:57,349 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:59:57,350 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:59:57,445 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:59:57,538 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:59:57,542 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:59:57,560 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:59:57,663 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:59:57,704 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:59:57,771 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:59:58,138 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:59:58,139 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:59:58,168 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:59:58,219 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:41361, TLS: (none), listener: (none)
2024-02-05T18:59:58,554 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34421, TLS: OPENSSL, listener: (none)
2024-02-05T18:59:58,574 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:59:58,578 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:58,579 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:59:58,613 - INFO  - [main:Log@170] - Logging initialized @6833ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:59:59,510 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:59:59,540 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:59:59,541 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:59:59,543 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T19:00:00,262 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T19:00:01,343 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T19:00:02,698 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T19:00:03,145 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T19:00:03,272 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T19:00:03,454 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T19:00:03,457 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T19:00:03,459 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T19:00:03,480 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:43535}
2024-02-05T19:00:03,624 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:33893}
2024-02-05T19:00:03,625 - INFO  - [main:Server@415] - Started @11847ms
2024-02-05T19:00:03,625 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:43535
2024-02-05T19:00:03,626 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33893
2024-02-05T19:00:03,633 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:00:03,634 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:00:03,791 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:43535
2024-02-05T19:00:03,806 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T19:00:03,809 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:43535 is changing the role from null to Leader
2024-02-05T19:00:03,813 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43535).
2024-02-05T19:00:04,114 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:43535 
2024-02-05T19:00:04,518 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T19:00:04,549 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:04,660 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:00:04,666 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:00:04,677 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:00:04,681 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T19:00:04,725 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T19:00:04,755 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T19:00:04,782 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T19:00:04,845 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T19:00:04,867 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T19:00:04,877 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T19:00:04,880 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T19:00:04,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:04 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 503
2024-02-05T19:00:04,912 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T19:00:05,064 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]] Connected to server
2024-02-05T19:00:05,102 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:46272] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:00:05,156 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,163 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,227 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T19:00:05,261 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46272] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46272, producerName=test-0-0, producerId=0}
2024-02-05T19:00:05,270 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,273 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T19:00:05,325 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,327 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-643ec01a46] Subscribing to topic on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361], consumerId 0
2024-02-05T19:00:05,338 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x99934205, L:/127.0.0.1:41361 - R:/127.0.0.1:46272]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-643ec01a46. consumerId: 0
2024-02-05T19:00:05,367 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-643ec01a46] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:05,368 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:00:05,368 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-643ec01a46, ackPos=3:-1, readPos=3:0}
2024-02-05T19:00:05,402 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46272] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-643ec01a46
2024-02-05T19:00:05,413 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-643ec01a46] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 0
2024-02-05T19:00:05,427 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.013 seconds
2024-02-05T19:00:05,429 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T19:00:05,430 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T19:00:05,431 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:00:05,468 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,488 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T19:00:05,489 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T19:00:05,491 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T19:00:05,492 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 47
2024-02-05T19:00:05,503 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,516 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T19:00:05,517 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T19:00:05,519 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T19:00:05,519 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T19:00:05,544 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,546 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,557 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T19:00:05,563 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46272] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46272, producerName=test-0-1, producerId=1}
2024-02-05T19:00:05,565 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,581 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,583 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-922bffa106] Subscribing to topic on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361], consumerId 1
2024-02-05T19:00:05,585 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x99934205, L:/127.0.0.1:41361 - R:/127.0.0.1:46272]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-922bffa106. consumerId: 1
2024-02-05T19:00:05,614 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-922bffa106] Created new subscription for 1
2024-02-05T19:00:05,615 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46272] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-922bffa106
2024-02-05T19:00:05,616 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-922bffa106] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 1
2024-02-05T19:00:05,635 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,637 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,647 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T19:00:05,654 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:46272] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46272, producerName=test-0-2, producerId=2}
2024-02-05T19:00:05,656 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:05,676 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:00:05,701 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:00:05,706 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:43535 started the ownership monitor.
2024-02-05T19:00:05,730 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:05,732 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5881a7156d] Subscribing to topic on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361], consumerId 2
2024-02-05T19:00:05,734 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x99934205, L:/127.0.0.1:41361 - R:/127.0.0.1:46272]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-5881a7156d. consumerId: 2
2024-02-05T19:00:05,744 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:43535/__change_events
2024-02-05T19:00:05,748 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5881a7156d] Created new subscription for 2
2024-02-05T19:00:05,748 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46272] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-5881a7156d
2024-02-05T19:00:05,749 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5881a7156d] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 2
2024-02-05T19:00:05,750 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:43535 plays the leader now.
2024-02-05T19:00:05,755 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707152405754, reportedAt= 0
2024-02-05T19:00:05,788 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T19:00:05,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:05,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:00:05,838 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:43535/0x00000000_0xffffffff - localhost:43535.
2024-02-05T19:00:05,841 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:43535
2024-02-05T19:00:05,841 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:43535/0x00000000_0xffffffff
2024-02-05T19:00:05,842 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:43535/0x00000000_0xffffffff - localhost:43535.
2024-02-05T19:00:05,843 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:43535
2024-02-05T19:00:05,843 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:43535/0x00000000_0xffffffff
2024-02-05T19:00:05,857 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:43535 doesn't exist.
2024-02-05T19:00:05,859 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:43535/__change_events][reader-70258deba5] Subscribing to topic on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361], consumerId 3
2024-02-05T19:00:05,861 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x99934205, L:/127.0.0.1:41361 - R:/127.0.0.1:46272]] Subscribing on topic persistent://sla-monitor/test/localhost:43535/__change_events / reader-70258deba5. consumerId: 3
2024-02-05T19:00:05,868 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:43535/persistent/__change_events
2024-02-05T19:00:05,871 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:43535/persistent/__change_events'
2024-02-05T19:00:05,877 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T19:00:05,878 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:43535/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T19:00:05,886 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:43535/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:00:05,892 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:43535/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T19:00:05,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:43535/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:43535/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T19:00:05,898 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:43535/__change_events - dedup is disabled
2024-02-05T19:00:05,912 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T19:00:05,918 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:43535/__change_events][reader-70258deba5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:05,919 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:43535/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T19:00:05,919 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:43535/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43535/persistent/__change_events, cursor=reader-70258deba5, ackPos=7:-1, readPos=7:0}
2024-02-05T19:00:05,922 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:46272] Created subscription on topic persistent://sla-monitor/test/localhost:43535/__change_events / reader-70258deba5
2024-02-05T19:00:05,925 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:43535/__change_events][reader-70258deba5] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 3
2024-02-05T19:00:05,880 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 43535, tls-port = Optional[33893], broker url= pulsar://localhost:41361, broker tls url= pulsar+ssl://localhost:34421, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[41361], brokerServicePortTls=Optional[34421], webServicePort=Optional[43535], webServicePortTls=Optional[33893], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:00:06,469 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T19:00:06,470 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T19:00:06,470 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T19:00:06,471 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T19:00:06,478 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T19:00:06,478 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T19:00:06,484 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T19:00:06,489 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T19:00:06,498 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T19:00:06,499 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:00:06,506 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T19:00:06,513 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T19:00:06,517 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T19:00:06,529 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T19:00:06,529 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T19:00:06,537 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T19:00:06,540 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37679, TLS: (none), listener: (none)
2024-02-05T19:00:06,542 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44073, TLS: OPENSSL, listener: (none)
2024-02-05T19:00:06,546 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T19:00:06,547 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:00:06,548 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:00:06,563 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T19:00:06,569 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T19:00:06,569 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T19:00:06,570 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T19:00:06,656 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@458044df{/,null,AVAILABLE}
2024-02-05T19:00:06,794 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:06,795 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:00:07,307 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/admin,null,AVAILABLE}
2024-02-05T19:00:07,796 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:07,796 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:00:08,598 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/admin/v2,null,AVAILABLE}
2024-02-05T19:00:08,797 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:08,798 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:00:08,821 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/admin/v3,null,AVAILABLE}
2024-02-05T19:00:08,895 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4a842e8a{/lookup,null,AVAILABLE}
2024-02-05T19:00:08,989 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/topics,null,AVAILABLE}
2024-02-05T19:00:08,993 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6b909973{/metrics,null,AVAILABLE}
2024-02-05T19:00:08,994 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@f4cfc61{/static,null,AVAILABLE}
2024-02-05T19:00:08,997 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@36b6ce5d{HTTP/1.1, (http/1.1)}{0.0.0.0:38117}
2024-02-05T19:00:09,029 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@52f1f54{SSL, (ssl, http/1.1)}{0.0.0.0:38441}
2024-02-05T19:00:09,030 - INFO  - [main:Server@415] - Started @17252ms
2024-02-05T19:00:09,030 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38117
2024-02-05T19:00:09,033 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:38441
2024-02-05T19:00:09,038 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:00:09,039 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:00:09,057 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38117
2024-02-05T19:00:09,060 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:38117 registry has been created.
2024-02-05T19:00:09,061 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:38117. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T19:00:09,063 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:38117 is changing the role from null to Follower
2024-02-05T19:00:09,067 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:43535).
2024-02-05T19:00:09,072 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T19:00:09,086 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38117 
2024-02-05T19:00:09,208 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 58
2024-02-05T19:00:09,231 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:09,233 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T19:00:09,235 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T19:00:09,248 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 32
2024-02-05T19:00:09,252 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38117/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:00:09,263 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xc55099be, L:/127.0.0.1:35124 - R:localhost/127.0.0.1:37679]] Connected to server
2024-02-05T19:00:09,268 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:35124] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:00:09,287 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]] Connected to server
2024-02-05T19:00:09,292 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:46274] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:00:09,294 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,308 - INFO  - [pulsar-io-9-2:ServerCnx@1606] - [/127.0.0.1:46274] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46274, producerName=test-0-3, producerId=0}
2024-02-05T19:00:09,310 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,326 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c7a7112865] Subscribing to topic on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361], consumerId 0
2024-02-05T19:00:09,328 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x05c35b2e, L:/127.0.0.1:41361 - R:/127.0.0.1:46274]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c7a7112865. consumerId: 0
2024-02-05T19:00:09,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c7a7112865] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:09,334 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:00:09,334 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c7a7112865, ackPos=3:-1, readPos=3:0}
2024-02-05T19:00:09,336 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46274] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-c7a7112865
2024-02-05T19:00:09,337 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c7a7112865] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 0
2024-02-05T19:00:09,340 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T19:00:09,341 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:00:09,362 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T19:00:09,370 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:09,373 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T19:00:09,373 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:00:09,377 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T19:00:09,377 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38117/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:00:09,390 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T19:00:09,397 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:09,400 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T19:00:09,401 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:00:09,404 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T19:00:09,405 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38117/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:00:09,424 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,432 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46274] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46274, producerName=test-0-4, producerId=1}
2024-02-05T19:00:09,436 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,452 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6bc7cffef1] Subscribing to topic on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361], consumerId 1
2024-02-05T19:00:09,454 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x05c35b2e, L:/127.0.0.1:41361 - R:/127.0.0.1:46274]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6bc7cffef1. consumerId: 1
2024-02-05T19:00:09,465 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6bc7cffef1] Created new subscription for 1
2024-02-05T19:00:09,465 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46274] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6bc7cffef1
2024-02-05T19:00:09,466 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6bc7cffef1] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 1
2024-02-05T19:00:09,483 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,492 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46274] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46274, producerName=test-0-5, producerId=2}
2024-02-05T19:00:09,493 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xc6f8845a, L:/127.0.0.1:46274 - R:localhost/127.0.0.1:41361]
2024-02-05T19:00:09,494 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:00:09,498 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:00:09,503 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:38117 plays a follower now.
2024-02-05T19:00:09,519 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38117/__change_events
2024-02-05T19:00:09,542 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38117/0x00000000_0xffffffff - localhost:38117.
2024-02-05T19:00:09,543 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38117
2024-02-05T19:00:09,543 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38117/0x00000000_0xffffffff
2024-02-05T19:00:09,544 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38117/0x00000000_0xffffffff - localhost:38117.
2024-02-05T19:00:09,545 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38117
2024-02-05T19:00:09,545 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38117/0x00000000_0xffffffff
2024-02-05T19:00:09,554 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38117/__change_events][reader-edd9cbf2ef] Subscribing to topic on cnx [id: 0xc55099be, L:/127.0.0.1:35124 - R:localhost/127.0.0.1:37679], consumerId 2
2024-02-05T19:00:09,555 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38117 doesn't exist.
2024-02-05T19:00:09,556 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x7c843a10, L:/127.0.0.1:37679 - R:/127.0.0.1:35124]] Subscribing on topic persistent://sla-monitor/test/localhost:38117/__change_events / reader-edd9cbf2ef. consumerId: 2
2024-02-05T19:00:09,558 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 38117, tls-port = Optional[38441], broker url= pulsar://localhost:37679, broker tls url= pulsar+ssl://localhost:44073, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37679], brokerServicePortTls=Optional[44073], webServicePort=Optional[38117], webServicePortTls=Optional[38441], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:00:09,564 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38117/persistent/__change_events
2024-02-05T19:00:09,566 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38117/persistent/__change_events'
2024-02-05T19:00:09,577 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T19:00:09,578 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38117/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T19:00:09,586 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38117/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:00:09,593 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38117/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T19:00:09,597 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38117/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38117/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T19:00:09,598 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38117/__change_events - dedup is disabled
2024-02-05T19:00:09,605 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T19:00:09,613 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38117/__change_events][reader-edd9cbf2ef] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:09,614 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38117/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T19:00:09,614 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38117/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38117/persistent/__change_events, cursor=reader-edd9cbf2ef, ackPos=9:-1, readPos=9:0}
2024-02-05T19:00:09,617 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:35124] Created subscription on topic persistent://sla-monitor/test/localhost:38117/__change_events / reader-edd9cbf2ef
2024-02-05T19:00:09,618 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38117/__change_events][reader-edd9cbf2ef] Subscribed to topic on localhost/127.0.0.1:37679 -- consumer: 2
2024-02-05T19:00:09,750 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T19:00:09,752 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T19:00:09,785 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T19:00:09,787 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T19:00:09,799 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:00:09,799 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:00:09,810 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:00:09,811 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:00:09,816 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T19:00:09,818 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T19:00:09,841 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:00:09,841 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:00:09,842 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T19:00:09,843 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:00:09,846 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:00:09,848 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T19:00:09,860 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:00:09,860 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:00:09,866 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T19:00:09,869 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T19:00:09,881 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:00:09,883 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:00:09,882 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:00:09,885 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T19:00:09,886 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T19:00:09,890 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:00:09,924 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T19:00:09,937 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:00:09,938 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:00:09,951 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T19:00:09,964 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:09,989 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:43535 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:00:10,040 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:43535, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152409991, versionId=1]. totalHandledRequests:1
2024-02-05T19:00:10,076 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43535, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152410064, versionId=2]. totalHandledRequests:1
2024-02-05T19:00:10,079 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:10,098 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:00:10,123 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:00:10,126 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:43535, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152410092, versionId=3]. totalHandledRequests:1
2024-02-05T19:00:10,127 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:00:10,134 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T19:00:10,144 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:10,148 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:43535, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152410127, versionId=4]. totalHandledRequests:1
2024-02-05T19:00:10,152 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43535. Skipping this broker. Phase one
2024-02-05T19:00:10,152 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:43535. Skipping this broker. Phase two
2024-02-05T19:00:10,152 - INFO  - [broker-client-shared-internal-executor-11-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38117 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:00:10,153 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:00:10,154 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T19:00:10,156 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T19:00:10,157 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 238
2024-02-05T19:00:10,159 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:00:09 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 212
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:00:10,167 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152410153, versionId=5]. totalHandledRequests:2
2024-02-05T19:00:10,181 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:00:10,230 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152410163, versionId=6]. totalHandledRequests:2
2024-02-05T19:00:10,235 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x09edcc26, L:/127.0.0.1:35128 - R:localhost/127.0.0.1:37679]] Connected to server
2024-02-05T19:00:10,238 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:35128] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:00:10,239 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-3339ae47e2] Subscribing to topic on cnx [id: 0x09edcc26, L:/127.0.0.1:35128 - R:localhost/127.0.0.1:37679], consumerId 4
2024-02-05T19:00:10,241 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0xb36a92c2, L:/127.0.0.1:37679 - R:/127.0.0.1:35128]] Subscribing on topic persistent://public/test/__change_events / reader-3339ae47e2. consumerId: 4
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a] 
2024-02-05T19:00:10,256 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35] 
2024-02-05T19:00:10,256 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21743dcc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@14665f29] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21743dcc, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4248d277], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@14665f29, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@8916d3f] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21743dcc, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4248d277, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@88bbbbc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@14665f29, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@8916d3f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e323293] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21743dcc, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4248d277, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@88bbbbc, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6d8648], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@14665f29, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@8916d3f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e323293, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2996feaf] 
2024-02-05T19:00:10,260 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-11e2590024] Subscribing to topic on cnx [id: 0xc55099be, L:/127.0.0.1:35124 - R:localhost/127.0.0.1:37679], consumerId 3
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68e2e374, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c055fa5, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21743dcc, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4248d277, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@88bbbbc, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2a6d8648, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7c95e67a], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6dab118a, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5e729c35, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@14665f29, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@8916d3f, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e323293, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2996feaf, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@438cf5d1] 
2024-02-05T19:00:10,264 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T19:00:10,264 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T19:00:10,268 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x7c843a10, L:/127.0.0.1:37679 - R:/127.0.0.1:35124]] Subscribing on topic persistent://public/test/__change_events / reader-11e2590024. consumerId: 3
2024-02-05T19:00:10,271 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:00:10,276 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T19:00:10,282 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T19:00:10,285 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:00:10,290 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:00:10,295 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T19:00:10,300 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T19:00:10,305 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-11e2590024] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:10,305 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T19:00:10,305 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-11e2590024, ackPos=11:-1, readPos=11:0}
2024-02-05T19:00:10,307 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:35124] Created subscription on topic persistent://public/test/__change_events / reader-11e2590024
2024-02-05T19:00:10,308 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-11e2590024] Subscribed to topic on localhost/127.0.0.1:37679 -- consumer: 3
2024-02-05T19:00:10,313 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@36b6ce5d{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:00:10,314 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@52f1f54{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:00:10,314 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:00:10,316 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@f4cfc61{/static,null,STOPPED}
2024-02-05T19:00:10,317 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6b909973{/metrics,null,STOPPED}
2024-02-05T19:00:10,326 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/topics,null,STOPPED}
2024-02-05T19:00:10,329 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4a842e8a{/lookup,null,STOPPED}
2024-02-05T19:00:10,331 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/admin/v3,null,STOPPED}
2024-02-05T19:00:10,332 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-3339ae47e2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:10,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T19:00:10,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-3339ae47e2, ackPos=11:-1, readPos=11:0}
2024-02-05T19:00:10,334 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/admin/v2,null,STOPPED}
2024-02-05T19:00:10,337 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/admin,null,STOPPED}
2024-02-05T19:00:10,340 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@458044df{/,null,STOPPED}
2024-02-05T19:00:10,340 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:35128] Created subscription on topic persistent://public/test/__change_events / reader-3339ae47e2
2024-02-05T19:00:10,341 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-3339ae47e2] Subscribed to topic on localhost/127.0.0.1:37679 -- consumer: 4
2024-02-05T19:00:10,344 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:00:10,346 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:35128] Closing consumer: consumerId=4
2024-02-05T19:00:10,347 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-3339ae47e2}, consumerId=4, consumerName=fdc44, address=/127.0.0.1:35128}
2024-02-05T19:00:10,347 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:00:10,347 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:00:10,348 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-3339ae47e2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-3339ae47e2, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:00:10,349 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:10,350 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-3339ae47e2] Successfully closed dispatcher for reader
2024-02-05T19:00:10,353 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:43535. Skipping this broker. Phase one
2024-02-05T19:00:10,355 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152410163, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43535, sourceBroker=localhost:38117, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152410355, versionId=7]
2024-02-05T19:00:10,360 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:35128] Closed consumer, consumerId=4
2024-02-05T19:00:10,361 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-3339ae47e2] Closed consumer
2024-02-05T19:00:10,362 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T19:00:10,365 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:43535, sourceBroker=localhost:38117, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152410355, versionId=7]. totalHandledRequests:6
2024-02-05T19:00:10,366 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:43535 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:43535, sourceBroker=localhost:38117, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152410355, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T19:00:10,366 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:00:10,367 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:00:10,369 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:00:10,370 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:00:10,371 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-11e2590024}, consumerId=3, consumerName=bedb2, address=/127.0.0.1:35124}
2024-02-05T19:00:10,373 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-11e2590024}, consumerId=3, consumerName=bedb2, address=/127.0.0.1:35124}
2024-02-05T19:00:10,373 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-11e2590024] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-11e2590024, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:00:10,374 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-11e2590024] Successfully closed dispatcher for reader
2024-02-05T19:00:10,373 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:37679] Broker notification of Closed consumer: 3
2024-02-05T19:00:10,375 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-11e2590024] Closed connection [id: 0xc55099be, L:/127.0.0.1:35124 - R:localhost/127.0.0.1:37679] -- Will try again in 0.1 s
2024-02-05T19:00:10,376 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-11e2590024] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-11e2590024, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:00:10,376 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-11e2590024] Successfully disconnected and closed subscription
2024-02-05T19:00:10,378 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:00:10,392 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T19:00:10,398 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:00:10,399 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-11e2590024] Closed Consumer (not connected)
2024-02-05T19:00:10,400 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-11e2590024 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-11e2590024 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:10,401 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 36.0 ms
2024-02-05T19:00:10,411 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:00:10,413 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Subscribing to topic on cnx [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361], consumerId 5
2024-02-05T19:00:10,417 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x99934205, L:/127.0.0.1:41361 - R:/127.0.0.1:46272]] Subscribing on topic persistent://public/test/__change_events / reader-73cf1e6c7c. consumerId: 5
2024-02-05T19:00:10,434 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T19:00:10,440 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T19:00:10,441 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T19:00:10,447 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T19:00:10,451 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T19:00:10,453 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T19:00:10,456 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T19:00:10,457 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T19:00:10,457 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:00:10,463 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:00:10,470 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:00:10,471 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T19:00:10,471 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-73cf1e6c7c, ackPos=14:-1, readPos=14:0}
2024-02-05T19:00:10,474 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46272] Created subscription on topic persistent://public/test/__change_events / reader-73cf1e6c7c
2024-02-05T19:00:10,475 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Subscribed to topic on localhost/127.0.0.1:41361 -- consumer: 5
2024-02-05T19:00:10,477 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-11e2590024] Reconnecting after timeout
2024-02-05T19:00:10,477 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-11e2590024] Ignoring reconnection request (state: Closed)
2024-02-05T19:00:10,696 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T19:00:10,697 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 44.73%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.73%, msgThroughputEMA= 0.00, updatedAt= 1707152410695, reportedAt= 0
2024-02-05T19:00:10,800 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:00:10,800 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:00:11,801 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:00:11,802 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:00:12,802 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:00:12,803 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:00:13,466 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 3116.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T19:00:13,473 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38117 was invalidated. state Releasing
2024-02-05T19:00:13,473 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:38117 registry has been deleted.
2024-02-05T19:00:13,474 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38117 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:00:13,475 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38117. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:00:13,476 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38117
2024-02-05T19:00:13,476 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38117 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:00:13,476 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:13,478 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:00:13,487 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38117/0x00000000_0xffffffff.
2024-02-05T19:00:13,489 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38117/0x00000000_0xffffffff.
2024-02-05T19:00:13,491 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38117/0x00000000_0xffffffff.
2024-02-05T19:00:13,494 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.015 seconds
2024-02-05T19:00:13,496 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:00:13,500 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] Disconnected
2024-02-05T19:00:13,501 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:35124
2024-02-05T19:00:13,501 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:13,502 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38117/__change_events, name=reader-edd9cbf2ef}, consumerId=2, consumerName=74c13, address=/127.0.0.1:35124}
2024-02-05T19:00:13,503 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38117/__change_events][reader-edd9cbf2ef] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38117/persistent/__change_events, cursor=reader-edd9cbf2ef, ackPos=9:-1, readPos=9:0}]
2024-02-05T19:00:13,503 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:46274
2024-02-05T19:00:13,504 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38117/__change_events][reader-edd9cbf2ef] Successfully closed dispatcher for reader
2024-02-05T19:00:13,504 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-c7a7112865}, consumerId=0, consumerName=10b9a, address=/127.0.0.1:46274}
2024-02-05T19:00:13,506 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xc55099be, L:/127.0.0.1:35124 ! R:localhost/127.0.0.1:37679] Disconnected
2024-02-05T19:00:13,506 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x09edcc26, L:/127.0.0.1:35128 ! R:localhost/127.0.0.1:37679] Disconnected
2024-02-05T19:00:13,507 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38117/__change_events] [reader-edd9cbf2ef] Closed connection [id: 0xc55099be, L:/127.0.0.1:35124 ! R:localhost/127.0.0.1:37679] -- Will try again in 0.1 s
2024-02-05T19:00:13,507 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:13,508 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:13,508 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c7a7112865] Closed connection [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:13,509 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c7a7112865] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-c7a7112865, ackPos=3:6, readPos=3:7}]
2024-02-05T19:00:13,509 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-c7a7112865] Successfully closed dispatcher for reader
2024-02-05T19:00:13,508 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6bc7cffef1] Closed connection [id: 0xc6f8845a, L:/127.0.0.1:46274 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:13,511 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:35128
2024-02-05T19:00:13,511 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-6bc7cffef1}, consumerId=1, consumerName=0f622, address=/127.0.0.1:46274}
2024-02-05T19:00:13,513 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T19:00:13,513 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38117/persistent/__change_events] Closing managed ledger
2024-02-05T19:00:13,516 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38117/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T19:00:13,517 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T19:00:13,518 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:00:13,519 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:00:13,526 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37679
2024-02-05T19:00:13,527 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T19:00:13,529 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T19:00:13,529 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T19:00:13,530 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-c7a7112865] Closed Consumer (not connected)
2024-02-05T19:00:13,531 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6bc7cffef1] Closed Consumer (not connected)
2024-02-05T19:00:13,531 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c7a7112865 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-c7a7112865 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:13,531 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38117/__change_events] [reader-edd9cbf2ef] Closed Consumer (not connected)
2024-02-05T19:00:13,532 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6bc7cffef1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6bc7cffef1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:13,532 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38117/__change_events with subscription name reader-edd9cbf2ef was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38117/__change_events with subscription name reader-edd9cbf2ef was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:13,538 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:00:13,538 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:00:13,541 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:00:13,541 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:13,547 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:00:13,547 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:13,806 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:13,806 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38117 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:00:13,807 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38117 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:00:13,807 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38117]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:00:13,807 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:13,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:00:14,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:14,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38117 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:00:14,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38117 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:00:14,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:38117]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:00:14,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:14,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:00:14,815 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:00:14,816 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:00:14,818 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:00:14,819 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:14,819 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:00:14,820 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:00:15,696 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 46.09%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.86%, msgThroughputEMA= 0.00, updatedAt= 1707152415695, reportedAt= 1707152410701
2024-02-05T19:00:15,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:15,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38117 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:00:15,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38117 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:00:15,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38117]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:00:15,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:15,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:00:16,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:00:16,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38117 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:00:16,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38117 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:00:16,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:38117]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:00:16,813 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38117
2024-02-05T19:00:16,814 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38117 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:00:16,834 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:00:16,835 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:00:16,836 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:00:16,836 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:00:16,836 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T19:00:16,837 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T19:00:16,838 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T19:00:16,840 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T19:00:16,842 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T19:00:16,844 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T19:00:16,845 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T19:00:16,846 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T19:00:16,847 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:00:16,848 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:00:16,848 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:00:16,849 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:43535
2024-02-05T19:00:16,851 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:43535, sourceBroker=localhost:38117, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152410355, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T19:00:21,860 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:43535 in 5009.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T19:00:21,871 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:43535 was invalidated. state Releasing
2024-02-05T19:00:21,872 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:43535. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:00:21,872 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:43535
2024-02-05T19:00:21,886 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:43535, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152421878, versionId=8]. totalHandledRequests:10
2024-02-05T19:00:21,887 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:00:21,888 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-73cf1e6c7c}, consumerId=5, consumerName=1099a, address=/127.0.0.1:46272}
2024-02-05T19:00:21,888 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-73cf1e6c7c}, consumerId=5, consumerName=1099a, address=/127.0.0.1:46272}
2024-02-05T19:00:21,888 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-73cf1e6c7c, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:00:21,888 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Successfully closed dispatcher for reader
2024-02-05T19:00:21,889 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-73cf1e6c7c, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:00:21,889 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:41361] Broker notification of Closed consumer: 5
2024-02-05T19:00:21,890 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-73cf1e6c7c] Successfully disconnected and closed subscription
2024-02-05T19:00:21,890 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-73cf1e6c7c] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 - R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,890 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:00:21,890 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:00:21,890 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:00:21,896 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T19:00:21,898 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:00:21,898 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-73cf1e6c7c] Closed Consumer (not connected)
2024-02-05T19:00:21,899 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T19:00:21,899 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-73cf1e6c7c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-73cf1e6c7c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:21,908 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:00:21,908 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:43535 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:43535, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152421886, versionId=9]. totalHandledRequests:4
2024-02-05T19:00:21,908 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:00:21,909 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:00:21,910 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:43535/0x00000000_0xffffffff.
2024-02-05T19:00:21,911 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:43535/0x00000000_0xffffffff.
2024-02-05T19:00:21,912 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:43535/0x00000000_0xffffffff.
2024-02-05T19:00:21,912 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.04 seconds
2024-02-05T19:00:21,912 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:00:21,913 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:46272
2024-02-05T19:00:21,914 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T19:00:21,914 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-643ec01a46}, consumerId=0, consumerName=5b1ac, address=/127.0.0.1:46272}
2024-02-05T19:00:21,914 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:00:21,914 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] Disconnected
2024-02-05T19:00:21,914 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,915 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:43535/persistent/__change_events] Closing managed ledger
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-643ec01a46] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-922bffa106] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-643ec01a46] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-643ec01a46, ackPos=3:7, readPos=3:9}]
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-643ec01a46] Successfully closed dispatcher for reader
2024-02-05T19:00:21,915 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:43535/__change_events] [reader-70258deba5] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,916 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-5881a7156d] Closed connection [id: 0xb086a966, L:/127.0.0.1:46272 ! R:localhost/127.0.0.1:41361] -- Will try again in 0.1 s
2024-02-05T19:00:21,916 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:43535/__change_events, name=reader-70258deba5}, consumerId=3, consumerName=8f75a, address=/127.0.0.1:46272}
2024-02-05T19:00:21,916 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T19:00:21,916 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:43535/__change_events][reader-70258deba5] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:43535/persistent/__change_events, cursor=reader-70258deba5, ackPos=7:-1, readPos=7:0}]
2024-02-05T19:00:21,916 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:43535/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T19:00:21,916 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:43535/__change_events][reader-70258deba5] Successfully closed dispatcher for reader
2024-02-05T19:00:21,917 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T19:00:21,917 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-5881a7156d}, consumerId=2, consumerName=123f5, address=/127.0.0.1:46272}
2024-02-05T19:00:21,918 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-922bffa106}, consumerId=1, consumerName=9febe, address=/127.0.0.1:46272}
2024-02-05T19:00:21,919 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:00:21,919 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:00:21,924 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:41361
2024-02-05T19:00:21,924 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T19:00:21,924 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T19:00:21,924 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T19:00:21,925 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:43535/__change_events] [reader-70258deba5] Closed Consumer (not connected)
2024-02-05T19:00:21,925 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-643ec01a46] Closed Consumer (not connected)
2024-02-05T19:00:21,925 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-922bffa106] Closed Consumer (not connected)
2024-02-05T19:00:21,925 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-5881a7156d] Closed Consumer (not connected)
2024-02-05T19:00:21,925 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43535/__change_events with subscription name reader-70258deba5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:43535/__change_events with subscription name reader-70258deba5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:21,926 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-643ec01a46 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-643ec01a46 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:21,926 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-922bffa106 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-922bffa106 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:21,927 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-5881a7156d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-5881a7156d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:00:21,929 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T19:00:21,929 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:00:21,929 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T19:00:21,930 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:00:21,930 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:00:21,931 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:21,932 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:00:21,932 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:23,319 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:00:23,320 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:00:23,322 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:00:23,322 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:23,322 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:00:23,323 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:00:23,330 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:00:23,331 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:00:23,334 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T19:00:23,334 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T19:00:23,334 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T19:00:23,334 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T19:00:23,334 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T19:00:23,334 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T19:00:23,334 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T19:00:23,335 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T19:00:23,335 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T19:00:23,335 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T19:00:23,335 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T19:00:23,335 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T19:00:23,335 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T19:00:23,335 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@155c2a47
2024-02-05T19:00:23,335 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T19:00:23,336 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T19:00:23,336 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.151 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.652 s
[INFO] Finished at: 2024-02-05T19:00:23+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 12 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T19:00:54,079 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T19:00:55,139 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T19:00:55,141 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T19:00:55,622 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T19:00:55,625 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T19:00:55,625 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T19:00:55,626 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T19:00:55,626 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T19:00:55,627 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T19:00:55,645 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T19:00:55,645 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T19:00:55,646 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T19:00:55,647 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T19:00:55,647 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T19:00:55,648 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T19:00:55,648 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T19:00:55,649 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T19:00:55,650 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:00:55,650 - INFO  - [main:Environment@98] - Client environment:os.memory.free=24MB
2024-02-05T19:00:55,651 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T19:00:55,651 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T19:00:57,122 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T19:00:57,123 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T19:00:57,123 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T19:00:57,124 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T19:00:57,484 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T19:00:57,485 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T19:00:57,574 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T19:00:57,661 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T19:00:57,664 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:00:57,684 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T19:00:57,806 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T19:00:57,846 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T19:00:57,891 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T19:00:58,249 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T19:00:58,250 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T19:00:58,280 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T19:00:58,347 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36115, TLS: (none), listener: (none)
2024-02-05T19:00:58,689 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45187, TLS: OPENSSL, listener: (none)
2024-02-05T19:00:58,708 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T19:00:58,713 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:00:58,714 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:00:58,744 - INFO  - [main:Log@170] - Logging initialized @7007ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T19:00:59,736 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T19:00:59,778 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T19:00:59,779 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T19:00:59,782 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T19:01:00,614 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T19:01:01,741 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T19:01:02,749 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T19:01:03,125 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T19:01:03,268 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T19:01:03,400 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T19:01:03,402 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T19:01:03,405 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T19:01:03,429 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:45321}
2024-02-05T19:01:03,575 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:44975}
2024-02-05T19:01:03,575 - INFO  - [main:Server@415] - Started @11840ms
2024-02-05T19:01:03,576 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45321
2024-02-05T19:01:03,577 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44975
2024-02-05T19:01:03,587 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:01:03,588 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:01:03,744 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45321
2024-02-05T19:01:03,762 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T19:01:03,766 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:45321 is changing the role from null to Leader
2024-02-05T19:01:03,771 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45321).
2024-02-05T19:01:04,056 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45321 
2024-02-05T19:01:04,549 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T19:01:04,576 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:04,679 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:01:04,683 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:01:04,695 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:01:04,697 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T19:01:04,729 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T19:01:04,757 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T19:01:04,782 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T19:01:04,844 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T19:01:04,863 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T19:01:04,872 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T19:01:04,875 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T19:01:04,908 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T19:01:04,908 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:04 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 512
2024-02-05T19:01:05,074 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]] Connected to server
2024-02-05T19:01:05,112 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:50950] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:01:05,183 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,195 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,259 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T19:01:05,291 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50950] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50950, producerName=test-0-0, producerId=0}
2024-02-05T19:01:05,302 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,304 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T19:01:05,351 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,353 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a716ed3f7] Subscribing to topic on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115], consumerId 0
2024-02-05T19:01:05,362 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf49540a, L:/127.0.0.1:36115 - R:/127.0.0.1:50950]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7a716ed3f7. consumerId: 0
2024-02-05T19:01:05,405 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a716ed3f7] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:05,406 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:01:05,407 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7a716ed3f7, ackPos=3:-1, readPos=3:0}
2024-02-05T19:01:05,433 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:50950] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-7a716ed3f7
2024-02-05T19:01:05,438 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a716ed3f7] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 0
2024-02-05T19:01:05,454 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.015 seconds
2024-02-05T19:01:05,455 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T19:01:05,457 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T19:01:05,457 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:01:05,493 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,508 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T19:01:05,510 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T19:01:05,512 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 41
2024-02-05T19:01:05,512 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T19:01:05,522 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,532 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T19:01:05,533 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T19:01:05,534 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T19:01:05,535 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T19:01:05,556 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,558 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,568 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T19:01:05,576 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50950] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50950, producerName=test-0-1, producerId=1}
2024-02-05T19:01:05,578 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,594 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,595 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1fe0b9ec73] Subscribing to topic on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115], consumerId 1
2024-02-05T19:01:05,598 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf49540a, L:/127.0.0.1:36115 - R:/127.0.0.1:50950]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1fe0b9ec73. consumerId: 1
2024-02-05T19:01:05,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1fe0b9ec73] Created new subscription for 1
2024-02-05T19:01:05,620 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50950] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-1fe0b9ec73
2024-02-05T19:01:05,624 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-1fe0b9ec73] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 1
2024-02-05T19:01:05,644 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,646 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,652 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T19:01:05,659 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50950] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50950, producerName=test-0-2, producerId=2}
2024-02-05T19:01:05,661 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:05,677 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:01:05,706 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:01:05,712 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:45321 started the ownership monitor.
2024-02-05T19:01:05,730 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:05,732 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e35ae600d3] Subscribing to topic on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115], consumerId 2
2024-02-05T19:01:05,734 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf49540a, L:/127.0.0.1:36115 - R:/127.0.0.1:50950]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-e35ae600d3. consumerId: 2
2024-02-05T19:01:05,747 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e35ae600d3] Created new subscription for 2
2024-02-05T19:01:05,747 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50950] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-e35ae600d3
2024-02-05T19:01:05,748 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-e35ae600d3] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 2
2024-02-05T19:01:05,751 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:45321 plays the leader now.
2024-02-05T19:01:05,757 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45321/__change_events
2024-02-05T19:01:05,758 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707152465757, reportedAt= 0
2024-02-05T19:01:05,777 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T19:01:05,790 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:05,791 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:01:05,851 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45321/0x00000000_0xffffffff - localhost:45321.
2024-02-05T19:01:05,854 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45321
2024-02-05T19:01:05,854 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45321/0x00000000_0xffffffff
2024-02-05T19:01:05,855 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45321/0x00000000_0xffffffff - localhost:45321.
2024-02-05T19:01:05,856 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45321/0x00000000_0xffffffff
2024-02-05T19:01:05,857 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45321
2024-02-05T19:01:05,860 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45321/__change_events][reader-a77b59d674] Subscribing to topic on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115], consumerId 3
2024-02-05T19:01:05,862 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf49540a, L:/127.0.0.1:36115 - R:/127.0.0.1:50950]] Subscribing on topic persistent://sla-monitor/test/localhost:45321/__change_events / reader-a77b59d674. consumerId: 3
2024-02-05T19:01:05,873 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45321 doesn't exist.
2024-02-05T19:01:05,874 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45321/persistent/__change_events
2024-02-05T19:01:05,877 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45321/persistent/__change_events'
2024-02-05T19:01:05,885 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T19:01:05,886 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45321/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T19:01:05,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45321/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:01:05,903 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45321/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T19:01:05,908 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45321/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45321/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T19:01:05,909 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45321/__change_events - dedup is disabled
2024-02-05T19:01:05,924 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T19:01:05,929 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45321/__change_events][reader-a77b59d674] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:05,929 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45321/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T19:01:05,929 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45321/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45321/persistent/__change_events, cursor=reader-a77b59d674, ackPos=7:-1, readPos=7:0}
2024-02-05T19:01:05,932 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50950] Created subscription on topic persistent://sla-monitor/test/localhost:45321/__change_events / reader-a77b59d674
2024-02-05T19:01:05,933 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45321/__change_events][reader-a77b59d674] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 3
2024-02-05T19:01:05,888 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 45321, tls-port = Optional[44975], broker url= pulsar://localhost:36115, broker tls url= pulsar+ssl://localhost:45187, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36115], brokerServicePortTls=Optional[45187], webServicePort=Optional[45321], webServicePortTls=Optional[44975], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:01:06,491 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T19:01:06,491 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T19:01:06,492 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T19:01:06,492 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T19:01:06,496 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T19:01:06,497 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T19:01:06,501 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T19:01:06,506 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T19:01:06,513 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T19:01:06,514 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:01:06,520 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T19:01:06,526 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T19:01:06,530 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T19:01:06,540 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T19:01:06,540 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T19:01:06,546 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T19:01:06,549 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36189, TLS: (none), listener: (none)
2024-02-05T19:01:06,551 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37677, TLS: OPENSSL, listener: (none)
2024-02-05T19:01:06,555 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T19:01:06,556 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:01:06,557 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:01:06,569 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T19:01:06,571 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T19:01:06,571 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T19:01:06,572 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T19:01:06,684 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T19:01:06,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:06,792 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:01:07,367 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T19:01:07,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:07,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:01:08,655 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T19:01:08,794 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:08,795 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:01:08,893 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T19:01:08,957 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T19:01:09,026 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T19:01:09,026 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T19:01:09,027 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T19:01:09,031 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:38465}
2024-02-05T19:01:09,044 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:33821}
2024-02-05T19:01:09,045 - INFO  - [main:Server@415] - Started @17310ms
2024-02-05T19:01:09,045 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38465
2024-02-05T19:01:09,048 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33821
2024-02-05T19:01:09,051 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:01:09,052 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:01:09,066 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38465
2024-02-05T19:01:09,068 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:38465 registry has been created.
2024-02-05T19:01:09,068 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:38465. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T19:01:09,072 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:38465 is changing the role from null to Follower
2024-02-05T19:01:09,076 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45321).
2024-02-05T19:01:09,081 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T19:01:09,096 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38465 
2024-02-05T19:01:09,216 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T19:01:09,237 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:09,239 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T19:01:09,241 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T19:01:09,252 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T19:01:09,257 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38465/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:01:09,265 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xa33c8e3d, L:/127.0.0.1:45102 - R:localhost/127.0.0.1:36189]] Connected to server
2024-02-05T19:01:09,270 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:45102] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:01:09,284 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]] Connected to server
2024-02-05T19:01:09,289 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:50958] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:01:09,290 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,302 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50958] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50958, producerName=test-0-3, producerId=0}
2024-02-05T19:01:09,303 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,318 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c74025dd8] Subscribing to topic on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115], consumerId 0
2024-02-05T19:01:09,320 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x756fe9d0, L:/127.0.0.1:36115 - R:/127.0.0.1:50958]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4c74025dd8. consumerId: 0
2024-02-05T19:01:09,326 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c74025dd8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:09,327 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:01:09,327 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4c74025dd8, ackPos=3:-1, readPos=3:0}
2024-02-05T19:01:09,329 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50958] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4c74025dd8
2024-02-05T19:01:09,330 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c74025dd8] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 0
2024-02-05T19:01:09,333 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T19:01:09,334 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:01:09,358 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T19:01:09,368 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:09,372 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T19:01:09,372 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:01:09,378 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38465/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:01:09,379 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T19:01:09,394 - INFO  - [pulsar-web-84-8:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T19:01:09,402 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:09,405 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T19:01:09,406 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:01:09,410 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T19:01:09,410 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38465/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:01:09,430 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,439 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50958] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50958, producerName=test-0-4, producerId=1}
2024-02-05T19:01:09,441 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,458 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4bdc5b9fc5] Subscribing to topic on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115], consumerId 1
2024-02-05T19:01:09,460 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x756fe9d0, L:/127.0.0.1:36115 - R:/127.0.0.1:50958]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4bdc5b9fc5. consumerId: 1
2024-02-05T19:01:09,474 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4bdc5b9fc5] Created new subscription for 1
2024-02-05T19:01:09,474 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50958] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4bdc5b9fc5
2024-02-05T19:01:09,475 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4bdc5b9fc5] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 1
2024-02-05T19:01:09,498 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,507 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50958] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50958, producerName=test-0-5, producerId=2}
2024-02-05T19:01:09,508 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xcc14ac71, L:/127.0.0.1:50958 - R:localhost/127.0.0.1:36115]
2024-02-05T19:01:09,511 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:01:09,516 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:01:09,518 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:38465 plays a follower now.
2024-02-05T19:01:09,537 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38465/__change_events
2024-02-05T19:01:09,569 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38465/0x00000000_0xffffffff - localhost:38465.
2024-02-05T19:01:09,571 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38465
2024-02-05T19:01:09,571 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38465/0x00000000_0xffffffff
2024-02-05T19:01:09,572 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38465/0x00000000_0xffffffff - localhost:38465.
2024-02-05T19:01:09,577 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38465
2024-02-05T19:01:09,577 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38465/0x00000000_0xffffffff
2024-02-05T19:01:09,578 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38465/__change_events][reader-042e829383] Subscribing to topic on cnx [id: 0xa33c8e3d, L:/127.0.0.1:45102 - R:localhost/127.0.0.1:36189], consumerId 2
2024-02-05T19:01:09,581 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x3ba11345, L:/127.0.0.1:36189 - R:/127.0.0.1:45102]] Subscribing on topic persistent://sla-monitor/test/localhost:38465/__change_events / reader-042e829383. consumerId: 2
2024-02-05T19:01:09,584 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38465 doesn't exist.
2024-02-05T19:01:09,587 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 38465, tls-port = Optional[33821], broker url= pulsar://localhost:36189, broker tls url= pulsar+ssl://localhost:37677, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36189], brokerServicePortTls=Optional[37677], webServicePort=Optional[38465], webServicePortTls=Optional[33821], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:01:09,592 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38465/persistent/__change_events
2024-02-05T19:01:09,596 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38465/persistent/__change_events'
2024-02-05T19:01:09,605 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T19:01:09,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38465/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T19:01:09,610 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38465/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:01:09,616 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38465/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T19:01:09,619 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38465/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38465/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T19:01:09,620 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38465/__change_events - dedup is disabled
2024-02-05T19:01:09,630 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T19:01:09,639 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38465/__change_events][reader-042e829383] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:09,639 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38465/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T19:01:09,640 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38465/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38465/persistent/__change_events, cursor=reader-042e829383, ackPos=9:-1, readPos=9:0}
2024-02-05T19:01:09,646 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:45102] Created subscription on topic persistent://sla-monitor/test/localhost:38465/__change_events / reader-042e829383
2024-02-05T19:01:09,649 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38465/__change_events][reader-042e829383] Subscribed to topic on localhost/127.0.0.1:36189 -- consumer: 2
2024-02-05T19:01:09,793 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T19:01:09,795 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T19:01:09,796 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:01:09,797 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:01:09,829 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T19:01:09,830 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T19:01:09,854 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:01:09,855 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:01:09,859 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T19:01:09,861 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T19:01:09,884 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:01:09,885 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T19:01:09,886 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:01:09,888 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:01:09,890 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T19:01:09,891 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:01:09,904 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:01:09,904 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:01:09,909 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T19:01:09,912 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T19:01:09,924 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:01:09,924 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:01:09,924 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T19:01:09,926 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T19:01:09,926 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:01:09,930 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:01:09,959 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T19:01:09,972 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:01:09,972 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:01:09,986 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T19:01:09,996 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:10,016 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45321 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:01:10,062 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45321, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470018, versionId=1]. totalHandledRequests:1
2024-02-05T19:01:10,089 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45321, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470077, versionId=2]. totalHandledRequests:1
2024-02-05T19:01:10,093 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:10,107 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:01:10,112 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:01:10,114 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:01:10,133 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45321, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152470101, versionId=3]. totalHandledRequests:1
2024-02-05T19:01:10,138 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:10,145 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 11.0 ms
2024-02-05T19:01:10,156 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45321, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470134, versionId=4]. totalHandledRequests:1
2024-02-05T19:01:10,158 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:01:10,158 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T19:01:10,160 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 177
2024-02-05T19:01:10,160 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45321. Skipping this broker. Phase one
2024-02-05T19:01:10,161 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:45321. Skipping this broker. Phase two
2024-02-05T19:01:10,161 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38465 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:01:10,162 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T19:01:10,163 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:01:09 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 208
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:01:10,173 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38465, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470161, versionId=5]. totalHandledRequests:2
2024-02-05T19:01:10,187 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38465, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470173, versionId=6]. totalHandledRequests:2
2024-02-05T19:01:10,189 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:01:10,226 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x638601e1, L:/127.0.0.1:45118 - R:localhost/127.0.0.1:36189]] Connected to server
2024-02-05T19:01:10,230 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:45118] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:01:10,232 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-916502967e] Subscribing to topic on cnx [id: 0x638601e1, L:/127.0.0.1:45118 - R:localhost/127.0.0.1:36189], consumerId 4
2024-02-05T19:01:10,233 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x680d8d2d, L:/127.0.0.1:36189 - R:/127.0.0.1:45118]] Subscribing on topic persistent://public/test/__change_events / reader-916502967e. consumerId: 4
2024-02-05T19:01:10,247 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148] 
2024-02-05T19:01:10,250 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59d4d0e6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1db474f] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7b102c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59d4d0e6, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7752e392], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1db474f, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4a247771] 
2024-02-05T19:01:10,257 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-61ce30e3f5] Subscribing to topic on cnx [id: 0xa33c8e3d, L:/127.0.0.1:45102 - R:localhost/127.0.0.1:36189], consumerId 3
2024-02-05T19:01:10,259 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x3ba11345, L:/127.0.0.1:36189 - R:/127.0.0.1:45102]] Subscribing on topic persistent://public/test/__change_events / reader-61ce30e3f5. consumerId: 3
2024-02-05T19:01:10,262 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T19:01:10,262 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T19:01:10,270 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:01:10,275 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:01:10,280 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T19:01:10,283 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:01:10,294 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T19:01:10,298 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T19:01:10,306 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-61ce30e3f5] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:10,316 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:01:10,316 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T19:01:10,317 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-61ce30e3f5, ackPos=11:-1, readPos=11:0}
2024-02-05T19:01:10,319 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:45102] Created subscription on topic persistent://public/test/__change_events / reader-61ce30e3f5
2024-02-05T19:01:10,320 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-61ce30e3f5] Subscribed to topic on localhost/127.0.0.1:36189 -- consumer: 3
2024-02-05T19:01:10,327 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:01:10,329 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:01:10,330 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:01:10,331 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T19:01:10,335 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T19:01:10,342 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-916502967e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:10,342 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T19:01:10,342 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-916502967e, ackPos=11:-1, readPos=11:0}
2024-02-05T19:01:10,344 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:45118] Created subscription on topic persistent://public/test/__change_events / reader-916502967e
2024-02-05T19:01:10,345 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-916502967e] Subscribed to topic on localhost/127.0.0.1:36189 -- consumer: 4
2024-02-05T19:01:10,349 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:45118] Closing consumer: consumerId=4
2024-02-05T19:01:10,349 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-916502967e}, consumerId=4, consumerName=a40a3, address=/127.0.0.1:45118}
2024-02-05T19:01:10,350 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-916502967e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-916502967e, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:01:10,352 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-916502967e] Successfully closed dispatcher for reader
2024-02-05T19:01:10,352 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T19:01:10,354 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T19:01:10,357 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T19:01:10,360 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T19:01:10,361 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:45118] Closed consumer, consumerId=4
2024-02-05T19:01:10,362 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-916502967e] Closed consumer
2024-02-05T19:01:10,363 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T19:01:10,363 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T19:01:10,366 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T19:01:10,370 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:01:10,373 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:01:10,374 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:01:10,375 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:10,381 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45321. Skipping this broker. Phase one
2024-02-05T19:01:10,382 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38465, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152470173, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45321, sourceBroker=localhost:38465, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152470381, versionId=7]
2024-02-05T19:01:10,390 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45321, sourceBroker=localhost:38465, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152470381, versionId=7]. totalHandledRequests:6
2024-02-05T19:01:10,391 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:45321 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:45321, sourceBroker=localhost:38465, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152470381, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T19:01:10,392 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:01:10,393 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:01:10,395 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:01:10,396 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:01:10,397 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-61ce30e3f5}, consumerId=3, consumerName=3e8e1, address=/127.0.0.1:45102}
2024-02-05T19:01:10,398 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-61ce30e3f5}, consumerId=3, consumerName=3e8e1, address=/127.0.0.1:45102}
2024-02-05T19:01:10,398 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:36189] Broker notification of Closed consumer: 3
2024-02-05T19:01:10,399 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-61ce30e3f5] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-61ce30e3f5, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:01:10,399 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-61ce30e3f5] Closed connection [id: 0xa33c8e3d, L:/127.0.0.1:45102 - R:localhost/127.0.0.1:36189] -- Will try again in 0.1 s
2024-02-05T19:01:10,399 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-61ce30e3f5] Successfully closed dispatcher for reader
2024-02-05T19:01:10,400 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-61ce30e3f5] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-61ce30e3f5, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:01:10,400 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-61ce30e3f5] Successfully disconnected and closed subscription
2024-02-05T19:01:10,403 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:01:10,416 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T19:01:10,421 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:01:10,422 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:01:10,423 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-f2deaaac80] Subscribing to topic on cnx [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115], consumerId 5
2024-02-05T19:01:10,423 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-61ce30e3f5] Closed Consumer (not connected)
2024-02-05T19:01:10,424 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 32.0 ms
2024-02-05T19:01:10,426 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbf49540a, L:/127.0.0.1:36115 - R:/127.0.0.1:50950]] Subscribing on topic persistent://public/test/__change_events / reader-f2deaaac80. consumerId: 5
2024-02-05T19:01:10,426 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-61ce30e3f5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-61ce30e3f5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:10,434 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T19:01:10,441 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T19:01:10,442 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T19:01:10,451 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T19:01:10,457 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T19:01:10,458 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T19:01:10,462 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T19:01:10,462 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T19:01:10,462 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:01:10,466 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:01:10,476 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-f2deaaac80] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:01:10,477 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T19:01:10,477 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f2deaaac80, ackPos=14:-1, readPos=14:0}
2024-02-05T19:01:10,478 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50950] Created subscription on topic persistent://public/test/__change_events / reader-f2deaaac80
2024-02-05T19:01:10,479 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-f2deaaac80] Subscribed to topic on localhost/127.0.0.1:36115 -- consumer: 5
2024-02-05T19:01:10,501 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-61ce30e3f5] Reconnecting after timeout
2024-02-05T19:01:10,502 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-61ce30e3f5] Ignoring reconnection request (state: Closed)
2024-02-05T19:01:10,701 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T19:01:10,702 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 42.97%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 42.97%, msgThroughputEMA= 0.00, updatedAt= 1707152470700, reportedAt= 0
2024-02-05T19:01:10,798 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:01:10,798 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:01:11,799 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:01:11,799 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:01:12,800 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:01:12,801 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:01:13,495 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 3119.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T19:01:13,508 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:38465 registry has been deleted.
2024-02-05T19:01:13,508 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38465 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:01:13,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38465 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:01:13,511 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:13,512 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38465 was invalidated. state Releasing
2024-02-05T19:01:13,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:01:13,515 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38465. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:01:13,517 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38465
2024-02-05T19:01:13,526 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38465/0x00000000_0xffffffff.
2024-02-05T19:01:13,527 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38465/0x00000000_0xffffffff.
2024-02-05T19:01:13,528 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38465/0x00000000_0xffffffff.
2024-02-05T19:01:13,528 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.011 seconds
2024-02-05T19:01:13,530 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:01:13,533 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T19:01:13,533 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38465/persistent/__change_events] Closing managed ledger
2024-02-05T19:01:13,534 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:45102
2024-02-05T19:01:13,534 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] Disconnected
2024-02-05T19:01:13,534 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xa33c8e3d, L:/127.0.0.1:45102 ! R:localhost/127.0.0.1:36189] Disconnected
2024-02-05T19:01:13,535 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38465/__change_events, name=reader-042e829383}, consumerId=2, consumerName=403e2, address=/127.0.0.1:45102}
2024-02-05T19:01:13,535 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38465/__change_events][reader-042e829383] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38465/persistent/__change_events, cursor=reader-042e829383, ackPos=9:-1, readPos=9:0}]
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x638601e1, L:/127.0.0.1:45118 ! R:localhost/127.0.0.1:36189] Disconnected
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38465/__change_events] [reader-042e829383] Closed connection [id: 0xa33c8e3d, L:/127.0.0.1:45102 ! R:localhost/127.0.0.1:36189] -- Will try again in 0.1 s
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38465/__change_events][reader-042e829383] Successfully closed dispatcher for reader
2024-02-05T19:01:13,535 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:13,536 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:50958
2024-02-05T19:01:13,538 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-4c74025dd8}, consumerId=0, consumerName=14023, address=/127.0.0.1:50958}
2024-02-05T19:01:13,538 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38465/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T19:01:13,538 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c74025dd8] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4c74025dd8, ackPos=3:6, readPos=3:7}]
2024-02-05T19:01:13,538 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c74025dd8] Successfully closed dispatcher for reader
2024-02-05T19:01:13,539 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T19:01:13,539 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-4bdc5b9fc5}, consumerId=1, consumerName=e622c, address=/127.0.0.1:50958}
2024-02-05T19:01:13,540 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:01:13,540 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4c74025dd8] Closed connection [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:13,541 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4bdc5b9fc5] Closed connection [id: 0xcc14ac71, L:/127.0.0.1:50958 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:13,541 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:45118
2024-02-05T19:01:13,541 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:01:13,548 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36189
2024-02-05T19:01:13,549 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T19:01:13,551 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T19:01:13,551 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T19:01:13,552 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38465/__change_events] [reader-042e829383] Closed Consumer (not connected)
2024-02-05T19:01:13,552 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4bdc5b9fc5] Closed Consumer (not connected)
2024-02-05T19:01:13,552 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38465/__change_events with subscription name reader-042e829383 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38465/__change_events with subscription name reader-042e829383 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:13,553 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4c74025dd8] Closed Consumer (not connected)
2024-02-05T19:01:13,553 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4bdc5b9fc5 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4bdc5b9fc5 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:13,554 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4c74025dd8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4c74025dd8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:13,558 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:01:13,558 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:01:13,560 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:01:13,561 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:13,565 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:01:13,565 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:13,807 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:13,807 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38465 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:01:13,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38465 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:01:13,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38465]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:01:13,808 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:13,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:01:14,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:14,809 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38465 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:01:14,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38465 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:01:14,810 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38465]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:01:14,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:14,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:01:14,847 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:01:14,848 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:01:14,850 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:01:14,850 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:14,851 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:01:14,851 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:01:15,701 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 44.34%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.11%, msgThroughputEMA= 0.00, updatedAt= 1707152475700, reportedAt= 1707152470707
2024-02-05T19:01:15,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:15,811 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38465 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:01:15,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38465 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:01:15,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38465]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:01:15,812 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:15,813 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:01:16,813 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:01:16,813 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38465 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:01:16,813 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38465 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:01:16,814 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38465]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:01:16,814 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38465
2024-02-05T19:01:16,815 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38465 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:01:16,867 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:01:16,868 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:01:16,869 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:01:16,869 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:01:16,869 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T19:01:16,870 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T19:01:16,872 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T19:01:16,874 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T19:01:16,876 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T19:01:16,877 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T19:01:16,878 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T19:01:16,880 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T19:01:16,881 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:01:16,882 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:01:16,882 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:01:16,883 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45321
2024-02-05T19:01:16,885 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45321, sourceBroker=localhost:38465, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152470381, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T19:01:21,895 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45321 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T19:01:21,902 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45321 was invalidated. state Releasing
2024-02-05T19:01:21,902 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45321. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:01:21,903 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45321
2024-02-05T19:01:21,907 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45321/0x00000000_0xffffffff.
2024-02-05T19:01:21,915 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45321, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152481908, versionId=8]. totalHandledRequests:10
2024-02-05T19:01:21,916 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:01:21,916 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:01:21,916 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:01:21,916 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f2deaaac80}, consumerId=5, consumerName=d4295, address=/127.0.0.1:50950}
2024-02-05T19:01:21,916 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f2deaaac80}, consumerId=5, consumerName=d4295, address=/127.0.0.1:50950}
2024-02-05T19:01:21,917 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f2deaaac80] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f2deaaac80, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:01:21,917 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:36115] Broker notification of Closed consumer: 5
2024-02-05T19:01:21,917 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-f2deaaac80] Successfully closed dispatcher for reader
2024-02-05T19:01:21,917 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-f2deaaac80] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 - R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,917 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f2deaaac80] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f2deaaac80, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:01:21,917 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-f2deaaac80] Successfully disconnected and closed subscription
2024-02-05T19:01:21,918 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:01:21,922 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T19:01:21,924 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:01:21,925 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-f2deaaac80] Closed Consumer (not connected)
2024-02-05T19:01:21,926 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T19:01:21,926 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f2deaaac80 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f2deaaac80 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:21,933 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45321 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45321, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152481915, versionId=9]. totalHandledRequests:4
2024-02-05T19:01:21,934 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:01:21,935 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:01:21,936 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45321/0x00000000_0xffffffff.
2024-02-05T19:01:21,936 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:01:21,937 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45321/0x00000000_0xffffffff.
2024-02-05T19:01:21,938 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.034 seconds
2024-02-05T19:01:21,938 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:01:21,939 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:50950
2024-02-05T19:01:21,939 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T19:01:21,939 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] Disconnected
2024-02-05T19:01:21,939 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:01:21,939 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,940 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45321/persistent/__change_events] Closing managed ledger
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7a716ed3f7] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1fe0b9ec73] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,939 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-7a716ed3f7}, consumerId=0, consumerName=4898f, address=/127.0.0.1:50950}
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45321/__change_events] [reader-a77b59d674] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,940 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-e35ae600d3] Closed connection [id: 0x5d429feb, L:/127.0.0.1:50950 ! R:localhost/127.0.0.1:36115] -- Will try again in 0.1 s
2024-02-05T19:01:21,941 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a716ed3f7] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-7a716ed3f7, ackPos=3:6, readPos=3:9}]
2024-02-05T19:01:21,941 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-7a716ed3f7] Successfully closed dispatcher for reader
2024-02-05T19:01:21,941 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45321/__change_events, name=reader-a77b59d674}, consumerId=3, consumerName=2dc01, address=/127.0.0.1:50950}
2024-02-05T19:01:21,941 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45321/__change_events][reader-a77b59d674] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45321/persistent/__change_events, cursor=reader-a77b59d674, ackPos=7:-1, readPos=7:0}]
2024-02-05T19:01:21,942 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45321/__change_events][reader-a77b59d674] Successfully closed dispatcher for reader
2024-02-05T19:01:21,942 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-e35ae600d3}, consumerId=2, consumerName=fd280, address=/127.0.0.1:50950}
2024-02-05T19:01:21,942 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-1fe0b9ec73}, consumerId=1, consumerName=ba0a8, address=/127.0.0.1:50950}
2024-02-05T19:01:21,943 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45321/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T19:01:21,943 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T19:01:21,943 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T19:01:21,944 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:01:21,945 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:01:21,951 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36115
2024-02-05T19:01:21,951 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-e35ae600d3] Closed Consumer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-1fe0b9ec73] Closed Consumer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45321/__change_events] [reader-a77b59d674] Closed Consumer (not connected)
2024-02-05T19:01:21,952 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-7a716ed3f7] Closed Consumer (not connected)
2024-02-05T19:01:21,952 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-e35ae600d3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-e35ae600d3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:21,953 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1fe0b9ec73 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-1fe0b9ec73 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:21,953 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45321/__change_events with subscription name reader-a77b59d674 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45321/__change_events with subscription name reader-a77b59d674 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:21,954 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7a716ed3f7 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-7a716ed3f7 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:01:21,957 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T19:01:21,958 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:01:21,958 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T19:01:21,958 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:01:21,958 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:01:21,959 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:21,960 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:01:21,960 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:23,345 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:01:23,346 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:01:23,347 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:01:23,348 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:23,348 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:01:23,348 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:01:23,356 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:01:23,356 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:01:23,360 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T19:01:23,360 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T19:01:23,360 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T19:01:23,360 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T19:01:23,360 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T19:01:23,360 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T19:01:23,361 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T19:01:23,361 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T19:01:23,362 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6277551c
2024-02-05T19:01:23,362 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T19:01:23,362 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T19:01:23,362 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.153 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.715 s
[INFO] Finished at: 2024-02-05T19:01:23+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 13 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T19:01:54,190 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T19:01:55,203 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T19:01:55,205 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T19:01:55,685 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T19:01:55,686 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T19:01:55,687 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T19:01:55,687 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T19:01:55,688 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T19:01:55,689 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T19:01:55,706 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T19:01:55,707 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T19:01:55,707 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T19:01:55,708 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T19:01:55,709 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T19:01:55,709 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T19:01:55,710 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T19:01:55,711 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T19:01:55,711 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:01:55,712 - INFO  - [main:Environment@98] - Client environment:os.memory.free=22MB
2024-02-05T19:01:55,712 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T19:01:55,713 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T19:01:57,470 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T19:01:57,471 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T19:01:57,471 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T19:01:57,472 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T19:01:57,775 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T19:01:57,776 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T19:01:57,845 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T19:01:57,920 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T19:01:57,923 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:01:57,943 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T19:01:58,071 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T19:01:58,122 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T19:01:58,167 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T19:01:58,537 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T19:01:58,538 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T19:01:58,570 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T19:01:58,612 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34279, TLS: (none), listener: (none)
2024-02-05T19:01:58,860 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44495, TLS: OPENSSL, listener: (none)
2024-02-05T19:01:58,879 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T19:01:58,883 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:01:58,883 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:01:58,922 - INFO  - [main:Log@170] - Logging initialized @6906ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T19:01:59,776 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T19:01:59,814 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T19:01:59,814 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T19:01:59,817 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T19:02:00,532 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T19:02:01,743 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T19:02:02,975 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T19:02:03,327 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T19:02:03,465 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T19:02:03,610 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T19:02:03,611 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T19:02:03,613 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T19:02:03,634 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:33233}
2024-02-05T19:02:03,797 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:45249}
2024-02-05T19:02:03,798 - INFO  - [main:Server@415] - Started @11784ms
2024-02-05T19:02:03,798 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33233
2024-02-05T19:02:03,799 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45249
2024-02-05T19:02:03,807 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:02:03,809 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:02:03,973 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33233
2024-02-05T19:02:03,993 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T19:02:03,996 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:33233 is changing the role from null to Leader
2024-02-05T19:02:03,999 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33233).
2024-02-05T19:02:04,279 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33233 
2024-02-05T19:02:04,659 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T19:02:04,685 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:04,793 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:02:04,798 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:02:04,806 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T19:02:04,807 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T19:02:04,843 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T19:02:04,882 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T19:02:04,919 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T19:02:04,997 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T19:02:05,019 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T19:02:05,031 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T19:02:05,034 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T19:02:05,069 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:04 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 520
2024-02-05T19:02:05,079 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T19:02:05,267 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]] Connected to server
2024-02-05T19:02:05,299 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:40088] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:02:05,365 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,375 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,458 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T19:02:05,499 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:40088] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:40088, producerName=test-0-0, producerId=0}
2024-02-05T19:02:05,507 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,509 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T19:02:05,565 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,567 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f80dc176bb] Subscribing to topic on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279], consumerId 0
2024-02-05T19:02:05,580 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x391c1cb6, L:/127.0.0.1:34279 - R:/127.0.0.1:40088]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f80dc176bb. consumerId: 0
2024-02-05T19:02:05,607 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f80dc176bb] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:05,608 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:02:05,609 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f80dc176bb, ackPos=3:-1, readPos=3:0}
2024-02-05T19:02:05,636 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40088] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f80dc176bb
2024-02-05T19:02:05,642 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f80dc176bb] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 0
2024-02-05T19:02:05,657 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T19:02:05,658 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T19:02:05,660 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T19:02:05,660 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:02:05,697 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,721 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T19:02:05,722 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T19:02:05,724 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T19:02:05,726 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 49
2024-02-05T19:02:05,736 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,745 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T19:02:05,746 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T19:02:05,747 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:05 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T19:02:05,748 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T19:02:05,768 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,770 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,778 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T19:02:05,785 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:40088] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:40088, producerName=test-0-1, producerId=1}
2024-02-05T19:02:05,787 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,801 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,803 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d415faf713] Subscribing to topic on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279], consumerId 1
2024-02-05T19:02:05,807 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x391c1cb6, L:/127.0.0.1:34279 - R:/127.0.0.1:40088]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d415faf713. consumerId: 1
2024-02-05T19:02:05,834 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d415faf713] Created new subscription for 1
2024-02-05T19:02:05,835 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40088] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d415faf713
2024-02-05T19:02:05,836 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d415faf713] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 1
2024-02-05T19:02:05,853 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,854 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,863 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T19:02:05,870 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:40088] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:40088, producerName=test-0-2, producerId=2}
2024-02-05T19:02:05,871 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:05,887 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:02:05,913 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:02:05,919 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:33233 started the ownership monitor.
2024-02-05T19:02:05,936 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:05,938 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c09c146ada] Subscribing to topic on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279], consumerId 2
2024-02-05T19:02:05,940 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x391c1cb6, L:/127.0.0.1:34279 - R:/127.0.0.1:40088]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c09c146ada. consumerId: 2
2024-02-05T19:02:05,957 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c09c146ada] Created new subscription for 2
2024-02-05T19:02:05,957 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40088] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c09c146ada
2024-02-05T19:02:05,958 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c09c146ada] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 2
2024-02-05T19:02:05,959 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:33233 plays the leader now.
2024-02-05T19:02:05,963 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33233/__change_events
2024-02-05T19:02:05,964 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 55.08%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 55.08%, msgThroughputEMA= 0.00, updatedAt= 1707152525963, reportedAt= 0
2024-02-05T19:02:05,985 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T19:02:05,989 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:05,991 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:02:06,072 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33233/0x00000000_0xffffffff - localhost:33233.
2024-02-05T19:02:06,075 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33233/0x00000000_0xffffffff
2024-02-05T19:02:06,075 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33233
2024-02-05T19:02:06,077 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33233/__change_events][reader-45c06c9c8d] Subscribing to topic on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279], consumerId 3
2024-02-05T19:02:06,077 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33233/0x00000000_0xffffffff - localhost:33233.
2024-02-05T19:02:06,078 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33233
2024-02-05T19:02:06,079 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x391c1cb6, L:/127.0.0.1:34279 - R:/127.0.0.1:40088]] Subscribing on topic persistent://sla-monitor/test/localhost:33233/__change_events / reader-45c06c9c8d. consumerId: 3
2024-02-05T19:02:06,082 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33233/0x00000000_0xffffffff
2024-02-05T19:02:06,089 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33233/persistent/__change_events
2024-02-05T19:02:06,091 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33233 doesn't exist.
2024-02-05T19:02:06,092 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33233/persistent/__change_events'
2024-02-05T19:02:06,101 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T19:02:06,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33233/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T19:02:06,107 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33233/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:02:06,113 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33233/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T19:02:06,122 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33233/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33233/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T19:02:06,123 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33233/__change_events - dedup is disabled
2024-02-05T19:02:06,134 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T19:02:06,142 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33233/__change_events][reader-45c06c9c8d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:06,143 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33233/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T19:02:06,143 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33233/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33233/persistent/__change_events, cursor=reader-45c06c9c8d, ackPos=7:-1, readPos=7:0}
2024-02-05T19:02:06,145 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:40088] Created subscription on topic persistent://sla-monitor/test/localhost:33233/__change_events / reader-45c06c9c8d
2024-02-05T19:02:06,146 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33233/__change_events][reader-45c06c9c8d] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 3
2024-02-05T19:02:06,114 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 33233, tls-port = Optional[45249], broker url= pulsar://localhost:34279, broker tls url= pulsar+ssl://localhost:44495, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34279], brokerServicePortTls=Optional[44495], webServicePort=Optional[33233], webServicePortTls=Optional[45249], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:02:06,761 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T19:02:06,761 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T19:02:06,762 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T19:02:06,762 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T19:02:06,767 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T19:02:06,767 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T19:02:06,773 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T19:02:06,777 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T19:02:06,784 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T19:02:06,784 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T19:02:06,791 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T19:02:06,800 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T19:02:06,803 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T19:02:06,815 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T19:02:06,815 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T19:02:06,819 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T19:02:06,821 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33341, TLS: (none), listener: (none)
2024-02-05T19:02:06,824 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44725, TLS: OPENSSL, listener: (none)
2024-02-05T19:02:06,828 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T19:02:06,829 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:02:06,829 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T19:02:06,844 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T19:02:06,850 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T19:02:06,850 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T19:02:06,850 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T19:02:06,939 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4a842e8a{/,null,AVAILABLE}
2024-02-05T19:02:06,996 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:06,997 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:02:07,623 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/admin,null,AVAILABLE}
2024-02-05T19:02:07,998 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:07,998 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:02:08,889 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/admin/v2,null,AVAILABLE}
2024-02-05T19:02:09,000 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:09,000 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:02:09,123 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin/v3,null,AVAILABLE}
2024-02-05T19:02:09,188 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/lookup,null,AVAILABLE}
2024-02-05T19:02:09,261 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/topics,null,AVAILABLE}
2024-02-05T19:02:09,264 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/metrics,null,AVAILABLE}
2024-02-05T19:02:09,264 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6b909973{/static,null,AVAILABLE}
2024-02-05T19:02:09,266 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3af4b14e{HTTP/1.1, (http/1.1)}{0.0.0.0:46615}
2024-02-05T19:02:09,294 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@36b6ce5d{SSL, (ssl, http/1.1)}{0.0.0.0:44441}
2024-02-05T19:02:09,294 - INFO  - [main:Server@415] - Started @17281ms
2024-02-05T19:02:09,295 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:46615
2024-02-05T19:02:09,297 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44441
2024-02-05T19:02:09,304 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T19:02:09,305 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T19:02:09,319 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:46615
2024-02-05T19:02:09,320 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:46615 registry has been created.
2024-02-05T19:02:09,320 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:46615. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T19:02:09,324 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:46615 is changing the role from null to Follower
2024-02-05T19:02:09,328 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33233).
2024-02-05T19:02:09,330 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T19:02:09,346 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:46615 
2024-02-05T19:02:09,446 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 38
2024-02-05T19:02:09,468 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:09,470 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T19:02:09,472 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T19:02:09,483 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T19:02:09,487 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:46615/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:02:09,496 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341]] Connected to server
2024-02-05T19:02:09,502 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:57354] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:02:09,521 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]] Connected to server
2024-02-05T19:02:09,525 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:40104] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T19:02:09,526 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,538 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:40104] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:40104, producerName=test-0-3, producerId=0}
2024-02-05T19:02:09,540 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,555 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-edd0ef8cb6] Subscribing to topic on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279], consumerId 0
2024-02-05T19:02:09,557 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xb0c3f3f8, L:/127.0.0.1:34279 - R:/127.0.0.1:40104]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-edd0ef8cb6. consumerId: 0
2024-02-05T19:02:09,563 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-edd0ef8cb6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:09,563 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T19:02:09,564 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-edd0ef8cb6, ackPos=3:-1, readPos=3:0}
2024-02-05T19:02:09,566 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40104] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-edd0ef8cb6
2024-02-05T19:02:09,567 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-edd0ef8cb6] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 0
2024-02-05T19:02:09,570 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T19:02:09,571 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T19:02:09,602 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T19:02:09,611 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:09,612 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T19:02:09,613 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:02:09,616 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T19:02:09,617 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:46615/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:02:09,627 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 6
2024-02-05T19:02:09,634 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:09,636 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T19:02:09,637 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T19:02:09,640 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T19:02:09,641 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:46615/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T19:02:09,655 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,664 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:40104] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:40104, producerName=test-0-4, producerId=1}
2024-02-05T19:02:09,665 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,678 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c4144c66ec] Subscribing to topic on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279], consumerId 1
2024-02-05T19:02:09,679 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xb0c3f3f8, L:/127.0.0.1:34279 - R:/127.0.0.1:40104]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c4144c66ec. consumerId: 1
2024-02-05T19:02:09,692 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c4144c66ec] Created new subscription for 1
2024-02-05T19:02:09,692 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40104] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c4144c66ec
2024-02-05T19:02:09,693 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c4144c66ec] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 1
2024-02-05T19:02:09,713 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,720 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:40104] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:40104, producerName=test-0-5, producerId=2}
2024-02-05T19:02:09,721 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x224485e5, L:/127.0.0.1:40104 - R:localhost/127.0.0.1:34279]
2024-02-05T19:02:09,723 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T19:02:09,727 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T19:02:09,729 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:46615 plays a follower now.
2024-02-05T19:02:09,756 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:46615/__change_events
2024-02-05T19:02:09,791 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:46615/0x00000000_0xffffffff - localhost:46615.
2024-02-05T19:02:09,792 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:46615
2024-02-05T19:02:09,792 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:46615/0x00000000_0xffffffff
2024-02-05T19:02:09,793 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:46615/0x00000000_0xffffffff - localhost:46615.
2024-02-05T19:02:09,794 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:46615/0x00000000_0xffffffff
2024-02-05T19:02:09,795 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:46615
2024-02-05T19:02:09,798 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:46615 doesn't exist.
2024-02-05T19:02:09,800 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:46615/__change_events][reader-3075ef50f3] Subscribing to topic on cnx [id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341], consumerId 2
2024-02-05T19:02:09,802 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf4afaed8, L:/127.0.0.1:33341 - R:/127.0.0.1:57354]] Subscribing on topic persistent://sla-monitor/test/localhost:46615/__change_events / reader-3075ef50f3. consumerId: 2
2024-02-05T19:02:09,802 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 46615, tls-port = Optional[44441], broker url= pulsar://localhost:33341, broker tls url= pulsar+ssl://localhost:44725, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33341], brokerServicePortTls=Optional[44725], webServicePort=Optional[46615], webServicePortTls=Optional[44441], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T19:02:09,810 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:46615/persistent/__change_events
2024-02-05T19:02:09,813 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:46615/persistent/__change_events'
2024-02-05T19:02:09,823 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T19:02:09,825 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:46615/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T19:02:09,833 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:46615/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:02:09,837 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:46615/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T19:02:09,844 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:46615/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:46615/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T19:02:09,845 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:46615/__change_events - dedup is disabled
2024-02-05T19:02:09,852 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T19:02:09,859 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:46615/__change_events][reader-3075ef50f3] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:09,861 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:46615/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T19:02:09,861 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:46615/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:46615/persistent/__change_events, cursor=reader-3075ef50f3, ackPos=9:-1, readPos=9:0}
2024-02-05T19:02:09,863 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:57354] Created subscription on topic persistent://sla-monitor/test/localhost:46615/__change_events / reader-3075ef50f3
2024-02-05T19:02:09,864 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:46615/__change_events][reader-3075ef50f3] Subscribed to topic on localhost/127.0.0.1:33341 -- consumer: 2
2024-02-05T19:02:10,001 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:02:10,001 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T19:02:10,031 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T19:02:10,032 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T19:02:10,067 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T19:02:10,069 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T19:02:10,096 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:02:10,096 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T19:02:10,101 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T19:02:10,102 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T19:02:10,132 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:02:10,132 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T19:02:10,132 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T19:02:10,134 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T19:02:10,135 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:02:10,136 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:02:10,145 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:02:10,147 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T19:02:10,151 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T19:02:10,152 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T19:02:10,163 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:02:10,164 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T19:02:10,165 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T19:02:10,165 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T19:02:10,167 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:02:10,167 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T19:02:10,223 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T19:02:10,233 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:02:10,233 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T19:02:10,247 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T19:02:10,257 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:10,279 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:46615 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:02:10,344 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:02:10,328 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:46615, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530281, versionId=1]. totalHandledRequests:1
2024-02-05T19:02:10,366 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:46615, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530328, versionId=2]. totalHandledRequests:1
2024-02-05T19:02:10,373 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:10,387 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 143
2024-02-05T19:02:10,395 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b30f6a7c21] Subscribing to topic on cnx [id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341], consumerId 3
2024-02-05T19:02:10,397 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf4afaed8, L:/127.0.0.1:33341 - R:/127.0.0.1:57354]] Subscribing on topic persistent://public/test/__change_events / reader-b30f6a7c21. consumerId: 3
2024-02-05T19:02:10,399 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T19:02:10,405 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T19:02:10,408 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T19:02:10,415 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T19:02:10,416 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T19:02:10,423 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:02:10,427 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T19:02:10,433 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T19:02:10,435 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:02:10,448 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152530433, versionId=3]. totalHandledRequests:1
2024-02-05T19:02:10,451 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T19:02:10,454 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:02:10,456 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T19:02:10,457 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:02:10,460 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:02:10,468 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T19:02:10,472 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:02:10,475 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 23.0 ms
2024-02-05T19:02:10,483 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530452, versionId=4]. totalHandledRequests:1
2024-02-05T19:02:10,484 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:46615. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T19:02:10,484 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:57354][persistent://public/test/__change_events][reader-b30f6a7c21] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:46615. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T19:02:10,487 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:02:10,487 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:46615. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T19:02:10,489 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T19:02:10,490 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-b30f6a7c21] Failed to subscribe to topic on localhost/127.0.0.1:33341
2024-02-05T19:02:10,490 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-b30f6a7c21] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:46615. Please redo the lookup. Request is denied: namespace=public/test","reqId":742431259798016396, "remote":"localhost/127.0.0.1:33341", "local":"/127.0.0.1:57354"}
2024-02-05T19:02:10,490 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 99
2024-02-05T19:02:10,490 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-b30f6a7c21] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:46615. Please redo the lookup. Request is denied: namespace=public/test","reqId":742431259798016396, "remote":"localhost/127.0.0.1:33341", "local":"/127.0.0.1:57354"} -- Will try again in 0.1 s
2024-02-05T19:02:10,491 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T19:02:10,492 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:19:02:10 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 275
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:02:10,592 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-b30f6a7c21] Reconnecting after connection was closed
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02] 
2024-02-05T19:02:10,599 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33233. Skipping this broker. Phase one
2024-02-05T19:02:10,599 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:46615. Skipping this broker. Phase one
2024-02-05T19:02:10,600 - INFO  - [pulsar-io-64-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:46615 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T19:02:10,607 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:46615, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530600, versionId=5]. totalHandledRequests:2
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3c477cc2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ba24766] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3c477cc2, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d70db10], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ba24766, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@30bd43a] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3c477cc2, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d70db10, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d19f5], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ba24766, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@30bd43a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4dfde761] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3c477cc2, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d70db10, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d19f5, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@160e0d95], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ba24766, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@30bd43a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4dfde761, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf9b16a] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10b25361, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@500acbc1, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3c477cc2, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d70db10, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d19f5, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@160e0d95, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@27f7fb51], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76f23e02, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3e6c1935, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ba24766, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@30bd43a, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4dfde761, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4bf9b16a, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@513d621] 
2024-02-05T19:02:10,620 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b30f6a7c21] Subscribing to topic on cnx [id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341], consumerId 3
2024-02-05T19:02:10,622 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf4afaed8, L:/127.0.0.1:33341 - R:/127.0.0.1:57354]] Subscribing on topic persistent://public/test/__change_events / reader-b30f6a7c21. consumerId: 3
2024-02-05T19:02:10,622 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:02:10,623 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:46615, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530607, versionId=6]. totalHandledRequests:6
2024-02-05T19:02:10,631 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T19:02:10,636 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T19:02:10,637 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T19:02:10,647 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T19:02:10,648 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T19:02:10,649 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T19:02:10,655 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T19:02:10,656 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T19:02:10,656 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:02:10,660 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:02:10,664 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fdf17ff369] Subscribing to topic on cnx [id: 0x32f82887, L:/127.0.0.1:57354 - R:localhost/127.0.0.1:33341], consumerId 4
2024-02-05T19:02:10,669 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf4afaed8, L:/127.0.0.1:33341 - R:/127.0.0.1:57354]] Subscribing on topic persistent://public/test/__change_events / reader-fdf17ff369. consumerId: 4
!!!!!!!!! FAILURE-- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T19:02:10,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-b30f6a7c21] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:10,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T19:02:10,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b30f6a7c21, ackPos=13:-1, readPos=13:0}
2024-02-05T19:02:10,676 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57354] Created subscription on topic persistent://public/test/__change_events / reader-b30f6a7c21
2024-02-05T19:02:10,678 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-b30f6a7c21] Subscribed to topic on localhost/127.0.0.1:33341 -- consumer: 3
2024-02-05T19:02:10,682 - INFO  - [pulsar-io-64-3:ServerCnx@2007] - [/127.0.0.1:57354] Closing consumer: consumerId=3
2024-02-05T19:02:10,683 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b30f6a7c21}, consumerId=3, consumerName=2982d, address=/127.0.0.1:57354}
2024-02-05T19:02:10,684 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b30f6a7c21] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b30f6a7c21, ackPos=13:-1, readPos=13:0}]
2024-02-05T19:02:10,685 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fdf17ff369] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:10,686 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T19:02:10,686 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fdf17ff369, ackPos=13:-1, readPos=13:0}
2024-02-05T19:02:10,686 - INFO  - [main:TestRetrySupport@70] - Detected test failure in test ExtensibleLoadManagerImplTest.testGetMetrics, currentSetupNumber=1
2024-02-05T19:02:10,686 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-b30f6a7c21] Successfully closed dispatcher for reader
2024-02-05T19:02:10,695 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57354] Created subscription on topic persistent://public/test/__change_events / reader-fdf17ff369
2024-02-05T19:02:10,696 - INFO  - [pulsar-io-64-3:ServerCnx@2043] - [/127.0.0.1:57354] Closed consumer, consumerId=3
2024-02-05T19:02:10,697 - INFO  - [pulsar-io-64-2:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-b30f6a7c21] Closed consumer
2024-02-05T19:02:10,700 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T19:02:10,700 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fdf17ff369] Subscribed to topic on localhost/127.0.0.1:33341 -- consumer: 4
2024-02-05T19:02:10,702 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:02:10,703 - INFO  - [pulsar-io-64-3:ServerCnx@2007] - [/127.0.0.1:57354] Closing consumer: consumerId=4
2024-02-05T19:02:10,703 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fdf17ff369}, consumerId=4, consumerName=84248, address=/127.0.0.1:57354}
2024-02-05T19:02:10,705 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fdf17ff369] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fdf17ff369, ackPos=13:-1, readPos=13:0}]
2024-02-05T19:02:10,705 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fdf17ff369] Successfully closed dispatcher for reader
2024-02-05T19:02:10,707 - INFO  - [pulsar-io-64-3:ServerCnx@2043] - [/127.0.0.1:57354] Closed consumer, consumerId=4
2024-02-05T19:02:10,708 - INFO  - [pulsar-io-64-2:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-fdf17ff369] Closed consumer
2024-02-05T19:02:10,708 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T19:02:10,713 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3af4b14e{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:02:10,718 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@36b6ce5d{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:02:10,718 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:02:10,719 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6b909973{/static,null,STOPPED}
2024-02-05T19:02:10,721 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/metrics,null,STOPPED}
2024-02-05T19:02:10,737 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/topics,null,STOPPED}
2024-02-05T19:02:10,739 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/lookup,null,STOPPED}
2024-02-05T19:02:10,743 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin/v3,null,STOPPED}
2024-02-05T19:02:10,750 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/admin/v2,null,STOPPED}
2024-02-05T19:02:10,753 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/admin,null,STOPPED}
2024-02-05T19:02:10,757 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4a842e8a{/,null,STOPPED}
2024-02-05T19:02:10,761 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:02:10,764 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:02:10,765 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:02:10,766 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:10,769 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33233. Skipping this broker. Phase one
2024-02-05T19:02:10,772 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:46615, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152530607, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33233, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152530771, versionId=7]
2024-02-05T19:02:10,781 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33233, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152530771, versionId=7]. totalHandledRequests:7
2024-02-05T19:02:10,782 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:02:10,782 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T19:02:10,783 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:02:10,783 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:02:10,783 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:33233 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:33233, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152530771, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T19:02:10,785 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T19:02:10,786 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:02:10,792 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:02:10,794 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:02:10,796 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 14.0 ms
2024-02-05T19:02:10,797 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T19:02:10,825 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T19:02:10,827 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b915f617e4] Subscribing to topic on cnx [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279], consumerId 4
2024-02-05T19:02:10,828 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x391c1cb6, L:/127.0.0.1:34279 - R:/127.0.0.1:40088]] Subscribing on topic persistent://public/test/__change_events / reader-b915f617e4. consumerId: 4
2024-02-05T19:02:10,839 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T19:02:10,843 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T19:02:10,844 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T19:02:10,848 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T19:02:10,852 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T19:02:10,853 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T19:02:10,857 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T19:02:10,858 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T19:02:10,858 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T19:02:10,863 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T19:02:10,871 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-b915f617e4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T19:02:10,872 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T19:02:10,872 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b915f617e4, ackPos=14:-1, readPos=14:0}
2024-02-05T19:02:10,874 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:40088] Created subscription on topic persistent://public/test/__change_events / reader-b915f617e4
2024-02-05T19:02:10,874 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-b915f617e4] Subscribed to topic on localhost/127.0.0.1:34279 -- consumer: 4
2024-02-05T19:02:10,908 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T19:02:10,909 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 42.97%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 42.97%, msgThroughputEMA= 0.00, updatedAt= 1707152530907, reportedAt= 0
2024-02-05T19:02:11,002 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:02:11,003 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:02:12,004 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:02:12,005 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:02:13,005 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T19:02:13,006 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T19:02:13,794 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 3025.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T19:02:13,800 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:46615 registry has been deleted.
2024-02-05T19:02:13,801 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:46615 was invalidated. state Releasing
2024-02-05T19:02:13,801 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:46615 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:02:13,803 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:46615. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:02:13,804 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:46615 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:02:13,804 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:46615
2024-02-05T19:02:13,804 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:13,806 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:02:13,815 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:46615/0x00000000_0xffffffff.
2024-02-05T19:02:13,816 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:46615/0x00000000_0xffffffff.
2024-02-05T19:02:13,818 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:46615/0x00000000_0xffffffff.
2024-02-05T19:02:13,818 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.014 seconds
2024-02-05T19:02:13,820 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:02:13,824 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x32f82887, L:/127.0.0.1:57354 ! R:localhost/127.0.0.1:33341] Disconnected
2024-02-05T19:02:13,826 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:46615/__change_events] [reader-3075ef50f3] Closed connection [id: 0x32f82887, L:/127.0.0.1:57354 ! R:localhost/127.0.0.1:33341] -- Will try again in 0.1 s
2024-02-05T19:02:13,828 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] Disconnected
2024-02-05T19:02:13,828 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T19:02:13,828 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:13,829 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:13,829 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:13,829 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:46615/persistent/__change_events] Closing managed ledger
2024-02-05T19:02:13,829 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-edd0ef8cb6] Closed connection [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:13,829 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c4144c66ec] Closed connection [id: 0x224485e5, L:/127.0.0.1:40104 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:13,831 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:57354
2024-02-05T19:02:13,831 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:40104
2024-02-05T19:02:13,832 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:46615/__change_events, name=reader-3075ef50f3}, consumerId=2, consumerName=c01e6, address=/127.0.0.1:57354}
2024-02-05T19:02:13,832 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-edd0ef8cb6}, consumerId=0, consumerName=b65f7, address=/127.0.0.1:40104}
2024-02-05T19:02:13,832 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:46615/__change_events][reader-3075ef50f3] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:46615/persistent/__change_events, cursor=reader-3075ef50f3, ackPos=9:-1, readPos=9:0}]
2024-02-05T19:02:13,833 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:46615/__change_events][reader-3075ef50f3] Successfully closed dispatcher for reader
2024-02-05T19:02:13,833 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-edd0ef8cb6] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-edd0ef8cb6, ackPos=3:6, readPos=3:7}]
2024-02-05T19:02:13,833 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-edd0ef8cb6] Successfully closed dispatcher for reader
2024-02-05T19:02:13,834 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-c4144c66ec}, consumerId=1, consumerName=a1d21, address=/127.0.0.1:40104}
2024-02-05T19:02:13,834 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:46615/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T19:02:13,835 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T19:02:13,837 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:02:13,838 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:02:13,846 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33341
2024-02-05T19:02:13,847 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T19:02:13,848 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T19:02:13,848 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T19:02:13,849 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:46615/__change_events] [reader-3075ef50f3] Closed Consumer (not connected)
2024-02-05T19:02:13,850 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:46615/__change_events with subscription name reader-3075ef50f3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:46615/__change_events with subscription name reader-3075ef50f3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:13,850 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-edd0ef8cb6] Closed Consumer (not connected)
2024-02-05T19:02:13,851 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c4144c66ec] Closed Consumer (not connected)
2024-02-05T19:02:13,853 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-edd0ef8cb6 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-edd0ef8cb6 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:13,854 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c4144c66ec was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c4144c66ec was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:13,860 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:02:13,860 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:02:13,865 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:02:13,866 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:13,873 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:02:13,874 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:14,008 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:14,008 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:46615 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:02:14,009 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:46615 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:02:14,009 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:46615]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:02:14,009 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:14,011 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:02:15,009 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:15,010 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:46615 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:02:15,010 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:46615 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:02:15,010 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:46615]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:02:15,011 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:15,011 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:02:15,142 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:02:15,143 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:02:15,145 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:02:15,146 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:15,147 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:02:15,147 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:02:15,908 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 44.53%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.13%, msgThroughputEMA= 0.00, updatedAt= 1707152535907, reportedAt= 1707152530919
2024-02-05T19:02:16,011 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:16,011 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:46615 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:02:16,012 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:46615 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:02:16,012 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:46615]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:02:16,012 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:16,013 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:02:17,013 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T19:02:17,013 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:46615 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T19:02:17,013 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:46615 with delay:0 secs. Pending clean jobs:1.
2024-02-05T19:02:17,014 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:46615]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T19:02:17,014 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46615
2024-02-05T19:02:17,014 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46615 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T19:02:17,161 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T19:02:17,162 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T19:02:17,163 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T19:02:17,163 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T19:02:17,163 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T19:02:17,164 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T19:02:17,166 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T19:02:17,168 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T19:02:17,170 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T19:02:17,172 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T19:02:17,173 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T19:02:17,175 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T19:02:17,176 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T19:02:17,177 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T19:02:17,177 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T19:02:17,178 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33233
2024-02-05T19:02:17,180 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33233, sourceBroker=localhost:46615, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152530771, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T19:02:22,191 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33233 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T19:02:22,198 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33233 was invalidated. state Releasing
2024-02-05T19:02:22,198 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33233. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T19:02:22,199 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33233
2024-02-05T19:02:22,215 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33233, splitServiceUnitToDestBroker=null, force=true, timestamp=1707152542203, versionId=8]. totalHandledRequests:10
2024-02-05T19:02:22,216 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T19:02:22,217 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b915f617e4}, consumerId=4, consumerName=bcf21, address=/127.0.0.1:40088}
2024-02-05T19:02:22,217 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b915f617e4}, consumerId=4, consumerName=bcf21, address=/127.0.0.1:40088}
2024-02-05T19:02:22,218 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b915f617e4] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b915f617e4, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:02:22,218 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-b915f617e4] Successfully closed dispatcher for reader
2024-02-05T19:02:22,218 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b915f617e4] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b915f617e4, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:02:22,219 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:34279] Broker notification of Closed consumer: 4
2024-02-05T19:02:22,219 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-b915f617e4] Successfully disconnected and closed subscription
2024-02-05T19:02:22,219 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-b915f617e4] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 - R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,219 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T19:02:22,219 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T19:02:22,219 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T19:02:22,223 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T19:02:22,224 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T19:02:22,225 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-b915f617e4] Closed Consumer (not connected)
2024-02-05T19:02:22,226 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T19:02:22,226 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b915f617e4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b915f617e4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:22,233 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33233 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33233, splitServiceUnitToDestBroker=null, force=false, timestamp=1707152542215, versionId=9]. totalHandledRequests:4
2024-02-05T19:02:22,233 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T19:02:22,235 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33233/0x00000000_0xffffffff.
2024-02-05T19:02:22,236 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33233/0x00000000_0xffffffff.
2024-02-05T19:02:22,237 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T19:02:22,237 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33233/0x00000000_0xffffffff.
2024-02-05T19:02:22,237 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.038 seconds
2024-02-05T19:02:22,237 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T19:02:22,238 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T19:02:22,239 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:40088
2024-02-05T19:02:22,239 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-f80dc176bb}, consumerId=0, consumerName=2e641, address=/127.0.0.1:40088}
2024-02-05T19:02:22,239 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f80dc176bb] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f80dc176bb, ackPos=3:6, readPos=3:9}]
2024-02-05T19:02:22,240 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f80dc176bb] Successfully closed dispatcher for reader
2024-02-05T19:02:22,240 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33233/__change_events, name=reader-45c06c9c8d}, consumerId=3, consumerName=d72a2, address=/127.0.0.1:40088}
2024-02-05T19:02:22,240 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33233/__change_events][reader-45c06c9c8d] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33233/persistent/__change_events, cursor=reader-45c06c9c8d, ackPos=7:-1, readPos=7:0}]
2024-02-05T19:02:22,241 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33233/__change_events][reader-45c06c9c8d] Successfully closed dispatcher for reader
2024-02-05T19:02:22,241 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-c09c146ada}, consumerId=2, consumerName=c974d, address=/127.0.0.1:40088}
2024-02-05T19:02:22,242 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d415faf713}, consumerId=1, consumerName=54809, address=/127.0.0.1:40088}
2024-02-05T19:02:22,242 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T19:02:22,243 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T19:02:22,243 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33233/persistent/__change_events] Closing managed ledger
2024-02-05T19:02:22,244 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] Disconnected
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f80dc176bb] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d415faf713] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33233/__change_events] [reader-45c06c9c8d] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,245 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c09c146ada] Closed connection [id: 0xab10b87a, L:/127.0.0.1:40088 ! R:localhost/127.0.0.1:34279] -- Will try again in 0.1 s
2024-02-05T19:02:22,248 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T19:02:22,248 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33233/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T19:02:22,249 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T19:02:22,250 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T19:02:22,251 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T19:02:22,257 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34279
2024-02-05T19:02:22,257 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T19:02:22,257 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T19:02:22,258 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T19:02:22,258 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f80dc176bb] Closed Consumer (not connected)
2024-02-05T19:02:22,258 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c09c146ada] Closed Consumer (not connected)
2024-02-05T19:02:22,258 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d415faf713] Closed Consumer (not connected)
2024-02-05T19:02:22,258 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33233/__change_events] [reader-45c06c9c8d] Closed Consumer (not connected)
2024-02-05T19:02:22,258 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f80dc176bb was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f80dc176bb was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:22,259 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c09c146ada was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c09c146ada was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:22,259 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d415faf713 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d415faf713 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:22,260 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33233/__change_events with subscription name reader-45c06c9c8d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33233/__change_events with subscription name reader-45c06c9c8d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T19:02:22,263 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T19:02:22,263 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T19:02:22,263 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T19:02:22,263 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T19:02:22,264 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:02:22,264 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:22,265 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T19:02:22,266 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:23,550 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T19:02:23,550 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T19:02:23,552 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T19:02:23,552 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:23,552 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T19:02:23,552 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T19:02:23,560 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T19:02:23,560 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T19:02:23,564 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T19:02:23,564 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T19:02:23,564 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T19:02:23,564 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T19:02:23,564 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 192 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T19:02:23,565 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T19:02:23,565 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T19:02:23,565 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@4d31ff3
2024-02-05T19:02:23,565 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T19:02:23,566 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T19:02:23,566 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 31.223 s <<< FAILURE! - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[ERROR] org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics  Time elapsed: 0.167 s  <<< FAILURE!
java.lang.AssertionError: Sets differ: expected [dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
	at org.testng.Assert.fail(Assert.java:110)
	at org.testng.Assert.assertEquals(Assert.java:2036)
	at org.testng.Assert.assertEquals(Assert.java:1963)
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics(ExtensibleLoadManagerImplTest.java:1018)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)
	at org.testng.internal.invokers.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:47)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:76)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:11)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   ExtensibleLoadManagerImplTest.testGetMetrics:1018 Sets differ: expected [dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  57.137 s
[INFO] Finished at: 2024-02-05T19:02:24+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.1.0:test (default-test) on project pulsar-broker: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
Exited after loop #14
