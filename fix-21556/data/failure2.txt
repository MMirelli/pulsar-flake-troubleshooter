[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:03:19,191 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:03:23,323 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:03:23,332 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:03:25,404 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:03:25,416 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:03:25,417 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:03:25,418 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:03:25,428 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:03:25,429 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:03:25,554 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:03:25,561 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:03:25,564 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:03:25,564 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:03:25,565 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:03:25,595 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:03:25,596 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:03:25,605 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:03:25,606 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:03:25,606 - INFO  - [main:Environment@98] - Client environment:os.memory.free=12MB
2024-02-05T18:03:25,607 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:03:25,618 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:03:36,401 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:03:36,409 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:03:36,410 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:03:36,411 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:03:38,579 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:03:38,583 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:03:39,234 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:03:39,773 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:03:39,794 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:03:39,909 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:03:40,687 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:03:40,883 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:03:41,196 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:03:43,489 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:03:43,496 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:03:43,630 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:03:43,870 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42775, TLS: (none), listener: (none)
2024-02-05T18:03:45,320 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44153, TLS: OPENSSL, listener: (none)
2024-02-05T18:03:45,434 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:03:45,466 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:03:45,468 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:03:45,601 - INFO  - [main:Log@170] - Logging initialized @37104ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:03:50,865 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:03:50,978 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:03:50,979 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:03:50,989 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:03:55,346 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/,null,AVAILABLE}
2024-02-05T18:04:02,674 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin,null,AVAILABLE}
2024-02-05T18:04:11,401 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/admin/v2,null,AVAILABLE}
2024-02-05T18:04:57,144 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3487947c{/admin/v3,null,AVAILABLE}
2024-02-05T18:04:57,836 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/lookup,null,AVAILABLE}
2024-02-05T18:04:58,334 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/topics,null,AVAILABLE}
2024-02-05T18:04:58,345 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/metrics,null,AVAILABLE}
2024-02-05T18:04:58,354 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@332fa1c{/static,null,AVAILABLE}
2024-02-05T18:04:58,412 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@47ae6c18{HTTP/1.1, (http/1.1)}{0.0.0.0:39281}
2024-02-05T18:04:59,125 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@79ee779c{SSL, (ssl, http/1.1)}{0.0.0.0:39055}
2024-02-05T18:04:59,135 - INFO  - [main:Server@415] - Started @110640ms
2024-02-05T18:04:59,141 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39281
2024-02-05T18:04:59,155 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39055
2024-02-05T18:04:59,188 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:04:59,191 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:05:00,006 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39281
2024-02-05T18:05:00,031 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:05:00,037 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39281).
2024-02-05T18:05:00,041 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39281 is changing the role from null to Leader
2024-02-05T18:05:01,011 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39281 
2024-02-05T18:05:02,724 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:05:02,807 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:02,966 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:05:02,970 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:05:02,983 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:05:02,985 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:05:03,073 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:05:03,142 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:05:03,185 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:05:03,316 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:05:03,350 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:05:03,361 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:05:03,364 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:05:03,394 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:05:03,404 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:02 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 1141
2024-02-05T18:05:03,611 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]] Connected to server
2024-02-05T18:05:03,656 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:53416] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:05:03,717 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:03,726 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:03,820 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:05:03,861 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:53416] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:53416, producerName=test-0-0, producerId=0}
2024-02-05T18:05:03,872 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:03,874 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:05:03,956 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:03,958 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-cf0c6f93f9] Subscribing to topic on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775], consumerId 0
2024-02-05T18:05:03,971 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xa1b05847, L:/127.0.0.1:42775 - R:/127.0.0.1:53416]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-cf0c6f93f9. consumerId: 0
2024-02-05T18:05:04,005 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-cf0c6f93f9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:04,007 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:05:04,007 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-cf0c6f93f9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:05:04,039 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:53416] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-cf0c6f93f9
2024-02-05T18:05:04,045 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-cf0c6f93f9] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 0
2024-02-05T18:05:04,060 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.013 seconds
2024-02-05T18:05:04,062 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:05:04,064 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:05:04,064 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:05:04,111 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,136 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:05:04,137 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:05:04,139 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:05:04,142 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:04 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:05:04,157 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,167 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:05:04,169 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:05:04,170 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:04 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:05:04,171 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:05:04,198 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,200 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:04,210 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:05:04,218 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:53416] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:53416, producerName=test-0-1, producerId=1}
2024-02-05T18:05:04,220 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:04,237 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,239 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-afb25be001] Subscribing to topic on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775], consumerId 1
2024-02-05T18:05:04,242 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xa1b05847, L:/127.0.0.1:42775 - R:/127.0.0.1:53416]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-afb25be001. consumerId: 1
2024-02-05T18:05:04,274 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-afb25be001] Created new subscription for 1
2024-02-05T18:05:04,276 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53416] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-afb25be001
2024-02-05T18:05:04,283 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-afb25be001] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 1
2024-02-05T18:05:04,307 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,309 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:04,315 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:05:04,322 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:53416] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:53416, producerName=test-0-2, producerId=2}
2024-02-05T18:05:04,323 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:04,337 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:05:04,356 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:05:04,364 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39281 started the ownership monitor.
2024-02-05T18:05:04,379 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:04,381 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19a2f9c524] Subscribing to topic on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775], consumerId 2
2024-02-05T18:05:04,382 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xa1b05847, L:/127.0.0.1:42775 - R:/127.0.0.1:53416]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-19a2f9c524. consumerId: 2
2024-02-05T18:05:04,395 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19a2f9c524] Created new subscription for 2
2024-02-05T18:05:04,395 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53416] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-19a2f9c524
2024-02-05T18:05:04,396 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-19a2f9c524] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 2
2024-02-05T18:05:04,397 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39281 plays the leader now.
2024-02-05T18:05:04,401 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 48.44%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 48.44%, msgThroughputEMA= 0.00, updatedAt= 1707149104400, reportedAt= 0
2024-02-05T18:05:04,410 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39281/__change_events
2024-02-05T18:05:04,416 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:05:04,420 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:04,421 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:04,544 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39281/__change_events][reader-d8e9cc4776] Subscribing to topic on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775], consumerId 3
2024-02-05T18:05:04,547 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xa1b05847, L:/127.0.0.1:42775 - R:/127.0.0.1:53416]] Subscribing on topic persistent://sla-monitor/test/localhost:39281/__change_events / reader-d8e9cc4776. consumerId: 3
2024-02-05T18:05:04,551 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39281/0x00000000_0xffffffff - localhost:39281.
2024-02-05T18:05:04,556 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39281/0x00000000_0xffffffff
2024-02-05T18:05:04,556 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39281/persistent/__change_events
2024-02-05T18:05:04,558 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39281
2024-02-05T18:05:04,559 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39281/persistent/__change_events'
2024-02-05T18:05:04,559 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39281/0x00000000_0xffffffff - localhost:39281.
2024-02-05T18:05:04,561 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39281/0x00000000_0xffffffff
2024-02-05T18:05:04,562 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39281
2024-02-05T18:05:04,566 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:05:04,567 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39281/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:05:04,574 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39281/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:05:04,579 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39281/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:05:04,581 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39281/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39281/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:05:04,582 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39281/__change_events - dedup is disabled
2024-02-05T18:05:04,591 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:05:04,596 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39281/__change_events][reader-d8e9cc4776] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:04,596 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39281/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:05:04,597 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39281/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39281/persistent/__change_events, cursor=reader-d8e9cc4776, ackPos=7:-1, readPos=7:0}
2024-02-05T18:05:04,599 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:53416] Created subscription on topic persistent://sla-monitor/test/localhost:39281/__change_events / reader-d8e9cc4776
2024-02-05T18:05:04,600 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39281 doesn't exist.
2024-02-05T18:05:04,600 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39281/__change_events][reader-d8e9cc4776] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 3
2024-02-05T18:05:04,620 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=88, bootstrap service port = 39281, tls-port = Optional[39055], broker url= pulsar://localhost:42775, broker tls url= pulsar+ssl://localhost:44153, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[42775], brokerServicePortTls=Optional[44153], webServicePort=Optional[39281], webServicePortTls=Optional[39055], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:05:05,154 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:05:05,154 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:05:05,154 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:05:05,154 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:05:05,159 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:05:05,160 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:05:05,164 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:05:05,168 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:05:05,178 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:05:05,178 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:05:05,185 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:05:05,188 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:05:05,190 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:05:05,199 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:05:05,200 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:05:05,209 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:05:05,212 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36117, TLS: (none), listener: (none)
2024-02-05T18:05:05,216 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44995, TLS: OPENSSL, listener: (none)
2024-02-05T18:05:05,224 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:05:05,227 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:05:05,228 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:05:05,277 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:05:05,283 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:05:05,284 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:05:05,284 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:05:05,393 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:05:05,422 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:05,422 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:06,327 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:05:06,423 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:06,424 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:07,425 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:07,426 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:07,800 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:05:08,172 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:05:08,387 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:05:08,427 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:08,427 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:08,608 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:05:08,609 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:05:08,609 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:05:08,611 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:38763}
2024-02-05T18:05:08,628 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:34233}
2024-02-05T18:05:08,628 - INFO  - [main:Server@415] - Started @120137ms
2024-02-05T18:05:08,629 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:38763
2024-02-05T18:05:08,631 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34233
2024-02-05T18:05:08,634 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:05:08,635 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:05:08,648 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:38763
2024-02-05T18:05:08,654 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:38763 registry has been created.
2024-02-05T18:05:08,654 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:38763. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:05:08,658 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:38763 is changing the role from null to Follower
2024-02-05T18:05:08,661 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39281).
2024-02-05T18:05:08,669 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:05:08,728 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:38763 
2024-02-05T18:05:08,923 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:08 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 61
2024-02-05T18:05:08,944 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:08,947 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:05:08,948 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:05:08,963 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:08 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 32
2024-02-05T18:05:08,966 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38763/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:05:08,977 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117]] Connected to server
2024-02-05T18:05:08,983 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:52228] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:05:09,005 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]] Connected to server
2024-02-05T18:05:09,010 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:53418] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:05:09,011 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,023 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53418] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:53418, producerName=test-0-3, producerId=0}
2024-02-05T18:05:09,024 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,047 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5ded669562] Subscribing to topic on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775], consumerId 0
2024-02-05T18:05:09,056 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x83b9683e, L:/127.0.0.1:42775 - R:/127.0.0.1:53418]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5ded669562. consumerId: 0
2024-02-05T18:05:09,064 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5ded669562] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:09,065 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:05:09,065 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5ded669562, ackPos=3:-1, readPos=3:0}
2024-02-05T18:05:09,067 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53418] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5ded669562
2024-02-05T18:05:09,073 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5ded669562] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 0
2024-02-05T18:05:09,080 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.006 seconds
2024-02-05T18:05:09,081 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:05:09,115 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:05:09,123 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:09,125 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:05:09,125 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:05:09,131 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:05:09,132 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38763/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:05:09,149 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:05:09,156 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:09,158 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:05:09,159 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:05:09,165 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:05:09,165 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:38763/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:05:09,186 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,197 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53418] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:53418, producerName=test-0-4, producerId=1}
2024-02-05T18:05:09,200 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,217 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-e8fa3f312d] Subscribing to topic on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775], consumerId 1
2024-02-05T18:05:09,218 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x83b9683e, L:/127.0.0.1:42775 - R:/127.0.0.1:53418]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-e8fa3f312d. consumerId: 1
2024-02-05T18:05:09,236 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-e8fa3f312d] Created new subscription for 1
2024-02-05T18:05:09,237 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53418] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-e8fa3f312d
2024-02-05T18:05:09,238 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-e8fa3f312d] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 1
2024-02-05T18:05:09,258 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,271 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:53418] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:53418, producerName=test-0-5, producerId=2}
2024-02-05T18:05:09,273 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x6a342b29, L:/127.0.0.1:53418 - R:localhost/127.0.0.1:42775]
2024-02-05T18:05:09,275 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:05:09,278 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:05:09,281 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:38763 plays a follower now.
2024-02-05T18:05:09,310 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:38763/__change_events
2024-02-05T18:05:09,342 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:38763/0x00000000_0xffffffff - localhost:38763.
2024-02-05T18:05:09,343 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:38763/0x00000000_0xffffffff
2024-02-05T18:05:09,343 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:38763
2024-02-05T18:05:09,344 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:38763/0x00000000_0xffffffff - localhost:38763.
2024-02-05T18:05:09,345 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:38763/0x00000000_0xffffffff
2024-02-05T18:05:09,347 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:38763
2024-02-05T18:05:09,351 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:38763 doesn't exist.
2024-02-05T18:05:09,353 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 22.85%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 45.88%, msgThroughputEMA= 0.00, updatedAt= 1707149109353, reportedAt= 1707149104502
2024-02-05T18:05:09,356 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:38763/__change_events][reader-3571a212c1] Subscribing to topic on cnx [id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117], consumerId 2
2024-02-05T18:05:09,358 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x9eab1a48, L:/127.0.0.1:36117 - R:/127.0.0.1:52228]] Subscribing on topic persistent://sla-monitor/test/localhost:38763/__change_events / reader-3571a212c1. consumerId: 2
2024-02-05T18:05:09,362 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=4, bootstrap service port = 38763, tls-port = Optional[34233], broker url= pulsar://localhost:36117, broker tls url= pulsar+ssl://localhost:44995, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36117], brokerServicePortTls=Optional[44995], webServicePort=Optional[38763], webServicePortTls=Optional[34233], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:05:09,373 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:38763/persistent/__change_events
2024-02-05T18:05:09,377 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:38763/persistent/__change_events'
2024-02-05T18:05:09,388 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:05:09,390 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:38763/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:05:09,428 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:05:09,429 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:05:09,430 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:38763/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:05:09,435 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:38763/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:05:09,439 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:38763/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:38763/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:05:09,440 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:38763/__change_events - dedup is disabled
2024-02-05T18:05:09,446 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:05:09,465 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:38763/__change_events][reader-3571a212c1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:09,467 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:38763/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:05:09,467 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:38763/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38763/persistent/__change_events, cursor=reader-3571a212c1, ackPos=9:-1, readPos=9:0}
2024-02-05T18:05:09,475 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:52228] Created subscription on topic persistent://sla-monitor/test/localhost:38763/__change_events / reader-3571a212c1
2024-02-05T18:05:09,479 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:38763/__change_events][reader-3571a212c1] Subscribed to topic on localhost/127.0.0.1:36117 -- consumer: 2
2024-02-05T18:05:09,628 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:05:09,629 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:05:09,658 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:05:09,659 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:05:09,688 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:05:09,689 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:05:09,693 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:05:09,694 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:05:09,719 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:05:09,719 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:05:09,721 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:05:09,722 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:05:09,723 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:05:09,723 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:05:09,738 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:05:09,738 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:05:09,743 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:05:09,744 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:05:09,758 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:05:09,759 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:05:09,760 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:05:09,761 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:05:09,762 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:05:09,765 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:05:09,806 - INFO  - [pulsar-web-30-4:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:05:09,819 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:05:09,820 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:05:09,845 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:05:09,863 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:09,895 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38763 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:05:10,013 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:05:09,983 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38763, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149109897, versionId=1]. totalHandledRequests:1
2024-02-05T18:05:10,040 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38763, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149109953, versionId=2]. totalHandledRequests:1
2024-02-05T18:05:10,056 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:10,078 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-9b10e9c685] Subscribing to topic on cnx [id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117], consumerId 3
2024-02-05T18:05:10,078 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 237
2024-02-05T18:05:10,082 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x9eab1a48, L:/127.0.0.1:36117 - R:/127.0.0.1:52228]] Subscribing on topic persistent://public/test/__change_events / reader-9b10e9c685. consumerId: 3
2024-02-05T18:05:10,104 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:05:10,109 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:05:10,113 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:05:10,119 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:05:10,120 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:05:10,127 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:05:10,132 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:05:10,137 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:05:10,140 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:05:10,150 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:05:10,162 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149110149, versionId=3]. totalHandledRequests:1
2024-02-05T18:05:10,166 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:05:10,173 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:05:10,175 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:05:10,178 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:05:10,193 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:05:10,199 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:05:10,205 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 41.0 ms
2024-02-05T18:05:10,217 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149110164, versionId=4]. totalHandledRequests:1
2024-02-05T18:05:10,221 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38763. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:05:10,226 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:52228][persistent://public/test/__change_events][reader-9b10e9c685] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38763. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:05:10,231 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38763. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:05:10,238 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-9b10e9c685] Failed to subscribe to topic on localhost/127.0.0.1:36117
2024-02-05T18:05:10,239 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-9b10e9c685] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38763. Please redo the lookup. Request is denied: namespace=public/test","reqId":4472336740305674051, "remote":"localhost/127.0.0.1:36117", "local":"/127.0.0.1:52228"}
2024-02-05T18:05:10,231 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:05:10,239 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-9b10e9c685] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:38763. Please redo the lookup. Request is denied: namespace=public/test","reqId":4472336740305674051, "remote":"localhost/127.0.0.1:36117", "local":"/127.0.0.1:52228"} -- Will try again in 0.1 s
2024-02-05T18:05:10,241 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:05:10,243 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:10 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 150
2024-02-05T18:05:10,243 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:05:10,245 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:05:09 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 443
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:05:10,365 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-9b10e9c685] Reconnecting after connection was closed
2024-02-05T18:05:10,374 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:38763. Skipping this broker. Phase one
2024-02-05T18:05:10,374 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39281. Skipping this broker. Phase one
2024-02-05T18:05:10,374 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:38763 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:05:10,384 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:38763, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149110375, versionId=5]. totalHandledRequests:2
2024-02-05T18:05:10,397 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:05:10,398 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-9b10e9c685] Subscribing to topic on cnx [id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117], consumerId 3
2024-02-05T18:05:10,400 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x9eab1a48, L:/127.0.0.1:36117 - R:/127.0.0.1:52228]] Subscribing on topic persistent://public/test/__change_events / reader-9b10e9c685. consumerId: 3
2024-02-05T18:05:10,408 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:38763, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149110383, versionId=6]. totalHandledRequests:2
2024-02-05T18:05:10,420 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:05:10,426 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:05:10,426 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:05:10,429 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:05:10,430 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7feb762c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21c6b037] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7feb762c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b2441dc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21c6b037, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b28243] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7feb762c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b2441dc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35cccc4f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21c6b037, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b28243, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@219f85c9] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7feb762c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b2441dc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35cccc4f, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@485c0a87], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21c6b037, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b28243, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@219f85c9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d792955] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@331d2274, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@66618d2e, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7feb762c, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b2441dc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35cccc4f, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@485c0a87, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e843a01], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@54a15a5c, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@25bffe6d, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21c6b037, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11b28243, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@219f85c9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d792955, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@43e845d5] 
2024-02-05T18:05:10,437 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:05:10,442 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:05:10,443 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:05:10,447 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:05:10,448 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:05:10,448 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-1ef24efaef] Subscribing to topic on cnx [id: 0x86b9b19c, L:/127.0.0.1:52228 - R:localhost/127.0.0.1:36117], consumerId 4
2024-02-05T18:05:10,448 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:05:10,458 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x9eab1a48, L:/127.0.0.1:36117 - R:/127.0.0.1:52228]] Subscribing on topic persistent://public/test/__change_events / reader-1ef24efaef. consumerId: 4
2024-02-05T18:05:10,459 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:05:10,474 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-9b10e9c685] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:10,474 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:05:10,475 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-9b10e9c685, ackPos=13:-1, readPos=13:0}
2024-02-05T18:05:10,484 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52228] Created subscription on topic persistent://public/test/__change_events / reader-9b10e9c685
2024-02-05T18:05:10,489 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-9b10e9c685] Subscribed to topic on localhost/127.0.0.1:36117 -- consumer: 3
2024-02-05T18:05:10,494 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:05:10,504 - INFO  - [pulsar-io-64-3:ServerCnx@2007] - [/127.0.0.1:52228] Closing consumer: consumerId=3
2024-02-05T18:05:10,504 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-9b10e9c685}, consumerId=3, consumerName=92058, address=/127.0.0.1:52228}
2024-02-05T18:05:10,505 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-9b10e9c685] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-9b10e9c685, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:05:10,506 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-9b10e9c685] Successfully closed dispatcher for reader
2024-02-05T18:05:10,509 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-1ef24efaef] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:10,510 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:05:10,510 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-1ef24efaef, ackPos=13:-1, readPos=13:0}
2024-02-05T18:05:10,511 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:05:10,513 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:05:10,514 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:05:10,518 - INFO  - [pulsar-io-64-3:ServerCnx@2043] - [/127.0.0.1:52228] Closed consumer, consumerId=3
2024-02-05T18:05:10,518 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52228] Created subscription on topic persistent://public/test/__change_events / reader-1ef24efaef
2024-02-05T18:05:10,520 - INFO  - [pulsar-io-64-2:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-9b10e9c685] Closed consumer
2024-02-05T18:05:10,521 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:05:10,522 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:05:10,525 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-1ef24efaef] Subscribed to topic on localhost/127.0.0.1:36117 -- consumer: 4
2024-02-05T18:05:10,528 - INFO  - [pulsar-io-64-3:ServerCnx@2007] - [/127.0.0.1:52228] Closing consumer: consumerId=4
2024-02-05T18:05:10,528 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-1ef24efaef}, consumerId=4, consumerName=4d09b, address=/127.0.0.1:52228}
2024-02-05T18:05:10,529 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-1ef24efaef] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-1ef24efaef, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:05:10,529 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-1ef24efaef] Successfully closed dispatcher for reader
2024-02-05T18:05:10,530 - INFO  - [pulsar-io-64-3:ServerCnx@2043] - [/127.0.0.1:52228] Closed consumer, consumerId=4
2024-02-05T18:05:10,531 - INFO  - [pulsar-io-64-2:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-1ef24efaef] Closed consumer
2024-02-05T18:05:10,532 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:05:10,535 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:05:10,548 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:05:10,554 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:05:10,559 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:05:10,561 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:05:10,577 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:05:10,583 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:05:10,598 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:05:10,601 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:05:10,602 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:05:10,604 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38763
2024-02-05T18:05:10,607 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39281. Skipping this broker. Phase one
2024-02-05T18:05:10,608 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:38763, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149110383, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39281, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149110608, versionId=7]
2024-02-05T18:05:10,619 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:05:10,619 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39281, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149110608, versionId=7]. totalHandledRequests:6
2024-02-05T18:05:10,619 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:05:10,620 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:05:10,620 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:05:10,621 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:39281 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:39281, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149110608, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:05:10,622 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:05:10,622 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:05:10,624 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:05:10,625 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 6.0 ms
2024-02-05T18:05:10,636 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:05:10,638 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:05:10,656 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:05:10,658 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-6724cdb14c] Subscribing to topic on cnx [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775], consumerId 4
2024-02-05T18:05:10,660 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xa1b05847, L:/127.0.0.1:42775 - R:/127.0.0.1:53416]] Subscribing on topic persistent://public/test/__change_events / reader-6724cdb14c. consumerId: 4
2024-02-05T18:05:10,671 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:05:10,675 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:05:10,676 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:05:10,680 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T18:05:10,686 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:05:10,687 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:05:10,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:05:10,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:05:10,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:05:10,694 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:05:10,703 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-6724cdb14c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:05:10,704 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:05:10,704 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6724cdb14c, ackPos=14:-1, readPos=14:0}
2024-02-05T18:05:10,706 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:53416] Created subscription on topic persistent://public/test/__change_events / reader-6724cdb14c
2024-02-05T18:05:10,707 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-6724cdb14c] Subscribed to topic on localhost/127.0.0.1:42775 -- consumer: 4
2024-02-05T18:05:11,430 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:05:11,431 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:05:12,432 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:05:12,432 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:05:13,433 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:05:13,433 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:05:13,720 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38763 in 3114.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:05:13,729 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:38763 was invalidated. state Releasing
2024-02-05T18:05:13,730 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:38763. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:05:13,732 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:38763 registry has been deleted.
2024-02-05T18:05:13,732 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38763 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:05:13,732 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:38763
2024-02-05T18:05:13,735 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38763 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:05:13,735 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38763
2024-02-05T18:05:13,737 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38763 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:05:13,747 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:38763/0x00000000_0xffffffff.
2024-02-05T18:05:13,749 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:38763/0x00000000_0xffffffff.
2024-02-05T18:05:13,750 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:38763/0x00000000_0xffffffff.
2024-02-05T18:05:13,751 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.017 seconds
2024-02-05T18:05:13,753 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:05:13,760 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:52228
2024-02-05T18:05:13,761 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x86b9b19c, L:/127.0.0.1:52228 ! R:localhost/127.0.0.1:36117] Disconnected
2024-02-05T18:05:13,761 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:38763/__change_events, name=reader-3571a212c1}, consumerId=2, consumerName=4881c, address=/127.0.0.1:52228}
2024-02-05T18:05:13,762 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:38763/__change_events][reader-3571a212c1] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:38763/persistent/__change_events, cursor=reader-3571a212c1, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:05:13,762 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:38763/__change_events][reader-3571a212c1] Successfully closed dispatcher for reader
2024-02-05T18:05:13,764 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:38763/__change_events] [reader-3571a212c1] Closed connection [id: 0x86b9b19c, L:/127.0.0.1:52228 ! R:localhost/127.0.0.1:36117] -- Will try again in 0.1 s
2024-02-05T18:05:13,764 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] Disconnected
2024-02-05T18:05:13,764 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:13,765 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:13,767 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:13,767 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5ded669562] Closed connection [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:13,767 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-e8fa3f312d] Closed connection [id: 0x6a342b29, L:/127.0.0.1:53418 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:13,771 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:53418
2024-02-05T18:05:13,773 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-5ded669562}, consumerId=0, consumerName=38ffd, address=/127.0.0.1:53418}
2024-02-05T18:05:13,773 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5ded669562] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5ded669562, ackPos=3:6, readPos=3:7}]
2024-02-05T18:05:13,774 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5ded669562] Successfully closed dispatcher for reader
2024-02-05T18:05:13,775 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-e8fa3f312d}, consumerId=1, consumerName=e1000, address=/127.0.0.1:53418}
2024-02-05T18:05:13,781 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:05:13,782 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:38763/persistent/__change_events] Closing managed ledger
2024-02-05T18:05:13,788 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:38763/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:05:13,793 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:05:13,797 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:05:13,801 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:05:13,822 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36117
2024-02-05T18:05:13,824 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:05:13,825 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:05:13,825 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:05:13,826 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:38763/__change_events] [reader-3571a212c1] Closed Consumer (not connected)
2024-02-05T18:05:13,826 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38763/__change_events with subscription name reader-3571a212c1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:38763/__change_events with subscription name reader-3571a212c1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:13,831 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5ded669562] Closed Consumer (not connected)
2024-02-05T18:05:13,832 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5ded669562 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5ded669562 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:13,836 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-e8fa3f312d] Closed Consumer (not connected)
2024-02-05T18:05:13,837 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-e8fa3f312d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-e8fa3f312d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:13,852 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:05:13,852 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:38763/__change_events] [reader-3571a212c1] Reconnecting after timeout
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://sla-monitor/test/localhost:38763/__change_events] [reader-3571a212c1] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Reconnecting after timeout
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Reconnecting after timeout
2024-02-05T18:05:13,866 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,868 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Reconnecting after timeout
2024-02-05T18:05:13,868 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,869 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5ded669562] Reconnecting after timeout
2024-02-05T18:05:13,869 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5ded669562] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,869 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:05:13,870 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-e8fa3f312d] Reconnecting after timeout
2024-02-05T18:05:13,870 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-e8fa3f312d] Ignoring reconnection request (state: Closed)
2024-02-05T18:05:13,870 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:13,878 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:05:13,878 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:14,353 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:05:14,354 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 29.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 29.10%, msgThroughputEMA= 0.00, updatedAt= 1707149114353, reportedAt= 0
2024-02-05T18:05:14,439 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:14,439 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38763 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:05:14,440 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38763 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:05:14,440 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38763]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:05:14,441 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38763
2024-02-05T18:05:14,442 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38763 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:05:15,082 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:05:15,083 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:05:15,085 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:05:15,088 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:15,088 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:05:15,088 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:05:15,441 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:15,441 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38763 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:05:15,442 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38763 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:05:15,442 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38763]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:05:15,442 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38763
2024-02-05T18:05:15,444 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38763 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:05:16,443 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:05:16,443 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:38763 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:05:16,443 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:38763 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:05:16,444 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:38763]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:05:16,444 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:38763
2024-02-05T18:05:16,445 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:38763 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:05:17,116 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:05:17,118 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@47ae6c18{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:05:17,119 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@79ee779c{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:05:17,119 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:05:17,120 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@332fa1c{/static,null,STOPPED}
2024-02-05T18:05:17,120 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/metrics,null,STOPPED}
2024-02-05T18:05:17,122 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/topics,null,STOPPED}
2024-02-05T18:05:17,125 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/lookup,null,STOPPED}
2024-02-05T18:05:17,127 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3487947c{/admin/v3,null,STOPPED}
2024-02-05T18:05:17,129 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/admin/v2,null,STOPPED}
2024-02-05T18:05:17,132 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin,null,STOPPED}
2024-02-05T18:05:17,134 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/,null,STOPPED}
2024-02-05T18:05:17,139 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:05:17,140 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:05:17,141 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:05:17,142 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39281
2024-02-05T18:05:17,144 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39281, sourceBroker=localhost:38763, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149110608, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:05:22,152 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39281 in 5008.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:05:22,164 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39281 was invalidated. state Releasing
2024-02-05T18:05:22,164 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39281. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:05:22,165 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39281
2024-02-05T18:05:22,173 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39281/0x00000000_0xffffffff.
2024-02-05T18:05:22,195 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39281, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149122181, versionId=8]. totalHandledRequests:10
2024-02-05T18:05:22,196 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:05:22,196 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:05:22,197 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:05:22,199 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-6724cdb14c}, consumerId=4, consumerName=369af, address=/127.0.0.1:53416}
2024-02-05T18:05:22,199 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-6724cdb14c}, consumerId=4, consumerName=369af, address=/127.0.0.1:53416}
2024-02-05T18:05:22,200 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-6724cdb14c] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6724cdb14c, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:05:22,200 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-6724cdb14c] Successfully closed dispatcher for reader
2024-02-05T18:05:22,202 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:42775] Broker notification of Closed consumer: 4
2024-02-05T18:05:22,203 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-6724cdb14c] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 - R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,203 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-6724cdb14c] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-6724cdb14c, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:05:22,203 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-6724cdb14c] Successfully disconnected and closed subscription
2024-02-05T18:05:22,204 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:05:22,210 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:05:22,211 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:05:22,212 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-6724cdb14c] Closed Consumer (not connected)
2024-02-05T18:05:22,213 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 17.0 ms
2024-02-05T18:05:22,214 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-6724cdb14c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-6724cdb14c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:22,226 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:05:22,227 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:05:22,229 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39281 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39281, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149122195, versionId=9]. totalHandledRequests:4
2024-02-05T18:05:22,229 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:05:22,231 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39281/0x00000000_0xffffffff.
2024-02-05T18:05:22,233 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39281/0x00000000_0xffffffff.
2024-02-05T18:05:22,233 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.067 seconds
2024-02-05T18:05:22,234 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:05:22,235 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:53416
2024-02-05T18:05:22,235 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-cf0c6f93f9}, consumerId=0, consumerName=679ab, address=/127.0.0.1:53416}
2024-02-05T18:05:22,235 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] Disconnected
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-cf0c6f93f9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-cf0c6f93f9, ackPos=3:6, readPos=3:9}]
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-cf0c6f93f9] Successfully closed dispatcher for reader
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,236 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-cf0c6f93f9] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,236 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:05:22,236 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39281/__change_events, name=reader-d8e9cc4776}, consumerId=3, consumerName=a974f, address=/127.0.0.1:53416}
2024-02-05T18:05:22,237 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-afb25be001] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,237 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39281/persistent/__change_events] Closing managed ledger
2024-02-05T18:05:22,237 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39281/__change_events] [reader-d8e9cc4776] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,237 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-19a2f9c524] Closed connection [id: 0x0ec7d609, L:/127.0.0.1:53416 ! R:localhost/127.0.0.1:42775] -- Will try again in 0.1 s
2024-02-05T18:05:22,237 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39281/__change_events][reader-d8e9cc4776] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39281/persistent/__change_events, cursor=reader-d8e9cc4776, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:05:22,238 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39281/__change_events][reader-d8e9cc4776] Successfully closed dispatcher for reader
2024-02-05T18:05:22,239 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39281/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:05:22,239 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-19a2f9c524}, consumerId=2, consumerName=69105, address=/127.0.0.1:53416}
2024-02-05T18:05:22,241 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-afb25be001}, consumerId=1, consumerName=aa404, address=/127.0.0.1:53416}
2024-02-05T18:05:22,242 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:05:22,242 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:05:22,243 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:05:22,244 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:05:22,256 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:42775
2024-02-05T18:05:22,257 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:05:22,257 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:05:22,257 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:05:22,258 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39281/__change_events] [reader-d8e9cc4776] Closed Consumer (not connected)
2024-02-05T18:05:22,258 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-cf0c6f93f9] Closed Consumer (not connected)
2024-02-05T18:05:22,258 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-afb25be001] Closed Consumer (not connected)
2024-02-05T18:05:22,258 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-19a2f9c524] Closed Consumer (not connected)
2024-02-05T18:05:22,263 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39281/__change_events with subscription name reader-d8e9cc4776 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39281/__change_events with subscription name reader-d8e9cc4776 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:22,264 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-cf0c6f93f9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-cf0c6f93f9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:22,265 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-afb25be001 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-afb25be001 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:22,266 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-19a2f9c524 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-19a2f9c524 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:05:22,276 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:05:22,277 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:05:22,277 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:05:22,277 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:05:22,278 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:05:22,281 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:22,284 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:05:22,284 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:23,640 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:05:23,640 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:05:23,642 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:05:23,642 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:23,642 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:05:23,642 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:05:23,653 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:05:23,653 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:05:23,660 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:05:23,661 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 81 with name 'Thread[ForkJoinPool.commonPool-worker-4,5,main]'
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 154 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:05:23,661 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:05:23,662 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:05:23,662 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 188 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:05:23,662 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 194 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:05:23,662 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:05:23,662 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:05:23,662 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@784df46e
2024-02-05T18:05:23,663 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:05:23,663 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:05:23,663 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 132.829 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  05:33 h
[INFO] Finished at: 2024-02-05T18:05:24+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 1 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 1 source file with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:06:22,009 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:06:22,956 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:06:22,957 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:06:23,417 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:06:23,418 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:06:23,419 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:06:23,420 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:06:23,420 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:06:23,421 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:06:23,435 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:06:23,436 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:06:23,436 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:06:23,437 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:06:23,437 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:06:23,438 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:06:23,439 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:06:23,439 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:06:23,440 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:06:23,440 - INFO  - [main:Environment@98] - Client environment:os.memory.free=30MB
2024-02-05T18:06:23,441 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:06:23,441 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:06:24,953 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:06:24,953 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:06:24,954 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:06:24,954 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:06:25,290 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:06:25,291 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:06:25,389 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:06:25,479 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:06:25,486 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:06:25,510 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:06:25,614 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:06:25,657 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:06:25,696 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:06:26,032 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:06:26,033 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:06:26,070 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:06:26,117 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37629, TLS: (none), listener: (none)
2024-02-05T18:06:26,484 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38509, TLS: OPENSSL, listener: (none)
2024-02-05T18:06:26,506 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:06:26,511 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:06:26,512 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:06:26,543 - INFO  - [main:Log@170] - Logging initialized @7198ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:06:27,479 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:06:27,536 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:06:27,536 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:06:27,539 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:06:28,386 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:06:29,500 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:06:30,792 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:06:31,149 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:06:31,263 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:06:31,378 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:06:31,379 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:06:31,381 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:06:31,394 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:39833}
2024-02-05T18:06:31,525 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:46659}
2024-02-05T18:06:31,526 - INFO  - [main:Server@415] - Started @12182ms
2024-02-05T18:06:31,526 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39833
2024-02-05T18:06:31,527 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:46659
2024-02-05T18:06:31,534 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:06:31,535 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:06:31,714 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39833
2024-02-05T18:06:31,733 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:06:31,737 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39833 is changing the role from null to Leader
2024-02-05T18:06:31,741 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39833).
2024-02-05T18:06:32,054 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39833 
2024-02-05T18:06:32,556 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:06:32,589 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:32,707 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:06:32,714 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:06:32,724 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:06:32,728 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:06:32,777 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:06:32,815 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:06:32,849 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:06:32,917 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:06:32,934 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:06:32,944 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:06:32,947 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:06:32,978 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:32 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 571
2024-02-05T18:06:32,982 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:06:33,127 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]] Connected to server
2024-02-05T18:06:33,163 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:36028] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:06:33,213 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,222 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,279 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:06:33,306 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36028] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:36028, producerName=test-0-0, producerId=0}
2024-02-05T18:06:33,312 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,314 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:06:33,359 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,361 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f90b6bad68] Subscribing to topic on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629], consumerId 0
2024-02-05T18:06:33,370 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xef5fa64a, L:/127.0.0.1:37629 - R:/127.0.0.1:36028]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f90b6bad68. consumerId: 0
2024-02-05T18:06:33,402 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f90b6bad68] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:33,403 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:06:33,403 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f90b6bad68, ackPos=3:-1, readPos=3:0}
2024-02-05T18:06:33,429 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36028] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f90b6bad68
2024-02-05T18:06:33,435 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f90b6bad68] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 0
2024-02-05T18:06:33,447 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:06:33,449 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:06:33,450 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:06:33,450 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:06:33,488 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,510 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:06:33,512 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:06:33,515 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:06:33,516 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:33 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 51
2024-02-05T18:06:33,528 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,537 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:06:33,538 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:06:33,539 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:33 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:06:33,540 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:06:33,558 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,560 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,569 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:06:33,577 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36028] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:36028, producerName=test-0-1, producerId=1}
2024-02-05T18:06:33,579 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,604 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,606 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-fc0c76a565] Subscribing to topic on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629], consumerId 1
2024-02-05T18:06:33,610 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xef5fa64a, L:/127.0.0.1:37629 - R:/127.0.0.1:36028]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-fc0c76a565. consumerId: 1
2024-02-05T18:06:33,638 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-fc0c76a565] Created new subscription for 1
2024-02-05T18:06:33,639 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36028] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-fc0c76a565
2024-02-05T18:06:33,640 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-fc0c76a565] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 1
2024-02-05T18:06:33,666 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,667 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,679 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:06:33,686 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36028] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:36028, producerName=test-0-2, producerId=2}
2024-02-05T18:06:33,688 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:33,705 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:06:33,741 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:06:33,748 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39833 started the ownership monitor.
2024-02-05T18:06:33,767 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:33,768 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f1b03b23a2] Subscribing to topic on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629], consumerId 2
2024-02-05T18:06:33,770 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xef5fa64a, L:/127.0.0.1:37629 - R:/127.0.0.1:36028]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f1b03b23a2. consumerId: 2
2024-02-05T18:06:33,785 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f1b03b23a2] Created new subscription for 2
2024-02-05T18:06:33,785 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36028] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-f1b03b23a2
2024-02-05T18:06:33,787 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-f1b03b23a2] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 2
2024-02-05T18:06:33,792 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39833 plays the leader now.
2024-02-05T18:06:33,800 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39833/__change_events
2024-02-05T18:06:33,804 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707149193802, reportedAt= 0
2024-02-05T18:06:33,846 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:06:33,857 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:33,858 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:06:33,921 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39833/0x00000000_0xffffffff - localhost:39833.
2024-02-05T18:06:33,926 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39833
2024-02-05T18:06:33,926 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39833/0x00000000_0xffffffff
2024-02-05T18:06:33,927 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39833/0x00000000_0xffffffff - localhost:39833.
2024-02-05T18:06:33,929 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39833
2024-02-05T18:06:33,931 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39833/0x00000000_0xffffffff
2024-02-05T18:06:33,935 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39833/__change_events][reader-5f5ee7ccae] Subscribing to topic on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629], consumerId 3
2024-02-05T18:06:33,939 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xef5fa64a, L:/127.0.0.1:37629 - R:/127.0.0.1:36028]] Subscribing on topic persistent://sla-monitor/test/localhost:39833/__change_events / reader-5f5ee7ccae. consumerId: 3
2024-02-05T18:06:33,952 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39833 doesn't exist.
2024-02-05T18:06:33,955 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39833/persistent/__change_events
2024-02-05T18:06:33,958 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39833/persistent/__change_events'
2024-02-05T18:06:33,967 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:06:33,968 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39833/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:06:33,978 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39833/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:06:33,984 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39833/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:06:33,989 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39833/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39833/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:06:33,990 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39833/__change_events - dedup is disabled
2024-02-05T18:06:34,009 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:06:34,021 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39833/__change_events][reader-5f5ee7ccae] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:34,022 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39833/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:06:34,022 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39833/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39833/persistent/__change_events, cursor=reader-5f5ee7ccae, ackPos=7:-1, readPos=7:0}
2024-02-05T18:06:34,031 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:36028] Created subscription on topic persistent://sla-monitor/test/localhost:39833/__change_events / reader-5f5ee7ccae
2024-02-05T18:06:34,032 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39833/__change_events][reader-5f5ee7ccae] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 3
2024-02-05T18:06:33,970 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 39833, tls-port = Optional[46659], broker url= pulsar://localhost:37629, broker tls url= pulsar+ssl://localhost:38509, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37629], brokerServicePortTls=Optional[38509], webServicePort=Optional[39833], webServicePortTls=Optional[46659], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:06:34,569 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:06:34,570 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:06:34,570 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:06:34,570 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:06:34,575 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:06:34,576 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:06:34,581 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:06:34,584 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:06:34,589 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:06:34,589 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:06:34,594 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:06:34,599 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:06:34,603 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:06:34,615 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:06:34,616 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:06:34,624 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:06:34,628 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34075, TLS: (none), listener: (none)
2024-02-05T18:06:34,630 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40481, TLS: OPENSSL, listener: (none)
2024-02-05T18:06:34,634 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:06:34,635 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:06:34,635 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:06:34,651 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:06:34,655 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:06:34,655 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:06:34,655 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:06:34,741 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:06:34,859 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:34,859 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:06:35,419 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:06:35,860 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:35,861 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:06:36,714 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:06:36,862 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:36,862 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:06:36,941 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:06:37,010 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:06:37,081 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:06:37,082 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:06:37,082 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:06:37,084 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:36377}
2024-02-05T18:06:37,095 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:37507}
2024-02-05T18:06:37,095 - INFO  - [main:Server@415] - Started @17752ms
2024-02-05T18:06:37,096 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36377
2024-02-05T18:06:37,098 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37507
2024-02-05T18:06:37,101 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:06:37,101 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:06:37,113 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36377
2024-02-05T18:06:37,114 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:36377 registry has been created.
2024-02-05T18:06:37,114 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:36377. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:06:37,119 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:36377 is changing the role from null to Follower
2024-02-05T18:06:37,123 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39833).
2024-02-05T18:06:37,129 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:06:37,145 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36377 
2024-02-05T18:06:37,291 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 71
2024-02-05T18:06:37,313 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:37,315 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:06:37,317 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:06:37,332 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 35
2024-02-05T18:06:37,333 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36377/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:06:37,342 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:37,347 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:59702] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:06:37,368 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]] Connected to server
2024-02-05T18:06:37,372 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:36040] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:06:37,373 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,385 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:36040] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:36040, producerName=test-0-3, producerId=0}
2024-02-05T18:06:37,387 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,402 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-533a89e52c] Subscribing to topic on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629], consumerId 0
2024-02-05T18:06:37,405 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x84856ee2, L:/127.0.0.1:37629 - R:/127.0.0.1:36040]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-533a89e52c. consumerId: 0
2024-02-05T18:06:37,410 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-533a89e52c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:37,411 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:06:37,411 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-533a89e52c, ackPos=3:-1, readPos=3:0}
2024-02-05T18:06:37,413 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36040] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-533a89e52c
2024-02-05T18:06:37,414 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-533a89e52c] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 0
2024-02-05T18:06:37,417 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:06:37,418 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:06:37,451 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:06:37,464 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:37,467 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:06:37,467 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:06:37,474 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36377/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:06:37,476 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:06:37,490 - INFO  - [pulsar-web-84-3:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:06:37,497 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:37,500 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:06:37,500 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:06:37,504 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:06:37,505 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36377/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:06:37,520 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,529 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:36040] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:36040, producerName=test-0-4, producerId=1}
2024-02-05T18:06:37,530 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,546 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4150328ad8] Subscribing to topic on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629], consumerId 1
2024-02-05T18:06:37,548 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x84856ee2, L:/127.0.0.1:37629 - R:/127.0.0.1:36040]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4150328ad8. consumerId: 1
2024-02-05T18:06:37,566 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4150328ad8] Created new subscription for 1
2024-02-05T18:06:37,567 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36040] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-4150328ad8
2024-02-05T18:06:37,568 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-4150328ad8] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 1
2024-02-05T18:06:37,590 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,598 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:36040] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:36040, producerName=test-0-5, producerId=2}
2024-02-05T18:06:37,599 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x04a7e0af, L:/127.0.0.1:36040 - R:localhost/127.0.0.1:37629]
2024-02-05T18:06:37,601 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:06:37,604 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:06:37,605 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:36377 plays a follower now.
2024-02-05T18:06:37,630 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36377/__change_events
2024-02-05T18:06:37,655 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36377/0x00000000_0xffffffff - localhost:36377.
2024-02-05T18:06:37,656 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36377
2024-02-05T18:06:37,657 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36377/0x00000000_0xffffffff - localhost:36377.
2024-02-05T18:06:37,658 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36377
2024-02-05T18:06:37,661 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36377 doesn't exist.
2024-02-05T18:06:37,662 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36377/0x00000000_0xffffffff
2024-02-05T18:06:37,662 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36377/0x00000000_0xffffffff
2024-02-05T18:06:37,669 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36377/__change_events][reader-d89e44b195] Subscribing to topic on cnx [id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075], consumerId 2
2024-02-05T18:06:37,671 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x13ea0a63, L:/127.0.0.1:34075 - R:/127.0.0.1:59702]] Subscribing on topic persistent://sla-monitor/test/localhost:36377/__change_events / reader-d89e44b195. consumerId: 2
2024-02-05T18:06:37,680 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36377/persistent/__change_events
2024-02-05T18:06:37,682 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36377/persistent/__change_events'
2024-02-05T18:06:37,677 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 36377, tls-port = Optional[37507], broker url= pulsar://localhost:34075, broker tls url= pulsar+ssl://localhost:40481, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34075], brokerServicePortTls=Optional[40481], webServicePort=Optional[36377], webServicePortTls=Optional[37507], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:06:37,692 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:06:37,693 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36377/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:06:37,702 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36377/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:06:37,708 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36377/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:06:37,713 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36377/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36377/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:06:37,714 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36377/__change_events - dedup is disabled
2024-02-05T18:06:37,721 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:06:37,729 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36377/__change_events][reader-d89e44b195] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:37,729 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36377/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:06:37,730 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36377/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36377/persistent/__change_events, cursor=reader-d89e44b195, ackPos=9:-1, readPos=9:0}
2024-02-05T18:06:37,732 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:59702] Created subscription on topic persistent://sla-monitor/test/localhost:36377/__change_events / reader-d89e44b195
2024-02-05T18:06:37,733 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36377/__change_events][reader-d89e44b195] Subscribed to topic on localhost/127.0.0.1:34075 -- consumer: 2
2024-02-05T18:06:37,863 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:06:37,863 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:06:37,888 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:06:37,890 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:06:37,918 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:06:37,920 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:06:37,943 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:06:37,945 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:06:37,949 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:06:37,950 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:06:37,974 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:06:37,974 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:06:37,975 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:06:37,975 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:06:37,977 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:06:37,979 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:06:37,988 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:06:37,989 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:06:37,993 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:06:37,994 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:37 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:06:38,008 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:06:38,009 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:06:38,010 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:06:38,011 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:06:38,011 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:38 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:06:38,015 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:06:38,053 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:06:38,064 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:06:38,064 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:06:38,077 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:06:38,087 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:38,106 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36377 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:06:38,173 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:06:38,154 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36377, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198108, versionId=1]. totalHandledRequests:1
2024-02-05T18:06:38,179 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36377, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198154, versionId=2]. totalHandledRequests:1
2024-02-05T18:06:38,183 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:38,196 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:38 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 122
2024-02-05T18:06:38,210 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:06:38,229 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-82da9c19e0] Subscribing to topic on cnx [id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075], consumerId 3
2024-02-05T18:06:38,231 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x13ea0a63, L:/127.0.0.1:34075 - R:/127.0.0.1:59702]] Subscribing on topic persistent://public/test/__change_events / reader-82da9c19e0. consumerId: 3
2024-02-05T18:06:38,244 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:06:38,247 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149198238, versionId=3]. totalHandledRequests:1
2024-02-05T18:06:38,249 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:06:38,251 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:06:38,256 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:06:38,257 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:06:38,262 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:06:38,267 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:06:38,274 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:06:38,276 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:06:38,280 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:06:38,281 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:06:38,283 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:06:38,291 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:06:38,293 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:06:38,302 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:06:38,306 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 57.0 ms
2024-02-05T18:06:38,316 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198248, versionId=4]. totalHandledRequests:1
2024-02-05T18:06:38,320 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36377. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:06:38,321 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:59702][persistent://public/test/__change_events][reader-82da9c19e0] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36377. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:06:38,324 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:06:38,324 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36377. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:06:38,324 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:06:38,325 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:38 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 126
2024-02-05T18:06:38,326 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-82da9c19e0] Failed to subscribe to topic on localhost/127.0.0.1:34075
2024-02-05T18:06:38,327 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36377. Please redo the lookup. Request is denied: namespace=public/test","reqId":2393460539038517726, "remote":"localhost/127.0.0.1:34075", "local":"/127.0.0.1:59702"}
2024-02-05T18:06:38,327 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36377. Please redo the lookup. Request is denied: namespace=public/test","reqId":2393460539038517726, "remote":"localhost/127.0.0.1:34075", "local":"/127.0.0.1:59702"} -- Will try again in 0.1 s
2024-02-05T18:06:38,327 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:06:38,329 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:06:38 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 282
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:06:38,430 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-82da9c19e0] Reconnecting after connection was closed
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70] 
2024-02-05T18:06:38,440 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36377. Skipping this broker. Phase one
2024-02-05T18:06:38,440 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39833. Skipping this broker. Phase one
2024-02-05T18:06:38,440 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36377 for bundle: public/test/0x00000000_0xffffffff.
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@278d1e2f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4bebf5] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@278d1e2f, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58f59cbe], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4bebf5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f1e9ba8] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@278d1e2f, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58f59cbe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@70ad8602], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4bebf5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f1e9ba8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@743dcfa1] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@278d1e2f, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58f59cbe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@70ad8602, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59bdf4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4bebf5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f1e9ba8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@743dcfa1, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b51a58c] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@662801ff, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@11f249f3, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@278d1e2f, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58f59cbe, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@70ad8602, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59bdf4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5750b772], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7261db70, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@18cd018, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4bebf5, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3f1e9ba8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@743dcfa1, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4b51a58c, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d8a3afe] 
2024-02-05T18:06:38,449 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36377, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198441, versionId=5]. totalHandledRequests:8
2024-02-05T18:06:38,461 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36377, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198451, versionId=6]. totalHandledRequests:6
2024-02-05T18:06:38,465 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-82da9c19e0] Subscribing to topic on cnx [id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075], consumerId 3
2024-02-05T18:06:38,465 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:06:38,466 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x13ea0a63, L:/127.0.0.1:34075 - R:/127.0.0.1:59702]] Subscribing on topic persistent://public/test/__change_events / reader-82da9c19e0. consumerId: 3
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:06:38,476 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:06:38,482 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:06:38,483 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:06:38,500 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:06:38,502 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:06:38,504 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:06:38,505 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:06:38,508 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:06:38,508 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:06:38,508 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:06:38,516 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x5cd782d1, L:/127.0.0.1:59702 - R:localhost/127.0.0.1:34075] Close connection because received internal-server error {"errorMsg":"Failed due to pulsar service is not ready","reqId":2393460539038517729, "remote":"localhost/127.0.0.1:34075", "local":"/127.0.0.1:59702"}
2024-02-05T18:06:38,518 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@234] - [persistent://public/test/__change_events] failed to get Partitioned metadata : {"errorMsg":"Failed due to pulsar service is not ready","reqId":2393460539038517729, "remote":"localhost/127.0.0.1:34075", "local":"/127.0.0.1:59702"}
org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2393460539038517729, "remote":"localhost/127.0.0.1:34075", "local":"/127.0.0.1:59702"}
	at org.apache.pulsar.client.impl.ClientCnx.getPulsarClientException(ClientCnx.java:1282) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.handlePartitionResponse(ClientCnx.java:662) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:144) ~[pulsar-common-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.flush.FlushConsolidationHandler.channelRead(FlushConsolidationHandler.java:152) ~[netty-handler-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:06:38,522 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:59702
2024-02-05T18:06:38,524 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:06:38,523 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36377/__change_events, name=reader-d89e44b195}, consumerId=2, consumerName=acbfb, address=/127.0.0.1:59702}
2024-02-05T18:06:38,525 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36377/__change_events][reader-d89e44b195] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36377/persistent/__change_events, cursor=reader-d89e44b195, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:06:38,527 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36377/__change_events][reader-d89e44b195] Successfully closed dispatcher for reader
2024-02-05T18:06:38,527 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x5cd782d1, L:/127.0.0.1:59702 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:38,529 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-82da9c19e0] Failed to subscribe to topic on localhost/127.0.0.1:34075
2024-02-05T18:06:38,529 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:34075
2024-02-05T18:06:38,529 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:34075 -- Will try again in 0.19 s
2024-02-05T18:06:38,531 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Closed connection [id: 0x5cd782d1, L:/127.0.0.1:59702 ! R:localhost/127.0.0.1:34075] -- Will try again in 0.1 s
2024-02-05T18:06:38,536 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:06:38,536 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:06:38,538 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:06:38,538 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:06:38,541 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:06:38,544 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-82da9c19e0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:38,544 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:06:38,544 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-82da9c19e0, ackPos=13:-1, readPos=13:0}
2024-02-05T18:06:38,546 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-82da9c19e0}, consumerId=3, consumerName=33718, address=/127.0.0.1:59702}
2024-02-05T18:06:38,546 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-82da9c19e0] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-82da9c19e0, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:06:38,547 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-82da9c19e0] Successfully closed dispatcher for reader
2024-02-05T18:06:38,548 - ERROR - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@954] - [persistent://public/test/__change_events] Failed to create subscription: reader-82da9c19e0
java.util.concurrent.CompletionException: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1189) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$20(PersistentTopic.java:896) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$22(PersistentTopic.java:891) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.internalSubscribe(PersistentTopic.java:812) ~[classes/:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.subscribe(PersistentTopic.java:786) ~[classes/:?]
	at org.apache.pulsar.broker.service.ServerCnx.lambda$handleSubscribe$15(ServerCnx.java:1255) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorage.lambda$closeLedger$42(BookkeeperSchemaStorage.java:621) ~[classes/:?]
	at org.apache.bookkeeper.client.PulsarMockLedgerHandle.lambda$asyncClose$1(PulsarMockLedgerHandle.java:96) ~[testmocks-3.0.2.jar:4.16.3]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:482) ~[?:?]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.safeRunTask(SingleThreadExecutor.java:137) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.run(SingleThreadExecutor.java:107) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$19(PersistentTopic.java:920) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 22 more
2024-02-05T18:06:38,549 - WARN  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1299] - [/127.0.0.1:59702][persistent://public/test/__change_events][reader-82da9c19e0] Failed to create consumer: consumerId=3, Connection was closed while the opening the cursor 
2024-02-05T18:06:38,561 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:06:38,565 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:06:38,569 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:06:38,575 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:06:38,579 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:06:38,582 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:06:38,586 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:06:38,588 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:06:38,589 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:06:38,590 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:38,594 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39833. Skipping this broker. Phase one
2024-02-05T18:06:38,594 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36377, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149198451, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39833, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149198594, versionId=7]
2024-02-05T18:06:38,603 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39833, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149198594, versionId=7]. totalHandledRequests:7
2024-02-05T18:06:38,605 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:06:38,605 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:06:38,605 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:06:38,605 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:39833 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:39833, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149198594, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T18:06:38,606 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:06:38,607 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:06:38,612 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:06:38,613 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:06:38,613 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:06:38,615 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:06:38,616 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 12.0 ms
2024-02-05T18:06:38,621 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 100 ms
2024-02-05T18:06:38,622 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x1f183aef, L:/127.0.0.1:59706 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:38,627 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x1f183aef, L:/127.0.0.1:59706 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:38,627 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x1f183aef, L:/127.0.0.1:59706 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:38,628 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x1f183aef, L:/127.0.0.1:59706 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:38,628 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x1f183aef, L:/127.0.0.1:59706 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,630 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:59706
2024-02-05T18:06:38,633 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Reconnecting after timeout
2024-02-05T18:06:38,634 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x5a6c41bf, L:/127.0.0.1:59716 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:38,637 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x5a6c41bf, L:/127.0.0.1:59716 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:38,637 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:59716
2024-02-05T18:06:38,637 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x5a6c41bf, L:/127.0.0.1:59716 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:38,638 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x5a6c41bf, L:/127.0.0.1:59716 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:38,638 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x5a6c41bf, L:/127.0.0.1:59716 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,638 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,638 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.186 s
2024-02-05T18:06:38,653 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:06:38,655 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-f5b0391809] Subscribing to topic on cnx [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629], consumerId 4
2024-02-05T18:06:38,658 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xef5fa64a, L:/127.0.0.1:37629 - R:/127.0.0.1:36028]] Subscribing on topic persistent://public/test/__change_events / reader-f5b0391809. consumerId: 4
2024-02-05T18:06:38,665 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:06:38,669 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:06:38,670 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:06:38,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T18:06:38,678 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:06:38,678 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:06:38,683 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:06:38,683 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:06:38,684 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:06:38,688 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:06:38,697 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-f5b0391809] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:06:38,697 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:06:38,697 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5b0391809, ackPos=14:-1, readPos=14:0}
2024-02-05T18:06:38,699 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36028] Created subscription on topic persistent://public/test/__change_events / reader-f5b0391809
2024-02-05T18:06:38,700 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-f5b0391809] Subscribed to topic on localhost/127.0.0.1:37629 -- consumer: 4
2024-02-05T18:06:38,721 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-82da9c19e0] Reconnecting after connection was closed
2024-02-05T18:06:38,722 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1c3bcccb, L:/127.0.0.1:59718 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:38,728 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x1c3bcccb, L:/127.0.0.1:59718 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:38,728 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x1c3bcccb, L:/127.0.0.1:59718 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:38,729 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1c3bcccb, L:/127.0.0.1:59718 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:38,729 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:59718
2024-02-05T18:06:38,729 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x1c3bcccb, L:/127.0.0.1:59718 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,729 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,730 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.39 s
2024-02-05T18:06:38,734 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:06:38,735 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 43.95%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 43.95%, msgThroughputEMA= 0.00, updatedAt= 1707149198734, reportedAt= 0
2024-02-05T18:06:38,825 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Reconnecting after connection was closed
2024-02-05T18:06:38,826 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 197 ms
2024-02-05T18:06:38,827 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x92bdb138, L:/127.0.0.1:59734 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:38,832 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x92bdb138, L:/127.0.0.1:59734 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:38,832 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x92bdb138, L:/127.0.0.1:59734 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:38,833 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:59734
2024-02-05T18:06:38,833 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x92bdb138, L:/127.0.0.1:59734 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:38,833 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x92bdb138, L:/127.0.0.1:59734 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,834 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:38,834 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.381 s
2024-02-05T18:06:38,864 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:06:38,864 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:06:39,120 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-82da9c19e0] Reconnecting after connection was closed
2024-02-05T18:06:39,122 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x016e9b12, L:/127.0.0.1:59740 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:39,124 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x016e9b12, L:/127.0.0.1:59740 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:39,124 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:59740
2024-02-05T18:06:39,125 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x016e9b12, L:/127.0.0.1:59740 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:39,125 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x016e9b12, L:/127.0.0.1:59740 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:39,125 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x016e9b12, L:/127.0.0.1:59740 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,126 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,126 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.767 s
2024-02-05T18:06:39,216 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 382 ms
2024-02-05T18:06:39,217 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Reconnecting after connection was closed
2024-02-05T18:06:39,218 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xb1f006bc, L:/127.0.0.1:59750 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:39,220 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:59750
2024-02-05T18:06:39,220 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xb1f006bc, L:/127.0.0.1:59750 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:39,220 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xb1f006bc, L:/127.0.0.1:59750 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:39,220 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xb1f006bc, L:/127.0.0.1:59750 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:39,221 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xb1f006bc, L:/127.0.0.1:59750 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,221 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,221 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.748 s
2024-02-05T18:06:39,865 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:06:39,865 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:06:39,894 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-82da9c19e0] Reconnecting after connection was closed
2024-02-05T18:06:39,895 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xd6526c9a, L:/127.0.0.1:59760 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:39,898 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xd6526c9a, L:/127.0.0.1:59760 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:39,898 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:59760
2024-02-05T18:06:39,898 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xd6526c9a, L:/127.0.0.1:59760 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:39,899 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xd6526c9a, L:/127.0.0.1:59760 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:39,899 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xd6526c9a, L:/127.0.0.1:59760 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,900 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,900 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.599 s
2024-02-05T18:06:39,970 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Reconnecting after connection was closed
2024-02-05T18:06:39,972 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x5bb65e4f, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:39,976 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x5bb65e4f, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:39,976 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:59776
2024-02-05T18:06:39,976 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x5bb65e4f, L:/127.0.0.1:59776 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:39,977 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x5bb65e4f, L:/127.0.0.1:59776 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:39,978 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x5bb65e4f, L:/127.0.0.1:59776 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,978 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:39,978 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.494 s
2024-02-05T18:06:39,985 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 764 ms
2024-02-05T18:06:39,987 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x92a6a5b8, L:/127.0.0.1:59782 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:39,990 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:59782
2024-02-05T18:06:39,990 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x92a6a5b8, L:/127.0.0.1:59782 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:39,990 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x92a6a5b8, L:/127.0.0.1:59782 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:39,990 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x92a6a5b8, L:/127.0.0.1:59782 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:39,990 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x92a6a5b8, L:/127.0.0.1:59782 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:40,866 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:06:40,867 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:06:41,473 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Reconnecting after connection was closed
2024-02-05T18:06:41,475 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x0fe13f47, L:/127.0.0.1:38074 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:41,478 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:38074
2024-02-05T18:06:41,478 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x0fe13f47, L:/127.0.0.1:38074 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:41,478 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x0fe13f47, L:/127.0.0.1:38074 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:41,478 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x0fe13f47, L:/127.0.0.1:38074 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:41,478 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x0fe13f47, L:/127.0.0.1:38074 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:41,479 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:41,479 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.144 s
2024-02-05T18:06:41,500 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-82da9c19e0] Reconnecting after connection was closed
2024-02-05T18:06:41,502 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x294ff40a, L:/127.0.0.1:38076 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:41,503 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x294ff40a, L:/127.0.0.1:38076 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:41,503 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:38076
2024-02-05T18:06:41,504 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x294ff40a, L:/127.0.0.1:38076 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:41,504 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x294ff40a, L:/127.0.0.1:38076 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:41,504 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x294ff40a, L:/127.0.0.1:38076 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:41,504 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-82da9c19e0] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:41,505 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-82da9c19e0] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.07 s
2024-02-05T18:06:41,553 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 1562 ms
2024-02-05T18:06:41,554 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xcc6eafb6, L:/127.0.0.1:38090 - R:localhost/127.0.0.1:34075]] Connected to server
2024-02-05T18:06:41,558 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xcc6eafb6, L:/127.0.0.1:38090 - R:localhost/127.0.0.1:34075] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:06:41,558 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:38090
2024-02-05T18:06:41,558 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xcc6eafb6, L:/127.0.0.1:38090 - R:localhost/127.0.0.1:34075] Received unknown request id from server: -1
2024-02-05T18:06:41,558 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xcc6eafb6, L:/127.0.0.1:38090 ! R:localhost/127.0.0.1:34075] Disconnected
2024-02-05T18:06:41,558 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xcc6eafb6, L:/127.0.0.1:38090 ! R:localhost/127.0.0.1:34075]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:06:41,704 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 3112.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:06:41,708 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36377 was invalidated. state Releasing
2024-02-05T18:06:41,708 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:36377 registry has been deleted.
2024-02-05T18:06:41,709 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36377 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:06:41,711 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36377 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:06:41,711 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36377. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:06:41,711 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:41,712 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36377
2024-02-05T18:06:41,713 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:06:41,722 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36377/0x00000000_0xffffffff.
2024-02-05T18:06:41,723 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36377/0x00000000_0xffffffff.
2024-02-05T18:06:41,724 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36377/0x00000000_0xffffffff.
2024-02-05T18:06:41,724 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.011 seconds
2024-02-05T18:06:41,725 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:06:41,728 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:06:41,729 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36377/persistent/__change_events] Closing managed ledger
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] Disconnected
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:36040
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-533a89e52c] Closed connection [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:41,731 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4150328ad8] Closed connection [id: 0x04a7e0af, L:/127.0.0.1:36040 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:41,732 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-533a89e52c}, consumerId=0, consumerName=4dc07, address=/127.0.0.1:36040}
2024-02-05T18:06:41,732 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-533a89e52c] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-533a89e52c, ackPos=3:6, readPos=3:7}]
2024-02-05T18:06:41,732 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-533a89e52c] Successfully closed dispatcher for reader
2024-02-05T18:06:41,732 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36377/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:06:41,733 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:06:41,733 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-4150328ad8}, consumerId=1, consumerName=441aa, address=/127.0.0.1:36040}
2024-02-05T18:06:41,734 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:06:41,735 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:06:41,740 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34075
2024-02-05T18:06:41,741 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:06:41,742 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:06:41,743 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:06:41,743 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36377/__change_events] [reader-d89e44b195] Closed Consumer (not connected)
2024-02-05T18:06:41,745 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36377/__change_events with subscription name reader-d89e44b195 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36377/__change_events with subscription name reader-d89e44b195 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:41,746 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-533a89e52c] Closed Consumer (not connected)
2024-02-05T18:06:41,747 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-533a89e52c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-533a89e52c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:41,747 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-82da9c19e0] Closed Consumer (not connected)
2024-02-05T18:06:41,748 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-4150328ad8] Closed Consumer (not connected)
2024-02-05T18:06:41,748 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4150328ad8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-4150328ad8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:41,754 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:06:41,755 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:06:41,757 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:06:41,758 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:41,766 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:06:41,767 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:41,868 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:41,868 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36377 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:06:41,869 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36377 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:06:41,869 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36377]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:06:41,869 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:41,870 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:06:42,869 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:42,870 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36377 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:06:42,870 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36377 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:06:42,871 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:36377]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:06:42,871 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:42,872 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:06:43,036 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:06:43,037 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:06:43,042 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:06:43,042 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:43,042 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:06:43,042 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:06:43,735 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 45.51%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 44.10%, msgThroughputEMA= 0.00, updatedAt= 1707149203734, reportedAt= 1707149198747
2024-02-05T18:06:43,871 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:43,872 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36377 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:06:43,872 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36377 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:06:43,872 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36377]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:06:43,872 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:43,873 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:06:44,873 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:06:44,873 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36377 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:06:44,874 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36377 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:06:44,874 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36377]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:06:44,874 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36377
2024-02-05T18:06:44,875 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36377 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:06:45,056 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:06:45,058 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:06:45,058 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:06:45,059 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:06:45,059 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:06:45,059 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:06:45,061 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:06:45,063 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:06:45,066 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:06:45,068 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:06:45,069 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:06:45,071 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:06:45,072 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:06:45,073 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:06:45,073 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:06:45,074 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39833
2024-02-05T18:06:45,076 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39833, sourceBroker=localhost:36377, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149198594, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:06:50,087 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39833 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:06:50,093 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39833 was invalidated. state Releasing
2024-02-05T18:06:50,094 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39833. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:06:50,094 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39833
2024-02-05T18:06:50,097 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39833/0x00000000_0xffffffff.
2024-02-05T18:06:50,105 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39833, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149210098, versionId=8]. totalHandledRequests:10
2024-02-05T18:06:50,106 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:06:50,106 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:06:50,106 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:06:50,106 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f5b0391809}, consumerId=4, consumerName=7d55f, address=/127.0.0.1:36028}
2024-02-05T18:06:50,107 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-f5b0391809}, consumerId=4, consumerName=7d55f, address=/127.0.0.1:36028}
2024-02-05T18:06:50,108 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:37629] Broker notification of Closed consumer: 4
2024-02-05T18:06:50,107 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f5b0391809] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5b0391809, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:06:50,108 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-f5b0391809] Successfully closed dispatcher for reader
2024-02-05T18:06:50,108 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-f5b0391809] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 - R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,108 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-f5b0391809] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-f5b0391809, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:06:50,108 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-f5b0391809] Successfully disconnected and closed subscription
2024-02-05T18:06:50,108 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:06:50,113 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:06:50,114 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:06:50,115 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-f5b0391809] Closed Consumer (not connected)
2024-02-05T18:06:50,115 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:06:50,115 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f5b0391809 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-f5b0391809 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:50,122 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39833 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39833, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149210105, versionId=9]. totalHandledRequests:4
2024-02-05T18:06:50,122 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:06:50,124 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39833/0x00000000_0xffffffff.
2024-02-05T18:06:50,125 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:06:50,125 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39833/0x00000000_0xffffffff.
2024-02-05T18:06:50,125 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.031 seconds
2024-02-05T18:06:50,126 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:06:50,126 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:06:50,127 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:36028
2024-02-05T18:06:50,127 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] Disconnected
2024-02-05T18:06:50,127 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-f90b6bad68}, consumerId=0, consumerName=d578a, address=/127.0.0.1:36028}
2024-02-05T18:06:50,127 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f90b6bad68] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f90b6bad68, ackPos=3:6, readPos=3:9}]
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f90b6bad68] Successfully closed dispatcher for reader
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f90b6bad68] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39833/__change_events, name=reader-5f5ee7ccae}, consumerId=3, consumerName=02e7f, address=/127.0.0.1:36028}
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-fc0c76a565] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39833/__change_events] [reader-5f5ee7ccae] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39833/__change_events][reader-5f5ee7ccae] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39833/persistent/__change_events, cursor=reader-5f5ee7ccae, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:06:50,128 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f1b03b23a2] Closed connection [id: 0xfbd79099, L:/127.0.0.1:36028 ! R:localhost/127.0.0.1:37629] -- Will try again in 0.1 s
2024-02-05T18:06:50,129 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39833/__change_events][reader-5f5ee7ccae] Successfully closed dispatcher for reader
2024-02-05T18:06:50,129 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:06:50,129 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:06:50,129 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-f1b03b23a2}, consumerId=2, consumerName=e6944, address=/127.0.0.1:36028}
2024-02-05T18:06:50,129 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39833/persistent/__change_events] Closing managed ledger
2024-02-05T18:06:50,129 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-fc0c76a565}, consumerId=1, consumerName=462c0, address=/127.0.0.1:36028}
2024-02-05T18:06:50,134 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:06:50,134 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39833/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:06:50,134 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:06:50,135 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:06:50,136 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:06:50,139 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37629
2024-02-05T18:06:50,139 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:06:50,139 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:06:50,139 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:06:50,139 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39833/__change_events] [reader-5f5ee7ccae] Closed Consumer (not connected)
2024-02-05T18:06:50,139 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f90b6bad68] Closed Consumer (not connected)
2024-02-05T18:06:50,140 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-fc0c76a565] Closed Consumer (not connected)
2024-02-05T18:06:50,140 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-f1b03b23a2] Closed Consumer (not connected)
2024-02-05T18:06:50,140 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39833/__change_events with subscription name reader-5f5ee7ccae was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39833/__change_events with subscription name reader-5f5ee7ccae was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:50,140 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f90b6bad68 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f90b6bad68 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:50,141 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-fc0c76a565 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-fc0c76a565 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:50,141 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f1b03b23a2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-f1b03b23a2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:06:50,143 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:06:50,143 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:06:50,143 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:06:50,143 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:06:50,143 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:06:50,143 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:50,144 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:06:50,144 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:51,532 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:06:51,533 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:06:51,534 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:06:51,534 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:51,534 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:06:51,535 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:06:51,543 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:06:51,543 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:06:51,548 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:06:51,548 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:06:51,548 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:06:51,549 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:06:51,549 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 192 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:06:51,549 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:06:51,549 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:06:51,549 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@11efc5da
2024-02-05T18:06:51,549 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:06:51,550 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:06:51,550 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.531 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:17 min
[INFO] Finished at: 2024-02-05T18:06:51+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 2 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:07:23,227 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:07:24,294 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:07:24,295 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:07:24,737 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:07:24,738 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:07:24,739 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:07:24,739 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:07:24,740 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:07:24,741 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:07:24,756 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:07:24,757 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:07:24,757 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:07:24,758 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:07:24,758 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:07:24,759 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:07:24,759 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:07:24,760 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:07:24,760 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:07:24,761 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-02-05T18:07:24,762 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:07:24,762 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:07:26,452 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:07:26,453 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:07:26,454 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:07:26,454 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:07:26,781 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:07:26,782 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:07:26,869 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:07:26,950 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:07:26,953 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:07:26,969 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:07:27,088 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:07:27,129 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:07:27,180 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:07:27,671 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:07:27,672 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:07:27,725 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:07:27,839 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33893, TLS: (none), listener: (none)
2024-02-05T18:07:28,483 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43281, TLS: OPENSSL, listener: (none)
2024-02-05T18:07:28,533 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:07:28,547 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:07:28,554 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:07:28,596 - INFO  - [main:Log@170] - Logging initialized @7839ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:07:30,213 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:07:30,257 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:07:30,257 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:07:30,260 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:07:31,546 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/,null,AVAILABLE}
2024-02-05T18:07:33,823 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin,null,AVAILABLE}
2024-02-05T18:07:35,926 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v2,null,AVAILABLE}
2024-02-05T18:07:36,646 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/admin/v3,null,AVAILABLE}
2024-02-05T18:07:36,904 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/lookup,null,AVAILABLE}
2024-02-05T18:07:37,197 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/topics,null,AVAILABLE}
2024-02-05T18:07:37,199 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/metrics,null,AVAILABLE}
2024-02-05T18:07:37,201 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1d0f7bcf{/static,null,AVAILABLE}
2024-02-05T18:07:37,235 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4c5e4bfa{HTTP/1.1, (http/1.1)}{0.0.0.0:36789}
2024-02-05T18:07:37,540 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@27a6384b{SSL, (ssl, http/1.1)}{0.0.0.0:45975}
2024-02-05T18:07:37,540 - INFO  - [main:Server@415] - Started @16786ms
2024-02-05T18:07:37,541 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36789
2024-02-05T18:07:37,542 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45975
2024-02-05T18:07:37,556 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:07:37,557 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:07:37,867 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36789
2024-02-05T18:07:37,898 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:07:37,921 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36789).
2024-02-05T18:07:37,943 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:36789 is changing the role from null to Leader
2024-02-05T18:07:38,660 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36789 
2024-02-05T18:07:39,686 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:07:39,760 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:39,992 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:07:39,999 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:07:40,020 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:07:40,035 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:07:40,118 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:07:40,177 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:07:40,219 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:07:40,332 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:07:40,372 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:07:40,390 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:07:40,396 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:07:40,463 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:07:40,474 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:39 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 1134
2024-02-05T18:07:40,710 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]] Connected to server
2024-02-05T18:07:40,780 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:39162] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:07:40,920 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:40,936 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,056 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:07:41,113 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:39162] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:39162, producerName=test-0-0, producerId=0}
2024-02-05T18:07:41,126 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,128 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:07:41,243 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,247 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-021bc6c3df] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 0
2024-02-05T18:07:41,273 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-021bc6c3df. consumerId: 0
2024-02-05T18:07:41,331 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-021bc6c3df] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:41,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:07:41,333 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-021bc6c3df, ackPos=3:-1, readPos=3:0}
2024-02-05T18:07:41,366 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-021bc6c3df
2024-02-05T18:07:41,372 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-021bc6c3df] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 0
2024-02-05T18:07:41,393 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.019 seconds
2024-02-05T18:07:41,394 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:07:41,395 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:07:41,395 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:07:41,490 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,561 - INFO  - [pulsar-web-30-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:07:41,571 - INFO  - [pulsar-web-30-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:07:41,574 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:07:41,580 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:41 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 149
2024-02-05T18:07:41,602 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,622 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:07:41,630 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:07:41,632 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:41 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 48
2024-02-05T18:07:41,636 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:07:41,678 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,679 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,705 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:07:41,714 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:39162] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:39162, producerName=test-0-1, producerId=1}
2024-02-05T18:07:41,720 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,783 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,789 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f264861a14] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 1
2024-02-05T18:07:41,793 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f264861a14. consumerId: 1
2024-02-05T18:07:41,868 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f264861a14] Created new subscription for 1
2024-02-05T18:07:41,870 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f264861a14
2024-02-05T18:07:41,872 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f264861a14] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 1
2024-02-05T18:07:41,909 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:41,911 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,926 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:07:41,938 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:39162] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:39162, producerName=test-0-2, producerId=2}
2024-02-05T18:07:41,940 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:41,969 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:07:42,016 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:07:42,029 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:36789 started the ownership monitor.
2024-02-05T18:07:42,057 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:42,061 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-56a6b8ce66] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 2
2024-02-05T18:07:42,066 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-56a6b8ce66. consumerId: 2
2024-02-05T18:07:42,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-56a6b8ce66] Created new subscription for 2
2024-02-05T18:07:42,103 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-56a6b8ce66
2024-02-05T18:07:42,109 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-56a6b8ce66] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 2
2024-02-05T18:07:42,110 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:36789 plays the leader now.
2024-02-05T18:07:42,112 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36789/__change_events
2024-02-05T18:07:42,123 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.10%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.10%, msgThroughputEMA= 0.00, updatedAt= 1707149262116, reportedAt= 0
2024-02-05T18:07:42,175 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:07:42,194 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:42,204 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 8.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:42,321 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36789/0x00000000_0xffffffff - localhost:36789.
2024-02-05T18:07:42,323 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36789
2024-02-05T18:07:42,325 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36789/__change_events][reader-a884352547] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 3
2024-02-05T18:07:42,326 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36789/0x00000000_0xffffffff - localhost:36789.
2024-02-05T18:07:42,329 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36789/0x00000000_0xffffffff
2024-02-05T18:07:42,332 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36789
2024-02-05T18:07:42,332 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic persistent://sla-monitor/test/localhost:36789/__change_events / reader-a884352547. consumerId: 3
2024-02-05T18:07:42,333 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36789/0x00000000_0xffffffff
2024-02-05T18:07:42,353 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36789/persistent/__change_events
2024-02-05T18:07:42,355 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36789/persistent/__change_events'
2024-02-05T18:07:42,373 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:07:42,374 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36789/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:07:42,375 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36789 doesn't exist.
2024-02-05T18:07:42,387 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36789/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:07:42,397 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36789/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:07:42,403 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36789/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36789/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:07:42,404 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36789/__change_events - dedup is disabled
2024-02-05T18:07:42,436 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:07:42,448 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36789/__change_events][reader-a884352547] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:42,448 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36789/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:07:42,449 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36789/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36789/persistent/__change_events, cursor=reader-a884352547, ackPos=7:-1, readPos=7:0}
2024-02-05T18:07:42,451 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic persistent://sla-monitor/test/localhost:36789/__change_events / reader-a884352547
2024-02-05T18:07:42,452 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36789/__change_events][reader-a884352547] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 3
2024-02-05T18:07:43,204 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:43,205 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:42,406 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=15, bootstrap service port = 36789, tls-port = Optional[45975], broker url= pulsar://localhost:33893, broker tls url= pulsar+ssl://localhost:43281, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33893], brokerServicePortTls=Optional[43281], webServicePort=Optional[36789], webServicePortTls=Optional[45975], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:07:43,878 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:07:43,878 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:07:43,879 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:07:43,879 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:07:43,911 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:07:43,912 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:07:43,957 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:07:43,962 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:07:44,011 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:07:44,012 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:07:44,039 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:07:44,055 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:07:44,067 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:07:44,098 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:07:44,098 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:07:44,111 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:07:44,119 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40863, TLS: (none), listener: (none)
2024-02-05T18:07:44,122 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45059, TLS: OPENSSL, listener: (none)
2024-02-05T18:07:44,131 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:07:44,133 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:07:44,133 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:07:44,169 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:07:44,177 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:07:44,178 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:07:44,178 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:07:44,207 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:44,208 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:44,525 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:07:45,211 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:45,212 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:46,215 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:46,216 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:46,227 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:07:47,004 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 77.73%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 56.46%, msgThroughputEMA= 0.00, updatedAt= 1707149267003, reportedAt= 1707149262300
2024-02-05T18:07:47,216 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:47,217 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:48,218 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:48,219 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:49,219 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:49,220 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:49,239 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:07:49,723 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:07:49,890 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:07:50,046 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:07:50,050 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:07:50,051 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:07:50,053 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:35431}
2024-02-05T18:07:50,075 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:37113}
2024-02-05T18:07:50,075 - INFO  - [main:Server@415] - Started @29321ms
2024-02-05T18:07:50,076 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:35431
2024-02-05T18:07:50,078 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37113
2024-02-05T18:07:50,088 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:07:50,091 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:07:50,108 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:35431
2024-02-05T18:07:50,111 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:35431 registry has been created.
2024-02-05T18:07:50,112 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:35431. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:07:50,128 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:35431 is changing the role from null to Follower
2024-02-05T18:07:50,129 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36789).
2024-02-05T18:07:50,136 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:07:50,158 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:35431 
2024-02-05T18:07:50,226 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:50,226 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:50,431 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 122
2024-02-05T18:07:50,461 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:50,463 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:07:50,465 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:07:50,514 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 73
2024-02-05T18:07:50,518 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35431/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:07:50,553 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x51047feb, L:/127.0.0.1:51616 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:50,578 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:51616] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:07:50,627 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]] Connected to server
2024-02-05T18:07:50,633 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:52316] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:07:50,637 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:50,660 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52316] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52316, producerName=test-0-3, producerId=0}
2024-02-05T18:07:50,662 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:50,699 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45100b1bc4] Subscribing to topic on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893], consumerId 0
2024-02-05T18:07:50,701 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xa60ababe, L:/127.0.0.1:33893 - R:/127.0.0.1:52316]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-45100b1bc4. consumerId: 0
2024-02-05T18:07:50,711 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45100b1bc4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:50,711 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:07:50,712 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-45100b1bc4, ackPos=3:-1, readPos=3:0}
2024-02-05T18:07:50,725 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52316] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-45100b1bc4
2024-02-05T18:07:50,733 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45100b1bc4] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 0
2024-02-05T18:07:50,773 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.039 seconds
2024-02-05T18:07:50,774 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:07:50,879 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 91
2024-02-05T18:07:50,892 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:50,896 - ERROR - [pulsar-web-30-7:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:07:50,900 - ERROR - [pulsar-web-30-7:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:07:50,909 - INFO  - [pulsar-web-30-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:07:50,916 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35431/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:07:50,945 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:50,948 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:07:50,957 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:07:50,957 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:07:50,969 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:50 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:07:50,970 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35431/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:07:50,995 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:51,007 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52316] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52316, producerName=test-0-4, producerId=1}
2024-02-05T18:07:51,008 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:51,029 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2550ddb583] Subscribing to topic on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893], consumerId 1
2024-02-05T18:07:51,032 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xa60ababe, L:/127.0.0.1:33893 - R:/127.0.0.1:52316]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2550ddb583. consumerId: 1
2024-02-05T18:07:51,044 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2550ddb583] Created new subscription for 1
2024-02-05T18:07:51,045 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52316] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2550ddb583
2024-02-05T18:07:51,045 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2550ddb583] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 1
2024-02-05T18:07:51,064 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:51,073 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52316] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52316, producerName=test-0-5, producerId=2}
2024-02-05T18:07:51,074 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xdf69c4ec, L:/127.0.0.1:52316 - R:localhost/127.0.0.1:33893]
2024-02-05T18:07:51,076 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:07:51,080 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:07:51,084 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:35431 plays a follower now.
2024-02-05T18:07:51,128 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:35431/__change_events
2024-02-05T18:07:51,232 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:51,232 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:51,234 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:35431/0x00000000_0xffffffff - localhost:35431.
2024-02-05T18:07:51,236 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:35431
2024-02-05T18:07:51,237 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:35431/0x00000000_0xffffffff - localhost:35431.
2024-02-05T18:07:51,238 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:35431
2024-02-05T18:07:51,260 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:35431/0x00000000_0xffffffff
2024-02-05T18:07:51,260 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:35431/0x00000000_0xffffffff
2024-02-05T18:07:51,268 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:35431/__change_events][reader-3b9e993228] Subscribing to topic on cnx [id: 0x51047feb, L:/127.0.0.1:51616 - R:localhost/127.0.0.1:40863], consumerId 2
2024-02-05T18:07:51,272 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:35431 doesn't exist.
2024-02-05T18:07:51,281 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xf733f914, L:/127.0.0.1:40863 - R:/127.0.0.1:51616]] Subscribing on topic persistent://sla-monitor/test/localhost:35431/__change_events / reader-3b9e993228. consumerId: 2
2024-02-05T18:07:51,294 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:35431/persistent/__change_events
2024-02-05T18:07:51,297 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:35431/persistent/__change_events'
2024-02-05T18:07:51,285 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=7, bootstrap service port = 35431, tls-port = Optional[37113], broker url= pulsar://localhost:40863, broker tls url= pulsar+ssl://localhost:45059, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40863], brokerServicePortTls=Optional[45059], webServicePort=Optional[35431], webServicePortTls=Optional[37113], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:07:51,306 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:07:51,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:35431/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:07:51,312 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:35431/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:07:51,320 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:35431/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:07:51,323 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:35431/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:35431/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:07:51,325 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:35431/__change_events - dedup is disabled
2024-02-05T18:07:51,350 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:07:51,358 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:35431/__change_events][reader-3b9e993228] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:51,359 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:35431/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:07:51,359 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:35431/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35431/persistent/__change_events, cursor=reader-3b9e993228, ackPos=9:-1, readPos=9:0}
2024-02-05T18:07:51,362 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:51616] Created subscription on topic persistent://sla-monitor/test/localhost:35431/__change_events / reader-3b9e993228
2024-02-05T18:07:51,372 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:35431/__change_events][reader-3b9e993228] Subscribed to topic on localhost/127.0.0.1:40863 -- consumer: 2
2024-02-05T18:07:51,874 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:07:51,875 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:51 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 35
2024-02-05T18:07:51,914 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:07:51,915 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:51 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 31
2024-02-05T18:07:51,959 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:07:51,961 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:07:51,964 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:07:51,966 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:51 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 42
2024-02-05T18:07:52,018 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 36.52%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.47%, msgThroughputEMA= 0.00, updatedAt= 1707149272015, reportedAt= 1707149262300
2024-02-05T18:07:52,072 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:07:52,074 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:07:52,075 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:07:52,078 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:07:52,080 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:51 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 98
2024-02-05T18:07:52,082 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:07:52,104 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:07:52,106 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:07:52,109 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:07:52,113 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:52 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:07:52,124 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:07:52,125 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:07:52,127 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:07:52,128 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:07:52,135 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:52 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:07:52,140 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:07:52,195 - INFO  - [pulsar-web-30-6:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:07:52,209 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:07:52,210 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:07:52,229 - INFO  - [pulsar-web-30-7:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:07:52,235 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:52,236 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:07:52,260 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:52,302 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36789 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:07:52,400 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36789, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149272307, versionId=1]. totalHandledRequests:1
2024-02-05T18:07:52,480 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36789, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149272465, versionId=2]. totalHandledRequests:1
2024-02-05T18:07:52,483 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:52,521 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:07:52,522 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:07:52,527 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:07:52,528 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:52 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 340
2024-02-05T18:07:52,531 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:07:52 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 305
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:07:52,545 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:07:52,565 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:07:52,566 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:07:52,601 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:52,605 - INFO  - [broker-client-shared-internal-executor-11-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-8b465b4007] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 4
2024-02-05T18:07:52,612 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic persistent://public/test/__change_events / reader-8b465b4007. consumerId: 4
2024-02-05T18:07:52,627 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36789, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149272511, versionId=3]. totalHandledRequests:1
2024-02-05T18:07:52,629 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:07:52,639 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:07:52,760 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:07:52,763 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:07:52,764 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:07:52,786 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:07:52,792 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:07:52,800 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:07:52,803 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:07:52,823 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:07:52,824 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:07:52,825 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:07:52,850 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@74097353], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@224364fb] 
2024-02-05T18:07:52,854 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6075ef64, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@74097353, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@664b683b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@224364fb, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d01adcb] 
2024-02-05T18:07:52,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:07:52,900 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 262.0 ms
2024-02-05T18:07:52,916 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36789, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149272627, versionId=4]. totalHandledRequests:4
2024-02-05T18:07:52,920 - WARN  - [broker-client-shared-internal-executor-11-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36789. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:07:52,921 - WARN  - [broker-client-shared-internal-executor-11-1:ServerCnx@1299] - [/127.0.0.1:39162][persistent://public/test/__change_events][reader-8b465b4007] Failed to create consumer: consumerId=4, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36789. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:07:52,924 - WARN  - [pulsar-io-9-4:ClientCnx@776] - [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36789. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:07:52,926 - WARN  - [pulsar-io-9-4:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-8b465b4007] Failed to subscribe to topic on localhost/127.0.0.1:33893
2024-02-05T18:07:52,927 - WARN  - [pulsar-io-9-4:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-8b465b4007] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36789. Please redo the lookup. Request is denied: namespace=public/test","reqId":3981925808462709520, "remote":"localhost/127.0.0.1:33893", "local":"/127.0.0.1:39162"}
2024-02-05T18:07:52,929 - WARN  - [pulsar-io-9-4:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-8b465b4007] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36789. Please redo the lookup. Request is denied: namespace=public/test","reqId":3981925808462709520, "remote":"localhost/127.0.0.1:33893", "local":"/127.0.0.1:39162"} -- Will try again in 0.1 s
!!!!!!!!! FAILURE-- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:07:52,975 - INFO  - [main:TestRetrySupport@70] - Detected test failure in test ExtensibleLoadManagerImplTest.testGetMetrics, currentSetupNumber=1
2024-02-05T18:07:52,992 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:07:53,008 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:07:53,009 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:07:53,011 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:07:53,016 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:07:53,031 - INFO  - [broker-client-shared-timer-14-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-8b465b4007] Reconnecting after connection was closed
2024-02-05T18:07:53,035 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:07:53,038 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:53,058 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36789. Skipping this broker. Phase one
2024-02-05T18:07:53,058 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:36789. Skipping this broker. Phase two
2024-02-05T18:07:53,059 - INFO  - [ForkJoinPool.commonPool-worker-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:35431 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:07:53,053 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:07:53,074 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:07:53,077 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:07:53,083 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:07:53,094 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:07:53,100 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:35431, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149273059, versionId=5]. totalHandledRequests:8
2024-02-05T18:07:53,106 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:07:53,112 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:07:53,113 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:35431, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149273082, versionId=6]. totalHandledRequests:6
2024-02-05T18:07:53,117 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:07:53,117 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:07:53,119 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35431
2024-02-05T18:07:53,134 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:07:53,137 - INFO  - [pulsar-io-9-2:ConnectionPool@265] - [[id: 0xe9de3a0f, L:/127.0.0.1:50254 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,138 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36789. Skipping this broker. Phase one
2024-02-05T18:07:53,142 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:50254
2024-02-05T18:07:53,143 - WARN  - [pulsar-io-9-2:ClientCnx@776] - [id: 0xe9de3a0f, L:/127.0.0.1:50254 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,143 - WARN  - [pulsar-io-9-2:ClientCnx@798] - [id: 0xe9de3a0f, L:/127.0.0.1:50254 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,144 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:35431, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149273082, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36789, sourceBroker=localhost:35431, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149273144, versionId=7]
2024-02-05T18:07:53,152 - INFO  - [pulsar-io-9-2:ClientCnx@308] - [id: 0xe9de3a0f, L:/127.0.0.1:50254 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,152 - WARN  - [pulsar-io-9-2:ConnectionPool@292] - [[id: 0xe9de3a0f, L:/127.0.0.1:50254 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,153 - WARN  - [pulsar-io-9-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-8b465b4007] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,153 - WARN  - [pulsar-io-9-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-8b465b4007] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.198 s
2024-02-05T18:07:53,170 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36789, sourceBroker=localhost:35431, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149273144, versionId=7]. totalHandledRequests:7
2024-02-05T18:07:53,171 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:36789 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:36789, sourceBroker=localhost:35431, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149273144, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T18:07:53,172 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:07:53,216 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x51047feb, L:/127.0.0.1:51616 - R:localhost/127.0.0.1:40863] Close connection because received internal-server error {"errorMsg":"Failed due to pulsar service is not ready","reqId":2987417287944116192, "remote":"localhost/127.0.0.1:40863", "local":"/127.0.0.1:51616"}
2024-02-05T18:07:53,217 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x51047feb, L:/127.0.0.1:51616 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,217 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Closed connection [id: 0x51047feb, L:/127.0.0.1:51616 ! R:localhost/127.0.0.1:40863] -- Will try again in 0.1 s
2024-02-05T18:07:53,219 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:51616
2024-02-05T18:07:53,219 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:35431/__change_events, name=reader-3b9e993228}, consumerId=2, consumerName=7bb3b, address=/127.0.0.1:51616}
2024-02-05T18:07:53,220 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:35431/__change_events][reader-3b9e993228] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35431/persistent/__change_events, cursor=reader-3b9e993228, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:07:53,222 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:35431/__change_events][reader-3b9e993228] Successfully closed dispatcher for reader
2024-02-05T18:07:53,234 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:53,236 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:53,237 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:07:53,236 - WARN  - [broker-client-shared-internal-executor-65-1:BinaryProtoLookupService@234] - [persistent://public/test/__change_events] failed to get Partitioned metadata : {"errorMsg":"Failed due to pulsar service is not ready","reqId":2987417287944116192, "remote":"localhost/127.0.0.1:40863", "local":"/127.0.0.1:51616"}
org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":2987417287944116192, "remote":"localhost/127.0.0.1:40863", "local":"/127.0.0.1:51616"}
	at org.apache.pulsar.client.impl.ClientCnx.getPulsarClientException(ClientCnx.java:1282) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.handlePartitionResponse(ClientCnx.java:662) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:144) ~[pulsar-common-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.flush.FlushConsolidationHandler.channelRead(FlushConsolidationHandler.java:152) ~[netty-handler-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:07:53,238 - INFO  - [broker-client-shared-internal-executor-11-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b06b8c6a92] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 5
2024-02-05T18:07:53,241 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic persistent://public/test/__change_events / reader-b06b8c6a92. consumerId: 5
2024-02-05T18:07:53,249 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 1.0 ms
2024-02-05T18:07:53,260 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:07:53,279 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:07:53,281 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:07:53,292 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:07:53,296 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:07:53,297 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:07:53,302 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:07:53,304 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:07:53,304 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:07:53,311 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:07:53,319 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Reconnecting after timeout
2024-02-05T18:07:53,321 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x0556060e, L:/127.0.0.1:50256 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-b06b8c6a92] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:53,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:07:53,322 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b06b8c6a92, ackPos=13:-1, readPos=13:0}
2024-02-05T18:07:53,324 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic persistent://public/test/__change_events / reader-b06b8c6a92
2024-02-05T18:07:53,325 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-b06b8c6a92] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 5
2024-02-05T18:07:53,326 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:50256
2024-02-05T18:07:53,327 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x0556060e, L:/127.0.0.1:50256 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,327 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x0556060e, L:/127.0.0.1:50256 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,328 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x0556060e, L:/127.0.0.1:50256 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,328 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x0556060e, L:/127.0.0.1:50256 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,329 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,329 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.195 s
2024-02-05T18:07:53,341 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 100 ms
2024-02-05T18:07:53,342 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x6da30434, L:/127.0.0.1:50270 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,352 - INFO  - [broker-client-shared-timer-14-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-8b465b4007] Reconnecting after connection was closed
2024-02-05T18:07:53,360 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:50270
2024-02-05T18:07:53,360 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x6da30434, L:/127.0.0.1:50270 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,360 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x6da30434, L:/127.0.0.1:50270 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,361 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x6da30434, L:/127.0.0.1:50270 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,361 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x6da30434, L:/127.0.0.1:50270 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,364 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:07:53,376 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-8b465b4007] Subscribing to topic on cnx [id: 0xdd71e808, L:/127.0.0.1:39162 - R:localhost/127.0.0.1:33893], consumerId 4
2024-02-05T18:07:53,379 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x396a1aea, L:/127.0.0.1:33893 - R:/127.0.0.1:39162]] Subscribing on topic persistent://public/test/__change_events / reader-8b465b4007. consumerId: 4
2024-02-05T18:07:53,399 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-8b465b4007] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:07:53,401 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:07:53,402 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8b465b4007, ackPos=13:-1, readPos=13:0}
2024-02-05T18:07:53,409 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:39162] Created subscription on topic persistent://public/test/__change_events / reader-8b465b4007
2024-02-05T18:07:53,410 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-8b465b4007] Subscribed to topic on localhost/127.0.0.1:33893 -- consumer: 4
2024-02-05T18:07:53,419 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:39162] Closing consumer: consumerId=4
2024-02-05T18:07:53,420 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-8b465b4007}, consumerId=4, consumerName=74f3c, address=/127.0.0.1:39162}
2024-02-05T18:07:53,420 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-8b465b4007] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8b465b4007, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:07:53,420 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-8b465b4007] Successfully closed dispatcher for reader
2024-02-05T18:07:53,421 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:39162] Closed consumer, consumerId=4
2024-02-05T18:07:53,422 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-8b465b4007] Closed consumer
2024-02-05T18:07:53,429 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:07:53,431 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:39162] Closing consumer: consumerId=5
2024-02-05T18:07:53,431 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b06b8c6a92}, consumerId=5, consumerName=9e41b, address=/127.0.0.1:39162}
2024-02-05T18:07:53,434 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b06b8c6a92] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b06b8c6a92, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:07:53,434 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-b06b8c6a92] Successfully closed dispatcher for reader
2024-02-05T18:07:53,437 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:39162] Closed consumer, consumerId=5
2024-02-05T18:07:53,438 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-b06b8c6a92] Closed consumer
2024-02-05T18:07:53,438 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b06b8c6a92 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b06b8c6a92 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:07:53,525 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Reconnecting after connection was closed
2024-02-05T18:07:53,527 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xc3d7d78f, L:/127.0.0.1:50278 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,532 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xc3d7d78f, L:/127.0.0.1:50278 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,532 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xc3d7d78f, L:/127.0.0.1:50278 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,533 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:50278
2024-02-05T18:07:53,533 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xc3d7d78f, L:/127.0.0.1:50278 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,534 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xc3d7d78f, L:/127.0.0.1:50278 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,539 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,539 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.363 s
2024-02-05T18:07:53,555 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 193 ms
2024-02-05T18:07:53,557 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x791b7f17, L:/127.0.0.1:50288 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,561 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x791b7f17, L:/127.0.0.1:50288 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,561 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x791b7f17, L:/127.0.0.1:50288 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,562 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x791b7f17, L:/127.0.0.1:50288 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,563 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x791b7f17, L:/127.0.0.1:50288 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:53,563 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:50288
2024-02-05T18:07:53,904 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Reconnecting after connection was closed
2024-02-05T18:07:53,910 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xc3a3c5de, L:/127.0.0.1:50296 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,910 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xc3a3c5de, L:/127.0.0.1:50296 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,914 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xc3a3c5de, L:/127.0.0.1:50296 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,915 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:50296
2024-02-05T18:07:53,915 - INFO  - [broker-client-shared-timer-68-1:ConnectionPool@265] - [[id: 0xc3a3c5de, L:/127.0.0.1:50296 ! R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,916 - WARN  - [broker-client-shared-timer-68-1:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Error connecting to broker: io.netty.channel.ChannelException: Connection already closed
2024-02-05T18:07:53,916 - WARN  - [broker-client-shared-timer-68-1:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Could not get connection to broker: io.netty.channel.ChannelException: Connection already closed -- Will try again in 0.759 s
2024-02-05T18:07:53,946 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 383 ms
2024-02-05T18:07:53,948 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x1028ae3f, L:/127.0.0.1:50308 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:53,952 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x1028ae3f, L:/127.0.0.1:50308 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:53,952 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:50308
2024-02-05T18:07:53,952 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x1028ae3f, L:/127.0.0.1:50308 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:53,953 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x1028ae3f, L:/127.0.0.1:50308 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:53,953 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x1028ae3f, L:/127.0.0.1:50308 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:54,237 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:54,238 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:07:54,681 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Reconnecting after connection was closed
2024-02-05T18:07:54,682 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x832b4ad6, L:/127.0.0.1:50310 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:54,693 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x832b4ad6, L:/127.0.0.1:50310 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:54,694 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:50310
2024-02-05T18:07:54,693 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x832b4ad6, L:/127.0.0.1:50310 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:54,694 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x832b4ad6, L:/127.0.0.1:50310 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:54,695 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x832b4ad6, L:/127.0.0.1:50310 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:54,695 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:54,695 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.466 s
2024-02-05T18:07:54,738 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 785 ms
2024-02-05T18:07:54,740 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xa657012d, L:/127.0.0.1:50324 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:54,747 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xa657012d, L:/127.0.0.1:50324 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:54,747 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xa657012d, L:/127.0.0.1:50324 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:54,750 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xa657012d, L:/127.0.0.1:50324 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:54,751 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xa657012d, L:/127.0.0.1:50324 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:54,753 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:50324
2024-02-05T18:07:55,239 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:55,240 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:07:56,173 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Reconnecting after connection was closed
2024-02-05T18:07:56,179 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:50340
2024-02-05T18:07:56,185 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xaaf70a2e, L:/127.0.0.1:50340 - R:localhost/127.0.0.1:40863] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:07:56,186 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xaaf70a2e, L:/127.0.0.1:50340 - R:localhost/127.0.0.1:40863] Received unknown request id from server: -1
2024-02-05T18:07:56,187 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xaaf70a2e, L:/127.0.0.1:50340 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:56,192 - INFO  - [broker-client-shared-timer-68-1:ConnectionPool@265] - [[id: 0xaaf70a2e, L:/127.0.0.1:50340 ! R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:56,196 - WARN  - [broker-client-shared-timer-68-1:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Error connecting to broker: io.netty.channel.ChannelException: Connection already closed
2024-02-05T18:07:56,196 - WARN  - [broker-client-shared-timer-68-1:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Could not get connection to broker: io.netty.channel.ChannelException: Connection already closed -- Will try again in 2.942 s
2024-02-05T18:07:56,240 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:07:56,241 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:07:56,273 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35431 in 3152.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:07:56,280 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:35431 registry has been deleted.
2024-02-05T18:07:56,281 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35431 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:07:56,286 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:35431 was invalidated. state Releasing
2024-02-05T18:07:56,288 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:35431. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:07:56,289 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35431 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:07:56,289 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35431
2024-02-05T18:07:56,291 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:35431
2024-02-05T18:07:56,305 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35431 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:07:56,330 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:35431/0x00000000_0xffffffff.
2024-02-05T18:07:56,332 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:35431/0x00000000_0xffffffff.
2024-02-05T18:07:56,343 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:35431/0x00000000_0xffffffff.
2024-02-05T18:07:56,344 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.052 seconds
2024-02-05T18:07:56,345 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 1594 ms
2024-02-05T18:07:56,346 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:07:56,347 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xbc6e8dc4, L:/127.0.0.1:50348 - R:localhost/127.0.0.1:40863]] Connected to server
2024-02-05T18:07:56,358 - WARN  - [pulsar-io-64-1:ServerCnx@407] - [/127.0.0.1:50348] Got exception java.lang.NullPointerException: Cannot invoke "org.apache.pulsar.broker.service.BrokerService.getPulsarStats()" because "this.service" is null
	at org.apache.pulsar.broker.service.ServerCnx.channelActive(ServerCnx.java:334)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelActive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelActive(AbstractChannelHandlerContext.java:238)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelActive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelActive(DefaultChannelPipeline.java:1398)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelActive(AbstractChannelHandlerContext.java:258)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelActive(AbstractChannelHandlerContext.java:238)
	at io.netty.channel.DefaultChannelPipeline.fireChannelActive(DefaultChannelPipeline.java:895)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:522)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:413)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:07:56,359 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:07:56,359 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xbc6e8dc4, L:/127.0.0.1:50348 ! R:localhost/127.0.0.1:40863] Disconnected
2024-02-05T18:07:56,360 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xbc6e8dc4, L:/127.0.0.1:50348 ! R:localhost/127.0.0.1:40863]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:07:56,360 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:35431/persistent/__change_events] Closing managed ledger
2024-02-05T18:07:56,362 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:35431/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:07:56,365 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:07:56,367 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:07:56,368 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:07:56,361 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:50348
2024-02-05T18:07:56,374 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:52316
2024-02-05T18:07:56,375 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-45100b1bc4}, consumerId=0, consumerName=40268, address=/127.0.0.1:52316}
2024-02-05T18:07:56,389 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45100b1bc4] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-45100b1bc4, ackPos=3:6, readPos=3:7}]
2024-02-05T18:07:56,389 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-45100b1bc4] Successfully closed dispatcher for reader
2024-02-05T18:07:56,390 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-2550ddb583}, consumerId=1, consumerName=dcc7e, address=/127.0.0.1:52316}
2024-02-05T18:07:56,390 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40863
2024-02-05T18:07:56,392 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xdf69c4ec, L:/127.0.0.1:52316 ! R:localhost/127.0.0.1:33893] Disconnected
2024-02-05T18:07:56,393 - INFO  - [pulsar-io-64-1:ProducerImpl@1084] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer
2024-02-05T18:07:56,395 - INFO  - [main:ProducerImpl@1084] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer
2024-02-05T18:07:56,395 - INFO  - [pulsar-io-64-1:ConnectionHandler@157] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Ignoring reconnection request (state: Closing)
2024-02-05T18:07:56,396 - INFO  - [pulsar-io-64-1:ConnectionHandler@157] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Ignoring reconnection request (state: Closing)
2024-02-05T18:07:56,396 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:35431/__change_events] [reader-3b9e993228] Closed Consumer (not connected)
2024-02-05T18:07:56,397 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45100b1bc4] Closed connection [id: 0xdf69c4ec, L:/127.0.0.1:52316 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:07:56,403 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2550ddb583] Closed connection [id: 0xdf69c4ec, L:/127.0.0.1:52316 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:07:56,404 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35431/__change_events with subscription name reader-3b9e993228 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35431/__change_events with subscription name reader-3b9e993228 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:07:56,404 - WARN  - [pulsar-io-64-1:ClientCnx@972] - [id: 0xdf69c4ec, L:/127.0.0.1:52316 ! R:localhost/127.0.0.1:33893] Failed to send request to broker: null
2024-02-05T18:07:56,405 - INFO  - [pulsar-io-64-1:ProducerImpl@1084] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer
2024-02-05T18:07:56,420 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45100b1bc4] Closed Consumer (not connected)
2024-02-05T18:07:56,423 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-45100b1bc4 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-45100b1bc4 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:07:56,424 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2550ddb583] Closed Consumer (not connected)
2024-02-05T18:07:56,425 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2550ddb583 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2550ddb583 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:07:56,455 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:07:56,456 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:07:56,474 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:07:56,476 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:07:56,507 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45100b1bc4] Reconnecting after timeout
2024-02-05T18:07:56,507 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-45100b1bc4] Ignoring reconnection request (state: Closed)
2024-02-05T18:07:56,508 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2550ddb583] Reconnecting after timeout
2024-02-05T18:07:56,508 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2550ddb583] Ignoring reconnection request (state: Closed)
2024-02-05T18:07:56,524 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:07:56,524 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:07:57,003 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:07:57,004 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 41.21%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 41.21%, msgThroughputEMA= 0.00, updatedAt= 1707149277003, reportedAt= 0
2024-02-05T18:07:57,245 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:57,246 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35431 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:07:57,246 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35431 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:07:57,247 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35431]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:07:57,247 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35431
2024-02-05T18:07:57,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35431 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:07:57,708 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:07:57,709 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:07:57,712 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:07:57,715 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:07:57,715 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:07:57,716 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:07:58,247 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:58,248 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35431 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:07:58,248 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35431 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:07:58,248 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35431]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:07:58,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35431
2024-02-05T18:07:58,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35431 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:07:59,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:07:59,249 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35431 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:07:59,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35431 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:07:59,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:35431]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:07:59,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35431
2024-02-05T18:07:59,251 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35431 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:07:59,756 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:07:59,759 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4c5e4bfa{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:07:59,760 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@27a6384b{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:07:59,760 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:07:59,760 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1d0f7bcf{/static,null,STOPPED}
2024-02-05T18:07:59,761 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/metrics,null,STOPPED}
2024-02-05T18:07:59,763 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/topics,null,STOPPED}
2024-02-05T18:07:59,766 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/lookup,null,STOPPED}
2024-02-05T18:07:59,784 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/admin/v3,null,STOPPED}
2024-02-05T18:07:59,786 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v2,null,STOPPED}
2024-02-05T18:07:59,788 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin,null,STOPPED}
2024-02-05T18:07:59,790 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/,null,STOPPED}
2024-02-05T18:07:59,794 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:07:59,804 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:07:59,805 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:07:59,806 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36789
2024-02-05T18:07:59,817 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36789, sourceBroker=localhost:35431, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149273144, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:08:04,827 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36789 in 5019.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:08:04,836 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36789 was invalidated. state Releasing
2024-02-05T18:08:04,836 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36789. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:08:04,836 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36789
2024-02-05T18:08:04,841 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36789/0x00000000_0xffffffff.
2024-02-05T18:08:04,842 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36789/0x00000000_0xffffffff.
2024-02-05T18:08:04,852 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36789, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149284845, versionId=8]. totalHandledRequests:10
2024-02-05T18:08:04,853 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:08:04,853 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:08:04,854 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:08:04,854 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:08:04,859 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:08:04,861 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:08:04,862 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:08:04,871 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36789 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36789, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149284852, versionId=9]. totalHandledRequests:5
2024-02-05T18:08:04,871 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:08:04,873 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36789/0x00000000_0xffffffff.
2024-02-05T18:08:04,873 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.036 seconds
2024-02-05T18:08:04,873 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:08:04,874 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:08:04,874 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36789/persistent/__change_events] Closing managed ledger
2024-02-05T18:08:04,874 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:08:04,874 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:08:04,875 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:39162
2024-02-05T18:08:04,875 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-021bc6c3df}, consumerId=0, consumerName=2b344, address=/127.0.0.1:39162}
2024-02-05T18:08:04,875 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:08:04,876 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-021bc6c3df] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-021bc6c3df, ackPos=3:6, readPos=3:9}]
2024-02-05T18:08:04,876 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-021bc6c3df] Successfully closed dispatcher for reader
2024-02-05T18:08:04,876 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] Disconnected
2024-02-05T18:08:04,876 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36789/__change_events, name=reader-a884352547}, consumerId=3, consumerName=17ab2, address=/127.0.0.1:39162}
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-021bc6c3df] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36789/__change_events][reader-a884352547] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36789/persistent/__change_events, cursor=reader-a884352547, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f264861a14] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36789/__change_events][reader-a884352547] Successfully closed dispatcher for reader
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36789/__change_events] [reader-a884352547] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,877 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-56a6b8ce66] Closed connection [id: 0xdd71e808, L:/127.0.0.1:39162 ! R:localhost/127.0.0.1:33893] -- Will try again in 0.1 s
2024-02-05T18:08:04,878 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-56a6b8ce66}, consumerId=2, consumerName=7b852, address=/127.0.0.1:39162}
2024-02-05T18:08:04,878 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-f264861a14}, consumerId=1, consumerName=008ae, address=/127.0.0.1:39162}
2024-02-05T18:08:04,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36789/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:08:04,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:08:04,881 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:08:04,882 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:08:04,882 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:08:04,886 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33893
2024-02-05T18:08:04,886 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f264861a14] Closed Consumer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36789/__change_events] [reader-a884352547] Closed Consumer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-56a6b8ce66] Closed Consumer (not connected)
2024-02-05T18:08:04,887 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-021bc6c3df] Closed Consumer (not connected)
2024-02-05T18:08:04,887 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f264861a14 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f264861a14 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:04,888 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36789/__change_events with subscription name reader-a884352547 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36789/__change_events with subscription name reader-a884352547 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:04,888 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-56a6b8ce66 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-56a6b8ce66 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:04,889 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-021bc6c3df was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-021bc6c3df was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:04,892 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:08:04,892 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:08:04,892 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:08:04,893 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:08:04,893 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:08:04,894 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:04,895 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:08:04,896 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:06,280 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:08:06,281 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:08:06,284 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:08:06,287 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:06,287 - INFO  - [GracefulExecutorServicesTerminationHandler:BrokerService@893] - Broker service completely shut down
2024-02-05T18:08:06,287 - INFO  - [GracefulExecutorServicesTerminationHandler:PulsarService@601] - Closed
2024-02-05T18:08:06,306 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:08:06,307 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:06,317 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:08:06,317 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 188 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 189 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:08:06,318 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 194 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:08:06,319 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:08:06,319 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:08:06,325 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@7d59e8d4
2024-02-05T18:08:06,325 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:08:06,326 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:08:06,327 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 45.212 s <<< FAILURE! - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[ERROR] org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics  Time elapsed: 0.379 s  <<< FAILURE!
java.lang.AssertionError: Sets differ: expected [dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
	at org.testng.Assert.fail(Assert.java:110)
	at org.testng.Assert.assertEquals(Assert.java:2036)
	at org.testng.Assert.assertEquals(Assert.java:1963)
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics(ExtensibleLoadManagerImplTest.java:1018)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)
	at org.testng.internal.invokers.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:47)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:76)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:11)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   ExtensibleLoadManagerImplTest.testGetMetrics:1018 Sets differ: expected [dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:11 min
[INFO] Finished at: 2024-02-05T18:08:07+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.1.0:test (default-test) on project pulsar-broker: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
Exited after loop #3
