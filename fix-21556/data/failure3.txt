[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.2
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 2
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-01-27T17:19:36,474 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-01-27T17:19:37,618 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-01-27T17:19:37,619 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-01-27T17:19:38,271 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-01-27T17:19:38,272 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-01-27T17:19:38,273 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-01-27T17:19:38,274 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-01-27T17:19:38,275 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-01-27T17:19:38,275 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-01-27T17:19:38,306 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-01-27T17:19:38,307 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-01-27T17:19:38,307 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-01-27T17:19:38,308 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-01-27T17:19:38,309 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-01-27T17:19:38,309 - INFO  - [main:Environment@98] - Client environment:os.version=6.2.0-39-generic
2024-01-27T17:19:38,310 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-01-27T17:19:38,311 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-01-27T17:19:38,311 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:19:38,312 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-01-27T17:19:38,312 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-01-27T17:19:38,313 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-01-27T17:19:40,712 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-01-27T17:19:40,713 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-01-27T17:19:40,713 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-01-27T17:19:40,714 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-01-27T17:19:41,199 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-01-27T17:19:41,200 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-01-27T17:19:41,326 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-01-27T17:19:41,412 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-01-27T17:19:41,418 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:19:41,438 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-01-27T17:19:41,565 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-01-27T17:19:41,613 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-01-27T17:19:41,706 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-01-27T17:19:42,193 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-01-27T17:19:42,194 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-01-27T17:19:42,238 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-01-27T17:19:42,311 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46417, TLS: (none), listener: (none)
2024-01-27T17:19:42,613 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38057, TLS: OPENSSL, listener: (none)
2024-01-27T17:19:42,632 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-01-27T17:19:42,636 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:19:42,636 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:19:42,664 - INFO  - [main:Log@170] - Logging initialized @8716ms to org.eclipse.jetty.util.log.Slf4jLog
2024-01-27T17:19:43,674 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-01-27T17:19:43,715 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-01-27T17:19:43,715 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-01-27T17:19:43,718 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-01-27T17:19:44,557 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-01-27T17:19:45,781 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-01-27T17:19:46,966 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-01-27T17:19:47,334 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-01-27T17:19:47,423 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-01-27T17:19:47,524 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-01-27T17:19:47,526 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-01-27T17:19:47,529 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-01-27T17:19:47,540 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:45807}
2024-01-27T17:19:47,650 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:42397}
2024-01-27T17:19:47,650 - INFO  - [main:Server@415] - Started @13703ms
2024-01-27T17:19:47,651 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45807
2024-01-27T17:19:47,652 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:42397
2024-01-27T17:19:47,660 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-01-27T17:19:47,661 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-01-27T17:19:47,825 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45807
2024-01-27T17:19:47,839 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-01-27T17:19:47,843 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:45807 is changing the role from null to Leader
2024-01-27T17:19:47,846 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45807).
2024-01-27T17:19:48,120 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45807 
2024-01-27T17:19:48,562 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-01-27T17:19:48,592 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:48,681 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-01-27T17:19:48,685 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-01-27T17:19:48,694 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-01-27T17:19:48,699 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-01-27T17:19:48,740 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-01-27T17:19:48,769 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-01-27T17:19:48,810 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-01-27T17:19:48,869 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-01-27T17:19:48,885 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-01-27T17:19:48,901 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-01-27T17:19:48,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-01-27T17:19:48,935 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-01-27T17:19:48,937 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:48 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 492
2024-01-27T17:19:49,105 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]] Connected to server
2024-01-27T17:19:49,161 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:52158] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:19:49,232 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,241 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,304 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-01-27T17:19:49,333 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52158] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52158, producerName=test-0-0, producerId=0}
2024-01-27T17:19:49,341 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,343 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-01-27T17:19:49,415 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,418 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a411222f31] Subscribing to topic on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417], consumerId 0
2024-01-27T17:19:49,429 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc356f9ff, L:/127.0.0.1:46417 - R:/127.0.0.1:52158]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-a411222f31. consumerId: 0
2024-01-27T17:19:49,460 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a411222f31] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:49,461 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-01-27T17:19:49,462 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-a411222f31, ackPos=3:-1, readPos=3:0}
2024-01-27T17:19:49,487 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52158] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-a411222f31
2024-01-27T17:19:49,492 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a411222f31] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 0
2024-01-27T17:19:49,505 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.012 seconds
2024-01-27T17:19:49,507 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-01-27T17:19:49,508 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-01-27T17:19:49,508 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-01-27T17:19:49,552 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,569 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-01-27T17:19:49,570 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-01-27T17:19:49,573 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-01-27T17:19:49,575 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:49 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 50
2024-01-27T17:19:49,587 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,596 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-01-27T17:19:49,597 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-01-27T17:19:49,598 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:49 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 20
2024-01-27T17:19:49,599 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-01-27T17:19:49,620 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,622 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,630 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-01-27T17:19:49,637 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52158] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52158, producerName=test-0-1, producerId=1}
2024-01-27T17:19:49,638 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,655 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,657 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2cc292f510] Subscribing to topic on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417], consumerId 1
2024-01-27T17:19:49,659 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc356f9ff, L:/127.0.0.1:46417 - R:/127.0.0.1:52158]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2cc292f510. consumerId: 1
2024-01-27T17:19:49,686 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2cc292f510] Created new subscription for 1
2024-01-27T17:19:49,687 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52158] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-2cc292f510
2024-01-27T17:19:49,689 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-2cc292f510] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 1
2024-01-27T17:19:49,710 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,712 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,720 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-01-27T17:19:49,726 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52158] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52158, producerName=test-0-2, producerId=2}
2024-01-27T17:19:49,727 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:49,741 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-01-27T17:19:49,762 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-01-27T17:19:49,769 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:45807 started the ownership monitor.
2024-01-27T17:19:49,785 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:49,787 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c9de24b9ef] Subscribing to topic on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417], consumerId 2
2024-01-27T17:19:49,789 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc356f9ff, L:/127.0.0.1:46417 - R:/127.0.0.1:52158]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c9de24b9ef. consumerId: 2
2024-01-27T17:19:49,802 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c9de24b9ef] Created new subscription for 2
2024-01-27T17:19:49,803 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52158] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c9de24b9ef
2024-01-27T17:19:49,803 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c9de24b9ef] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 2
2024-01-27T17:19:49,805 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:45807 plays the leader now.
2024-01-27T17:19:49,810 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.69%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.69%, msgThroughputEMA= 0.00, updatedAt= 1706368789809, reportedAt= 0
2024-01-27T17:19:49,810 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45807/__change_events
2024-01-27T17:19:49,831 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-01-27T17:19:49,837 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:49,841 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 2.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:19:49,899 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45807/0x00000000_0xffffffff - localhost:45807.
2024-01-27T17:19:49,902 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45807
2024-01-27T17:19:49,902 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45807/0x00000000_0xffffffff
2024-01-27T17:19:49,907 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45807/0x00000000_0xffffffff - localhost:45807.
2024-01-27T17:19:49,910 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45807/0x00000000_0xffffffff
2024-01-27T17:19:49,918 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45807
2024-01-27T17:19:49,918 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45807/__change_events][reader-1dfdbaf959] Subscribing to topic on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417], consumerId 3
2024-01-27T17:19:49,921 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc356f9ff, L:/127.0.0.1:46417 - R:/127.0.0.1:52158]] Subscribing on topic persistent://sla-monitor/test/localhost:45807/__change_events / reader-1dfdbaf959. consumerId: 3
2024-01-27T17:19:49,930 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45807/persistent/__change_events
2024-01-27T17:19:49,934 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45807/persistent/__change_events'
2024-01-27T17:19:49,941 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-01-27T17:19:49,942 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45807/persistent/__change_events] Created ledger 7 after closed null
2024-01-27T17:19:49,947 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45807 doesn't exist.
2024-01-27T17:19:49,949 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45807/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:19:49,955 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45807/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-01-27T17:19:49,960 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45807/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45807/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-01-27T17:19:49,965 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45807/__change_events - dedup is disabled
2024-01-27T17:19:49,987 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-01-27T17:19:49,996 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45807/__change_events][reader-1dfdbaf959] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:49,996 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45807/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-01-27T17:19:49,997 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45807/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45807/persistent/__change_events, cursor=reader-1dfdbaf959, ackPos=7:-1, readPos=7:0}
2024-01-27T17:19:49,999 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:52158] Created subscription on topic persistent://sla-monitor/test/localhost:45807/__change_events / reader-1dfdbaf959
2024-01-27T17:19:50,001 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45807/__change_events][reader-1dfdbaf959] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 3
2024-01-27T17:19:49,962 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 45807, tls-port = Optional[42397], broker url= pulsar://localhost:46417, broker tls url= pulsar+ssl://localhost:38057, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[46417], brokerServicePortTls=Optional[38057], webServicePort=Optional[45807], webServicePortTls=Optional[42397], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-01-27T17:19:50,555 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-01-27T17:19:50,555 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-01-27T17:19:50,555 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-01-27T17:19:50,556 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-01-27T17:19:50,561 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-01-27T17:19:50,561 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-01-27T17:19:50,566 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-01-27T17:19:50,570 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-01-27T17:19:50,577 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-01-27T17:19:50,578 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:19:50,585 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-01-27T17:19:50,590 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-01-27T17:19:50,592 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-01-27T17:19:50,602 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-01-27T17:19:50,602 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-01-27T17:19:50,609 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-01-27T17:19:50,612 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33131, TLS: (none), listener: (none)
2024-01-27T17:19:50,613 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42821, TLS: OPENSSL, listener: (none)
2024-01-27T17:19:50,618 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-01-27T17:19:50,620 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:19:50,620 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:19:50,630 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-01-27T17:19:50,633 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-01-27T17:19:50,633 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-01-27T17:19:50,633 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-01-27T17:19:50,712 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-01-27T17:19:50,842 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:50,843 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:19:51,245 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-01-27T17:19:51,844 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:51,845 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:19:52,356 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-01-27T17:19:52,552 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-01-27T17:19:52,614 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-01-27T17:19:52,667 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-01-27T17:19:52,669 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-01-27T17:19:52,669 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-01-27T17:19:52,670 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:42917}
2024-01-27T17:19:52,679 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:39191}
2024-01-27T17:19:52,679 - INFO  - [main:Server@415] - Started @18733ms
2024-01-27T17:19:52,680 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42917
2024-01-27T17:19:52,682 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39191
2024-01-27T17:19:52,687 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-01-27T17:19:52,688 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-01-27T17:19:52,706 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42917 registry has been created.
2024-01-27T17:19:52,707 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42917
2024-01-27T17:19:52,707 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42917. There was no scheduled cleanup job. Active cleanup job count:0
2024-01-27T17:19:52,711 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42917 is changing the role from null to Follower
2024-01-27T17:19:52,714 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45807).
2024-01-27T17:19:52,719 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-01-27T17:19:52,737 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42917 
2024-01-27T17:19:52,847 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:52 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 36
2024-01-27T17:19:52,849 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:19:52,849 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:19:52,864 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:52,867 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-01-27T17:19:52,868 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-01-27T17:19:52,879 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:52 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 27
2024-01-27T17:19:52,883 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42917/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:19:52,892 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x6585eb85, L:/127.0.0.1:46006 - R:localhost/127.0.0.1:33131]] Connected to server
2024-01-27T17:19:52,898 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:46006] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:19:52,918 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]] Connected to server
2024-01-27T17:19:52,922 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:52164] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:19:52,923 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:52,933 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52164] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52164, producerName=test-0-3, producerId=0}
2024-01-27T17:19:52,934 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:52,945 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-39f8401db6] Subscribing to topic on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417], consumerId 0
2024-01-27T17:19:52,947 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xc225474f, L:/127.0.0.1:46417 - R:/127.0.0.1:52164]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-39f8401db6. consumerId: 0
2024-01-27T17:19:52,951 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-39f8401db6] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:52,952 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-01-27T17:19:52,952 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-39f8401db6, ackPos=3:-1, readPos=3:0}
2024-01-27T17:19:52,954 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52164] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-39f8401db6
2024-01-27T17:19:52,955 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-39f8401db6] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 0
2024-01-27T17:19:52,957 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-01-27T17:19:52,958 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-01-27T17:19:52,978 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:52 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 16
2024-01-27T17:19:52,985 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:52,988 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-01-27T17:19:52,988 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-01-27T17:19:52,991 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:52 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-01-27T17:19:52,992 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42917/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:19:53,012 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:52 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 16
2024-01-27T17:19:53,021 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:53,024 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-01-27T17:19:53,024 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-01-27T17:19:53,029 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-01-27T17:19:53,030 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42917/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:19:53,045 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:53,052 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52164] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52164, producerName=test-0-4, producerId=1}
2024-01-27T17:19:53,053 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:53,064 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b3a2104d92] Subscribing to topic on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417], consumerId 1
2024-01-27T17:19:53,065 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0xc225474f, L:/127.0.0.1:46417 - R:/127.0.0.1:52164]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b3a2104d92. consumerId: 1
2024-01-27T17:19:53,076 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b3a2104d92] Created new subscription for 1
2024-01-27T17:19:53,076 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52164] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-b3a2104d92
2024-01-27T17:19:53,077 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-b3a2104d92] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 1
2024-01-27T17:19:53,092 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:53,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52164] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52164, producerName=test-0-5, producerId=2}
2024-01-27T17:19:53,104 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x868a4066, L:/127.0.0.1:52164 - R:localhost/127.0.0.1:46417]
2024-01-27T17:19:53,107 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-01-27T17:19:53,117 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-01-27T17:19:53,119 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42917 plays a follower now.
2024-01-27T17:19:53,145 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42917/__change_events
2024-01-27T17:19:53,174 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42917/0x00000000_0xffffffff - localhost:42917.
2024-01-27T17:19:53,175 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42917
2024-01-27T17:19:53,175 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42917/0x00000000_0xffffffff
2024-01-27T17:19:53,176 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42917/0x00000000_0xffffffff - localhost:42917.
2024-01-27T17:19:53,177 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42917/0x00000000_0xffffffff
2024-01-27T17:19:53,179 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42917
2024-01-27T17:19:53,187 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42917/__change_events][reader-ea076a0a24] Subscribing to topic on cnx [id: 0x6585eb85, L:/127.0.0.1:46006 - R:localhost/127.0.0.1:33131], consumerId 2
2024-01-27T17:19:53,190 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xbc2251cd, L:/127.0.0.1:33131 - R:/127.0.0.1:46006]] Subscribing on topic persistent://sla-monitor/test/localhost:42917/__change_events / reader-ea076a0a24. consumerId: 2
2024-01-27T17:19:53,194 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42917 doesn't exist.
2024-01-27T17:19:53,196 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 42917, tls-port = Optional[39191], broker url= pulsar://localhost:33131, broker tls url= pulsar+ssl://localhost:42821, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33131], brokerServicePortTls=Optional[42821], webServicePort=Optional[42917], webServicePortTls=Optional[39191], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-01-27T17:19:53,206 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42917/persistent/__change_events
2024-01-27T17:19:53,208 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42917/persistent/__change_events'
2024-01-27T17:19:53,218 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-01-27T17:19:53,221 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42917/persistent/__change_events] Created ledger 9 after closed null
2024-01-27T17:19:53,228 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42917/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:19:53,234 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42917/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-01-27T17:19:53,237 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42917/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42917/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-01-27T17:19:53,238 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42917/__change_events - dedup is disabled
2024-01-27T17:19:53,248 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-01-27T17:19:53,255 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42917/__change_events][reader-ea076a0a24] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:53,256 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42917/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-01-27T17:19:53,256 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42917/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42917/persistent/__change_events, cursor=reader-ea076a0a24, ackPos=9:-1, readPos=9:0}
2024-01-27T17:19:53,258 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:46006] Created subscription on topic persistent://sla-monitor/test/localhost:42917/__change_events / reader-ea076a0a24
2024-01-27T17:19:53,259 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42917/__change_events][reader-ea076a0a24] Subscribed to topic on localhost/127.0.0.1:33131 -- consumer: 2
2024-01-27T17:19:53,381 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-01-27T17:19:53,382 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-01-27T17:19:53,412 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-01-27T17:19:53,413 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-01-27T17:19:53,437 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-01-27T17:19:53,439 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-01-27T17:19:53,442 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-01-27T17:19:53,444 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-01-27T17:19:53,473 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-01-27T17:19:53,473 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-01-27T17:19:53,475 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:19:53,477 - INFO  - [pulsar-web-30-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-01-27T17:19:53,478 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:19:53,481 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-01-27T17:19:53,491 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-01-27T17:19:53,491 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-01-27T17:19:53,497 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-01-27T17:19:53,498 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-01-27T17:19:53,512 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-01-27T17:19:53,512 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-01-27T17:19:53,513 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-01-27T17:19:53,514 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-01-27T17:19:53,515 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:19:53,518 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:19:53,559 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-01-27T17:19:53,570 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-01-27T17:19:53,571 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-01-27T17:19:53,584 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-01-27T17:19:53,595 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:53,614 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45807 for bundle: public/test/0x00000000_0xffffffff.
2024-01-27T17:19:53,659 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45807, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793615, versionId=1]. totalHandledRequests:1
2024-01-27T17:19:53,696 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45807, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793679, versionId=2]. totalHandledRequests:1
2024-01-27T17:19:53,702 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:53,724 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-01-27T17:19:53,725 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-01-27T17:19:53,731 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-01-27T17:19:53,766 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45807, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368793714, versionId=3]. totalHandledRequests:1
2024-01-27T17:19:53,776 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 9.0 ms
2024-01-27T17:19:53,780 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:53,787 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45807, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793767, versionId=4]. totalHandledRequests:1
2024-01-27T17:19:53,788 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-01-27T17:19:53,788 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-01-27T17:19:53,790 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 209
2024-01-27T17:19:53,791 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-01-27T17:19:53,791 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45807. Skipping this broker. Phase one
2024-01-27T17:19:53,791 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:45807. Skipping this broker. Phase two
2024-01-27T17:19:53,792 - INFO  - [ForkJoinPool.commonPool-worker-3:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42917 for bundle: public/test/0x00000000_0xffffffff.
2024-01-27T17:19:53,792 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:19:53 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 237
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-01-27T17:19:53,803 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42917, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793792, versionId=5]. totalHandledRequests:2
2024-01-27T17:19:53,817 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42917, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793804, versionId=6]. totalHandledRequests:2
2024-01-27T17:19:53,821 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-01-27T17:19:53,877 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x9285dc3d, L:/127.0.0.1:46022 - R:localhost/127.0.0.1:33131]] Connected to server
2024-01-27T17:19:53,883 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:19:53,883 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:19:53,892 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:46022] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:19:53,893 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-ae2f69d920] Subscribing to topic on cnx [id: 0x9285dc3d, L:/127.0.0.1:46022 - R:localhost/127.0.0.1:33131], consumerId 4
2024-01-27T17:19:53,898 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x61b558f5, L:/127.0.0.1:33131 - R:/127.0.0.1:46022]] Subscribing on topic persistent://public/test/__change_events / reader-ae2f69d920. consumerId: 4
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@457a6aff], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7eb07cb4] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@457a6aff, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77cf0424], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7eb07cb4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@442d35ee] 
2024-01-27T17:19:53,919 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-01-27T17:19:53,923 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-01-27T17:19:53,932 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-01-27T17:19:53,935 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-01-27T17:19:53,938 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-b26cae940a] Subscribing to topic on cnx [id: 0x6585eb85, L:/127.0.0.1:46006 - R:localhost/127.0.0.1:33131], consumerId 3
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-01-27T17:19:53,941 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xbc2251cd, L:/127.0.0.1:33131 - R:/127.0.0.1:46006]] Subscribing on topic persistent://public/test/__change_events / reader-b26cae940a. consumerId: 3
2024-01-27T17:19:53,943 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:19:53,950 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-01-27T17:19:53,954 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-01-27T17:19:53,957 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-01-27T17:19:53,960 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-01-27T17:19:53,968 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-01-27T17:19:53,968 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-01-27T17:19:53,969 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-01-27T17:19:53,970 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-01-27T17:19:53,973 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-01-27T17:19:53,973 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-01-27T17:19:53,974 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-01-27T17:19:53,978 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-b26cae940a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:53,979 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-01-27T17:19:53,979 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b26cae940a, ackPos=11:-1, readPos=11:0}
2024-01-27T17:19:53,983 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-01-27T17:19:53,983 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:46006] Created subscription on topic persistent://public/test/__change_events / reader-b26cae940a
2024-01-27T17:19:53,985 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-b26cae940a] Subscribed to topic on localhost/127.0.0.1:33131 -- consumer: 3
2024-01-27T17:19:53,989 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-01-27T17:19:53,994 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-01-27T17:19:53,997 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-01-27T17:19:54,000 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-01-27T17:19:54,003 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-01-27T17:19:54,004 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-ae2f69d920] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:54,005 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-01-27T17:19:54,005 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-ae2f69d920, ackPos=11:-1, readPos=11:0}
2024-01-27T17:19:54,008 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46022] Created subscription on topic persistent://public/test/__change_events / reader-ae2f69d920
2024-01-27T17:19:54,009 - INFO  - [main:WebService@350] - Web service closed
2024-01-27T17:19:54,009 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-ae2f69d920] Subscribed to topic on localhost/127.0.0.1:33131 -- consumer: 4
2024-01-27T17:19:54,010 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-01-27T17:19:54,011 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-01-27T17:19:54,013 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42917
2024-01-27T17:19:54,015 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:46022] Closing consumer: consumerId=4
2024-01-27T17:19:54,015 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-ae2f69d920}, consumerId=4, consumerName=f3b71, address=/127.0.0.1:46022}
2024-01-27T17:19:54,016 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-ae2f69d920] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-ae2f69d920, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:19:54,017 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-ae2f69d920] Successfully closed dispatcher for reader
2024-01-27T17:19:54,020 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45807. Skipping this broker. Phase one
2024-01-27T17:19:54,020 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:46022] Closed consumer, consumerId=4
2024-01-27T17:19:54,023 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-ae2f69d920] Closed consumer
2024-01-27T17:19:54,023 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-01-27T17:19:54,023 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:42917, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368793804, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45807, sourceBroker=localhost:42917, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368794020, versionId=7]
2024-01-27T17:19:54,036 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45807, sourceBroker=localhost:42917, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368794020, versionId=7]. totalHandledRequests:6
2024-01-27T17:19:54,037 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:45807 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:45807, sourceBroker=localhost:42917, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368794020, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-01-27T17:19:54,037 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-01-27T17:19:54,038 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-01-27T17:19:54,040 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b26cae940a}, consumerId=3, consumerName=d4484, address=/127.0.0.1:46006}
2024-01-27T17:19:54,041 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:33131] Broker notification of Closed consumer: 3
2024-01-27T17:19:54,041 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-b26cae940a}, consumerId=3, consumerName=d4484, address=/127.0.0.1:46006}
2024-01-27T17:19:54,042 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-b26cae940a] Closed connection [id: 0x6585eb85, L:/127.0.0.1:46006 - R:localhost/127.0.0.1:33131] -- Will try again in 0.1 s
2024-01-27T17:19:54,042 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b26cae940a] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b26cae940a, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:19:54,042 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-b26cae940a] Successfully closed dispatcher for reader
2024-01-27T17:19:54,044 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-b26cae940a] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-b26cae940a, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:19:54,045 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-b26cae940a] Successfully disconnected and closed subscription
2024-01-27T17:19:54,046 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:19:54,046 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-01-27T17:19:54,051 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-01-27T17:19:54,064 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-01-27T17:19:54,071 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-01-27T17:19:54,073 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-b26cae940a] Closed Consumer (not connected)
2024-01-27T17:19:54,073 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b26cae940a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-b26cae940a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:19:54,074 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:19:54,075 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 38.0 ms
2024-01-27T17:19:54,076 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Subscribing to topic on cnx [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417], consumerId 5
2024-01-27T17:19:54,078 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xc356f9ff, L:/127.0.0.1:46417 - R:/127.0.0.1:52158]] Subscribing on topic persistent://public/test/__change_events / reader-a1f7b07a7e. consumerId: 5
2024-01-27T17:19:54,086 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-01-27T17:19:54,094 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-01-27T17:19:54,094 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-01-27T17:19:54,102 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-01-27T17:19:54,104 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-01-27T17:19:54,105 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-01-27T17:19:54,109 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-01-27T17:19:54,109 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-01-27T17:19:54,110 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:19:54,113 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-01-27T17:19:54,123 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:19:54,123 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-01-27T17:19:54,124 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a1f7b07a7e, ackPos=14:-1, readPos=14:0}
2024-01-27T17:19:54,125 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52158] Created subscription on topic persistent://public/test/__change_events / reader-a1f7b07a7e
2024-01-27T17:19:54,126 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Subscribed to topic on localhost/127.0.0.1:46417 -- consumer: 5
2024-01-27T17:19:54,143 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-b26cae940a] Reconnecting after timeout
2024-01-27T17:19:54,143 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-b26cae940a] Ignoring reconnection request (state: Closed)
2024-01-27T17:19:54,759 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-01-27T17:19:54,760 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 46.68%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.68%, msgThroughputEMA= 0.00, updatedAt= 1706368794758, reportedAt= 0
2024-01-27T17:19:54,884 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:19:54,885 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:19:55,886 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:19:55,887 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:19:56,888 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:19:56,888 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:19:57,135 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42917 in 3120.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-01-27T17:19:57,145 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42917 was invalidated. state Releasing
2024-01-27T17:19:57,145 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42917 registry has been deleted.
2024-01-27T17:19:57,145 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42917 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-01-27T17:19:57,147 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42917. Retrying later on reconnection Lock was not in valid state: Releasing
2024-01-27T17:19:57,148 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42917
2024-01-27T17:19:57,149 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42917 with delay:0 secs. Pending clean jobs:1.
2024-01-27T17:19:57,153 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42917
2024-01-27T17:19:57,154 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42917 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-01-27T17:19:57,164 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42917/0x00000000_0xffffffff.
2024-01-27T17:19:57,169 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42917/0x00000000_0xffffffff.
2024-01-27T17:19:57,172 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42917/0x00000000_0xffffffff.
2024-01-27T17:19:57,173 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.024 seconds
2024-01-27T17:19:57,175 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-01-27T17:19:57,182 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x6585eb85, L:/127.0.0.1:46006 ! R:localhost/127.0.0.1:33131] Disconnected
2024-01-27T17:19:57,183 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] Disconnected
2024-01-27T17:19:57,184 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:52164
2024-01-27T17:19:57,184 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:19:57,185 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:19:57,185 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:46006
2024-01-27T17:19:57,185 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:19:57,185 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42917/__change_events, name=reader-ea076a0a24}, consumerId=2, consumerName=69c74, address=/127.0.0.1:46006}
2024-01-27T17:19:57,185 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x9285dc3d, L:/127.0.0.1:46022 ! R:localhost/127.0.0.1:33131] Disconnected
2024-01-27T17:19:57,186 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42917/__change_events][reader-ea076a0a24] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42917/persistent/__change_events, cursor=reader-ea076a0a24, ackPos=9:-1, readPos=9:0}]
2024-01-27T17:19:57,186 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42917/__change_events][reader-ea076a0a24] Successfully closed dispatcher for reader
2024-01-27T17:19:57,190 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42917/__change_events] [reader-ea076a0a24] Closed connection [id: 0x6585eb85, L:/127.0.0.1:46006 ! R:localhost/127.0.0.1:33131] -- Will try again in 0.1 s
2024-01-27T17:19:57,190 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-39f8401db6}, consumerId=0, consumerName=abfc3, address=/127.0.0.1:52164}
2024-01-27T17:19:57,191 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-39f8401db6] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-39f8401db6, ackPos=3:6, readPos=3:7}]
2024-01-27T17:19:57,191 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-39f8401db6] Closed connection [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:19:57,191 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-39f8401db6] Successfully closed dispatcher for reader
2024-01-27T17:19:57,191 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b3a2104d92] Closed connection [id: 0x868a4066, L:/127.0.0.1:52164 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:19:57,192 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-b3a2104d92}, consumerId=1, consumerName=34f99, address=/127.0.0.1:52164}
2024-01-27T17:19:57,193 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-01-27T17:19:57,194 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:46022
2024-01-27T17:19:57,195 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42917/persistent/__change_events] Closing managed ledger
2024-01-27T17:19:57,198 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42917/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-01-27T17:19:57,199 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-01-27T17:19:57,200 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-01-27T17:19:57,201 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-01-27T17:19:57,208 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33131
2024-01-27T17:19:57,209 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-01-27T17:19:57,213 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-01-27T17:19:57,213 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-01-27T17:19:57,214 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42917/__change_events] [reader-ea076a0a24] Closed Consumer (not connected)
2024-01-27T17:19:57,215 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-b3a2104d92] Closed Consumer (not connected)
2024-01-27T17:19:57,215 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42917/__change_events with subscription name reader-ea076a0a24 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42917/__change_events with subscription name reader-ea076a0a24 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:19:57,216 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-39f8401db6] Closed Consumer (not connected)
2024-01-27T17:19:57,216 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b3a2104d92 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-b3a2104d92 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:19:57,218 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-39f8401db6 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-39f8401db6 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:19:57,223 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-01-27T17:19:57,223 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-01-27T17:19:57,226 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:19:57,227 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:19:57,252 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-01-27T17:19:57,253 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:19:57,894 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:57,894 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42917 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-01-27T17:19:57,895 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42917 with delay:0 secs. Pending clean jobs:1.
2024-01-27T17:19:57,895 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42917]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-01-27T17:19:57,895 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42917
2024-01-27T17:19:57,897 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42917 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-01-27T17:19:58,501 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-01-27T17:19:58,502 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-01-27T17:19:58,506 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-01-27T17:19:58,507 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:19:58,508 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-01-27T17:19:58,508 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-01-27T17:19:58,896 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:58,896 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42917 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-01-27T17:19:58,897 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42917 with delay:0 secs. Pending clean jobs:1.
2024-01-27T17:19:58,897 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:42917]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-01-27T17:19:58,898 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42917
2024-01-27T17:19:58,900 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42917 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-01-27T17:19:59,758 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 47.66%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 46.78%, msgThroughputEMA= 0.00, updatedAt= 1706368799757, reportedAt= 1706368794764
2024-01-27T17:19:59,898 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:19:59,898 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42917 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-01-27T17:19:59,899 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42917 with delay:0 secs. Pending clean jobs:1.
2024-01-27T17:19:59,899 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42917]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-01-27T17:19:59,899 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42917
2024-01-27T17:19:59,901 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42917 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-01-27T17:20:00,521 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-01-27T17:20:00,522 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-01-27T17:20:00,523 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-01-27T17:20:00,523 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-01-27T17:20:00,524 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-01-27T17:20:00,524 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-01-27T17:20:00,526 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-01-27T17:20:00,529 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-01-27T17:20:00,531 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-01-27T17:20:00,534 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-01-27T17:20:00,536 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-01-27T17:20:00,538 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-01-27T17:20:00,540 - INFO  - [main:WebService@350] - Web service closed
2024-01-27T17:20:00,541 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-01-27T17:20:00,541 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-01-27T17:20:00,542 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45807
2024-01-27T17:20:00,544 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45807, sourceBroker=localhost:42917, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368794020, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-01-27T17:20:05,553 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45807 in 5009.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-01-27T17:20:05,566 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45807 was invalidated. state Releasing
2024-01-27T17:20:05,566 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45807. Retrying later on reconnection Lock was not in valid state: Releasing
2024-01-27T17:20:05,567 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45807
2024-01-27T17:20:05,577 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45807/0x00000000_0xffffffff.
2024-01-27T17:20:05,591 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45807, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368805579, versionId=8]. totalHandledRequests:10
2024-01-27T17:20:05,593 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-01-27T17:20:05,593 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-01-27T17:20:05,593 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-01-27T17:20:05,593 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a1f7b07a7e}, consumerId=5, consumerName=ccd3f, address=/127.0.0.1:52158}
2024-01-27T17:20:05,594 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:46417] Broker notification of Closed consumer: 5
2024-01-27T17:20:05,594 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a1f7b07a7e}, consumerId=5, consumerName=ccd3f, address=/127.0.0.1:52158}
2024-01-27T17:20:05,595 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a1f7b07a7e, ackPos=14:-1, readPos=14:0}]
2024-01-27T17:20:05,595 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-a1f7b07a7e] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 - R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,595 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Successfully closed dispatcher for reader
2024-01-27T17:20:05,595 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a1f7b07a7e, ackPos=14:-1, readPos=14:0}]
2024-01-27T17:20:05,596 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-a1f7b07a7e] Successfully disconnected and closed subscription
2024-01-27T17:20:05,596 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-01-27T17:20:05,600 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-01-27T17:20:05,601 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-01-27T17:20:05,601 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a1f7b07a7e] Closed Consumer (not connected)
2024-01-27T17:20:05,601 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-01-27T17:20:05,601 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a1f7b07a7e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a1f7b07a7e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:20:05,611 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45807 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45807, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368805591, versionId=9]. totalHandledRequests:4
2024-01-27T17:20:05,611 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-01-27T17:20:05,613 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45807/0x00000000_0xffffffff.
2024-01-27T17:20:05,614 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-01-27T17:20:05,615 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45807/0x00000000_0xffffffff.
2024-01-27T17:20:05,615 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.047 seconds
2024-01-27T17:20:05,615 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-01-27T17:20:05,615 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-01-27T17:20:05,617 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:52158
2024-01-27T17:20:05,617 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-01-27T17:20:05,617 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-a411222f31}, consumerId=0, consumerName=88e70, address=/127.0.0.1:52158}
2024-01-27T17:20:05,617 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-01-27T17:20:05,617 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a411222f31] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-a411222f31, ackPos=3:7, readPos=3:9}]
2024-01-27T17:20:05,617 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45807/persistent/__change_events] Closing managed ledger
2024-01-27T17:20:05,618 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-a411222f31] Successfully closed dispatcher for reader
2024-01-27T17:20:05,618 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] Disconnected
2024-01-27T17:20:05,618 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45807/__change_events, name=reader-1dfdbaf959}, consumerId=3, consumerName=6be6a, address=/127.0.0.1:52158}
2024-01-27T17:20:05,618 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,619 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45807/__change_events][reader-1dfdbaf959] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45807/persistent/__change_events, cursor=reader-1dfdbaf959, ackPos=7:-1, readPos=7:0}]
2024-01-27T17:20:05,619 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45807/__change_events][reader-1dfdbaf959] Successfully closed dispatcher for reader
2024-01-27T17:20:05,620 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-01-27T17:20:05,620 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45807/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-01-27T17:20:05,619 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-c9de24b9ef}, consumerId=2, consumerName=45931, address=/127.0.0.1:52158}
2024-01-27T17:20:05,620 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-01-27T17:20:05,620 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-2cc292f510}, consumerId=1, consumerName=44c9e, address=/127.0.0.1:52158}
2024-01-27T17:20:05,619 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,620 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,621 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-a411222f31] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,621 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2cc292f510] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,621 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45807/__change_events] [reader-1dfdbaf959] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,621 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-01-27T17:20:05,621 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c9de24b9ef] Closed connection [id: 0x4ace8fb7, L:/127.0.0.1:52158 ! R:localhost/127.0.0.1:46417] -- Will try again in 0.1 s
2024-01-27T17:20:05,622 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-01-27T17:20:05,626 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:46417
2024-01-27T17:20:05,626 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-01-27T17:20:05,626 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-01-27T17:20:05,626 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-01-27T17:20:05,627 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-a411222f31] Closed Consumer (not connected)
2024-01-27T17:20:05,627 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-a411222f31 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-a411222f31 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:20:05,627 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-2cc292f510] Closed Consumer (not connected)
2024-01-27T17:20:05,627 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45807/__change_events] [reader-1dfdbaf959] Closed Consumer (not connected)
2024-01-27T17:20:05,627 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c9de24b9ef] Closed Consumer (not connected)
2024-01-27T17:20:05,627 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2cc292f510 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-2cc292f510 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:20:05,628 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45807/__change_events with subscription name reader-1dfdbaf959 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45807/__change_events with subscription name reader-1dfdbaf959 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:20:05,629 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c9de24b9ef was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c9de24b9ef was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:20:05,631 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-01-27T17:20:05,632 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-01-27T17:20:05,632 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-01-27T17:20:05,632 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-01-27T17:20:05,632 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:20:05,633 - INFO  - [GracefulExecutorServicesTerminationHandler:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:20:05,634 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-01-27T17:20:05,634 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:20:07,019 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-01-27T17:20:07,020 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-01-27T17:20:07,021 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-01-27T17:20:07,021 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:20:07,021 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-01-27T17:20:07,022 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-01-27T17:20:07,032 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:20:07,032 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:20:07,037 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-01-27T17:20:07,038 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-01-27T17:20:07,038 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-01-27T17:20:07,039 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-01-27T17:20:07,039 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-01-27T17:20:07,039 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 193 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-01-27T17:20:07,039 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-01-27T17:20:07,039 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-01-27T17:20:07,039 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@1d88414a
2024-01-27T17:20:07,039 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-01-27T17:20:07,039 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-01-27T17:20:07,040 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 32.48 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:04 min
[INFO] Finished at: 2024-01-27T17:20:07+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[INFO] Cleaning up the local build cache...
[INFO] Deleted 1 unused file from the local build cache in 0.002s
[INFO] ------------------------------------------------------------------------
----------- LOOP 1 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.2
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 2
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-01-27T17:20:49,265 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-01-27T17:20:50,337 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-01-27T17:20:50,339 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-01-27T17:20:50,838 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-01-27T17:20:50,839 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-01-27T17:20:50,839 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-01-27T17:20:50,840 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-01-27T17:20:50,841 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-01-27T17:20:50,842 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-01-27T17:20:50,857 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-01-27T17:20:50,858 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-01-27T17:20:50,859 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-01-27T17:20:50,860 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-01-27T17:20:50,860 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-01-27T17:20:50,861 - INFO  - [main:Environment@98] - Client environment:os.version=6.2.0-39-generic
2024-01-27T17:20:50,862 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-01-27T17:20:50,862 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-01-27T17:20:50,863 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:20:50,863 - INFO  - [main:Environment@98] - Client environment:os.memory.free=26MB
2024-01-27T17:20:50,864 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-01-27T17:20:50,864 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-01-27T17:20:52,593 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-01-27T17:20:52,593 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-01-27T17:20:52,594 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-01-27T17:20:52,594 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-01-27T17:20:53,009 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-01-27T17:20:53,011 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-01-27T17:20:53,106 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-01-27T17:20:53,198 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-01-27T17:20:53,202 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:20:53,226 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-01-27T17:20:53,351 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-01-27T17:20:53,406 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-01-27T17:20:53,504 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-01-27T17:20:53,937 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-01-27T17:20:53,938 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-01-27T17:20:53,978 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-01-27T17:20:54,049 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38397, TLS: (none), listener: (none)
2024-01-27T17:20:54,392 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33255, TLS: OPENSSL, listener: (none)
2024-01-27T17:20:54,420 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-01-27T17:20:54,425 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:20:54,425 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:20:54,472 - INFO  - [main:Log@170] - Logging initialized @7968ms to org.eclipse.jetty.util.log.Slf4jLog
2024-01-27T17:20:55,557 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-01-27T17:20:55,619 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-01-27T17:20:55,619 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-01-27T17:20:55,622 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-01-27T17:20:56,488 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-01-27T17:20:57,703 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-01-27T17:20:58,714 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-01-27T17:20:59,019 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-01-27T17:20:59,124 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-01-27T17:20:59,267 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-01-27T17:20:59,268 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-01-27T17:20:59,271 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-01-27T17:20:59,289 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:33981}
2024-01-27T17:20:59,440 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:39391}
2024-01-27T17:20:59,441 - INFO  - [main:Server@415] - Started @12939ms
2024-01-27T17:20:59,441 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33981
2024-01-27T17:20:59,442 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39391
2024-01-27T17:20:59,455 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-01-27T17:20:59,456 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-01-27T17:20:59,645 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33981
2024-01-27T17:20:59,664 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-01-27T17:20:59,672 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33981).
2024-01-27T17:20:59,669 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:33981 is changing the role from null to Leader
2024-01-27T17:21:00,011 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33981 
2024-01-27T17:21:00,585 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-01-27T17:21:00,623 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:00,752 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-01-27T17:21:00,761 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-01-27T17:21:00,776 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-01-27T17:21:00,781 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-01-27T17:21:00,813 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-01-27T17:21:00,845 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-01-27T17:21:00,874 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-01-27T17:21:00,951 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-01-27T17:21:00,975 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-01-27T17:21:00,984 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-01-27T17:21:00,987 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-01-27T17:21:01,015 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-01-27T17:21:01,025 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:00 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 619
2024-01-27T17:21:01,157 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]] Connected to server
2024-01-27T17:21:01,189 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:34958] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:21:01,248 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,255 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-01-27T17:21:01,337 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:34958] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:34958, producerName=test-0-0, producerId=0}
2024-01-27T17:21:01,348 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,349 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-01-27T17:21:01,425 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,427 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6cc1187a34] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 0
2024-01-27T17:21:01,442 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6cc1187a34. consumerId: 0
2024-01-27T17:21:01,486 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6cc1187a34] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:01,487 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-01-27T17:21:01,488 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6cc1187a34, ackPos=3:-1, readPos=3:0}
2024-01-27T17:21:01,516 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-6cc1187a34
2024-01-27T17:21:01,523 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6cc1187a34] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 0
2024-01-27T17:21:01,541 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.017 seconds
2024-01-27T17:21:01,542 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-01-27T17:21:01,544 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-01-27T17:21:01,544 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-01-27T17:21:01,603 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,623 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-01-27T17:21:01,624 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-01-27T17:21:01,625 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-01-27T17:21:01,626 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:01 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 59
2024-01-27T17:21:01,638 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,649 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-01-27T17:21:01,650 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-01-27T17:21:01,651 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:01 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 21
2024-01-27T17:21:01,651 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-01-27T17:21:01,667 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,668 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,675 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-01-27T17:21:01,683 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:34958] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:34958, producerName=test-0-1, producerId=1}
2024-01-27T17:21:01,684 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,696 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,698 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-24edf74021] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 1
2024-01-27T17:21:01,700 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-24edf74021. consumerId: 1
2024-01-27T17:21:01,720 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-24edf74021] Created new subscription for 1
2024-01-27T17:21:01,721 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-24edf74021
2024-01-27T17:21:01,724 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-24edf74021] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 1
2024-01-27T17:21:01,743 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,745 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,755 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-01-27T17:21:01,763 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:34958] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:34958, producerName=test-0-2, producerId=2}
2024-01-27T17:21:01,764 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:01,778 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-01-27T17:21:01,798 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-01-27T17:21:01,803 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:33981 started the ownership monitor.
2024-01-27T17:21:01,821 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:01,823 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29b530a02f] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 2
2024-01-27T17:21:01,825 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-29b530a02f. consumerId: 2
2024-01-27T17:21:01,840 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29b530a02f] Created new subscription for 2
2024-01-27T17:21:01,840 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-29b530a02f
2024-01-27T17:21:01,841 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-29b530a02f] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 2
2024-01-27T17:21:01,842 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:33981 plays the leader now.
2024-01-27T17:21:01,842 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33981/__change_events
2024-01-27T17:21:01,848 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.30%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.30%, msgThroughputEMA= 0.00, updatedAt= 1706368861846, reportedAt= 0
2024-01-27T17:21:01,884 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-01-27T17:21:01,893 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:01,900 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 5.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:01,935 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33981/0x00000000_0xffffffff - localhost:33981.
2024-01-27T17:21:01,938 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33981/0x00000000_0xffffffff
2024-01-27T17:21:01,938 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33981
2024-01-27T17:21:01,939 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33981/0x00000000_0xffffffff - localhost:33981.
2024-01-27T17:21:01,941 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33981
2024-01-27T17:21:01,941 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33981/0x00000000_0xffffffff
2024-01-27T17:21:01,952 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33981/__change_events][reader-7349ede60a] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 3
2024-01-27T17:21:01,955 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic persistent://sla-monitor/test/localhost:33981/__change_events / reader-7349ede60a. consumerId: 3
2024-01-27T17:21:01,966 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33981/persistent/__change_events
2024-01-27T17:21:01,968 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33981/persistent/__change_events'
2024-01-27T17:21:01,975 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-01-27T17:21:01,976 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33981/persistent/__change_events] Created ledger 7 after closed null
2024-01-27T17:21:01,979 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33981 doesn't exist.
2024-01-27T17:21:01,984 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33981/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:21:01,990 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33981/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-01-27T17:21:01,995 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33981/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33981/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-01-27T17:21:01,996 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33981/__change_events - dedup is disabled
2024-01-27T17:21:02,010 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-01-27T17:21:02,021 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33981/__change_events][reader-7349ede60a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:02,021 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33981/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-01-27T17:21:02,022 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33981/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33981/persistent/__change_events, cursor=reader-7349ede60a, ackPos=7:-1, readPos=7:0}
2024-01-27T17:21:02,024 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic persistent://sla-monitor/test/localhost:33981/__change_events / reader-7349ede60a
2024-01-27T17:21:02,025 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33981/__change_events][reader-7349ede60a] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 3
2024-01-27T17:21:01,996 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 33981, tls-port = Optional[39391], broker url= pulsar://localhost:38397, broker tls url= pulsar+ssl://localhost:33255, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[38397], brokerServicePortTls=Optional[33255], webServicePort=Optional[33981], webServicePortTls=Optional[39391], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-01-27T17:21:02,600 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-01-27T17:21:02,600 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-01-27T17:21:02,600 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-01-27T17:21:02,601 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-01-27T17:21:02,608 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-01-27T17:21:02,608 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-01-27T17:21:02,615 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-01-27T17:21:02,621 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-01-27T17:21:02,629 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-01-27T17:21:02,630 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-01-27T17:21:02,646 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-01-27T17:21:02,654 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-01-27T17:21:02,657 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-01-27T17:21:02,669 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-01-27T17:21:02,670 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-01-27T17:21:02,681 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-01-27T17:21:02,687 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:41981, TLS: (none), listener: (none)
2024-01-27T17:21:02,689 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45329, TLS: OPENSSL, listener: (none)
2024-01-27T17:21:02,695 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-01-27T17:21:02,699 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:21:02,701 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-01-27T17:21:02,743 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-01-27T17:21:02,767 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-01-27T17:21:02,768 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-01-27T17:21:02,768 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-01-27T17:21:02,891 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-01-27T17:21:02,901 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:02,901 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:03,567 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-01-27T17:21:03,903 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:03,904 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:04,905 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:04,906 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:05,265 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-01-27T17:21:05,659 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-01-27T17:21:05,785 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-01-27T17:21:05,907 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:05,908 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:05,916 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-01-27T17:21:05,917 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-01-27T17:21:05,918 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-01-27T17:21:05,920 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:40905}
2024-01-27T17:21:05,932 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:37315}
2024-01-27T17:21:05,932 - INFO  - [main:Server@415] - Started @19430ms
2024-01-27T17:21:05,932 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:40905
2024-01-27T17:21:05,937 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37315
2024-01-27T17:21:05,941 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-01-27T17:21:05,942 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-01-27T17:21:05,974 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:40905
2024-01-27T17:21:05,975 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:40905 registry has been created.
2024-01-27T17:21:05,975 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:40905. There was no scheduled cleanup job. Active cleanup job count:0
2024-01-27T17:21:05,987 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:40905 is changing the role from null to Follower
2024-01-27T17:21:05,988 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33981).
2024-01-27T17:21:05,995 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-01-27T17:21:06,021 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:40905 
2024-01-27T17:21:06,182 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 68
2024-01-27T17:21:06,234 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:06,237 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-01-27T17:21:06,240 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-01-27T17:21:06,292 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 93
2024-01-27T17:21:06,302 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40905/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:21:06,321 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xe44446cd, L:/127.0.0.1:48958 - R:localhost/127.0.0.1:41981]] Connected to server
2024-01-27T17:21:06,332 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:48958] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:21:06,361 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]] Connected to server
2024-01-27T17:21:06,367 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:34962] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-01-27T17:21:06,369 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,384 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34962] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:34962, producerName=test-0-3, producerId=0}
2024-01-27T17:21:06,386 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,408 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-1b4d79e85e] Subscribing to topic on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397], consumerId 0
2024-01-27T17:21:06,410 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x4d566e17, L:/127.0.0.1:38397 - R:/127.0.0.1:34962]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-1b4d79e85e. consumerId: 0
2024-01-27T17:21:06,420 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-1b4d79e85e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:06,421 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-01-27T17:21:06,421 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-1b4d79e85e, ackPos=3:-1, readPos=3:0}
2024-01-27T17:21:06,423 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34962] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-1b4d79e85e
2024-01-27T17:21:06,424 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-1b4d79e85e] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 0
2024-01-27T17:21:06,432 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.006 seconds
2024-01-27T17:21:06,433 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-01-27T17:21:06,482 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 37
2024-01-27T17:21:06,484 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:06,487 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-01-27T17:21:06,487 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-01-27T17:21:06,495 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40905/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:21:06,498 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 25
2024-01-27T17:21:06,530 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 18
2024-01-27T17:21:06,543 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:06,552 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-01-27T17:21:06,552 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-01-27T17:21:06,575 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40905/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-01-27T17:21:06,584 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:06 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 53
2024-01-27T17:21:06,603 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,620 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34962] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:34962, producerName=test-0-4, producerId=1}
2024-01-27T17:21:06,621 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,635 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-abf169c084] Subscribing to topic on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397], consumerId 1
2024-01-27T17:21:06,637 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x4d566e17, L:/127.0.0.1:38397 - R:/127.0.0.1:34962]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-abf169c084. consumerId: 1
2024-01-27T17:21:06,649 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-abf169c084] Created new subscription for 1
2024-01-27T17:21:06,650 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34962] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-abf169c084
2024-01-27T17:21:06,655 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-abf169c084] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 1
2024-01-27T17:21:06,680 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,687 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:34962] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:34962, producerName=test-0-5, producerId=2}
2024-01-27T17:21:06,688 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xd5353239, L:/127.0.0.1:34962 - R:localhost/127.0.0.1:38397]
2024-01-27T17:21:06,690 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-01-27T17:21:06,698 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-01-27T17:21:06,700 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:40905 plays a follower now.
2024-01-27T17:21:06,745 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:40905/__change_events
2024-01-27T17:21:06,795 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 39.26%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.79%, msgThroughputEMA= 0.00, updatedAt= 1706368866794, reportedAt= 1706368861931
2024-01-27T17:21:06,815 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:40905/__change_events][reader-c91064b7a0] Subscribing to topic on cnx [id: 0xe44446cd, L:/127.0.0.1:48958 - R:localhost/127.0.0.1:41981], consumerId 2
2024-01-27T17:21:06,817 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x25e490e2, L:/127.0.0.1:41981 - R:/127.0.0.1:48958]] Subscribing on topic persistent://sla-monitor/test/localhost:40905/__change_events / reader-c91064b7a0. consumerId: 2
2024-01-27T17:21:06,820 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:40905/0x00000000_0xffffffff - localhost:40905.
2024-01-27T17:21:06,822 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:40905/0x00000000_0xffffffff
2024-01-27T17:21:06,822 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:40905
2024-01-27T17:21:06,828 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:40905/0x00000000_0xffffffff - localhost:40905.
2024-01-27T17:21:06,830 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:40905/persistent/__change_events
2024-01-27T17:21:06,830 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:40905/0x00000000_0xffffffff
2024-01-27T17:21:06,830 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:40905
2024-01-27T17:21:06,832 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:40905/persistent/__change_events'
2024-01-27T17:21:06,833 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:40905 doesn't exist.
2024-01-27T17:21:06,839 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=4, bootstrap service port = 40905, tls-port = Optional[37315], broker url= pulsar://localhost:41981, broker tls url= pulsar+ssl://localhost:45329, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[41981], brokerServicePortTls=Optional[45329], webServicePort=Optional[40905], webServicePortTls=Optional[37315], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-01-27T17:21:06,849 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-01-27T17:21:06,850 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:40905/persistent/__change_events] Created ledger 9 after closed null
2024-01-27T17:21:06,852 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:40905/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:21:06,858 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:40905/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-01-27T17:21:06,861 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:40905/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:40905/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-01-27T17:21:06,864 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:40905/__change_events - dedup is disabled
2024-01-27T17:21:06,879 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-01-27T17:21:06,886 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:40905/__change_events][reader-c91064b7a0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:06,886 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:40905/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-01-27T17:21:06,887 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:40905/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40905/persistent/__change_events, cursor=reader-c91064b7a0, ackPos=9:-1, readPos=9:0}
2024-01-27T17:21:06,889 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:48958] Created subscription on topic persistent://sla-monitor/test/localhost:40905/__change_events / reader-c91064b7a0
2024-01-27T17:21:06,891 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:40905/__change_events][reader-c91064b7a0] Subscribed to topic on localhost/127.0.0.1:41981 -- consumer: 2
2024-01-27T17:21:06,909 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:21:06,909 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:07,135 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-01-27T17:21:07,136 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 42
2024-01-27T17:21:07,170 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-01-27T17:21:07,171 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 27
2024-01-27T17:21:07,205 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-01-27T17:21:07,205 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-01-27T17:21:07,210 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-01-27T17:21:07,213 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 34
2024-01-27T17:21:07,271 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-01-27T17:21:07,271 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-01-27T17:21:07,271 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-01-27T17:21:07,272 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:21:07,275 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:21:07,286 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 61
2024-01-27T17:21:07,300 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-01-27T17:21:07,301 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-01-27T17:21:07,305 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-01-27T17:21:07,306 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 15
2024-01-27T17:21:07,331 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-01-27T17:21:07,333 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-01-27T17:21:07,333 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-01-27T17:21:07,335 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 17
2024-01-27T17:21:07,337 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:21:07,346 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-01-27T17:21:07,423 - INFO  - [pulsar-web-30-3:NamespacesBase@838] - [null] Unloading namespace public/test
2024-01-27T17:21:07,440 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-01-27T17:21:07,442 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-01-27T17:21:07,460 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-01-27T17:21:07,477 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:07,534 - INFO  - [ForkJoinPool.commonPool-worker-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33981 for bundle: public/test/0x00000000_0xffffffff.
2024-01-27T17:21:07,626 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33981, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867549, versionId=1]. totalHandledRequests:1
2024-01-27T17:21:07,689 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33981, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867673, versionId=2]. totalHandledRequests:1
2024-01-27T17:21:07,692 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:07,720 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-01-27T17:21:07,727 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-01-27T17:21:07,731 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-01-27T17:21:07,782 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33981, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368867703, versionId=3]. totalHandledRequests:1
2024-01-27T17:21:07,786 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:07,796 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 13.0 ms
2024-01-27T17:21:07,812 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33981, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867783, versionId=4]. totalHandledRequests:1
2024-01-27T17:21:07,815 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33981. Skipping this broker. Phase one
2024-01-27T17:21:07,815 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-01-27T17:21:07,815 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:33981. Skipping this broker. Phase two
2024-01-27T17:21:07,816 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-01-27T17:21:07,816 - INFO  - [ForkJoinPool.commonPool-worker-2:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33981 for bundle: public/test/0x00000000_0xffffffff.
2024-01-27T17:21:07,818 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 362
2024-01-27T17:21:07,820 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-01-27T17:21:07,834 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [27/Jan/2024:17:21:07 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 409
2024-01-27T17:21:07,847 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33981, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867816, versionId=5]. totalHandledRequests:2
2024-01-27T17:21:07,864 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33981, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867849, versionId=6]. totalHandledRequests:2
2024-01-27T17:21:07,866 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-266ac0d1ee] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 4
2024-01-27T17:21:07,866 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-01-27T17:21:07,868 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic persistent://public/test/__change_events / reader-266ac0d1ee. consumerId: 4
2024-01-27T17:21:07,881 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-01-27T17:21:07,883 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-01-27T17:21:07,890 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-01-27T17:21:07,891 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-01-27T17:21:07,899 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-01-27T17:21:07,903 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-01-27T17:21:07,904 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-01-27T17:21:07,909 - INFO  - [broker-client-shared-internal-executor-11-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-eff177bbda] Subscribing to topic on cnx [id: 0x2e9ee66d, L:/127.0.0.1:34958 - R:localhost/127.0.0.1:38397], consumerId 5
2024-01-27T17:21:07,910 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-01-27T17:21:07,910 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-01-27T17:21:07,910 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-01-27T17:21:07,912 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x444d8e67, L:/127.0.0.1:38397 - R:/127.0.0.1:34958]] Subscribing on topic persistent://public/test/__change_events / reader-eff177bbda. consumerId: 5
2024-01-27T17:21:07,913 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-01-27T17:21:07,983 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-01-27T17:21:07,993 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-01-27T17:21:07,995 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-eff177bbda] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:07,996 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-01-27T17:21:07,996 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-eff177bbda, ackPos=11:-1, readPos=11:0}
2024-01-27T17:21:07,998 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic persistent://public/test/__change_events / reader-eff177bbda
2024-01-27T17:21:07,999 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-eff177bbda] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 5
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f9473e9] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a810b6d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f9473e9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21e49afd] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@c5f203d, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3613e358, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2589aebd, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bcdcda3, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72289df8, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a810b6d, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17951464], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@52f0a869, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@50a2325c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@72edf985, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1abc3454, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6f9473e9, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@21e49afd, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b522644] 
2024-01-27T17:21:08,032 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-266ac0d1ee] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-01-27T17:21:08,032 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-01-27T17:21:08,033 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-266ac0d1ee, ackPos=11:-1, readPos=11:0}
2024-01-27T17:21:08,035 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:34958] Created subscription on topic persistent://public/test/__change_events / reader-266ac0d1ee
2024-01-27T17:21:08,036 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-266ac0d1ee] Subscribed to topic on localhost/127.0.0.1:38397 -- consumer: 4
2024-01-27T17:21:08,041 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:34958] Closing consumer: consumerId=4
2024-01-27T17:21:08,041 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-266ac0d1ee}, consumerId=4, consumerName=e8dab, address=/127.0.0.1:34958}
2024-01-27T17:21:08,042 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-266ac0d1ee] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-266ac0d1ee, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:21:08,044 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-266ac0d1ee] Successfully closed dispatcher for reader
2024-01-27T17:21:08,050 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:34958] Closed consumer, consumerId=4
2024-01-27T17:21:08,056 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-266ac0d1ee] Closed consumer
2024-01-27T17:21:08,056 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
!!!!!!!!! FAILURE-- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-01-27T17:21:08,061 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:34958] Closing consumer: consumerId=5
2024-01-27T17:21:08,061 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-eff177bbda}, consumerId=5, consumerName=173c9, address=/127.0.0.1:34958}
2024-01-27T17:21:08,062 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-eff177bbda] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-eff177bbda, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:21:08,062 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-eff177bbda] Successfully closed dispatcher for reader
2024-01-27T17:21:08,063 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:34958] Closed consumer, consumerId=5
2024-01-27T17:21:08,065 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-eff177bbda] Closed consumer
2024-01-27T17:21:08,066 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-eff177bbda was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-eff177bbda was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:08,086 - INFO  - [main:TestRetrySupport@70] - Detected test failure in test ExtensibleLoadManagerImplTest.testGetMetrics, currentSetupNumber=1
2024-01-27T17:21:08,103 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-01-27T17:21:08,135 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-01-27T17:21:08,136 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-01-27T17:21:08,136 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-01-27T17:21:08,140 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-01-27T17:21:08,142 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-01-27T17:21:08,160 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-01-27T17:21:08,177 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-01-27T17:21:08,183 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-01-27T17:21:08,192 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-01-27T17:21:08,202 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-01-27T17:21:08,209 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-01-27T17:21:08,220 - INFO  - [main:WebService@350] - Web service closed
2024-01-27T17:21:08,225 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-01-27T17:21:08,226 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-01-27T17:21:08,228 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40905
2024-01-27T17:21:08,231 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40905 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-01-27T17:21:08,245 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:40905 was invalidated. state Releasing
2024-01-27T17:21:08,246 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:40905 registry has been deleted.
2024-01-27T17:21:08,246 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40905 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-01-27T17:21:08,247 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:40905. Retrying later on reconnection Lock was not in valid state: Releasing
2024-01-27T17:21:08,249 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:40905
2024-01-27T17:21:08,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40905 with delay:0 secs. Pending clean jobs:1.
2024-01-27T17:21:08,250 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40905
2024-01-27T17:21:08,252 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40905 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-01-27T17:21:08,269 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:40905/0x00000000_0xffffffff.
2024-01-27T17:21:08,271 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:40905/0x00000000_0xffffffff.
2024-01-27T17:21:08,272 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:40905/0x00000000_0xffffffff.
2024-01-27T17:21:08,274 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.023 seconds
2024-01-27T17:21:08,275 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-01-27T17:21:08,279 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-01-27T17:21:08,283 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:40905/persistent/__change_events] Closing managed ledger
2024-01-27T17:21:08,283 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:48958
2024-01-27T17:21:08,285 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:40905/__change_events, name=reader-c91064b7a0}, consumerId=2, consumerName=94145, address=/127.0.0.1:48958}
2024-01-27T17:21:08,285 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:40905/__change_events][reader-c91064b7a0] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40905/persistent/__change_events, cursor=reader-c91064b7a0, ackPos=9:-1, readPos=9:0}]
2024-01-27T17:21:08,286 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:40905/__change_events][reader-c91064b7a0] Successfully closed dispatcher for reader
2024-01-27T17:21:08,287 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] Disconnected
2024-01-27T17:21:08,290 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xe44446cd, L:/127.0.0.1:48958 ! R:localhost/127.0.0.1:41981] Disconnected
2024-01-27T17:21:08,291 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:08,291 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:40905/__change_events] [reader-c91064b7a0] Closed connection [id: 0xe44446cd, L:/127.0.0.1:48958 ! R:localhost/127.0.0.1:41981] -- Will try again in 0.1 s
2024-01-27T17:21:08,293 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:08,294 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:08,299 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:34962
2024-01-27T17:21:08,295 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-1b4d79e85e] Closed connection [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:08,300 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-1b4d79e85e}, consumerId=0, consumerName=b52ad, address=/127.0.0.1:34962}
2024-01-27T17:21:08,301 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-abf169c084] Closed connection [id: 0xd5353239, L:/127.0.0.1:34962 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:08,301 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-1b4d79e85e] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-1b4d79e85e, ackPos=3:5, readPos=3:6}]
2024-01-27T17:21:08,301 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-1b4d79e85e] Successfully closed dispatcher for reader
2024-01-27T17:21:08,302 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:40905/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-01-27T17:21:08,303 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-abf169c084}, consumerId=1, consumerName=9eef4, address=/127.0.0.1:34962}
2024-01-27T17:21:08,304 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-01-27T17:21:08,307 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-01-27T17:21:08,308 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-01-27T17:21:08,315 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:41981
2024-01-27T17:21:08,316 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-01-27T17:21:08,318 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-01-27T17:21:08,322 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-01-27T17:21:08,323 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-1b4d79e85e] Closed Consumer (not connected)
2024-01-27T17:21:08,325 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-abf169c084] Closed Consumer (not connected)
2024-01-27T17:21:08,325 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-1b4d79e85e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-1b4d79e85e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:08,326 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:40905/__change_events] [reader-c91064b7a0] Closed Consumer (not connected)
2024-01-27T17:21:08,326 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-abf169c084 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-abf169c084 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:08,327 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40905/__change_events with subscription name reader-c91064b7a0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40905/__change_events with subscription name reader-c91064b7a0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:08,336 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-01-27T17:21:08,336 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-01-27T17:21:08,340 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:21:08,341 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:08,380 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-01-27T17:21:08,380 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:08,913 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:08,914 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:21:09,605 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-01-27T17:21:09,606 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-01-27T17:21:09,609 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-01-27T17:21:09,609 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:09,609 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-01-27T17:21:09,610 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-01-27T17:21:09,915 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:09,915 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:21:10,916 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-01-27T17:21:10,916 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-01-27T17:21:11,624 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-01-27T17:21:11,626 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-01-27T17:21:11,627 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-01-27T17:21:11,627 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-01-27T17:21:11,627 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-01-27T17:21:11,627 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-01-27T17:21:11,629 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-01-27T17:21:11,630 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-01-27T17:21:11,632 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-01-27T17:21:11,634 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-01-27T17:21:11,635 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-01-27T17:21:11,636 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-01-27T17:21:11,637 - INFO  - [main:WebService@350] - Web service closed
2024-01-27T17:21:11,638 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-01-27T17:21:11,638 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-01-27T17:21:11,639 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33981
2024-01-27T17:21:11,642 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33981, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368867849, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-01-27T17:21:16,650 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33981 in 5009.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-01-27T17:21:16,659 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33981 was invalidated. state Releasing
2024-01-27T17:21:16,660 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33981. Retrying later on reconnection Lock was not in valid state: Releasing
2024-01-27T17:21:16,661 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33981
2024-01-27T17:21:16,665 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33981/0x00000000_0xffffffff.
2024-01-27T17:21:16,673 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33981, splitServiceUnitToDestBroker=null, force=true, timestamp=1706368876667, versionId=7]. totalHandledRequests:10
2024-01-27T17:21:16,674 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-01-27T17:21:16,676 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-01-27T17:21:16,677 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-01-27T17:21:16,679 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-01-27T17:21:16,684 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-01-27T17:21:16,690 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-01-27T17:21:16,691 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 17.0 ms
2024-01-27T17:21:16,700 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33981 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33981, splitServiceUnitToDestBroker=null, force=false, timestamp=1706368876674, versionId=8]. totalHandledRequests:4
2024-01-27T17:21:16,700 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-01-27T17:21:16,704 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33981/0x00000000_0xffffffff.
2024-01-27T17:21:16,705 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33981/0x00000000_0xffffffff.
2024-01-27T17:21:16,705 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.044 seconds
2024-01-27T17:21:16,706 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-01-27T17:21:16,706 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:34958
2024-01-27T17:21:16,707 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] Disconnected
2024-01-27T17:21:16,707 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-6cc1187a34}, consumerId=0, consumerName=cff6a, address=/127.0.0.1:34958}
2024-01-27T17:21:16,707 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,707 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6cc1187a34] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-6cc1187a34, ackPos=3:6, readPos=3:8}]
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-6cc1187a34] Successfully closed dispatcher for reader
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6cc1187a34] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-24edf74021] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33981/__change_events] [reader-7349ede60a] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33981/__change_events, name=reader-7349ede60a}, consumerId=3, consumerName=c1931, address=/127.0.0.1:34958}
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-29b530a02f] Closed connection [id: 0x2e9ee66d, L:/127.0.0.1:34958 ! R:localhost/127.0.0.1:38397] -- Will try again in 0.1 s
2024-01-27T17:21:16,708 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33981/__change_events][reader-7349ede60a] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33981/persistent/__change_events, cursor=reader-7349ede60a, ackPos=7:-1, readPos=7:0}]
2024-01-27T17:21:16,709 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33981/__change_events][reader-7349ede60a] Successfully closed dispatcher for reader
2024-01-27T17:21:16,709 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-01-27T17:21:16,709 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-29b530a02f}, consumerId=2, consumerName=38f72, address=/127.0.0.1:34958}
2024-01-27T17:21:16,710 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-01-27T17:21:16,710 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-24edf74021}, consumerId=1, consumerName=b0021, address=/127.0.0.1:34958}
2024-01-27T17:21:16,711 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33981/persistent/__change_events] Closing managed ledger
2024-01-27T17:21:16,712 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:34958] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-01-27T17:21:16,714 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-01-27T17:21:16,714 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33981/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-01-27T17:21:16,715 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-01-27T17:21:16,715 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-01-27T17:21:16,716 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-01-27T17:21:16,727 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:38397
2024-01-27T17:21:16,727 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-01-27T17:21:16,728 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-01-27T17:21:16,728 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-01-27T17:21:16,728 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33981/__change_events] [reader-7349ede60a] Closed Consumer (not connected)
2024-01-27T17:21:16,729 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-24edf74021] Closed Consumer (not connected)
2024-01-27T17:21:16,729 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33981/__change_events with subscription name reader-7349ede60a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33981/__change_events with subscription name reader-7349ede60a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:16,729 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-24edf74021 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-24edf74021 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:16,729 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-29b530a02f] Closed Consumer (not connected)
2024-01-27T17:21:16,730 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-6cc1187a34] Closed Consumer (not connected)
2024-01-27T17:21:16,730 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-29b530a02f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-29b530a02f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:16,731 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6cc1187a34 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-6cc1187a34 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-01-27T17:21:16,737 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-01-27T17:21:16,737 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-01-27T17:21:16,737 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-01-27T17:21:16,738 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-01-27T17:21:16,739 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:21:16,739 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:16,740 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-01-27T17:21:16,741 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:18,016 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-01-27T17:21:18,017 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-01-27T17:21:18,018 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-01-27T17:21:18,019 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:18,019 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-01-27T17:21:18,019 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-01-27T17:21:18,029 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-01-27T17:21:18,029 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-01-27T17:21:18,034 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-01-27T17:21:18,035 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-01-27T17:21:18,035 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-01-27T17:21:18,035 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-01-27T17:21:18,036 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-01-27T17:21:18,036 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-01-27T17:21:18,037 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@514abad9
2024-01-27T17:21:18,037 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-01-27T17:21:18,037 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-01-27T17:21:18,037 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 30.911 s <<< FAILURE! - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[ERROR] org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics  Time elapsed: 0.224 s  <<< FAILURE!
java.lang.AssertionError: Sets differ: expected [dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
	at org.testng.Assert.fail(Assert.java:110)
	at org.testng.Assert.assertEquals(Assert.java:2036)
	at org.testng.Assert.assertEquals(Assert.java:1963)
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics(ExtensibleLoadManagerImplTest.java:1018)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)
	at org.testng.internal.invokers.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:47)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:76)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:11)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   ExtensibleLoadManagerImplTest.testGetMetrics:1018 Sets differ: expected [dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:06 min
[INFO] Finished at: 2024-01-27T17:21:18+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.1.0:test (default-test) on project pulsar-broker: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
Exited after loop #2
