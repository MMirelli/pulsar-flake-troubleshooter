[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:08:14,467 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:08:15,399 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:08:15,401 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:08:15,897 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:08:15,898 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:08:15,899 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:08:15,900 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:08:15,900 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:08:15,901 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:08:15,923 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:08:15,924 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:08:15,925 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:08:15,925 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:08:15,926 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:08:15,926 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:08:15,927 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:08:15,927 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:08:15,928 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:08:15,929 - INFO  - [main:Environment@98] - Client environment:os.memory.free=32MB
2024-02-05T18:08:15,929 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:08:15,930 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:08:17,490 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:08:17,490 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:08:17,491 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:08:17,491 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:08:17,824 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:08:17,825 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:08:17,897 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:08:17,981 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:08:17,984 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:08:17,999 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:08:18,121 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:08:18,176 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:08:18,229 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:08:18,617 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:08:18,618 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:08:18,651 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:08:18,700 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45233, TLS: (none), listener: (none)
2024-02-05T18:08:19,051 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38815, TLS: OPENSSL, listener: (none)
2024-02-05T18:08:19,074 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:08:19,079 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:08:19,079 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:08:19,117 - INFO  - [main:Log@170] - Logging initialized @6967ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:08:20,122 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:08:20,161 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:08:20,161 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:08:20,163 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:08:20,960 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:08:22,089 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:08:23,376 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:08:23,773 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:08:23,896 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:08:24,018 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:08:24,021 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:08:24,023 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:08:24,041 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:37803}
2024-02-05T18:08:24,203 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:43853}
2024-02-05T18:08:24,204 - INFO  - [main:Server@415] - Started @12055ms
2024-02-05T18:08:24,204 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:37803
2024-02-05T18:08:24,206 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43853
2024-02-05T18:08:24,215 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:08:24,216 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:08:24,404 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:37803
2024-02-05T18:08:24,419 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:08:24,424 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:37803 is changing the role from null to Leader
2024-02-05T18:08:24,427 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:37803).
2024-02-05T18:08:24,776 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:37803 
2024-02-05T18:08:25,221 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:08:25,252 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:25,360 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:08:25,364 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:08:25,377 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:08:25,378 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:08:25,425 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:08:25,455 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:08:25,484 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:08:25,542 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:08:25,564 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:08:25,571 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:08:25,573 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:08:25,597 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 480
2024-02-05T18:08:25,598 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:08:25,734 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]] Connected to server
2024-02-05T18:08:25,771 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:57042] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:08:25,830 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:25,836 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:25,881 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:08:25,909 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:57042] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:57042, producerName=test-0-0, producerId=0}
2024-02-05T18:08:25,916 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:25,918 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:08:25,971 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:25,973 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5df6c8780f] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 0
2024-02-05T18:08:25,985 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5df6c8780f. consumerId: 0
2024-02-05T18:08:26,020 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5df6c8780f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:26,021 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:08:26,022 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5df6c8780f, ackPos=3:-1, readPos=3:0}
2024-02-05T18:08:26,041 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-5df6c8780f
2024-02-05T18:08:26,046 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5df6c8780f] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 0
2024-02-05T18:08:26,057 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.01 seconds
2024-02-05T18:08:26,059 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:08:26,060 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:08:26,061 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:08:26,101 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,123 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:08:26,125 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:08:26,127 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 55
2024-02-05T18:08:26,128 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:08:26,138 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,147 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:08:26,148 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:08:26,149 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:26 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:08:26,149 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:08:26,162 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,163 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:26,169 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:08:26,175 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:57042] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:57042, producerName=test-0-1, producerId=1}
2024-02-05T18:08:26,177 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:26,191 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,193 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f082c9203f] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 1
2024-02-05T18:08:26,194 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f082c9203f. consumerId: 1
2024-02-05T18:08:26,215 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f082c9203f] Created new subscription for 1
2024-02-05T18:08:26,216 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f082c9203f
2024-02-05T18:08:26,217 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f082c9203f] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 1
2024-02-05T18:08:26,233 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,235 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:26,244 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:08:26,250 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:57042] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:57042, producerName=test-0-2, producerId=2}
2024-02-05T18:08:26,252 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:26,262 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:08:26,278 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:08:26,282 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:37803 started the ownership monitor.
2024-02-05T18:08:26,297 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:26,299 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4bb80212e8] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 2
2024-02-05T18:08:26,300 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-4bb80212e8. consumerId: 2
2024-02-05T18:08:26,310 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4bb80212e8] Created new subscription for 2
2024-02-05T18:08:26,310 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-4bb80212e8
2024-02-05T18:08:26,311 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-4bb80212e8] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 2
2024-02-05T18:08:26,312 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:37803 plays the leader now.
2024-02-05T18:08:26,315 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707149306315, reportedAt= 0
2024-02-05T18:08:26,328 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:37803/__change_events
2024-02-05T18:08:26,330 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:08:26,334 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:26,335 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:08:26,400 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:37803/0x00000000_0xffffffff - localhost:37803.
2024-02-05T18:08:26,403 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:37803
2024-02-05T18:08:26,403 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:37803/0x00000000_0xffffffff
2024-02-05T18:08:26,404 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:37803/0x00000000_0xffffffff - localhost:37803.
2024-02-05T18:08:26,405 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:37803/0x00000000_0xffffffff
2024-02-05T18:08:26,406 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:37803
2024-02-05T18:08:26,410 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:37803/__change_events][reader-953ddaa993] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 3
2024-02-05T18:08:26,412 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic persistent://sla-monitor/test/localhost:37803/__change_events / reader-953ddaa993. consumerId: 3
2024-02-05T18:08:26,419 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:37803 doesn't exist.
2024-02-05T18:08:26,421 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:37803/persistent/__change_events
2024-02-05T18:08:26,423 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:37803/persistent/__change_events'
2024-02-05T18:08:26,431 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:08:26,432 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:37803/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:08:26,438 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:37803/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:08:26,448 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:37803/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:08:26,454 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:37803/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:37803/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:08:26,456 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:37803/__change_events - dedup is disabled
2024-02-05T18:08:26,470 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:08:26,479 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:37803/__change_events][reader-953ddaa993] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:26,480 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:37803/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:08:26,480 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:37803/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37803/persistent/__change_events, cursor=reader-953ddaa993, ackPos=7:-1, readPos=7:0}
2024-02-05T18:08:26,483 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic persistent://sla-monitor/test/localhost:37803/__change_events / reader-953ddaa993
2024-02-05T18:08:26,484 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:37803/__change_events][reader-953ddaa993] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 3
2024-02-05T18:08:26,438 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 37803, tls-port = Optional[43853], broker url= pulsar://localhost:45233, broker tls url= pulsar+ssl://localhost:38815, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[45233], brokerServicePortTls=Optional[38815], webServicePort=Optional[37803], webServicePortTls=Optional[43853], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:08:27,073 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:08:27,074 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:08:27,074 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:08:27,074 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:08:27,080 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:08:27,080 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:08:27,087 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:08:27,092 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:08:27,099 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:08:27,100 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:08:27,108 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:08:27,113 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:08:27,117 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:08:27,128 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:08:27,128 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:08:27,132 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:08:27,135 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44161, TLS: (none), listener: (none)
2024-02-05T18:08:27,137 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40131, TLS: OPENSSL, listener: (none)
2024-02-05T18:08:27,141 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:08:27,142 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:08:27,143 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:08:27,161 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:08:27,164 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:08:27,164 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:08:27,164 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:08:27,248 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@f4cfc61{/,null,AVAILABLE}
2024-02-05T18:08:27,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:27,336 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:08:27,819 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@4a842e8a{/admin,null,AVAILABLE}
2024-02-05T18:08:28,339 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:28,339 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:08:29,008 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7537f638{/admin/v2,null,AVAILABLE}
2024-02-05T18:08:29,262 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/admin/v3,null,AVAILABLE}
2024-02-05T18:08:29,336 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6b909973{/lookup,null,AVAILABLE}
2024-02-05T18:08:29,340 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:29,341 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:08:29,430 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@554f6e30{/topics,null,AVAILABLE}
2024-02-05T18:08:29,433 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@458044df{/metrics,null,AVAILABLE}
2024-02-05T18:08:29,433 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@64d7737c{/static,null,AVAILABLE}
2024-02-05T18:08:29,435 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@1a4eb392{HTTP/1.1, (http/1.1)}{0.0.0.0:37951}
2024-02-05T18:08:29,444 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2495a351{SSL, (ssl, http/1.1)}{0.0.0.0:43935}
2024-02-05T18:08:29,444 - INFO  - [main:Server@415] - Started @17296ms
2024-02-05T18:08:29,445 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:37951
2024-02-05T18:08:29,446 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43935
2024-02-05T18:08:29,449 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:08:29,450 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:08:29,469 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:37951
2024-02-05T18:08:29,471 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:37951 registry has been created.
2024-02-05T18:08:29,472 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:37951. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:08:29,476 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:37951 is changing the role from null to Follower
2024-02-05T18:08:29,478 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:37803).
2024-02-05T18:08:29,483 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:08:29,504 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:37951 
2024-02-05T18:08:29,634 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 54
2024-02-05T18:08:29,653 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:29,656 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:08:29,658 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:08:29,670 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:08:29,675 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37951/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:08:29,685 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xb761ae12, L:/127.0.0.1:46784 - R:localhost/127.0.0.1:44161]] Connected to server
2024-02-05T18:08:29,690 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:46784] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:08:29,707 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]] Connected to server
2024-02-05T18:08:29,711 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:57044] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:08:29,713 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,725 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:57044] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:57044, producerName=test-0-3, producerId=0}
2024-02-05T18:08:29,727 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,741 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ddc81ba248] Subscribing to topic on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233], consumerId 0
2024-02-05T18:08:29,743 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x7432648d, L:/127.0.0.1:45233 - R:/127.0.0.1:57044]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-ddc81ba248. consumerId: 0
2024-02-05T18:08:29,749 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ddc81ba248] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:29,749 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:08:29,749 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-ddc81ba248, ackPos=3:-1, readPos=3:0}
2024-02-05T18:08:29,751 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57044] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-ddc81ba248
2024-02-05T18:08:29,753 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ddc81ba248] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 0
2024-02-05T18:08:29,756 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:08:29,757 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:08:29,779 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:08:29,785 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:29,787 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:08:29,787 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:08:29,791 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:08:29,791 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37951/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:08:29,803 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 6
2024-02-05T18:08:29,808 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:29,810 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:08:29,810 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:08:29,814 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:37951/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:08:29,816 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:29 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:08:29,833 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,840 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:57044] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:57044, producerName=test-0-4, producerId=1}
2024-02-05T18:08:29,842 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,853 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-efebfdf7f1] Subscribing to topic on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233], consumerId 1
2024-02-05T18:08:29,855 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x7432648d, L:/127.0.0.1:45233 - R:/127.0.0.1:57044]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-efebfdf7f1. consumerId: 1
2024-02-05T18:08:29,867 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-efebfdf7f1] Created new subscription for 1
2024-02-05T18:08:29,867 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57044] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-efebfdf7f1
2024-02-05T18:08:29,868 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-efebfdf7f1] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 1
2024-02-05T18:08:29,882 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,890 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:57044] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:57044, producerName=test-0-5, producerId=2}
2024-02-05T18:08:29,891 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xff787124, L:/127.0.0.1:57044 - R:localhost/127.0.0.1:45233]
2024-02-05T18:08:29,892 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:08:29,896 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:08:29,897 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:37951 plays a follower now.
2024-02-05T18:08:29,918 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:37951/__change_events
2024-02-05T18:08:29,933 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:37951/0x00000000_0xffffffff - localhost:37951.
2024-02-05T18:08:29,934 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:37951/0x00000000_0xffffffff
2024-02-05T18:08:29,935 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:37951
2024-02-05T18:08:29,936 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:37951/0x00000000_0xffffffff - localhost:37951.
2024-02-05T18:08:29,937 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:37951
2024-02-05T18:08:29,937 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:37951/0x00000000_0xffffffff
2024-02-05T18:08:29,939 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:37951 doesn't exist.
2024-02-05T18:08:29,942 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:37951/__change_events][reader-b3fba5fe57] Subscribing to topic on cnx [id: 0xb761ae12, L:/127.0.0.1:46784 - R:localhost/127.0.0.1:44161], consumerId 2
2024-02-05T18:08:29,941 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 37951, tls-port = Optional[43935], broker url= pulsar://localhost:44161, broker tls url= pulsar+ssl://localhost:40131, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[44161], brokerServicePortTls=Optional[40131], webServicePort=Optional[37951], webServicePortTls=Optional[43935], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:08:29,944 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x9f32d04a, L:/127.0.0.1:44161 - R:/127.0.0.1:46784]] Subscribing on topic persistent://sla-monitor/test/localhost:37951/__change_events / reader-b3fba5fe57. consumerId: 2
2024-02-05T18:08:29,954 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:37951/persistent/__change_events
2024-02-05T18:08:29,960 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:37951/persistent/__change_events'
2024-02-05T18:08:29,977 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:08:29,979 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:37951/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:08:29,986 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:37951/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:08:29,991 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:37951/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:08:29,997 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:37951/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:37951/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:08:29,999 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:37951/__change_events - dedup is disabled
2024-02-05T18:08:30,005 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:08:30,068 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:37951/__change_events][reader-b3fba5fe57] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:30,068 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:37951/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:08:30,068 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:37951/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37951/persistent/__change_events, cursor=reader-b3fba5fe57, ackPos=9:-1, readPos=9:0}
2024-02-05T18:08:30,071 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:46784] Created subscription on topic persistent://sla-monitor/test/localhost:37951/__change_events / reader-b3fba5fe57
2024-02-05T18:08:30,080 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:37951/__change_events][reader-b3fba5fe57] Subscribed to topic on localhost/127.0.0.1:44161 -- consumer: 2
2024-02-05T18:08:30,134 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:08:30,135 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:08:30,164 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:08:30,165 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:08:30,189 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:08:30,189 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:08:30,194 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:08:30,195 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:08:30,219 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:08:30,220 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:08:30,221 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:08:30,223 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:08:30,224 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:08:30,227 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:08:30,238 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:08:30,238 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:08:30,244 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:08:30,245 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:08:30,259 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:08:30,259 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:08:30,260 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:08:30,260 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:08:30,264 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:08:30,265 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:08:30,304 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:08:30,314 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:08:30,314 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:08:30,331 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:08:30,342 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:08:30,342 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:08:30,344 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:30,362 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:37803 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:08:30,410 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:37803, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310364, versionId=1]. totalHandledRequests:1
2024-02-05T18:08:30,445 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:37803, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310432, versionId=2]. totalHandledRequests:1
2024-02-05T18:08:30,449 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:30,473 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:08:30,473 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:08:30,476 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:08:30,477 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 177
2024-02-05T18:08:30,478 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:08:30 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 148
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:08:30,484 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:08:30,488 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:08:30,495 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:08:30,508 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:37803, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149310460, versionId=3]. totalHandledRequests:1
2024-02-05T18:08:30,556 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:30,557 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 48.0 ms
2024-02-05T18:08:30,568 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:37803, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310509, versionId=4]. totalHandledRequests:1
2024-02-05T18:08:30,572 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:37803. Skipping this broker. Phase one
2024-02-05T18:08:30,572 - WARN  - [ForkJoinPool.commonPool-worker-1:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:37803. Skipping this broker. Phase two
2024-02-05T18:08:30,573 - INFO  - [broker-client-shared-internal-executor-11-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:37803 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:08:30,583 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:37803, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310573, versionId=5]. totalHandledRequests:2
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@74097353] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@224364fb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@74097353, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@664b683b] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73e5c917, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@537fca7b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@41cece4e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d3175bc, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6e5b081, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@224364fb, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4d01adcb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@51ac1c78, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1cbe11bf, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@703045d3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@31eea44c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@74097353, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@664b683b, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@722dccd3] 
2024-02-05T18:08:30,596 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:37803, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310583, versionId=6]. totalHandledRequests:6
2024-02-05T18:08:30,598 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-124100d513] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 4
2024-02-05T18:08:30,598 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:08:30,599 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic persistent://public/test/__change_events / reader-124100d513. consumerId: 4
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:08:30,610 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:08:30,613 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:08:30,615 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:08:30,619 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:08:30,620 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:08:30,628 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:08:30,629 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@1a4eb392{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:08:30,630 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2495a351{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:08:30,630 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:08:30,634 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:08:30,634 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@64d7737c{/static,null,STOPPED}
2024-02-05T18:08:30,637 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@458044df{/metrics,null,STOPPED}
2024-02-05T18:08:30,641 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:08:30,644 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:08:30,646 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:08:30,648 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-d75db64b10] Subscribing to topic on cnx [id: 0x3af9cb4e, L:/127.0.0.1:57042 - R:localhost/127.0.0.1:45233], consumerId 5
2024-02-05T18:08:30,649 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:08:30,650 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x221870a3, L:/127.0.0.1:45233 - R:/127.0.0.1:57042]] Subscribing on topic persistent://public/test/__change_events / reader-d75db64b10. consumerId: 5
2024-02-05T18:08:30,655 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-124100d513] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:30,655 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:08:30,656 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-124100d513, ackPos=11:-1, readPos=11:0}
2024-02-05T18:08:30,657 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic persistent://public/test/__change_events / reader-124100d513
2024-02-05T18:08:30,658 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-124100d513] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 4
2024-02-05T18:08:30,660 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@554f6e30{/topics,null,STOPPED}
2024-02-05T18:08:30,662 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6b909973{/lookup,null,STOPPED}
2024-02-05T18:08:30,663 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:57042] Closing consumer: consumerId=4
2024-02-05T18:08:30,664 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-124100d513}, consumerId=4, consumerName=0f70e, address=/127.0.0.1:57042}
2024-02-05T18:08:30,665 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-124100d513] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-124100d513, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:08:30,668 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/admin/v3,null,STOPPED}
2024-02-05T18:08:30,670 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7537f638{/admin/v2,null,STOPPED}
2024-02-05T18:08:30,673 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@4a842e8a{/admin,null,STOPPED}
2024-02-05T18:08:30,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-d75db64b10] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:08:30,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:08:30,675 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-124100d513] Successfully closed dispatcher for reader
2024-02-05T18:08:30,675 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d75db64b10, ackPos=11:-1, readPos=11:0}
2024-02-05T18:08:30,676 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@f4cfc61{/,null,STOPPED}
2024-02-05T18:08:30,678 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:57042] Created subscription on topic persistent://public/test/__change_events / reader-d75db64b10
2024-02-05T18:08:30,679 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:57042] Closed consumer, consumerId=4
2024-02-05T18:08:30,680 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-124100d513] Closed consumer
2024-02-05T18:08:30,681 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-d75db64b10] Subscribed to topic on localhost/127.0.0.1:45233 -- consumer: 5
2024-02-05T18:08:30,681 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:08:30,683 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:08:30,685 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:08:30,686 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:08:30,687 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37951
2024-02-05T18:08:30,687 - INFO  - [pulsar-io-9-1:ServerCnx@2007] - [/127.0.0.1:57042] Closing consumer: consumerId=5
2024-02-05T18:08:30,689 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-d75db64b10}, consumerId=5, consumerName=84fbc, address=/127.0.0.1:57042}
2024-02-05T18:08:30,689 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-d75db64b10] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d75db64b10, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:08:30,689 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-d75db64b10] Successfully closed dispatcher for reader
2024-02-05T18:08:30,691 - INFO  - [pulsar-io-9-1:ServerCnx@2043] - [/127.0.0.1:57042] Closed consumer, consumerId=5
2024-02-05T18:08:30,691 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37951 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:08:30,692 - INFO  - [pulsar-io-9-4:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-d75db64b10] Closed consumer
2024-02-05T18:08:30,693 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:08:30,698 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:37951 was invalidated. state Releasing
2024-02-05T18:08:30,700 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:37951. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:08:30,700 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:37951 registry has been deleted.
2024-02-05T18:08:30,700 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:37951 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:08:30,701 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:37951
2024-02-05T18:08:30,703 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:37951 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:08:30,703 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37951
2024-02-05T18:08:30,705 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37951 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:08:30,713 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:37951/0x00000000_0xffffffff.
2024-02-05T18:08:30,715 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:37951/0x00000000_0xffffffff.
2024-02-05T18:08:30,716 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:37951/0x00000000_0xffffffff.
2024-02-05T18:08:30,716 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.014 seconds
2024-02-05T18:08:30,717 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:08:30,720 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:08:30,720 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:37951/persistent/__change_events] Closing managed ledger
2024-02-05T18:08:30,721 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:46784
2024-02-05T18:08:30,723 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xb761ae12, L:/127.0.0.1:46784 ! R:localhost/127.0.0.1:44161] Disconnected
2024-02-05T18:08:30,725 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:37951/__change_events] [reader-b3fba5fe57] Closed connection [id: 0xb761ae12, L:/127.0.0.1:46784 ! R:localhost/127.0.0.1:44161] -- Will try again in 0.1 s
2024-02-05T18:08:30,728 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] Disconnected
2024-02-05T18:08:30,728 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:37951/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:08:30,728 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:37951/__change_events, name=reader-b3fba5fe57}, consumerId=2, consumerName=a3c84, address=/127.0.0.1:46784}
2024-02-05T18:08:30,728 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:37951/__change_events][reader-b3fba5fe57] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37951/persistent/__change_events, cursor=reader-b3fba5fe57, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:37951/__change_events][reader-b3fba5fe57] Successfully closed dispatcher for reader
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-ddc81ba248] Closed connection [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-efebfdf7f1] Closed connection [id: 0xff787124, L:/127.0.0.1:57044 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:30,729 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:57044
2024-02-05T18:08:30,731 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:08:30,731 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-ddc81ba248}, consumerId=0, consumerName=20b2f, address=/127.0.0.1:57044}
2024-02-05T18:08:30,733 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ddc81ba248] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-ddc81ba248, ackPos=3:5, readPos=3:6}]
2024-02-05T18:08:30,733 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:08:30,733 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-ddc81ba248] Successfully closed dispatcher for reader
2024-02-05T18:08:30,734 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:08:30,737 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-efebfdf7f1}, consumerId=1, consumerName=4d9b9, address=/127.0.0.1:57044}
2024-02-05T18:08:30,743 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:44161
2024-02-05T18:08:30,744 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:08:30,746 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:08:30,746 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:08:30,747 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-ddc81ba248] Closed Consumer (not connected)
2024-02-05T18:08:30,748 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-ddc81ba248 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-ddc81ba248 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:30,749 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:37951/__change_events] [reader-b3fba5fe57] Closed Consumer (not connected)
2024-02-05T18:08:30,750 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37951/__change_events with subscription name reader-b3fba5fe57 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37951/__change_events with subscription name reader-b3fba5fe57 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:30,751 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-efebfdf7f1] Closed Consumer (not connected)
2024-02-05T18:08:30,751 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-efebfdf7f1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-efebfdf7f1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:30,757 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:08:30,757 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:08:30,761 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:08:30,762 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:30,771 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:08:30,771 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:31,275 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:08:31,276 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 47.07%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 47.07%, msgThroughputEMA= 0.00, updatedAt= 1707149311275, reportedAt= 0
2024-02-05T18:08:31,343 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:31,344 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:08:32,040 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:08:32,040 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:08:32,042 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:08:32,042 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:32,042 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:08:32,043 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:08:32,345 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:32,345 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:08:33,346 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:08:33,346 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:08:34,056 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:08:34,057 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:08:34,058 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:08:34,058 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:08:34,058 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:08:34,059 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:08:34,060 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:08:34,061 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:08:34,063 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:08:34,064 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:08:34,066 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:08:34,067 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:08:34,069 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:08:34,070 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:08:34,071 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:08:34,072 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37803
2024-02-05T18:08:34,074 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:37803, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149310583, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:08:39,085 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37803 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:08:39,094 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:37803 was invalidated. state Releasing
2024-02-05T18:08:39,094 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:37803. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:08:39,094 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:37803
2024-02-05T18:08:39,107 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:37803, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149319099, versionId=7]. totalHandledRequests:10
2024-02-05T18:08:39,108 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:08:39,110 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:08:39,110 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:08:39,111 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:08:39,113 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:08:39,118 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:08:39,119 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 11.0 ms
2024-02-05T18:08:39,126 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37803 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:37803, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149319107, versionId=8]. totalHandledRequests:4
2024-02-05T18:08:39,126 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:08:39,128 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:37803/0x00000000_0xffffffff.
2024-02-05T18:08:39,130 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:37803/0x00000000_0xffffffff.
2024-02-05T18:08:39,132 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:37803/0x00000000_0xffffffff.
2024-02-05T18:08:39,132 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.037 seconds
2024-02-05T18:08:39,132 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:08:39,133 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:08:39,133 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:08:39,133 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:57042
2024-02-05T18:08:39,134 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] Disconnected
2024-02-05T18:08:39,134 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-5df6c8780f}, consumerId=0, consumerName=25e0c, address=/127.0.0.1:57042}
2024-02-05T18:08:39,135 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,134 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:37803/persistent/__change_events] Closing managed ledger
2024-02-05T18:08:39,135 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5df6c8780f] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-5df6c8780f, ackPos=3:5, readPos=3:8}]
2024-02-05T18:08:39,135 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,135 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-5df6c8780f] Successfully closed dispatcher for reader
2024-02-05T18:08:39,136 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,136 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:37803/__change_events, name=reader-953ddaa993}, consumerId=3, consumerName=34e74, address=/127.0.0.1:57042}
2024-02-05T18:08:39,136 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5df6c8780f] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,136 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:37803/__change_events][reader-953ddaa993] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37803/persistent/__change_events, cursor=reader-953ddaa993, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:08:39,137 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:37803/__change_events][reader-953ddaa993] Successfully closed dispatcher for reader
2024-02-05T18:08:39,137 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f082c9203f] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,137 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:37803/__change_events] [reader-953ddaa993] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,137 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-4bb80212e8] Closed connection [id: 0x3af9cb4e, L:/127.0.0.1:57042 ! R:localhost/127.0.0.1:45233] -- Will try again in 0.1 s
2024-02-05T18:08:39,138 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-4bb80212e8}, consumerId=2, consumerName=e465d, address=/127.0.0.1:57042}
2024-02-05T18:08:39,138 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-f082c9203f}, consumerId=1, consumerName=bf1e7, address=/127.0.0.1:57042}
2024-02-05T18:08:39,139 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:37803/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:08:39,139 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:08:39,140 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:08:39,141 - WARN  - [pulsar-io-9-1:ServerCnx@407] - [/127.0.0.1:57042] Got exception java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:934)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:351)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:344)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:836)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute0(SingleThreadEventExecutor.java:827)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:817)
	at io.netty.util.concurrent.AbstractEventExecutorGroup.execute(AbstractEventExecutorGroup.java:115)
	at java.base/java.util.concurrent.CompletableFuture.asyncRunStage(CompletableFuture.java:1818)
	at java.base/java.util.concurrent.CompletableFuture.runAsync(CompletableFuture.java:2033)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentTopic.unsubscribe(NonPersistentTopic.java:1151)
	at org.apache.pulsar.broker.service.nonpersistent.NonPersistentSubscription.removeConsumer(NonPersistentSubscription.java:189)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:400)
	at org.apache.pulsar.broker.service.Consumer.close(Consumer.java:396)
	at org.apache.pulsar.broker.service.ServerCnx.lambda$channelInactive$1(ServerCnx.java:378)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:562)
	at org.apache.pulsar.common.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:242)
	at org.apache.pulsar.broker.service.ServerCnx.channelInactive(ServerCnx.java:369)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.flow.FlowControlHandler.channelInactive(FlowControlHandler.java:134)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:411)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasksFrom(SingleThreadEventExecutor.java:426)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:375)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:763)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:431)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)

2024-02-05T18:08:39,141 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:08:39,142 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:08:39,146 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:45233
2024-02-05T18:08:39,147 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:08:39,147 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:08:39,147 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:08:39,148 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-5df6c8780f] Closed Consumer (not connected)
2024-02-05T18:08:39,148 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:37803/__change_events] [reader-953ddaa993] Closed Consumer (not connected)
2024-02-05T18:08:39,148 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f082c9203f] Closed Consumer (not connected)
2024-02-05T18:08:39,148 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5df6c8780f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-5df6c8780f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:39,148 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-4bb80212e8] Closed Consumer (not connected)
2024-02-05T18:08:39,149 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37803/__change_events with subscription name reader-953ddaa993 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37803/__change_events with subscription name reader-953ddaa993 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:39,149 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f082c9203f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f082c9203f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:39,150 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-4bb80212e8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-4bb80212e8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:08:39,153 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:08:39,153 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:08:39,153 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:08:39,154 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:08:39,154 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:08:39,154 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:39,156 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:08:39,156 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:40,445 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:08:40,446 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:08:40,448 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:08:40,448 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:40,448 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:08:40,448 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:08:40,457 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:08:40,457 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:08:40,462 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:08:40,462 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:08:40,462 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:08:40,463 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:08:40,464 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:08:40,464 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:08:40,464 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:08:40,464 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@7a72fc23
2024-02-05T18:08:40,464 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:08:40,464 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:08:40,465 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 27.811 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:06 min
[INFO] Finished at: 2024-02-05T18:08:40+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 1 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:09:10,452 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:09:11,400 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:09:11,402 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:09:11,878 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:09:11,879 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:09:11,880 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:09:11,880 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:09:11,881 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:09:11,882 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:09:11,902 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:09:11,902 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:09:11,903 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:09:11,904 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:09:11,904 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:09:11,905 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:09:11,905 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:09:11,906 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:09:11,906 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:09:11,907 - INFO  - [main:Environment@98] - Client environment:os.memory.free=34MB
2024-02-05T18:09:11,907 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:09:11,908 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:09:13,613 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:09:13,614 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:09:13,615 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:09:13,615 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:09:13,979 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:09:13,981 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:09:14,073 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:09:14,156 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:09:14,159 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:09:14,176 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:09:14,291 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:09:14,334 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:09:14,389 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:09:14,784 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:09:14,785 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:09:14,819 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:09:14,877 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46875, TLS: (none), listener: (none)
2024-02-05T18:09:15,231 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46201, TLS: OPENSSL, listener: (none)
2024-02-05T18:09:15,254 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:09:15,258 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:09:15,259 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:09:15,289 - INFO  - [main:Log@170] - Logging initialized @7026ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:09:16,157 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:09:16,190 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:09:16,191 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:09:16,193 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:09:17,028 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:09:18,183 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:09:19,436 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:09:19,716 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:09:19,834 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:09:20,058 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:09:20,059 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:09:20,061 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:09:20,075 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:37769}
2024-02-05T18:09:20,218 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:34097}
2024-02-05T18:09:20,219 - INFO  - [main:Server@415] - Started @11957ms
2024-02-05T18:09:20,219 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:37769
2024-02-05T18:09:20,220 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:34097
2024-02-05T18:09:20,228 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:09:20,229 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:09:20,402 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:37769
2024-02-05T18:09:20,422 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:09:20,427 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:37769 is changing the role from null to Leader
2024-02-05T18:09:20,429 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:37769).
2024-02-05T18:09:20,756 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:37769 
2024-02-05T18:09:21,169 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:09:21,195 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:21,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:09:21,301 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:09:21,310 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:09:21,316 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:09:21,352 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:09:21,390 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:09:21,427 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:09:21,504 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:09:21,527 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:09:21,539 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:09:21,542 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:09:21,577 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:21 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 522
2024-02-05T18:09:21,582 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:09:21,720 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]] Connected to server
2024-02-05T18:09:21,748 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:41136] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:09:21,797 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:21,803 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:21,841 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:09:21,873 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:41136] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:41136, producerName=test-0-0, producerId=0}
2024-02-05T18:09:21,881 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:21,884 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:09:21,936 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:21,938 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-92ef632fc2] Subscribing to topic on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875], consumerId 0
2024-02-05T18:09:21,948 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x8519111f, L:/127.0.0.1:46875 - R:/127.0.0.1:41136]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-92ef632fc2. consumerId: 0
2024-02-05T18:09:21,996 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-92ef632fc2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:21,997 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:09:21,997 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-92ef632fc2, ackPos=3:-1, readPos=3:0}
2024-02-05T18:09:22,015 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:41136] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-92ef632fc2
2024-02-05T18:09:22,020 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-92ef632fc2] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 0
2024-02-05T18:09:22,032 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:09:22,033 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:09:22,035 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:09:22,035 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:09:22,077 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,098 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:09:22,099 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:09:22,101 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:09:22,101 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:09:22,113 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,122 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:09:22,123 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:09:22,124 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:22 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:09:22,125 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:09:22,147 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,149 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:22,157 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:09:22,164 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:41136] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:41136, producerName=test-0-1, producerId=1}
2024-02-05T18:09:22,165 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:22,181 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,183 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8b81b1536a] Subscribing to topic on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875], consumerId 1
2024-02-05T18:09:22,185 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x8519111f, L:/127.0.0.1:46875 - R:/127.0.0.1:41136]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-8b81b1536a. consumerId: 1
2024-02-05T18:09:22,206 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8b81b1536a] Created new subscription for 1
2024-02-05T18:09:22,207 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:41136] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-8b81b1536a
2024-02-05T18:09:22,211 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-8b81b1536a] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 1
2024-02-05T18:09:22,228 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,229 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:22,237 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:09:22,245 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:41136] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:41136, producerName=test-0-2, producerId=2}
2024-02-05T18:09:22,246 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:22,257 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:09:22,276 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:09:22,281 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:37769 started the ownership monitor.
2024-02-05T18:09:22,296 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:22,300 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-12b2219587] Subscribing to topic on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875], consumerId 2
2024-02-05T18:09:22,302 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x8519111f, L:/127.0.0.1:46875 - R:/127.0.0.1:41136]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-12b2219587. consumerId: 2
2024-02-05T18:09:22,314 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-12b2219587] Created new subscription for 2
2024-02-05T18:09:22,315 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:41136] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-12b2219587
2024-02-05T18:09:22,316 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:37769/__change_events
2024-02-05T18:09:22,316 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-12b2219587] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 2
2024-02-05T18:09:22,317 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:37769 plays the leader now.
2024-02-05T18:09:22,323 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707149362322, reportedAt= 0
2024-02-05T18:09:22,341 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:09:22,345 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:22,346 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:09:22,403 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:37769/0x00000000_0xffffffff - localhost:37769.
2024-02-05T18:09:22,405 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:37769/0x00000000_0xffffffff
2024-02-05T18:09:22,407 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:37769
2024-02-05T18:09:22,408 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:37769/0x00000000_0xffffffff - localhost:37769.
2024-02-05T18:09:22,410 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:37769/0x00000000_0xffffffff
2024-02-05T18:09:22,410 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:37769/__change_events][reader-d2a37cb119] Subscribing to topic on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875], consumerId 3
2024-02-05T18:09:22,413 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x8519111f, L:/127.0.0.1:46875 - R:/127.0.0.1:41136]] Subscribing on topic persistent://sla-monitor/test/localhost:37769/__change_events / reader-d2a37cb119. consumerId: 3
2024-02-05T18:09:22,413 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:37769
2024-02-05T18:09:22,424 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:37769/persistent/__change_events
2024-02-05T18:09:22,426 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:37769/persistent/__change_events'
2024-02-05T18:09:22,429 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:37769 doesn't exist.
2024-02-05T18:09:22,433 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:09:22,433 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:37769/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:09:22,441 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:37769/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:09:22,448 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:37769/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:09:22,460 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:37769/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:37769/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:09:22,462 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:37769/__change_events - dedup is disabled
2024-02-05T18:09:22,489 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:09:22,498 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:37769/__change_events][reader-d2a37cb119] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:22,498 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:37769/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:09:22,499 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:37769/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37769/persistent/__change_events, cursor=reader-d2a37cb119, ackPos=7:-1, readPos=7:0}
2024-02-05T18:09:22,502 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:41136] Created subscription on topic persistent://sla-monitor/test/localhost:37769/__change_events / reader-d2a37cb119
2024-02-05T18:09:22,503 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:37769/__change_events][reader-d2a37cb119] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 3
2024-02-05T18:09:22,446 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 37769, tls-port = Optional[34097], broker url= pulsar://localhost:46875, broker tls url= pulsar+ssl://localhost:46201, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[46875], brokerServicePortTls=Optional[46201], webServicePort=Optional[37769], webServicePortTls=Optional[34097], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:09:23,094 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:09:23,095 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:09:23,095 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:09:23,095 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:09:23,101 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:09:23,101 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:09:23,107 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:09:23,112 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:09:23,120 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:09:23,120 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:09:23,128 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:09:23,134 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:09:23,137 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:09:23,147 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:09:23,149 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:09:23,153 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:09:23,156 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44559, TLS: (none), listener: (none)
2024-02-05T18:09:23,158 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:41515, TLS: OPENSSL, listener: (none)
2024-02-05T18:09:23,163 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:09:23,164 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:09:23,165 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:09:23,180 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:09:23,184 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:09:23,184 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:09:23,185 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:09:23,267 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:09:23,347 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:23,348 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:09:24,033 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:09:24,348 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:24,349 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:09:25,217 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:09:25,352 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:25,353 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:09:25,459 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:09:25,521 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:09:25,583 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:09:25,585 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:09:25,585 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:09:25,588 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:42723}
2024-02-05T18:09:25,604 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:37529}
2024-02-05T18:09:25,606 - INFO  - [main:Server@415] - Started @17343ms
2024-02-05T18:09:25,607 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42723
2024-02-05T18:09:25,610 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37529
2024-02-05T18:09:25,621 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:09:25,624 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:09:25,639 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42723
2024-02-05T18:09:25,641 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42723 registry has been created.
2024-02-05T18:09:25,642 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42723. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:09:25,651 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42723 is changing the role from null to Follower
2024-02-05T18:09:25,653 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:37769).
2024-02-05T18:09:25,658 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:09:25,682 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42723 
2024-02-05T18:09:25,808 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 61
2024-02-05T18:09:25,836 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:25,839 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:09:25,840 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:09:25,854 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 34
2024-02-05T18:09:25,858 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42723/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:09:25,870 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:25,878 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:43894] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:09:25,893 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]] Connected to server
2024-02-05T18:09:25,897 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:41142] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:09:25,898 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:25,912 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:41142] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:41142, producerName=test-0-3, producerId=0}
2024-02-05T18:09:25,914 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:25,930 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b3f4c24ea2] Subscribing to topic on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875], consumerId 0
2024-02-05T18:09:25,932 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x7c564bd8, L:/127.0.0.1:46875 - R:/127.0.0.1:41142]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-b3f4c24ea2. consumerId: 0
2024-02-05T18:09:25,937 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b3f4c24ea2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:25,938 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:09:25,938 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-b3f4c24ea2, ackPos=3:-1, readPos=3:0}
2024-02-05T18:09:25,941 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:41142] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-b3f4c24ea2
2024-02-05T18:09:25,942 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b3f4c24ea2] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 0
2024-02-05T18:09:25,948 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.005 seconds
2024-02-05T18:09:25,949 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:09:25,969 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:09:25,978 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:25,982 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:09:25,982 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:09:25,986 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:09:25,986 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42723/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:09:25,997 - INFO  - [pulsar-web-84-7:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:09:26,004 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:26,007 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:09:26,008 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:09:26,011 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:09:26,012 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42723/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:09:26,029 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:26,037 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:41142] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:41142, producerName=test-0-4, producerId=1}
2024-02-05T18:09:26,038 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:26,050 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cad50eeef] Subscribing to topic on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875], consumerId 1
2024-02-05T18:09:26,051 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x7c564bd8, L:/127.0.0.1:46875 - R:/127.0.0.1:41142]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3cad50eeef. consumerId: 1
2024-02-05T18:09:26,062 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cad50eeef] Created new subscription for 1
2024-02-05T18:09:26,062 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:41142] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3cad50eeef
2024-02-05T18:09:26,063 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cad50eeef] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 1
2024-02-05T18:09:26,080 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:26,088 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:41142] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:41142, producerName=test-0-5, producerId=2}
2024-02-05T18:09:26,089 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x1b4e0679, L:/127.0.0.1:41142 - R:localhost/127.0.0.1:46875]
2024-02-05T18:09:26,091 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:09:26,093 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:09:26,094 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42723 plays a follower now.
2024-02-05T18:09:26,109 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42723/__change_events
2024-02-05T18:09:26,133 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42723/0x00000000_0xffffffff - localhost:42723.
2024-02-05T18:09:26,134 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42723/0x00000000_0xffffffff
2024-02-05T18:09:26,135 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42723
2024-02-05T18:09:26,136 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42723/0x00000000_0xffffffff - localhost:42723.
2024-02-05T18:09:26,137 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42723
2024-02-05T18:09:26,137 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42723/0x00000000_0xffffffff
2024-02-05T18:09:26,139 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42723 doesn't exist.
2024-02-05T18:09:26,143 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42723/__change_events][reader-d435088cf8] Subscribing to topic on cnx [id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559], consumerId 2
2024-02-05T18:09:26,141 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 42723, tls-port = Optional[37529], broker url= pulsar://localhost:44559, broker tls url= pulsar+ssl://localhost:41515, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[44559], brokerServicePortTls=Optional[41515], webServicePort=Optional[42723], webServicePortTls=Optional[37529], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:09:26,147 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xa00ad4e3, L:/127.0.0.1:44559 - R:/127.0.0.1:43894]] Subscribing on topic persistent://sla-monitor/test/localhost:42723/__change_events / reader-d435088cf8. consumerId: 2
2024-02-05T18:09:26,154 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42723/persistent/__change_events
2024-02-05T18:09:26,157 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42723/persistent/__change_events'
2024-02-05T18:09:26,167 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:09:26,168 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42723/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:09:26,177 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42723/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:09:26,182 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42723/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:09:26,188 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42723/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42723/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:09:26,189 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42723/__change_events - dedup is disabled
2024-02-05T18:09:26,201 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:09:26,209 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42723/__change_events][reader-d435088cf8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:26,209 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42723/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:09:26,210 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42723/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42723/persistent/__change_events, cursor=reader-d435088cf8, ackPos=9:-1, readPos=9:0}
2024-02-05T18:09:26,212 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:43894] Created subscription on topic persistent://sla-monitor/test/localhost:42723/__change_events / reader-d435088cf8
2024-02-05T18:09:26,214 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42723/__change_events][reader-d435088cf8] Subscribed to topic on localhost/127.0.0.1:44559 -- consumer: 2
2024-02-05T18:09:26,348 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:09:26,349 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:09:26,353 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:09:26,354 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:09:26,377 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:09:26,379 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:09:26,408 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:09:26,408 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:09:26,413 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:09:26,414 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:09:26,439 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:09:26,439 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:09:26,440 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:09:26,441 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:09:26,443 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:09:26,441 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:09:26,462 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:09:26,462 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:09:26,468 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:09:26,469 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:09:26,478 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:09:26,478 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:09:26,478 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:09:26,479 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:09:26,480 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T18:09:26,486 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:09:26,515 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:09:26,527 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:09:26,527 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:09:26,540 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:09:26,551 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:26,570 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42723 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:09:26,632 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:09:26,616 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42723, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366572, versionId=1]. totalHandledRequests:1
2024-02-05T18:09:26,655 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42723, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366616, versionId=2]. totalHandledRequests:1
2024-02-05T18:09:26,664 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:26,679 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 142
2024-02-05T18:09:26,681 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Subscribing to topic on cnx [id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559], consumerId 3
2024-02-05T18:09:26,684 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xa00ad4e3, L:/127.0.0.1:44559 - R:/127.0.0.1:43894]] Subscribing on topic persistent://public/test/__change_events / reader-ba5c6ad4ee. consumerId: 3
2024-02-05T18:09:26,693 - INFO  - [pulsar-web-84-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:09:26,694 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:09:26,697 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:09:26,703 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:09:26,704 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:09:26,712 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:09:26,718 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:09:26,723 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:09:26,726 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:09:26,733 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149366724, versionId=3]. totalHandledRequests:1
2024-02-05T18:09:26,740 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:09:26,742 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:09:26,743 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:09:26,745 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:09:26,747 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:09:26,758 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:09:26,766 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:09:26,770 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 31.0 ms
2024-02-05T18:09:26,781 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366738, versionId=4]. totalHandledRequests:1
2024-02-05T18:09:26,782 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42723. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:09:26,783 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:43894][persistent://public/test/__change_events][reader-ba5c6ad4ee] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42723. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:09:26,786 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42723. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:09:26,787 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:09:26,787 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:09:26,789 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Failed to subscribe to topic on localhost/127.0.0.1:44559
2024-02-05T18:09:26,789 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42723. Please redo the lookup. Request is denied: namespace=public/test","reqId":149991473957218449, "remote":"localhost/127.0.0.1:44559", "local":"/127.0.0.1:43894"}
2024-02-05T18:09:26,790 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42723. Please redo the lookup. Request is denied: namespace=public/test","reqId":149991473957218449, "remote":"localhost/127.0.0.1:44559", "local":"/127.0.0.1:43894"} -- Will try again in 0.1 s
2024-02-05T18:09:26,790 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:09:26,791 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 280
2024-02-05T18:09:26,793 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:09:26 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 109
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71052aa9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b4561f3] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71052aa9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77242a08], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b4561f3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e68bcd1] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71052aa9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77242a08, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46e09dd7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b4561f3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e68bcd1, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56ba2601] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71052aa9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77242a08, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46e09dd7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1832b4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b4561f3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e68bcd1, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56ba2601, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4d9852] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@16e8eeae, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7f267172, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@71052aa9, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77242a08, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@46e09dd7, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1832b4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1901b8c9], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7537f7a5, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@20492d90, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b4561f3, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e68bcd1, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@56ba2601, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5b4d9852, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e0c1fc6] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:09:26,892 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Reconnecting after connection was closed
2024-02-05T18:09:26,900 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:37769. Skipping this broker. Phase one
2024-02-05T18:09:26,900 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:42723. Skipping this broker. Phase one
2024-02-05T18:09:26,901 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42723 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:09:26,909 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42723, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366901, versionId=5]. totalHandledRequests:8
2024-02-05T18:09:26,911 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:09:26,922 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42723, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366909, versionId=6]. totalHandledRequests:6
2024-02-05T18:09:26,924 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Subscribing to topic on cnx [id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559], consumerId 3
2024-02-05T18:09:26,924 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:09:26,925 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:09:26,925 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xa00ad4e3, L:/127.0.0.1:44559 - R:/127.0.0.1:43894]] Subscribing on topic persistent://public/test/__change_events / reader-ba5c6ad4ee. consumerId: 3
2024-02-05T18:09:26,926 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:09:26,926 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:09:26,927 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:09:26,928 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:09:26,934 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:09:26,942 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:09:26,942 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:09:26,952 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:09:26,955 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:09:26,958 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:09:26,958 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:09:26,959 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:09:26,960 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:09:26,962 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:09:26,962 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:09:26,963 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:09:26,963 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:09:26,965 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:09:26,968 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:09:26,970 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0xa0e2bb89, L:/127.0.0.1:43894 - R:localhost/127.0.0.1:44559] Close connection because received internal-server error {"errorMsg":"Failed due to pulsar service is not ready","reqId":149991473957218452, "remote":"localhost/127.0.0.1:44559", "local":"/127.0.0.1:43894"}
2024-02-05T18:09:26,971 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xa0e2bb89, L:/127.0.0.1:43894 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:26,972 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Failed to subscribe to topic on localhost/127.0.0.1:44559
2024-02-05T18:09:26,972 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:44559
2024-02-05T18:09:26,973 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$ConnectException: Disconnected from server at localhost/127.0.0.1:44559 -- Will try again in 0.183 s
2024-02-05T18:09:26,975 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:26,975 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:43894
2024-02-05T18:09:26,975 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:09:26,976 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-ba5c6ad4ee, ackPos=13:-1, readPos=13:0}
2024-02-05T18:09:26,976 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42723/__change_events, name=reader-d435088cf8}, consumerId=2, consumerName=f4916, address=/127.0.0.1:43894}
2024-02-05T18:09:26,977 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42723/__change_events][reader-d435088cf8] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42723/persistent/__change_events, cursor=reader-d435088cf8, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:09:26,978 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-ba5c6ad4ee}, consumerId=3, consumerName=30ab3, address=/127.0.0.1:43894}
2024-02-05T18:09:26,978 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Closed connection [id: 0xa0e2bb89, L:/127.0.0.1:43894 ! R:localhost/127.0.0.1:44559] -- Will try again in 0.1 s
2024-02-05T18:09:26,978 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-ba5c6ad4ee, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:09:26,979 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42723/__change_events][reader-d435088cf8] Successfully closed dispatcher for reader
2024-02-05T18:09:26,979 - WARN  - [broker-client-shared-internal-executor-65-1:BinaryProtoLookupService@234] - [persistent://public/test/__change_events] failed to get Partitioned metadata : {"errorMsg":"Failed due to pulsar service is not ready","reqId":149991473957218452, "remote":"localhost/127.0.0.1:44559", "local":"/127.0.0.1:43894"}
org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":149991473957218452, "remote":"localhost/127.0.0.1:44559", "local":"/127.0.0.1:43894"}
	at org.apache.pulsar.client.impl.ClientCnx.getPulsarClientException(ClientCnx.java:1282) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ClientCnx.handlePartitionResponse(ClientCnx.java:662) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:144) ~[pulsar-common-3.0.2.jar:3.0.2]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[netty-codec-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.handler.flush.FlushConsolidationHandler.channelRead(FlushConsolidationHandler.java:152) ~[netty-handler-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) ~[netty-transport-classes-epoll-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
2024-02-05T18:09:26,979 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-ba5c6ad4ee] Successfully closed dispatcher for reader
2024-02-05T18:09:26,981 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:09:26,985 - ERROR - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@954] - [persistent://public/test/__change_events] Failed to create subscription: reader-ba5c6ad4ee
java.util.concurrent.CompletionException: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1189) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$20(PersistentTopic.java:896) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$22(PersistentTopic.java:891) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.internalSubscribe(PersistentTopic.java:812) ~[classes/:?]
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.subscribe(PersistentTopic.java:786) ~[classes/:?]
	at org.apache.pulsar.broker.service.ServerCnx.lambda$handleSubscribe$15(ServerCnx.java:1255) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorage.lambda$closeLedger$42(BookkeeperSchemaStorage.java:621) ~[classes/:?]
	at org.apache.bookkeeper.client.PulsarMockLedgerHandle.lambda$asyncClose$1(PulsarMockLedgerHandle.java:96) ~[testmocks-3.0.2.jar:4.16.3]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:482) ~[?:?]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.safeRunTask(SingleThreadExecutor.java:137) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at org.apache.bookkeeper.common.util.SingleThreadExecutor.run(SingleThreadExecutor.java:107) ~[bookkeeper-common-4.16.3.jar:4.16.3]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.service.BrokerServiceException: Connection was closed while the opening the cursor 
	at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$internalSubscribe$19(PersistentTopic.java:920) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 22 more
2024-02-05T18:09:26,986 - WARN  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1299] - [/127.0.0.1:43894][persistent://public/test/__change_events][reader-ba5c6ad4ee] Failed to create consumer: consumerId=3, Connection was closed while the opening the cursor 
2024-02-05T18:09:26,997 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:09:27,000 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:09:27,000 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:09:27,002 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:27,004 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:37769. Skipping this broker. Phase one
2024-02-05T18:09:27,005 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:42723, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149366909, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:37769, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149367005, versionId=7]
2024-02-05T18:09:27,014 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:37769, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149367005, versionId=7]. totalHandledRequests:7
2024-02-05T18:09:27,016 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:09:27,017 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:09:27,017 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:09:27,017 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:09:27,018 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:37769 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:37769, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149367005, versionId=7], next:, totalHandledRequests:7, totalFailedRequests:6
2024-02-05T18:09:27,019 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:09:27,023 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:09:27,025 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:09:27,025 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:09:27,026 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 10.0 ms
2024-02-05T18:09:27,026 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:09:27,049 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:09:27,052 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-798e19a2ad] Subscribing to topic on cnx [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875], consumerId 4
2024-02-05T18:09:27,055 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x8519111f, L:/127.0.0.1:46875 - R:/127.0.0.1:41136]] Subscribing on topic persistent://public/test/__change_events / reader-798e19a2ad. consumerId: 4
2024-02-05T18:09:27,063 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:09:27,067 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 14
2024-02-05T18:09:27,067 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 14 after closed null
2024-02-05T18:09:27,072 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=13 rc=0
2024-02-05T18:09:27,076 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:09:27,076 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:09:27,080 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 100 ms
2024-02-05T18:09:27,083 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x098f7137, L:/127.0.0.1:43908 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,086 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Reconnecting after timeout
2024-02-05T18:09:27,086 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:43908
2024-02-05T18:09:27,087 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x098f7137, L:/127.0.0.1:43908 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,087 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 14:-1
2024-02-05T18:09:27,087 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x098f7137, L:/127.0.0.1:43908 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,087 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=14:-1 -- todo=0
2024-02-05T18:09:27,088 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:09:27,088 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x098f7137, L:/127.0.0.1:43908 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,088 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x098f7137, L:/127.0.0.1:43908 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,088 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,089 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.191 s
2024-02-05T18:09:27,094 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:09:27,105 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-798e19a2ad] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:09:27,106 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=14:0 mark-delete-position=14:-1
2024-02-05T18:09:27,106 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-798e19a2ad, ackPos=14:-1, readPos=14:0}
2024-02-05T18:09:27,108 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:41136] Created subscription on topic persistent://public/test/__change_events / reader-798e19a2ad
2024-02-05T18:09:27,109 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-798e19a2ad] Subscribed to topic on localhost/127.0.0.1:46875 -- consumer: 4
2024-02-05T18:09:27,157 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Reconnecting after connection was closed
2024-02-05T18:09:27,158 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xdb3f6086, L:/127.0.0.1:43918 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,162 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:43918
2024-02-05T18:09:27,162 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xdb3f6086, L:/127.0.0.1:43918 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,163 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xdb3f6086, L:/127.0.0.1:43918 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,163 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xdb3f6086, L:/127.0.0.1:43918 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,164 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xdb3f6086, L:/127.0.0.1:43918 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,164 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,164 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.384 s
2024-02-05T18:09:27,271 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:09:27,272 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 40.82%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 40.82%, msgThroughputEMA= 0.00, updatedAt= 1707149367271, reportedAt= 0
2024-02-05T18:09:27,279 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 190 ms
2024-02-05T18:09:27,280 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xfb3316b2, L:/127.0.0.1:43922 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,284 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:43922
2024-02-05T18:09:27,284 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Reconnecting after connection was closed
2024-02-05T18:09:27,285 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xfb3316b2, L:/127.0.0.1:43922 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,285 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xfb3316b2, L:/127.0.0.1:43922 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,285 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xfb3316b2, L:/127.0.0.1:43922 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,286 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xfb3316b2, L:/127.0.0.1:43922 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,286 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,286 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.398 s
2024-02-05T18:09:27,354 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:09:27,355 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:09:27,549 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Reconnecting after connection was closed
2024-02-05T18:09:27,551 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x2b1cc9ef, L:/127.0.0.1:43930 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,553 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:43930
2024-02-05T18:09:27,553 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x2b1cc9ef, L:/127.0.0.1:43930 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,553 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x2b1cc9ef, L:/127.0.0.1:43930 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,554 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x2b1cc9ef, L:/127.0.0.1:43930 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,554 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x2b1cc9ef, L:/127.0.0.1:43930 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,555 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,555 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.776 s
2024-02-05T18:09:27,671 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 385 ms
2024-02-05T18:09:27,673 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x59b33ea8, L:/127.0.0.1:43944 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,676 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x59b33ea8, L:/127.0.0.1:43944 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,676 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:43944
2024-02-05T18:09:27,676 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x59b33ea8, L:/127.0.0.1:43944 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,676 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x59b33ea8, L:/127.0.0.1:43944 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,676 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x59b33ea8, L:/127.0.0.1:43944 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,685 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Reconnecting after connection was closed
2024-02-05T18:09:27,686 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x6b75d316, L:/127.0.0.1:43946 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:27,688 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x6b75d316, L:/127.0.0.1:43946 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:27,688 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:43946
2024-02-05T18:09:27,688 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x6b75d316, L:/127.0.0.1:43946 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:27,689 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x6b75d316, L:/127.0.0.1:43946 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:27,689 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x6b75d316, L:/127.0.0.1:43946 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,689 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:27,690 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.763 s
2024-02-05T18:09:28,333 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Reconnecting after connection was closed
2024-02-05T18:09:28,334 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x913d3d42, L:/127.0.0.1:43962 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:28,336 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x913d3d42, L:/127.0.0.1:43962 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:28,336 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:43962
2024-02-05T18:09:28,336 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x913d3d42, L:/127.0.0.1:43962 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:28,337 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x913d3d42, L:/127.0.0.1:43962 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:28,337 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x913d3d42, L:/127.0.0.1:43962 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:28,337 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:28,337 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.543 s
2024-02-05T18:09:28,356 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:09:28,356 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:09:28,454 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Reconnecting after connection was closed
2024-02-05T18:09:28,456 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xd9d43b1c, L:/127.0.0.1:43966 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:28,458 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xd9d43b1c, L:/127.0.0.1:43966 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:28,458 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:43966
2024-02-05T18:09:28,458 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xd9d43b1c, L:/127.0.0.1:43966 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:28,459 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xd9d43b1c, L:/127.0.0.1:43966 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:28,459 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xd9d43b1c, L:/127.0.0.1:43966 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:28,459 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:28,459 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.463 s
2024-02-05T18:09:28,461 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 784 ms
2024-02-05T18:09:28,462 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0xa68492af, L:/127.0.0.1:43980 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:28,464 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0xa68492af, L:/127.0.0.1:43980 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:28,464 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:43980
2024-02-05T18:09:28,464 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0xa68492af, L:/127.0.0.1:43980 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:28,465 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0xa68492af, L:/127.0.0.1:43980 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:28,465 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0xa68492af, L:/127.0.0.1:43980 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:29,357 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:09:29,358 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:09:29,882 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Reconnecting after connection was closed
2024-02-05T18:09:29,883 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xa56f068e, L:/127.0.0.1:43990 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:29,886 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xa56f068e, L:/127.0.0.1:43990 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:29,886 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:43990
2024-02-05T18:09:29,886 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0xa56f068e, L:/127.0.0.1:43990 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:29,887 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xa56f068e, L:/127.0.0.1:43990 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:29,887 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0xa56f068e, L:/127.0.0.1:43990 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:29,887 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:29,887 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.178 s
2024-02-05T18:09:29,923 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Reconnecting after connection was closed
2024-02-05T18:09:29,925 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x743c05c7, L:/127.0.0.1:44002 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:29,926 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0x743c05c7, L:/127.0.0.1:44002 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:29,926 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:44002
2024-02-05T18:09:29,926 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0x743c05c7, L:/127.0.0.1:44002 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:29,927 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x743c05c7, L:/127.0.0.1:44002 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:29,927 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0x743c05c7, L:/127.0.0.1:44002 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:29,927 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:29,927 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.049 s
2024-02-05T18:09:29,989 - WARN  - [broker-client-shared-scheduled-executor-67-1:PulsarClientImpl@1074] - [topic: persistent://public/test/__change_events] Could not get connection while getPartitionedTopicMetadata -- Will try again in 1523 ms
2024-02-05T18:09:29,990 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x86519102, L:/127.0.0.1:44010 - R:localhost/127.0.0.1:44559]] Connected to server
2024-02-05T18:09:29,993 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x86519102, L:/127.0.0.1:44010 - R:localhost/127.0.0.1:44559] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:09:29,993 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:44010
2024-02-05T18:09:29,993 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x86519102, L:/127.0.0.1:44010 - R:localhost/127.0.0.1:44559] Received unknown request id from server: -1
2024-02-05T18:09:29,994 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x86519102, L:/127.0.0.1:44010 ! R:localhost/127.0.0.1:44559] Disconnected
2024-02-05T18:09:29,994 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x86519102, L:/127.0.0.1:44010 ! R:localhost/127.0.0.1:44559]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:09:30,117 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 3112.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:09:30,123 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42723 registry has been deleted.
2024-02-05T18:09:30,124 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42723 was invalidated. state Releasing
2024-02-05T18:09:30,124 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42723 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:09:30,125 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42723. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:09:30,125 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42723 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:09:30,125 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:30,126 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42723
2024-02-05T18:09:30,127 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:09:30,135 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42723/0x00000000_0xffffffff.
2024-02-05T18:09:30,136 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42723/0x00000000_0xffffffff.
2024-02-05T18:09:30,137 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42723/0x00000000_0xffffffff.
2024-02-05T18:09:30,137 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.01 seconds
2024-02-05T18:09:30,139 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:09:30,142 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:41142
2024-02-05T18:09:30,142 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:09:30,142 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] Disconnected
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:30,143 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42723/persistent/__change_events] Closing managed ledger
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-b3f4c24ea2}, consumerId=0, consumerName=737b4, address=/127.0.0.1:41142}
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b3f4c24ea2] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-b3f4c24ea2, ackPos=3:6, readPos=3:7}]
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-b3f4c24ea2] Closed connection [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-b3f4c24ea2] Successfully closed dispatcher for reader
2024-02-05T18:09:30,143 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3cad50eeef] Closed connection [id: 0x1b4e0679, L:/127.0.0.1:41142 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:30,144 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-3cad50eeef}, consumerId=1, consumerName=e694d, address=/127.0.0.1:41142}
2024-02-05T18:09:30,148 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42723/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:09:30,148 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:09:30,150 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:09:30,151 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:09:30,156 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:44559
2024-02-05T18:09:30,157 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:09:30,158 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:09:30,159 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:09:30,159 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42723/__change_events] [reader-d435088cf8] Closed Consumer (not connected)
2024-02-05T18:09:30,160 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42723/__change_events with subscription name reader-d435088cf8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42723/__change_events with subscription name reader-d435088cf8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:30,160 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-b3f4c24ea2] Closed Consumer (not connected)
2024-02-05T18:09:30,161 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3cad50eeef] Closed Consumer (not connected)
2024-02-05T18:09:30,161 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-ba5c6ad4ee] Closed Consumer (not connected)
2024-02-05T18:09:30,161 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-b3f4c24ea2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-b3f4c24ea2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:30,162 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3cad50eeef was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3cad50eeef was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:30,168 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:09:30,168 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:09:30,171 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:09:30,171 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:30,177 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:09:30,177 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:30,361 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:30,362 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42723 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:09:30,362 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42723 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:09:30,363 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[localhost:42723]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:09:30,363 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:30,365 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:09:31,364 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:31,364 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42723 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:09:31,365 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42723 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:09:31,365 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42723]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:09:31,365 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:31,366 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:09:31,449 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:09:31,450 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:09:31,453 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:09:31,453 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:31,453 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:09:31,454 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:09:32,272 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 42.19%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 40.96%, msgThroughputEMA= 0.00, updatedAt= 1707149372271, reportedAt= 1707149367277
2024-02-05T18:09:32,365 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:32,366 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42723 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:09:32,366 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42723 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:09:32,367 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42723]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:09:32,367 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:32,368 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:09:33,367 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:09:33,368 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42723 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:09:33,368 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42723 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:09:33,369 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42723]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:09:33,369 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42723
2024-02-05T18:09:33,370 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42723 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:09:33,468 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:09:33,469 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:09:33,470 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:09:33,470 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:09:33,470 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:09:33,470 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:09:33,472 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:09:33,473 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:09:33,475 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:09:33,476 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:09:33,478 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:09:33,479 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:09:33,480 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:09:33,482 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:09:33,482 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:09:33,483 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:37769
2024-02-05T18:09:33,485 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:37769, sourceBroker=localhost:42723, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149367005, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:09:38,495 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:37769 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:09:38,501 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:37769 was invalidated. state Releasing
2024-02-05T18:09:38,502 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:37769. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:09:38,502 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:37769
2024-02-05T18:09:38,505 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:37769/0x00000000_0xffffffff.
2024-02-05T18:09:38,506 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:37769/0x00000000_0xffffffff.
2024-02-05T18:09:38,514 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:37769, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149378507, versionId=8]. totalHandledRequests:10
2024-02-05T18:09:38,515 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:09:38,516 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:09:38,516 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:09:38,516 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-798e19a2ad}, consumerId=4, consumerName=f5d56, address=/127.0.0.1:41136}
2024-02-05T18:09:38,517 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-798e19a2ad}, consumerId=4, consumerName=f5d56, address=/127.0.0.1:41136}
2024-02-05T18:09:38,518 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:46875] Broker notification of Closed consumer: 4
2024-02-05T18:09:38,518 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-798e19a2ad] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-798e19a2ad, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:09:38,518 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-798e19a2ad] Successfully closed dispatcher for reader
2024-02-05T18:09:38,518 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-798e19a2ad] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 - R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,518 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-798e19a2ad] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-798e19a2ad, ackPos=14:-1, readPos=14:0}]
2024-02-05T18:09:38,518 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-798e19a2ad] Successfully disconnected and closed subscription
2024-02-05T18:09:38,519 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:09:38,521 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=14:-1
2024-02-05T18:09:38,522 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:09:38,523 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-798e19a2ad] Closed Consumer (not connected)
2024-02-05T18:09:38,523 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 8.0 ms
2024-02-05T18:09:38,523 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-798e19a2ad was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-798e19a2ad was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:38,529 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:37769 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:37769, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149378515, versionId=9]. totalHandledRequests:4
2024-02-05T18:09:38,529 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:09:38,531 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:37769/0x00000000_0xffffffff.
2024-02-05T18:09:38,531 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.028 seconds
2024-02-05T18:09:38,532 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:09:38,532 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:09:38,533 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:41136
2024-02-05T18:09:38,533 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:09:38,533 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:09:38,533 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-92ef632fc2}, consumerId=0, consumerName=bda7a, address=/127.0.0.1:41136}
2024-02-05T18:09:38,533 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:09:38,534 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-92ef632fc2] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-92ef632fc2, ackPos=3:6, readPos=3:9}]
2024-02-05T18:09:38,534 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-92ef632fc2] Successfully closed dispatcher for reader
2024-02-05T18:09:38,534 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] Disconnected
2024-02-05T18:09:38,534 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,534 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:37769/__change_events, name=reader-d2a37cb119}, consumerId=3, consumerName=6b5dd, address=/127.0.0.1:41136}
2024-02-05T18:09:38,535 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:37769/persistent/__change_events] Closing managed ledger
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:37769/__change_events][reader-d2a37cb119] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:37769/persistent/__change_events, cursor=reader-d2a37cb119, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-92ef632fc2] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:37769/__change_events][reader-d2a37cb119] Successfully closed dispatcher for reader
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-8b81b1536a] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:37769/__change_events] [reader-d2a37cb119] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-12b2219587] Closed connection [id: 0x7eed2833, L:/127.0.0.1:41136 ! R:localhost/127.0.0.1:46875] -- Will try again in 0.1 s
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-12b2219587}, consumerId=2, consumerName=3012b, address=/127.0.0.1:41136}
2024-02-05T18:09:38,535 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-8b81b1536a}, consumerId=1, consumerName=279e2, address=/127.0.0.1:41136}
2024-02-05T18:09:38,536 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:37769/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:09:38,536 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:09:38,537 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:09:38,537 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:09:38,537 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:09:38,541 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:46875
2024-02-05T18:09:38,541 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:09:38,541 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:09:38,541 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:09:38,541 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-92ef632fc2] Closed Consumer (not connected)
2024-02-05T18:09:38,542 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-12b2219587] Closed Consumer (not connected)
2024-02-05T18:09:38,542 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:37769/__change_events] [reader-d2a37cb119] Closed Consumer (not connected)
2024-02-05T18:09:38,542 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-8b81b1536a] Closed Consumer (not connected)
2024-02-05T18:09:38,542 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-92ef632fc2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-92ef632fc2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:38,542 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-12b2219587 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-12b2219587 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:38,543 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37769/__change_events with subscription name reader-d2a37cb119 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:37769/__change_events with subscription name reader-d2a37cb119 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:38,543 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-8b81b1536a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-8b81b1536a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:09:38,546 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:09:38,546 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:09:38,546 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:09:38,546 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:09:38,547 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:09:38,547 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:38,548 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:09:38,548 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:39,939 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:09:39,940 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:09:39,941 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:09:39,942 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:39,942 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:09:39,942 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:09:39,950 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:09:39,950 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:09:39,954 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:09:39,954 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:09:39,955 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 187 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:09:39,956 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 192 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:09:39,956 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:09:39,956 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:09:39,956 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6277551c
2024-02-05T18:09:39,956 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:09:39,956 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:09:39,956 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.284 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.259 s
[INFO] Finished at: 2024-02-05T18:09:40+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 2 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:10:09,674 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:10:10,668 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:10:10,669 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:10:11,116 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:10:11,116 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:10:11,117 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:10:11,118 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:10:11,118 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:10:11,119 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:10:11,139 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:10:11,140 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:10:11,140 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:10:11,141 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:10:11,142 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:10:11,142 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:10:11,143 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:10:11,143 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:10:11,144 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:10:11,144 - INFO  - [main:Environment@98] - Client environment:os.memory.free=50MB
2024-02-05T18:10:11,145 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:10:11,146 - INFO  - [main:Environment@98] - Client environment:os.memory.total=134MB
2024-02-05T18:10:12,720 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:10:12,721 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:10:12,721 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:10:12,722 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:10:13,086 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:10:13,087 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:10:13,174 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:10:13,263 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:10:13,266 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:10:13,286 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:10:13,399 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:10:13,446 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:10:13,497 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:10:13,823 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:10:13,823 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:10:13,857 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:10:13,916 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43403, TLS: (none), listener: (none)
2024-02-05T18:10:14,234 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42667, TLS: OPENSSL, listener: (none)
2024-02-05T18:10:14,257 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:10:14,262 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:10:14,263 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:10:14,302 - INFO  - [main:Log@170] - Logging initialized @6865ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:10:15,310 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:10:15,351 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:10:15,352 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:10:15,355 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:10:16,246 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:10:17,397 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:10:18,473 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:10:18,764 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:10:18,852 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:10:19,053 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:10:19,056 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:10:19,059 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:10:19,075 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:34313}
2024-02-05T18:10:19,243 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:38475}
2024-02-05T18:10:19,243 - INFO  - [main:Server@415] - Started @11809ms
2024-02-05T18:10:19,244 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:34313
2024-02-05T18:10:19,245 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:38475
2024-02-05T18:10:19,251 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:10:19,252 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:10:19,447 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:34313
2024-02-05T18:10:19,467 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:10:19,470 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:34313 is changing the role from null to Leader
2024-02-05T18:10:19,474 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34313).
2024-02-05T18:10:19,812 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:34313 
2024-02-05T18:10:20,276 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:10:20,300 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:20,406 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:10:20,413 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:10:20,424 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:10:20,427 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:10:20,472 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:10:20,501 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:10:20,528 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:10:20,601 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:10:20,623 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:10:20,634 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:10:20,636 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:10:20,663 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:10:20,672 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 553
2024-02-05T18:10:20,809 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]] Connected to server
2024-02-05T18:10:20,849 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:37184] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:10:20,922 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:20,929 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:20,984 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:10:21,018 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37184] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:37184, producerName=test-0-0, producerId=0}
2024-02-05T18:10:21,028 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:21,029 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:10:21,098 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,100 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-86da99d0e9] Subscribing to topic on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403], consumerId 0
2024-02-05T18:10:21,117 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x454d323d, L:/127.0.0.1:43403 - R:/127.0.0.1:37184]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-86da99d0e9. consumerId: 0
2024-02-05T18:10:21,155 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-86da99d0e9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:21,157 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:10:21,157 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-86da99d0e9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:10:21,177 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:37184] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-86da99d0e9
2024-02-05T18:10:21,182 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-86da99d0e9] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 0
2024-02-05T18:10:21,194 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:10:21,196 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:10:21,197 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:10:21,198 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:10:21,234 - INFO  - [pulsar-web-30-2:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,251 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:10:21,252 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:10:21,256 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 44
2024-02-05T18:10:21,259 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:10:21,274 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,288 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:10:21,290 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:10:21,291 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:10:21,293 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:10:21,317 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,319 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:21,328 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:10:21,335 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37184] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:37184, producerName=test-0-1, producerId=1}
2024-02-05T18:10:21,338 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:21,354 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,356 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-52ef27c825] Subscribing to topic on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403], consumerId 1
2024-02-05T18:10:21,359 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x454d323d, L:/127.0.0.1:43403 - R:/127.0.0.1:37184]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-52ef27c825. consumerId: 1
2024-02-05T18:10:21,387 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-52ef27c825] Created new subscription for 1
2024-02-05T18:10:21,389 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37184] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-52ef27c825
2024-02-05T18:10:21,394 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-52ef27c825] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 1
2024-02-05T18:10:21,418 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,420 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:21,428 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:10:21,435 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37184] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:37184, producerName=test-0-2, producerId=2}
2024-02-05T18:10:21,437 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:21,453 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:10:21,480 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:10:21,486 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:34313 started the ownership monitor.
2024-02-05T18:10:21,511 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:34313/__change_events
2024-02-05T18:10:21,514 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:21,515 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c38745a989] Subscribing to topic on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403], consumerId 2
2024-02-05T18:10:21,517 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x454d323d, L:/127.0.0.1:43403 - R:/127.0.0.1:37184]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c38745a989. consumerId: 2
2024-02-05T18:10:21,533 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c38745a989] Created new subscription for 2
2024-02-05T18:10:21,533 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37184] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-c38745a989
2024-02-05T18:10:21,534 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-c38745a989] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 2
2024-02-05T18:10:21,535 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:34313 plays the leader now.
2024-02-05T18:10:21,540 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 52.34%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.34%, msgThroughputEMA= 0.00, updatedAt= 1707149421539, reportedAt= 0
2024-02-05T18:10:21,571 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:10:21,576 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:21,577 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:10:21,607 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:34313/0x00000000_0xffffffff - localhost:34313.
2024-02-05T18:10:21,610 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:34313
2024-02-05T18:10:21,610 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:34313/0x00000000_0xffffffff
2024-02-05T18:10:21,611 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:34313/0x00000000_0xffffffff - localhost:34313.
2024-02-05T18:10:21,613 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:34313
2024-02-05T18:10:21,613 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:34313/0x00000000_0xffffffff
2024-02-05T18:10:21,620 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:34313/__change_events][reader-bec7718aa1] Subscribing to topic on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403], consumerId 3
2024-02-05T18:10:21,623 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x454d323d, L:/127.0.0.1:43403 - R:/127.0.0.1:37184]] Subscribing on topic persistent://sla-monitor/test/localhost:34313/__change_events / reader-bec7718aa1. consumerId: 3
2024-02-05T18:10:21,627 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:34313 doesn't exist.
2024-02-05T18:10:21,634 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:34313/persistent/__change_events
2024-02-05T18:10:21,637 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:34313/persistent/__change_events'
2024-02-05T18:10:21,644 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:10:21,644 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:34313/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:10:21,652 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:34313/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:10:21,662 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:34313/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:10:21,668 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:34313/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:34313/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:10:21,669 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:34313/__change_events - dedup is disabled
2024-02-05T18:10:21,683 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:10:21,689 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:34313/__change_events][reader-bec7718aa1] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:21,689 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:34313/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:10:21,690 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:34313/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34313/persistent/__change_events, cursor=reader-bec7718aa1, ackPos=7:-1, readPos=7:0}
2024-02-05T18:10:21,692 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:37184] Created subscription on topic persistent://sla-monitor/test/localhost:34313/__change_events / reader-bec7718aa1
2024-02-05T18:10:21,693 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:34313/__change_events][reader-bec7718aa1] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 3
2024-02-05T18:10:21,645 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 34313, tls-port = Optional[38475], broker url= pulsar://localhost:43403, broker tls url= pulsar+ssl://localhost:42667, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[43403], brokerServicePortTls=Optional[42667], webServicePort=Optional[34313], webServicePortTls=Optional[38475], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:10:22,266 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:10:22,267 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:10:22,267 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:10:22,268 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:10:22,273 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:10:22,274 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:10:22,280 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:10:22,286 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:10:22,293 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:10:22,293 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:10:22,301 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:10:22,306 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:10:22,309 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:10:22,319 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:10:22,319 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:10:22,326 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:10:22,328 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38573, TLS: (none), listener: (none)
2024-02-05T18:10:22,330 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:35625, TLS: OPENSSL, listener: (none)
2024-02-05T18:10:22,334 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:10:22,335 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:10:22,335 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:10:22,348 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:10:22,354 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:10:22,354 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:10:22,354 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:10:22,436 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:10:22,579 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:22,580 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:10:23,169 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:10:23,581 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:23,581 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:10:24,469 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:10:24,583 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:24,584 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:10:24,718 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:10:24,792 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:10:24,886 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:10:24,888 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:10:24,888 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:10:24,889 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:42575}
2024-02-05T18:10:24,900 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:35783}
2024-02-05T18:10:24,901 - INFO  - [main:Server@415] - Started @17467ms
2024-02-05T18:10:24,902 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42575
2024-02-05T18:10:24,905 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:35783
2024-02-05T18:10:24,908 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:10:24,909 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:10:24,926 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42575
2024-02-05T18:10:24,929 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42575 registry has been created.
2024-02-05T18:10:24,929 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42575. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:10:24,937 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42575 is changing the role from null to Follower
2024-02-05T18:10:24,940 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:34313).
2024-02-05T18:10:24,945 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:10:24,960 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42575 
2024-02-05T18:10:25,073 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 42
2024-02-05T18:10:25,092 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,095 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:10:25,096 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:10:25,105 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:10:25,109 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42575/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:10:25,116 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xec915724, L:/127.0.0.1:32824 - R:localhost/127.0.0.1:38573]] Connected to server
2024-02-05T18:10:25,121 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:32824] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:10:25,133 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]] Connected to server
2024-02-05T18:10:25,136 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:46074] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:10:25,137 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,147 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46074] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:46074, producerName=test-0-3, producerId=0}
2024-02-05T18:10:25,148 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,161 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d54101e4e] Subscribing to topic on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403], consumerId 0
2024-02-05T18:10:25,164 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x8662da3f, L:/127.0.0.1:43403 - R:/127.0.0.1:46074]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9d54101e4e. consumerId: 0
2024-02-05T18:10:25,170 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d54101e4e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:25,171 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:10:25,173 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9d54101e4e, ackPos=3:-1, readPos=3:0}
2024-02-05T18:10:25,176 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46074] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9d54101e4e
2024-02-05T18:10:25,177 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d54101e4e] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 0
2024-02-05T18:10:25,179 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:10:25,180 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:10:25,206 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:10:25,215 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,218 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:10:25,218 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:10:25,223 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:10:25,224 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42575/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:10:25,238 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:10:25,244 - INFO  - [pulsar-web-30-2:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,247 - ERROR - [pulsar-web-30-2:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:10:25,248 - ERROR - [pulsar-web-30-2:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:10:25,251 - INFO  - [pulsar-web-30-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:10:25,252 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42575/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:10:25,266 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,274 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46074] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:46074, producerName=test-0-4, producerId=1}
2024-02-05T18:10:25,275 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,288 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-56113010b6] Subscribing to topic on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403], consumerId 1
2024-02-05T18:10:25,290 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x8662da3f, L:/127.0.0.1:43403 - R:/127.0.0.1:46074]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-56113010b6. consumerId: 1
2024-02-05T18:10:25,301 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-56113010b6] Created new subscription for 1
2024-02-05T18:10:25,301 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:46074] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-56113010b6
2024-02-05T18:10:25,302 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-56113010b6] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 1
2024-02-05T18:10:25,316 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,323 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:46074] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:46074, producerName=test-0-5, producerId=2}
2024-02-05T18:10:25,324 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x138fa9ac, L:/127.0.0.1:46074 - R:localhost/127.0.0.1:43403]
2024-02-05T18:10:25,326 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:10:25,329 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:10:25,330 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42575 plays a follower now.
2024-02-05T18:10:25,346 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42575/__change_events
2024-02-05T18:10:25,370 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42575/0x00000000_0xffffffff - localhost:42575.
2024-02-05T18:10:25,371 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42575/0x00000000_0xffffffff
2024-02-05T18:10:25,372 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42575
2024-02-05T18:10:25,373 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42575/0x00000000_0xffffffff - localhost:42575.
2024-02-05T18:10:25,374 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42575
2024-02-05T18:10:25,374 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42575/0x00000000_0xffffffff
2024-02-05T18:10:25,376 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42575 doesn't exist.
2024-02-05T18:10:25,382 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42575/__change_events][reader-a0fc3949f0] Subscribing to topic on cnx [id: 0xec915724, L:/127.0.0.1:32824 - R:localhost/127.0.0.1:38573], consumerId 2
2024-02-05T18:10:25,385 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x4349fd40, L:/127.0.0.1:38573 - R:/127.0.0.1:32824]] Subscribing on topic persistent://sla-monitor/test/localhost:42575/__change_events / reader-a0fc3949f0. consumerId: 2
2024-02-05T18:10:25,385 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 42575, tls-port = Optional[35783], broker url= pulsar://localhost:38573, broker tls url= pulsar+ssl://localhost:35625, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[38573], brokerServicePortTls=Optional[35625], webServicePort=Optional[42575], webServicePortTls=Optional[35783], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:10:25,391 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42575/persistent/__change_events
2024-02-05T18:10:25,394 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42575/persistent/__change_events'
2024-02-05T18:10:25,405 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:10:25,406 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42575/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:10:25,415 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42575/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:10:25,419 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42575/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:10:25,425 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42575/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42575/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:10:25,426 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42575/__change_events - dedup is disabled
2024-02-05T18:10:25,433 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:10:25,441 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42575/__change_events][reader-a0fc3949f0] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:25,441 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42575/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:10:25,442 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42575/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42575/persistent/__change_events, cursor=reader-a0fc3949f0, ackPos=9:-1, readPos=9:0}
2024-02-05T18:10:25,444 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:32824] Created subscription on topic persistent://sla-monitor/test/localhost:42575/__change_events / reader-a0fc3949f0
2024-02-05T18:10:25,445 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42575/__change_events][reader-a0fc3949f0] Subscribed to topic on localhost/127.0.0.1:38573 -- consumer: 2
2024-02-05T18:10:25,573 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:10:25,575 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:10:25,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:10:25,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:10:25,603 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:10:25,606 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:10:25,628 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:10:25,628 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:10:25,634 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:10:25,638 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:10:25,660 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:10:25,662 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:10:25,662 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:10:25,663 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:10:25,665 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:10:25,670 - INFO  - [pulsar-web-30-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:10:25,683 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:10:25,683 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:10:25,689 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:10:25,690 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:10:25,704 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:10:25,704 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:10:25,704 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:10:25,705 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:10:25,706 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:10:25,711 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:10:25,745 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:10:25,758 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:10:25,758 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:10:25,774 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:10:25,784 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,801 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:34313 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:10:25,843 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:34313, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425804, versionId=1]. totalHandledRequests:1
2024-02-05T18:10:25,872 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:34313, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425859, versionId=2]. totalHandledRequests:1
2024-02-05T18:10:25,876 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,901 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:10:25,904 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:10:25,906 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:10:25,932 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:34313, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149425888, versionId=3]. totalHandledRequests:1
2024-02-05T18:10:25,941 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 8.0 ms
2024-02-05T18:10:25,944 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:25,952 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:34313, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425933, versionId=4]. totalHandledRequests:1
2024-02-05T18:10:25,956 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:34313. Skipping this broker. Phase one
2024-02-05T18:10:25,956 - WARN  - [ForkJoinPool.commonPool-worker-3:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:34313. Skipping this broker. Phase two
2024-02-05T18:10:25,957 - INFO  - [broker-client-shared-internal-executor-11-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42575 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:10:25,958 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:10:25,958 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:10:25,960 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:10:25,962 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 221
2024-02-05T18:10:25,963 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:10:25 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 192
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:10:25,974 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42575, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425957, versionId=5]. totalHandledRequests:2
2024-02-05T18:10:25,985 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:10:25,987 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42575, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425969, versionId=6]. totalHandledRequests:2
2024-02-05T18:10:25,991 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0x61dec0ba, L:/127.0.0.1:32828 - R:localhost/127.0.0.1:38573]] Connected to server
2024-02-05T18:10:25,997 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:32828] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:10:25,998 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-340debc9b4] Subscribing to topic on cnx [id: 0x61dec0ba, L:/127.0.0.1:32828 - R:localhost/127.0.0.1:38573], consumerId 4
2024-02-05T18:10:26,001 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x3b5f9bd4, L:/127.0.0.1:38573 - R:/127.0.0.1:32828]] Subscribing on topic persistent://public/test/__change_events / reader-340debc9b4. consumerId: 4
2024-02-05T18:10:26,051 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:10:26,056 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:10:26,060 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:10:26,061 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:10:26,067 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a91d20a59e] Subscribing to topic on cnx [id: 0xec915724, L:/127.0.0.1:32824 - R:localhost/127.0.0.1:38573], consumerId 3
2024-02-05T18:10:26,069 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:10:26,072 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x4349fd40, L:/127.0.0.1:38573 - R:/127.0.0.1:32824]] Subscribing on topic persistent://public/test/__change_events / reader-a91d20a59e. consumerId: 3
2024-02-05T18:10:26,073 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:10:26,075 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:10:26,078 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3968d10b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@532cb5ec] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3968d10b, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e9f84d], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@532cb5ec, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76520dcd] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3968d10b, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e9f84d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@9cd7a85], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@532cb5ec, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76520dcd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3ff83d85] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3968d10b, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e9f84d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@9cd7a85, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@711d81a7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@532cb5ec, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76520dcd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3ff83d85, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1747c62c] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5bc22c1b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6d97e004, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3968d10b, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1e9f84d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@9cd7a85, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@711d81a7, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75bc9f13], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5d06f507, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@73808994, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@532cb5ec, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76520dcd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3ff83d85, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1747c62c, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b569034] 
2024-02-05T18:10:26,096 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:10:26,101 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a91d20a59e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:26,102 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:10:26,102 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a91d20a59e, ackPos=11:-1, readPos=11:0}
2024-02-05T18:10:26,105 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:32824] Created subscription on topic persistent://public/test/__change_events / reader-a91d20a59e
2024-02-05T18:10:26,106 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a91d20a59e] Subscribed to topic on localhost/127.0.0.1:38573 -- consumer: 3
2024-02-05T18:10:26,113 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-340debc9b4] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:26,114 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:10:26,114 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-340debc9b4, ackPos=11:-1, readPos=11:0}
2024-02-05T18:10:26,116 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:32828] Created subscription on topic persistent://public/test/__change_events / reader-340debc9b4
2024-02-05T18:10:26,117 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-340debc9b4] Subscribed to topic on localhost/127.0.0.1:38573 -- consumer: 4
2024-02-05T18:10:26,121 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:32828] Closing consumer: consumerId=4
2024-02-05T18:10:26,122 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-340debc9b4}, consumerId=4, consumerName=71f29, address=/127.0.0.1:32828}
2024-02-05T18:10:26,123 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-340debc9b4] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-340debc9b4, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:10:26,124 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-340debc9b4] Successfully closed dispatcher for reader
2024-02-05T18:10:26,127 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:32828] Closed consumer, consumerId=4
2024-02-05T18:10:26,128 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-340debc9b4] Closed consumer
2024-02-05T18:10:26,130 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:10:26,136 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:10:26,143 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:10:26,144 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:10:26,145 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:10:26,147 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:10:26,149 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:10:26,156 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:10:26,159 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:10:26,161 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:10:26,163 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:10:26,166 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:10:26,168 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:10:26,171 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:10:26,174 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:10:26,175 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:10:26,176 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:26,181 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:34313. Skipping this broker. Phase one
2024-02-05T18:10:26,181 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:42575, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149425969, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:34313, sourceBroker=localhost:42575, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149426181, versionId=7]
2024-02-05T18:10:26,192 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:34313, sourceBroker=localhost:42575, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149426181, versionId=7]. totalHandledRequests:6
2024-02-05T18:10:26,193 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:34313 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:34313, sourceBroker=localhost:42575, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149426181, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:10:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:10:26,200 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:10:26,202 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a91d20a59e}, consumerId=3, consumerName=cf636, address=/127.0.0.1:32824}
2024-02-05T18:10:26,203 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:38573] Broker notification of Closed consumer: 3
2024-02-05T18:10:26,204 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-a91d20a59e] Closed connection [id: 0xec915724, L:/127.0.0.1:32824 - R:localhost/127.0.0.1:38573] -- Will try again in 0.1 s
2024-02-05T18:10:26,206 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a91d20a59e}, consumerId=3, consumerName=cf636, address=/127.0.0.1:32824}
2024-02-05T18:10:26,206 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a91d20a59e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a91d20a59e, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:10:26,207 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a91d20a59e] Successfully closed dispatcher for reader
2024-02-05T18:10:26,208 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a91d20a59e] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a91d20a59e, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:10:26,209 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-a91d20a59e] Successfully disconnected and closed subscription
2024-02-05T18:10:26,210 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:10:26,210 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:10:26,211 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:10:26,220 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:10:26,226 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:10:26,228 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a91d20a59e] Closed Consumer (not connected)
2024-02-05T18:10:26,228 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 29.0 ms
2024-02-05T18:10:26,232 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a91d20a59e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a91d20a59e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:26,233 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:10:26,235 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-fa17694cc8] Subscribing to topic on cnx [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403], consumerId 5
2024-02-05T18:10:26,237 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x454d323d, L:/127.0.0.1:43403 - R:/127.0.0.1:37184]] Subscribing on topic persistent://public/test/__change_events / reader-fa17694cc8. consumerId: 5
2024-02-05T18:10:26,244 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:10:26,250 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:10:26,251 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:10:26,260 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:10:26,262 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:10:26,263 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:10:26,267 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:10:26,268 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:10:26,269 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:10:26,273 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:10:26,280 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-fa17694cc8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:10:26,280 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:10:26,281 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fa17694cc8, ackPos=13:-1, readPos=13:0}
2024-02-05T18:10:26,282 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37184] Created subscription on topic persistent://public/test/__change_events / reader-fa17694cc8
2024-02-05T18:10:26,283 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-fa17694cc8] Subscribed to topic on localhost/127.0.0.1:43403 -- consumer: 5
2024-02-05T18:10:26,306 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-a91d20a59e] Reconnecting after timeout
2024-02-05T18:10:26,306 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-a91d20a59e] Ignoring reconnection request (state: Closed)
2024-02-05T18:10:26,476 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:10:26,477 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 40.23%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 40.23%, msgThroughputEMA= 0.00, updatedAt= 1707149426476, reportedAt= 0
2024-02-05T18:10:26,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:10:26,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:10:27,587 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:10:27,587 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:10:28,588 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:10:28,589 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:10:29,299 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 3121.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:10:29,306 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42575 was invalidated. state Releasing
2024-02-05T18:10:29,306 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42575 registry has been deleted.
2024-02-05T18:10:29,306 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42575 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:10:29,308 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42575. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:10:29,309 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42575 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:10:29,309 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42575
2024-02-05T18:10:29,309 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:29,311 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:10:29,319 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42575/0x00000000_0xffffffff.
2024-02-05T18:10:29,321 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42575/0x00000000_0xffffffff.
2024-02-05T18:10:29,321 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42575/0x00000000_0xffffffff.
2024-02-05T18:10:29,322 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.012 seconds
2024-02-05T18:10:29,323 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:10:29,325 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:10:29,326 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42575/persistent/__change_events] Closing managed ledger
2024-02-05T18:10:29,327 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xec915724, L:/127.0.0.1:32824 ! R:localhost/127.0.0.1:38573] Disconnected
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:32824
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] Disconnected
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0x61dec0ba, L:/127.0.0.1:32828 ! R:localhost/127.0.0.1:38573] Disconnected
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42575/__change_events, name=reader-a0fc3949f0}, consumerId=2, consumerName=9aa60, address=/127.0.0.1:32824}
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42575/__change_events] [reader-a0fc3949f0] Closed connection [id: 0xec915724, L:/127.0.0.1:32824 ! R:localhost/127.0.0.1:38573] -- Will try again in 0.1 s
2024-02-05T18:10:29,329 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:29,330 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:29,330 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42575/__change_events][reader-a0fc3949f0] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42575/persistent/__change_events, cursor=reader-a0fc3949f0, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:10:29,330 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9d54101e4e] Closed connection [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:29,330 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42575/__change_events][reader-a0fc3949f0] Successfully closed dispatcher for reader
2024-02-05T18:10:29,330 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-56113010b6] Closed connection [id: 0x138fa9ac, L:/127.0.0.1:46074 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:29,331 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:46074
2024-02-05T18:10:29,332 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-9d54101e4e}, consumerId=0, consumerName=b76d7, address=/127.0.0.1:46074}
2024-02-05T18:10:29,333 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d54101e4e] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9d54101e4e, ackPos=3:6, readPos=3:7}]
2024-02-05T18:10:29,333 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42575/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:10:29,333 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:32828
2024-02-05T18:10:29,334 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d54101e4e] Successfully closed dispatcher for reader
2024-02-05T18:10:29,334 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:10:29,334 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-56113010b6}, consumerId=1, consumerName=1af60, address=/127.0.0.1:46074}
2024-02-05T18:10:29,335 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:10:29,336 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:10:29,341 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:38573
2024-02-05T18:10:29,342 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:10:29,343 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:10:29,343 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:10:29,344 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9d54101e4e] Closed Consumer (not connected)
2024-02-05T18:10:29,345 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42575/__change_events] [reader-a0fc3949f0] Closed Consumer (not connected)
2024-02-05T18:10:29,345 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9d54101e4e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9d54101e4e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:29,345 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-56113010b6] Closed Consumer (not connected)
2024-02-05T18:10:29,345 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42575/__change_events with subscription name reader-a0fc3949f0 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42575/__change_events with subscription name reader-a0fc3949f0 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:29,346 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-56113010b6 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-56113010b6 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:29,350 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:10:29,350 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:10:29,353 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:10:29,353 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:29,359 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:10:29,359 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:29,592 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:29,592 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42575 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:10:29,593 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42575 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:10:29,593 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42575]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:10:29,593 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:29,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:10:30,594 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:30,594 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42575 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:10:30,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42575 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:10:30,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42575]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:10:30,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:30,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:10:30,639 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:10:30,640 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:10:30,642 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:10:30,643 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:30,643 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:10:30,644 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:10:31,477 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 41.80%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 40.39%, msgThroughputEMA= 0.00, updatedAt= 1707149431476, reportedAt= 1707149426482
2024-02-05T18:10:31,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:31,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42575 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:10:31,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42575 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:10:31,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42575]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:10:31,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:31,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:10:32,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:10:32,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42575 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:10:32,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42575 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:10:32,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:42575]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:10:32,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42575
2024-02-05T18:10:32,602 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42575 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:10:32,659 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:10:32,660 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:10:32,661 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:10:32,661 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:10:32,661 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:10:32,662 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:10:32,663 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:10:32,665 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:10:32,666 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:10:32,667 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:10:32,668 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:10:32,669 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:10:32,671 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:10:32,672 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:10:32,672 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:10:32,673 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:34313
2024-02-05T18:10:32,675 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:34313, sourceBroker=localhost:42575, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149426181, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:10:37,687 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:34313 in 5012.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:10:37,697 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:34313 was invalidated. state Releasing
2024-02-05T18:10:37,698 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:34313. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:10:37,698 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:34313
2024-02-05T18:10:37,702 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:34313/0x00000000_0xffffffff.
2024-02-05T18:10:37,703 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:34313/0x00000000_0xffffffff.
2024-02-05T18:10:37,710 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:34313, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149437704, versionId=8]. totalHandledRequests:10
2024-02-05T18:10:37,712 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:10:37,712 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:10:37,712 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:10:37,712 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fa17694cc8}, consumerId=5, consumerName=e87a4, address=/127.0.0.1:37184}
2024-02-05T18:10:37,712 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-fa17694cc8}, consumerId=5, consumerName=e87a4, address=/127.0.0.1:37184}
2024-02-05T18:10:37,713 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fa17694cc8] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fa17694cc8, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:10:37,713 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:43403] Broker notification of Closed consumer: 5
2024-02-05T18:10:37,713 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-fa17694cc8] Successfully closed dispatcher for reader
2024-02-05T18:10:37,713 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-fa17694cc8] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 - R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,713 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-fa17694cc8] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-fa17694cc8, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:10:37,713 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-fa17694cc8] Successfully disconnected and closed subscription
2024-02-05T18:10:37,713 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:10:37,717 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:10:37,718 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:10:37,718 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-fa17694cc8] Closed Consumer (not connected)
2024-02-05T18:10:37,719 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 7.0 ms
2024-02-05T18:10:37,719 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-fa17694cc8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-fa17694cc8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:37,727 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:10:37,728 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:34313 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:34313, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149437711, versionId=9]. totalHandledRequests:4
2024-02-05T18:10:37,728 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:10:37,729 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:10:37,731 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:34313/0x00000000_0xffffffff.
2024-02-05T18:10:37,731 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.032 seconds
2024-02-05T18:10:37,731 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:10:37,732 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:37184
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-86da99d0e9}, consumerId=0, consumerName=9e8f9, address=/127.0.0.1:37184}
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] Disconnected
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-86da99d0e9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-86da99d0e9, ackPos=3:8, readPos=3:9}]
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-86da99d0e9] Successfully closed dispatcher for reader
2024-02-05T18:10:37,733 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,734 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-86da99d0e9] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,734 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:10:37,734 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:10:37,734 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:34313/__change_events, name=reader-bec7718aa1}, consumerId=3, consumerName=55ce0, address=/127.0.0.1:37184}
2024-02-05T18:10:37,734 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:34313/persistent/__change_events] Closing managed ledger
2024-02-05T18:10:37,734 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:34313/__change_events][reader-bec7718aa1] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:34313/persistent/__change_events, cursor=reader-bec7718aa1, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:10:37,735 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-52ef27c825] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,735 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:34313/__change_events][reader-bec7718aa1] Successfully closed dispatcher for reader
2024-02-05T18:10:37,735 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:34313/__change_events] [reader-bec7718aa1] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,735 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c38745a989] Closed connection [id: 0xb1294c6a, L:/127.0.0.1:37184 ! R:localhost/127.0.0.1:43403] -- Will try again in 0.1 s
2024-02-05T18:10:37,735 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-c38745a989}, consumerId=2, consumerName=a5bb0, address=/127.0.0.1:37184}
2024-02-05T18:10:37,736 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-52ef27c825}, consumerId=1, consumerName=eed21, address=/127.0.0.1:37184}
2024-02-05T18:10:37,737 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:10:37,737 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:34313/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:10:37,737 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:10:37,738 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:10:37,738 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:10:37,742 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:43403
2024-02-05T18:10:37,742 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:10:37,742 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:10:37,742 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:10:37,742 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-52ef27c825] Closed Consumer (not connected)
2024-02-05T18:10:37,742 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-c38745a989] Closed Consumer (not connected)
2024-02-05T18:10:37,742 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:34313/__change_events] [reader-bec7718aa1] Closed Consumer (not connected)
2024-02-05T18:10:37,743 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-86da99d0e9] Closed Consumer (not connected)
2024-02-05T18:10:37,742 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-52ef27c825 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-52ef27c825 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:37,743 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c38745a989 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-c38745a989 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:37,743 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34313/__change_events with subscription name reader-bec7718aa1 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:34313/__change_events with subscription name reader-bec7718aa1 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:37,744 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-86da99d0e9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-86da99d0e9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:10:37,745 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:10:37,746 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:10:37,746 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:10:37,746 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:10:37,746 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:10:37,746 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:37,747 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:10:37,748 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:39,139 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:10:39,140 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:10:39,141 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:10:39,141 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:39,141 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:10:39,141 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:10:39,150 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:10:39,150 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:10:39,154 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:10:39,154 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:10:39,154 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:10:39,155 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:10:39,155 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:10:39,155 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:10:39,155 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:10:39,155 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6277551c
2024-02-05T18:10:39,156 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:10:39,156 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:10:39,156 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.29 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  56.046 s
[INFO] Finished at: 2024-02-05T18:10:39+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 3 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:11:09,902 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:11:10,877 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:11:10,878 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:11:11,322 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:11:11,323 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:11:11,324 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:11:11,324 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:11:11,325 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:11:11,326 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:11:11,341 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:11:11,341 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:11:11,342 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:11:11,343 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:11:11,343 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:11:11,344 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:11:11,344 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:11:11,345 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:11:11,345 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:11:11,346 - INFO  - [main:Environment@98] - Client environment:os.memory.free=30MB
2024-02-05T18:11:11,346 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:11:11,347 - INFO  - [main:Environment@98] - Client environment:os.memory.total=126MB
2024-02-05T18:11:12,865 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:11:12,865 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:11:12,866 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:11:12,866 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:11:13,209 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:11:13,210 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:11:13,306 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:11:13,389 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:11:13,392 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:11:13,408 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:11:13,523 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:11:13,580 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:11:13,630 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:11:13,984 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:11:13,985 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:11:14,017 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:11:14,075 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:40543, TLS: (none), listener: (none)
2024-02-05T18:11:14,382 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44501, TLS: OPENSSL, listener: (none)
2024-02-05T18:11:14,405 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:11:14,411 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:11:14,411 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:11:14,444 - INFO  - [main:Log@170] - Logging initialized @6949ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:11:15,452 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:11:15,482 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:11:15,482 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:11:15,485 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:11:16,349 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/,null,AVAILABLE}
2024-02-05T18:11:17,455 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin,null,AVAILABLE}
2024-02-05T18:11:18,689 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,AVAILABLE}
2024-02-05T18:11:19,001 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,AVAILABLE}
2024-02-05T18:11:19,100 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,AVAILABLE}
2024-02-05T18:11:19,276 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/topics,null,AVAILABLE}
2024-02-05T18:11:19,278 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,AVAILABLE}
2024-02-05T18:11:19,280 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@1978b0d5{/static,null,AVAILABLE}
2024-02-05T18:11:19,296 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:36933}
2024-02-05T18:11:19,436 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:37825}
2024-02-05T18:11:19,437 - INFO  - [main:Server@415] - Started @11943ms
2024-02-05T18:11:19,437 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36933
2024-02-05T18:11:19,439 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:37825
2024-02-05T18:11:19,448 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:11:19,449 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:11:19,620 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36933
2024-02-05T18:11:19,635 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:11:19,640 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:36933 is changing the role from null to Leader
2024-02-05T18:11:19,642 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36933).
2024-02-05T18:11:19,949 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36933 
2024-02-05T18:11:20,387 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:11:20,418 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:20,534 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:11:20,540 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:11:20,548 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:11:20,549 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:11:20,583 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:11:20,616 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:11:20,645 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:11:20,706 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:11:20,726 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:11:20,737 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:11:20,739 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:11:20,771 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:20 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 535
2024-02-05T18:11:20,775 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:11:20,944 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]] Connected to server
2024-02-05T18:11:20,983 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:36330] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:11:21,055 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,062 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,128 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:11:21,159 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36330] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:36330, producerName=test-0-0, producerId=0}
2024-02-05T18:11:21,165 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,167 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:11:21,215 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,217 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f3b8534305] Subscribing to topic on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543], consumerId 0
2024-02-05T18:11:21,229 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x00ef024d, L:/127.0.0.1:40543 - R:/127.0.0.1:36330]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f3b8534305. consumerId: 0
2024-02-05T18:11:21,263 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f3b8534305] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:11:21,264 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:11:21,264 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f3b8534305, ackPos=3:-1, readPos=3:0}
2024-02-05T18:11:21,288 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36330] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-f3b8534305
2024-02-05T18:11:21,294 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f3b8534305] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 0
2024-02-05T18:11:21,309 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.014 seconds
2024-02-05T18:11:21,314 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:11:21,316 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:11:21,316 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:11:21,362 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,384 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:11:21,385 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:11:21,387 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 56
2024-02-05T18:11:21,388 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:11:21,404 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,414 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:11:21,415 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:11:21,417 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:21 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:11:21,418 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:11:21,441 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,444 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,456 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:11:21,463 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36330] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:36330, producerName=test-0-1, producerId=1}
2024-02-05T18:11:21,465 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,482 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,484 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f39066a2f2] Subscribing to topic on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543], consumerId 1
2024-02-05T18:11:21,486 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x00ef024d, L:/127.0.0.1:40543 - R:/127.0.0.1:36330]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f39066a2f2. consumerId: 1
2024-02-05T18:11:21,508 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f39066a2f2] Created new subscription for 1
2024-02-05T18:11:21,509 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36330] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-f39066a2f2
2024-02-05T18:11:21,511 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-f39066a2f2] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 1
2024-02-05T18:11:21,530 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,532 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,540 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:11:21,546 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:36330] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:36330, producerName=test-0-2, producerId=2}
2024-02-05T18:11:21,547 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:21,560 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:11:21,581 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:11:21,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:36933 started the ownership monitor.
2024-02-05T18:11:21,601 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:21,603 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-2582e1c065] Subscribing to topic on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543], consumerId 2
2024-02-05T18:11:21,605 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x00ef024d, L:/127.0.0.1:40543 - R:/127.0.0.1:36330]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-2582e1c065. consumerId: 2
2024-02-05T18:11:21,617 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-2582e1c065] Created new subscription for 2
2024-02-05T18:11:21,617 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:36330] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-2582e1c065
2024-02-05T18:11:21,618 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-2582e1c065] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 2
2024-02-05T18:11:21,620 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:36933 plays the leader now.
2024-02-05T18:11:21,624 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.52%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.52%, msgThroughputEMA= 0.00, updatedAt= 1707149481623, reportedAt= 0
2024-02-05T18:11:21,626 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36933/__change_events
2024-02-05T18:11:21,647 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:11:21,658 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:21,659 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:11:21,717 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36933/0x00000000_0xffffffff - localhost:36933.
2024-02-05T18:11:21,719 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36933
2024-02-05T18:11:21,719 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36933/0x00000000_0xffffffff
2024-02-05T18:11:21,720 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36933/0x00000000_0xffffffff - localhost:36933.
2024-02-05T18:11:21,722 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36933
2024-02-05T18:11:21,722 - INFO  - [pulsar-7-3:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36933/0x00000000_0xffffffff
2024-02-05T18:11:21,726 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36933/__change_events][reader-595182f286] Subscribing to topic on cnx [id: 0x1d34b5a4, L:/127.0.0.1:36330 - R:localhost/127.0.0.1:40543], consumerId 3
2024-02-05T18:11:21,728 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x00ef024d, L:/127.0.0.1:40543 - R:/127.0.0.1:36330]] Subscribing on topic persistent://sla-monitor/test/localhost:36933/__change_events / reader-595182f286. consumerId: 3
2024-02-05T18:11:21,738 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36933/persistent/__change_events
2024-02-05T18:11:21,739 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36933 doesn't exist.
2024-02-05T18:11:21,739 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36933/persistent/__change_events'
2024-02-05T18:11:21,750 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:11:21,751 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36933/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:11:21,759 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36933/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:11:21,765 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36933/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:11:21,770 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36933/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36933/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:11:21,772 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36933/__change_events - dedup is disabled
2024-02-05T18:11:21,785 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:11:21,791 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36933/__change_events][reader-595182f286] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:11:21,792 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36933/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:11:21,792 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36933/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36933/persistent/__change_events, cursor=reader-595182f286, ackPos=7:-1, readPos=7:0}
2024-02-05T18:11:21,799 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:36330] Created subscription on topic persistent://sla-monitor/test/localhost:36933/__change_events / reader-595182f286
2024-02-05T18:11:21,801 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36933/__change_events][reader-595182f286] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 3
2024-02-05T18:11:21,756 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 36933, tls-port = Optional[37825], broker url= pulsar://localhost:40543, broker tls url= pulsar+ssl://localhost:44501, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[40543], brokerServicePortTls=Optional[44501], webServicePort=Optional[36933], webServicePortTls=Optional[37825], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:11:22,310 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:11:22,310 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:11:22,311 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:11:22,311 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:11:22,316 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:11:22,317 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:11:22,324 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:11:22,328 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:11:22,335 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:11:22,335 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:11:22,341 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:11:22,348 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:11:22,350 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:11:22,358 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:11:22,359 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:11:22,362 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:11:22,365 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33569, TLS: (none), listener: (none)
2024-02-05T18:11:22,367 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44899, TLS: OPENSSL, listener: (none)
2024-02-05T18:11:22,371 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:11:22,372 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:11:22,373 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:11:22,387 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:11:22,390 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:11:22,390 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:11:22,391 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:11:22,469 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:11:22,660 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:22,660 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:11:23,146 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:11:23,661 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:23,661 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:11:24,387 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:11:24,584 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:11:24,663 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:24,663 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:11:24,673 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:11:24,757 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:11:24,758 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:11:24,759 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:11:24,765 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:44363}
2024-02-05T18:11:24,780 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:43179}
2024-02-05T18:11:24,781 - INFO  - [main:Server@415] - Started @17288ms
2024-02-05T18:11:24,781 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:44363
2024-02-05T18:11:24,783 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43179
2024-02-05T18:11:24,786 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:11:24,787 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:11:24,802 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:44363
2024-02-05T18:11:24,804 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:44363 registry has been created.
2024-02-05T18:11:24,804 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:44363. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:11:24,808 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:44363 is changing the role from null to Follower
2024-02-05T18:11:24,812 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:36933).
2024-02-05T18:11:24,818 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:11:24,833 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:44363 
2024-02-05T18:11:24,945 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:24 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 48
2024-02-05T18:11:24,965 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:24,967 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:11:24,968 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:11:24,977 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:24 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:11:24,980 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44363/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:11:24,987 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x95c2ac49, L:/127.0.0.1:32810 - R:localhost/127.0.0.1:33569]] Connected to server
2024-02-05T18:11:24,991 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:32810] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:11:25,005 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]] Connected to server
2024-02-05T18:11:25,008 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:48920] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:11:25,009 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,018 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48920] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:48920, producerName=test-0-3, producerId=0}
2024-02-05T18:11:25,020 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,030 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0adb8ef9a9] Subscribing to topic on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543], consumerId 0
2024-02-05T18:11:25,032 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2337231c, L:/127.0.0.1:40543 - R:/127.0.0.1:48920]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0adb8ef9a9. consumerId: 0
2024-02-05T18:11:25,036 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0adb8ef9a9] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:11:25,036 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:11:25,037 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0adb8ef9a9, ackPos=3:-1, readPos=3:0}
2024-02-05T18:11:25,039 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48920] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-0adb8ef9a9
2024-02-05T18:11:25,040 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0adb8ef9a9] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 0
2024-02-05T18:11:25,043 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:11:25,044 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:11:25,063 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:11:25,071 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:25,073 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:11:25,074 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:11:25,077 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:11:25,077 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44363/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:11:25,090 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T18:11:25,096 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:25,098 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:11:25,099 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:11:25,102 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:11:25,103 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:44363/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:11:25,119 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,126 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48920] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:48920, producerName=test-0-4, producerId=1}
2024-02-05T18:11:25,127 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,138 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-adb76ead64] Subscribing to topic on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543], consumerId 1
2024-02-05T18:11:25,139 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x2337231c, L:/127.0.0.1:40543 - R:/127.0.0.1:48920]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-adb76ead64. consumerId: 1
2024-02-05T18:11:25,149 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-adb76ead64] Created new subscription for 1
2024-02-05T18:11:25,150 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:48920] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-adb76ead64
2024-02-05T18:11:25,151 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-adb76ead64] Subscribed to topic on localhost/127.0.0.1:40543 -- consumer: 1
2024-02-05T18:11:25,163 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,170 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:48920] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:48920, producerName=test-0-5, producerId=2}
2024-02-05T18:11:25,171 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x5096bc9d, L:/127.0.0.1:48920 - R:localhost/127.0.0.1:40543]
2024-02-05T18:11:25,172 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:11:25,176 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:11:25,178 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:44363 plays a follower now.
2024-02-05T18:11:25,199 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:44363/__change_events
2024-02-05T18:11:25,221 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:44363/0x00000000_0xffffffff - localhost:44363.
2024-02-05T18:11:25,226 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:44363
2024-02-05T18:11:25,226 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:44363/0x00000000_0xffffffff
2024-02-05T18:11:25,228 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:44363/0x00000000_0xffffffff - localhost:44363.
2024-02-05T18:11:25,235 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:44363/__change_events][reader-375da92764] Subscribing to topic on cnx [id: 0x95c2ac49, L:/127.0.0.1:32810 - R:localhost/127.0.0.1:33569], consumerId 2
2024-02-05T18:11:25,237 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0e370cb2, L:/127.0.0.1:33569 - R:/127.0.0.1:32810]] Subscribing on topic persistent://sla-monitor/test/localhost:44363/__change_events / reader-375da92764. consumerId: 2
2024-02-05T18:11:25,245 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:44363
2024-02-05T18:11:25,245 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:44363/0x00000000_0xffffffff
2024-02-05T18:11:25,246 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:44363 doesn't exist.
2024-02-05T18:11:25,248 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:44363/persistent/__change_events
2024-02-05T18:11:25,249 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 44363, tls-port = Optional[43179], broker url= pulsar://localhost:33569, broker tls url= pulsar+ssl://localhost:44899, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[33569], brokerServicePortTls=Optional[44899], webServicePort=Optional[44363], webServicePortTls=Optional[43179], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:11:25,251 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:44363/persistent/__change_events'
2024-02-05T18:11:25,260 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:11:25,263 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:44363/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:11:25,268 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:44363/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:11:25,272 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:44363/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:11:25,274 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:44363/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:44363/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:11:25,281 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:44363/__change_events - dedup is disabled
2024-02-05T18:11:25,300 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:11:25,313 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:44363/__change_events][reader-375da92764] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:11:25,314 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:44363/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:11:25,314 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:44363/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44363/persistent/__change_events, cursor=reader-375da92764, ackPos=9:-1, readPos=9:0}
2024-02-05T18:11:25,316 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:32810] Created subscription on topic persistent://sla-monitor/test/localhost:44363/__change_events / reader-375da92764
2024-02-05T18:11:25,317 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:44363/__change_events][reader-375da92764] Subscribed to topic on localhost/127.0.0.1:33569 -- consumer: 2
2024-02-05T18:11:25,489 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:11:25,490 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:11:25,524 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:11:25,525 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:11:25,549 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:11:25,549 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:11:25,554 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:11:25,555 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:11:25,580 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:11:25,581 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:11:25,582 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:11:25,584 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:11:25,584 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:11:25,585 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:11:25,599 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:11:25,600 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:11:25,604 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:11:25,606 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 16
2024-02-05T18:11:25,619 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:11:25,621 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:11:25,621 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:11:25,623 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:11:25,625 - INFO  - [pulsar-7-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:11:25,628 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:11:25,663 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:11:25,664 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:11:25,664 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:11:25,675 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:11:25,675 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:11:25,691 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:11:25,703 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:25,721 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:44363 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:11:25,786 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:11:25,767 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36933 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:44363, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149485724, versionId=1]. totalHandledRequests:1
2024-02-05T18:11:25,794 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36933 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:44363, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149485767, versionId=2]. totalHandledRequests:1
2024-02-05T18:11:25,798 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:11:25,807 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 120
2024-02-05T18:11:25,819 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:11:25,836 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-525129b0c5] Subscribing to topic on cnx [id: 0x95c2ac49, L:/127.0.0.1:32810 - R:localhost/127.0.0.1:33569], consumerId 3
2024-02-05T18:11:25,842 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0e370cb2, L:/127.0.0.1:33569 - R:/127.0.0.1:32810]] Subscribing on topic persistent://public/test/__change_events / reader-525129b0c5. consumerId: 3
2024-02-05T18:11:25,870 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36933 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:44363, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149485858, versionId=3]. totalHandledRequests:1
2024-02-05T18:11:25,871 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:11:25,871 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:11:25,872 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:11:25,879 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:11:25,880 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:11:25,886 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:11:25,894 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:11:25,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:11:25,901 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:11:25,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:11:25,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:11:25,906 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:11:25,916 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:11:25,917 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:11:25,923 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:11:25,927 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 56.0 ms
2024-02-05T18:11:25,936 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:36933 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:44363, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149485870, versionId=4]. totalHandledRequests:1
2024-02-05T18:11:25,937 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:44363. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:11:25,938 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:32810][persistent://public/test/__change_events][reader-525129b0c5] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:44363. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:11:25,941 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:11:25,941 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:11:25,941 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x95c2ac49, L:/127.0.0.1:32810 - R:localhost/127.0.0.1:33569] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:44363. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:11:25,943 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 133
2024-02-05T18:11:25,943 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:11:25,944 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-525129b0c5] Failed to subscribe to topic on localhost/127.0.0.1:33569
2024-02-05T18:11:25,944 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-525129b0c5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:44363. Please redo the lookup. Request is denied: namespace=public/test","reqId":4610281462546526220, "remote":"localhost/127.0.0.1:33569", "local":"/127.0.0.1:32810"}
2024-02-05T18:11:25,944 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:11:25 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 285
2024-02-05T18:11:25,944 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-525129b0c5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:44363. Please redo the lookup. Request is denied: namespace=public/test","reqId":4610281462546526220, "remote":"localhost/127.0.0.1:33569", "local":"/127.0.0.1:32810"} -- Will try again in 0.1 s
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d23a79], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17efa7f7] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d23a79, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a49ebb6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17efa7f7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4cb27ce2] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d23a79, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a49ebb6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1fe096ff], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17efa7f7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4cb27ce2, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75da4aeb] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d23a79, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a49ebb6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1fe096ff, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b0bbd], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17efa7f7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4cb27ce2, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75da4aeb, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f312234] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29b62326, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29609d69, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42d23a79, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3a49ebb6, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1fe096ff, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3b0bbd, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@44fd0043], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5c412539, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5ae58d10, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17efa7f7, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4cb27ce2, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@75da4aeb, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5f312234, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@63d79725] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:11:26,040 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:11:26,045 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:11:26,046 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:11:26,046 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:11:26,047 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:11:26,047 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-525129b0c5] Reconnecting after connection was closed
2024-02-05T18:11:26,047 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:11:26,049 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0x95c2ac49, L:/127.0.0.1:32810 - R:localhost/127.0.0.1:33569] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:11:26,049 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":4610281462546526221, "remote":"localhost/127.0.0.1:33569", "local":"/127.0.0.1:32810"}
2024-02-05T18:11:26,050 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-525129b0c5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":4610281462546526221, "remote":"localhost/127.0.0.1:33569", "local":"/127.0.0.1:32810"}
2024-02-05T18:11:26,050 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-525129b0c5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":4610281462546526221, "remote":"localhost/127.0.0.1:33569", "local":"/127.0.0.1:32810"} -- Will try again in 0.195 s
2024-02-05T18:11:26,050 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x95c2ac49, L:/127.0.0.1:32810 ! R:localhost/127.0.0.1:33569] Disconnected
2024-02-05T18:11:26,051 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:32810
2024-02-05T18:11:26,052 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:44363/__change_events, name=reader-375da92764}, consumerId=2, consumerName=b27bd, address=/127.0.0.1:32810}
2024-02-05T18:11:26,052 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:44363/__change_events][reader-375da92764] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:44363/persistent/__change_events, cursor=reader-375da92764, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:11:26,053 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:44363/__change_events][reader-375da92764] Successfully closed dispatcher for reader
2024-02-05T18:11:26,054 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:11:26,057 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:11:26,052 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:44363/__change_events] [reader-375da92764] Closed connection [id: 0x95c2ac49, L:/127.0.0.1:32810 ! R:localhost/127.0.0.1:33569] -- Will try again in 0.1 s
2024-02-05T18:11:26,061 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:11:26,064 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:11:26,067 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:11:26,069 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:11:26,072 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:11:26,074 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:11:26,075 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:11:26,076 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44363
2024-02-05T18:11:26,079 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44363 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:11:26,084 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:44363 registry has been deleted.
2024-02-05T18:11:26,084 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:44363 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:11:26,084 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:44363 was invalidated. state Releasing
2024-02-05T18:11:26,085 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:44363. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:11:26,086 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:44363 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:11:26,086 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:44363
2024-02-05T18:11:26,087 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:44363
2024-02-05T18:11:26,087 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:44363 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:11:26,098 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:44363/0x00000000_0xffffffff.
2024-02-05T18:11:26,099 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:44363/0x00000000_0xffffffff.
2024-02-05T18:11:26,100 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:44363/0x00000000_0xffffffff.
2024-02-05T18:11:26,100 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.013 seconds
2024-02-05T18:11:26,102 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:11:26,105 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:11:26,106 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:44363/persistent/__change_events] Closing managed ledger
2024-02-05T18:11:26,107 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:48920
2024-02-05T18:11:26,108 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:44363/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:11:26,108 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-0adb8ef9a9}, consumerId=0, consumerName=91e40, address=/127.0.0.1:48920}
2024-02-05T18:11:26,109 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0adb8ef9a9] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-0adb8ef9a9, ackPos=3:3, readPos=3:4}]
2024-02-05T18:11:26,109 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:11:26,109 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-0adb8ef9a9] Successfully closed dispatcher for reader
2024-02-05T18:11:26,106 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] Disconnected
2024-02-05T18:11:26,110 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:26,110 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:26,110 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:26,111 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0adb8ef9a9] Closed connection [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:26,111 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-adb76ead64] Closed connection [id: 0x5096bc9d, L:/127.0.0.1:48920 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:26,111 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-adb76ead64}, consumerId=1, consumerName=35337, address=/127.0.0.1:48920}
2024-02-05T18:11:26,112 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:11:26,113 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:11:26,134 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:33569
2024-02-05T18:11:26,135 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:11:26,136 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:11:26,137 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:11:26,138 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:44363/__change_events] [reader-375da92764] Closed Consumer (not connected)
2024-02-05T18:11:26,139 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44363/__change_events with subscription name reader-375da92764 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:44363/__change_events with subscription name reader-375da92764 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:26,139 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-525129b0c5] Closed Consumer (not connected)
2024-02-05T18:11:26,140 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-0adb8ef9a9] Closed Consumer (not connected)
2024-02-05T18:11:26,140 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-adb76ead64] Closed Consumer (not connected)
2024-02-05T18:11:26,141 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0adb8ef9a9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-0adb8ef9a9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:26,141 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-adb76ead64 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-adb76ead64 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:26,147 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:11:26,147 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:11:26,150 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:11:26,150 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:26,157 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:11:26,157 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:26,578 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 40.23%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.19%, msgThroughputEMA= 0.00, updatedAt= 1707149486577, reportedAt= 1707149481690
2024-02-05T18:11:26,669 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:26,670 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:11:27,415 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:11:27,416 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:11:27,418 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:11:27,418 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:27,419 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:11:27,419 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:11:27,671 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:27,671 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:11:28,672 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:11:28,672 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:11:29,433 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:11:29,434 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@61d6c8c4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:11:29,435 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@23365142{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:11:29,435 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:11:29,436 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@1978b0d5{/static,null,STOPPED}
2024-02-05T18:11:29,436 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/metrics,null,STOPPED}
2024-02-05T18:11:29,437 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/topics,null,STOPPED}
2024-02-05T18:11:29,439 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/lookup,null,STOPPED}
2024-02-05T18:11:29,441 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin/v3,null,STOPPED}
2024-02-05T18:11:29,443 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/admin/v2,null,STOPPED}
2024-02-05T18:11:29,445 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin,null,STOPPED}
2024-02-05T18:11:29,446 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/,null,STOPPED}
2024-02-05T18:11:29,447 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:11:29,448 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:11:29,448 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:11:29,449 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36933
2024-02-05T18:11:29,450 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36933 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:11:29,459 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36933 was invalidated. state Releasing
2024-02-05T18:11:29,460 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36933. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:11:29,460 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36933
2024-02-05T18:11:29,462 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36933/0x00000000_0xffffffff.
2024-02-05T18:11:29,463 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36933/0x00000000_0xffffffff.
2024-02-05T18:11:29,464 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36933/0x00000000_0xffffffff.
2024-02-05T18:11:29,464 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.003 seconds
2024-02-05T18:11:29,464 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:11:29,465 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] Disconnected
2024-02-05T18:11:29,465 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:36330
2024-02-05T18:11:29,465 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-f3b8534305}, consumerId=0, consumerName=b7734, address=/127.0.0.1:36330}
2024-02-05T18:11:29,466 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f3b8534305] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-f3b8534305, ackPos=3:3, readPos=3:4}]
2024-02-05T18:11:29,466 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-f3b8534305] Successfully closed dispatcher for reader
2024-02-05T18:11:29,467 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:11:29,467 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,467 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:11:29,467 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,467 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36933/__change_events, name=reader-595182f286}, consumerId=3, consumerName=659a9, address=/127.0.0.1:36330}
2024-02-05T18:11:29,467 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36933/persistent/__change_events] Closing managed ledger
2024-02-05T18:11:29,467 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36933/__change_events][reader-595182f286] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36933/persistent/__change_events, cursor=reader-595182f286, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f3b8534305] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36933/__change_events][reader-595182f286] Successfully closed dispatcher for reader
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f39066a2f2] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36933/__change_events] [reader-595182f286] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-2582e1c065] Closed connection [id: 0x1d34b5a4, L:/127.0.0.1:36330 ! R:localhost/127.0.0.1:40543] -- Will try again in 0.1 s
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-2582e1c065}, consumerId=2, consumerName=5c9f7, address=/127.0.0.1:36330}
2024-02-05T18:11:29,468 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-f39066a2f2}, consumerId=1, consumerName=2db94, address=/127.0.0.1:36330}
2024-02-05T18:11:29,476 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:11:29,476 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36933/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:11:29,476 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:11:29,477 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:11:29,477 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:11:29,481 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:40543
2024-02-05T18:11:29,481 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:11:29,481 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:11:29,481 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:11:29,482 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-f39066a2f2] Closed Consumer (not connected)
2024-02-05T18:11:29,482 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-f3b8534305] Closed Consumer (not connected)
2024-02-05T18:11:29,482 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-2582e1c065] Closed Consumer (not connected)
2024-02-05T18:11:29,482 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36933/__change_events] [reader-595182f286] Closed Consumer (not connected)
2024-02-05T18:11:29,482 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f39066a2f2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-f39066a2f2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:29,483 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f3b8534305 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-f3b8534305 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:29,483 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-2582e1c065 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-2582e1c065 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:29,484 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36933/__change_events with subscription name reader-595182f286 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36933/__change_events with subscription name reader-595182f286 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:11:29,488 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:11:29,489 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:11:29,489 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:11:29,489 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:11:29,490 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:11:29,490 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:29,491 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:11:29,491 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:30,773 - INFO  - [globalEventExecutor-10-5:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:11:30,774 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:11:30,775 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:11:30,775 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:30,775 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:11:30,776 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:11:30,785 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:11:30,785 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:11:30,791 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:11:30,791 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:11:30,791 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 67 with name 'Thread[AsyncHttpClient-37-1,5,main]'
2024-02-05T18:11:30,791 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:11:30,792 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:11:30,793 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 188 with name 'Thread[globalEventExecutor-10-5,5,main]'
2024-02-05T18:11:30,793 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:11:30,793 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:11:30,793 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@51a4feef
2024-02-05T18:11:30,794 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:11:30,794 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:11:30,794 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.787 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  48.406 s
[INFO] Finished at: 2024-02-05T18:11:31+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 4 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:12:02,272 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:12:03,179 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:12:03,180 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:12:03,648 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:12:03,649 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:12:03,650 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:12:03,651 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:12:03,651 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:12:03,652 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:12:03,683 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:12:03,684 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:12:03,684 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:12:03,685 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:12:03,685 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:12:03,686 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:12:03,686 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:12:03,687 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:12:03,687 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:12:03,688 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:12:03,688 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:12:03,688 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:12:05,396 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:12:05,396 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:12:05,397 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:12:05,397 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:12:05,758 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:12:05,759 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:12:05,838 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:12:05,920 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:12:05,924 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:12:05,947 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:12:06,060 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:12:06,104 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:12:06,154 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:12:06,500 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:12:06,501 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:12:06,535 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:12:06,593 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36289, TLS: (none), listener: (none)
2024-02-05T18:12:06,932 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36107, TLS: OPENSSL, listener: (none)
2024-02-05T18:12:06,952 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:12:06,955 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:12:06,956 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:12:06,982 - INFO  - [main:Log@170] - Logging initialized @7099ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:12:07,754 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:12:07,789 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:12:07,790 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:12:07,792 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:12:08,509 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:12:09,733 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:12:10,842 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:12:11,248 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:12:11,397 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:12:11,561 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:12:11,566 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:12:11,571 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:12:11,587 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:39293}
2024-02-05T18:12:11,734 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:39351}
2024-02-05T18:12:11,735 - INFO  - [main:Server@415] - Started @11853ms
2024-02-05T18:12:11,736 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:39293
2024-02-05T18:12:11,737 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:39351
2024-02-05T18:12:11,745 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:12:11,746 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:12:11,917 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:39293
2024-02-05T18:12:11,932 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:12:11,935 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:39293 is changing the role from null to Leader
2024-02-05T18:12:11,939 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39293).
2024-02-05T18:12:12,283 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:39293 
2024-02-05T18:12:12,704 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:12:12,729 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:12,853 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:12:12,857 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:12:12,868 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:12:12,871 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:12:12,914 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:12:12,949 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:12:12,987 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:12:13,060 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:12:13,083 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:12:13,094 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:12:13,098 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:12:13,130 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:12:13,135 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 548
2024-02-05T18:12:13,320 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]] Connected to server
2024-02-05T18:12:13,356 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:52454] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:12:13,414 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,422 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,502 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:12:13,532 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52454] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52454, producerName=test-0-0, producerId=0}
2024-02-05T18:12:13,540 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,541 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:12:13,601 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,604 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d37187f02] Subscribing to topic on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289], consumerId 0
2024-02-05T18:12:13,615 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27254967, L:/127.0.0.1:36289 - R:/127.0.0.1:52454]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9d37187f02. consumerId: 0
2024-02-05T18:12:13,646 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d37187f02] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:13,648 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:12:13,648 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9d37187f02, ackPos=3:-1, readPos=3:0}
2024-02-05T18:12:13,673 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52454] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-9d37187f02
2024-02-05T18:12:13,679 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d37187f02] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 0
2024-02-05T18:12:13,694 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.012 seconds
2024-02-05T18:12:13,695 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:12:13,698 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:12:13,698 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:12:13,738 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,756 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:12:13,757 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:12:13,759 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:12:13,761 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 49
2024-02-05T18:12:13,772 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,781 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:12:13,782 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:12:13,783 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 18
2024-02-05T18:12:13,784 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:12:13,807 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,809 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,817 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:12:13,824 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52454] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52454, producerName=test-0-1, producerId=1}
2024-02-05T18:12:13,825 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,841 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,843 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6e91f43c0a] Subscribing to topic on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289], consumerId 1
2024-02-05T18:12:13,845 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27254967, L:/127.0.0.1:36289 - R:/127.0.0.1:52454]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6e91f43c0a. consumerId: 1
2024-02-05T18:12:13,867 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6e91f43c0a] Created new subscription for 1
2024-02-05T18:12:13,868 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52454] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-6e91f43c0a
2024-02-05T18:12:13,869 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-6e91f43c0a] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 1
2024-02-05T18:12:13,891 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,892 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,897 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:12:13,904 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:52454] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52454, producerName=test-0-2, producerId=2}
2024-02-05T18:12:13,906 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:13,921 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:12:13,948 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:12:13,954 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:39293 started the ownership monitor.
2024-02-05T18:12:13,970 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:13,972 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0c2ec9f27f] Subscribing to topic on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289], consumerId 2
2024-02-05T18:12:13,974 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27254967, L:/127.0.0.1:36289 - R:/127.0.0.1:52454]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-0c2ec9f27f. consumerId: 2
2024-02-05T18:12:13,990 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0c2ec9f27f] Created new subscription for 2
2024-02-05T18:12:13,990 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52454] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-0c2ec9f27f
2024-02-05T18:12:13,991 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-0c2ec9f27f] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 2
2024-02-05T18:12:13,992 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:39293 plays the leader now.
2024-02-05T18:12:13,996 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:39293/__change_events
2024-02-05T18:12:13,998 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.71%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.71%, msgThroughputEMA= 0.00, updatedAt= 1707149533997, reportedAt= 0
2024-02-05T18:12:14,030 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:12:14,040 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:14,044 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 1.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:12:14,082 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:39293/0x00000000_0xffffffff - localhost:39293.
2024-02-05T18:12:14,085 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:39293
2024-02-05T18:12:14,085 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:39293/0x00000000_0xffffffff
2024-02-05T18:12:14,086 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:39293/0x00000000_0xffffffff - localhost:39293.
2024-02-05T18:12:14,088 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:39293
2024-02-05T18:12:14,088 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:39293/0x00000000_0xffffffff
2024-02-05T18:12:14,101 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:39293 doesn't exist.
2024-02-05T18:12:14,138 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:39293/__change_events][reader-f71e6c3679] Subscribing to topic on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289], consumerId 3
2024-02-05T18:12:14,140 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27254967, L:/127.0.0.1:36289 - R:/127.0.0.1:52454]] Subscribing on topic persistent://sla-monitor/test/localhost:39293/__change_events / reader-f71e6c3679. consumerId: 3
2024-02-05T18:12:14,149 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:39293/persistent/__change_events
2024-02-05T18:12:14,151 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:39293/persistent/__change_events'
2024-02-05T18:12:14,161 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:12:14,162 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:39293/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:12:14,171 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:39293/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:12:14,177 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:39293/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:12:14,182 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:39293/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:39293/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:12:14,184 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:39293/__change_events - dedup is disabled
2024-02-05T18:12:14,193 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:12:14,198 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:39293/__change_events][reader-f71e6c3679] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:14,199 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:39293/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:12:14,199 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:39293/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39293/persistent/__change_events, cursor=reader-f71e6c3679, ackPos=7:-1, readPos=7:0}
2024-02-05T18:12:14,201 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:52454] Created subscription on topic persistent://sla-monitor/test/localhost:39293/__change_events / reader-f71e6c3679
2024-02-05T18:12:14,202 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:39293/__change_events][reader-f71e6c3679] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 3
2024-02-05T18:12:14,123 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 39293, tls-port = Optional[39351], broker url= pulsar://localhost:36289, broker tls url= pulsar+ssl://localhost:36107, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[36289], brokerServicePortTls=Optional[36107], webServicePort=Optional[39293], webServicePortTls=Optional[39351], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:12:14,821 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:12:14,821 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:12:14,821 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:12:14,821 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:12:14,826 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:12:14,826 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:12:14,832 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:12:14,839 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:12:14,846 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:12:14,846 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:12:14,854 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:12:14,860 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:12:14,866 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:12:14,877 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:12:14,877 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:12:14,885 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:12:14,887 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34503, TLS: (none), listener: (none)
2024-02-05T18:12:14,889 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33333, TLS: OPENSSL, listener: (none)
2024-02-05T18:12:14,894 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:12:14,895 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:12:14,896 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:12:14,910 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:12:14,912 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:12:14,913 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:12:14,913 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:12:15,003 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@45ec9b22{/,null,AVAILABLE}
2024-02-05T18:12:15,064 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:15,064 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:12:15,647 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/admin,null,AVAILABLE}
2024-02-05T18:12:16,065 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:16,066 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:12:16,834 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,AVAILABLE}
2024-02-05T18:12:17,067 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:17,067 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:12:17,069 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,AVAILABLE}
2024-02-05T18:12:17,134 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,AVAILABLE}
2024-02-05T18:12:17,215 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/topics,null,AVAILABLE}
2024-02-05T18:12:17,216 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,AVAILABLE}
2024-02-05T18:12:17,216 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@554f6e30{/static,null,AVAILABLE}
2024-02-05T18:12:17,218 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:42987}
2024-02-05T18:12:17,227 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:35485}
2024-02-05T18:12:17,227 - INFO  - [main:Server@415] - Started @17346ms
2024-02-05T18:12:17,228 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:42987
2024-02-05T18:12:17,230 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:35485
2024-02-05T18:12:17,233 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:12:17,234 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:12:17,251 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:42987 registry has been created.
2024-02-05T18:12:17,251 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:42987. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:12:17,252 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:42987
2024-02-05T18:12:17,260 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:39293).
2024-02-05T18:12:17,264 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:42987 is changing the role from null to Follower
2024-02-05T18:12:17,269 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:12:17,301 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:42987 
2024-02-05T18:12:17,405 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 47
2024-02-05T18:12:17,427 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:17,429 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:12:17,431 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:12:17,439 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:12:17,442 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42987/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:12:17,452 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xbcac4a3c, L:/127.0.0.1:52532 - R:localhost/127.0.0.1:34503]] Connected to server
2024-02-05T18:12:17,456 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:52532] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:12:17,471 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]] Connected to server
2024-02-05T18:12:17,474 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:52464] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:12:17,475 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,484 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52464] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:52464, producerName=test-0-3, producerId=0}
2024-02-05T18:12:17,485 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,498 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-11f7c227ff] Subscribing to topic on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289], consumerId 0
2024-02-05T18:12:17,501 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x15a4b7a8, L:/127.0.0.1:36289 - R:/127.0.0.1:52464]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-11f7c227ff. consumerId: 0
2024-02-05T18:12:17,506 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-11f7c227ff] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:17,506 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:12:17,507 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-11f7c227ff, ackPos=3:-1, readPos=3:0}
2024-02-05T18:12:17,508 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52464] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-11f7c227ff
2024-02-05T18:12:17,509 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-11f7c227ff] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 0
2024-02-05T18:12:17,513 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:12:17,514 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:12:17,537 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 20
2024-02-05T18:12:17,546 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:17,549 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:12:17,549 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:12:17,554 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42987/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:12:17,556 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:12:17,568 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 9
2024-02-05T18:12:17,577 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:17,581 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:12:17,581 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:12:17,585 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:12:17,586 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:42987/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:12:17,601 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,609 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52464] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:52464, producerName=test-0-4, producerId=1}
2024-02-05T18:12:17,611 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,625 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cf4dd63d9] Subscribing to topic on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289], consumerId 1
2024-02-05T18:12:17,631 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x15a4b7a8, L:/127.0.0.1:36289 - R:/127.0.0.1:52464]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3cf4dd63d9. consumerId: 1
2024-02-05T18:12:17,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cf4dd63d9] Created new subscription for 1
2024-02-05T18:12:17,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52464] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-3cf4dd63d9
2024-02-05T18:12:17,647 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-3cf4dd63d9] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 1
2024-02-05T18:12:17,666 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,674 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:52464] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:52464, producerName=test-0-5, producerId=2}
2024-02-05T18:12:17,676 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289]
2024-02-05T18:12:17,677 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:12:17,681 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:12:17,683 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:42987 plays a follower now.
2024-02-05T18:12:17,700 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:42987/__change_events
2024-02-05T18:12:17,723 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:42987/0x00000000_0xffffffff - localhost:42987.
2024-02-05T18:12:17,724 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:42987
2024-02-05T18:12:17,724 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:42987/0x00000000_0xffffffff
2024-02-05T18:12:17,725 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:42987/0x00000000_0xffffffff - localhost:42987.
2024-02-05T18:12:17,730 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:42987/0x00000000_0xffffffff
2024-02-05T18:12:17,731 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:42987
2024-02-05T18:12:17,731 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:42987/__change_events][reader-63392ad28c] Subscribing to topic on cnx [id: 0xbcac4a3c, L:/127.0.0.1:52532 - R:localhost/127.0.0.1:34503], consumerId 2
2024-02-05T18:12:17,734 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:42987 doesn't exist.
2024-02-05T18:12:17,734 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0cc689c0, L:/127.0.0.1:34503 - R:/127.0.0.1:52532]] Subscribing on topic persistent://sla-monitor/test/localhost:42987/__change_events / reader-63392ad28c. consumerId: 2
2024-02-05T18:12:17,736 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 42987, tls-port = Optional[35485], broker url= pulsar://localhost:34503, broker tls url= pulsar+ssl://localhost:33333, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34503], brokerServicePortTls=Optional[33333], webServicePort=Optional[42987], webServicePortTls=Optional[35485], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:12:17,743 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:42987/persistent/__change_events
2024-02-05T18:12:17,748 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:42987/persistent/__change_events'
2024-02-05T18:12:17,760 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:12:17,764 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:42987/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:12:17,774 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:42987/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:12:17,778 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:42987/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:12:17,780 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:42987/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:42987/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:12:17,781 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:42987/__change_events - dedup is disabled
2024-02-05T18:12:17,793 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:12:17,803 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:42987/__change_events][reader-63392ad28c] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:17,804 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:42987/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:12:17,804 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:42987/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42987/persistent/__change_events, cursor=reader-63392ad28c, ackPos=9:-1, readPos=9:0}
2024-02-05T18:12:17,808 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:52532] Created subscription on topic persistent://sla-monitor/test/localhost:42987/__change_events / reader-63392ad28c
2024-02-05T18:12:17,809 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:42987/__change_events][reader-63392ad28c] Subscribed to topic on localhost/127.0.0.1:34503 -- consumer: 2
2024-02-05T18:12:17,943 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:12:17,944 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:12:17,973 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:12:17,974 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:12:17,998 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:12:17,998 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:12:18,003 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:12:18,005 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:17 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:12:18,029 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:12:18,029 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:12:18,030 - INFO  - [pulsar-web-30-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:12:18,030 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:12:18,034 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:12:18,036 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 25
2024-02-05T18:12:18,048 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:12:18,048 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:12:18,053 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:12:18,054 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:12:18,068 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:12:18,068 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:12:18,068 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:12:18,069 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:12:18,069 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:12:18,070 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:12:18,070 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:12:18,076 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:12:18,115 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:12:18,127 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:12:18,128 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:12:18,144 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:12:18,153 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:18,170 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:42987 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:12:18,236 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:12:18,216 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:42987, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538172, versionId=1]. totalHandledRequests:1
2024-02-05T18:12:18,250 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:42987, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538216, versionId=2]. totalHandledRequests:1
2024-02-05T18:12:18,260 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:18,270 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 130
2024-02-05T18:12:18,286 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-aa6c5c7168] Subscribing to topic on cnx [id: 0xbcac4a3c, L:/127.0.0.1:52532 - R:localhost/127.0.0.1:34503], consumerId 3
2024-02-05T18:12:18,287 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:12:18,288 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x0cc689c0, L:/127.0.0.1:34503 - R:/127.0.0.1:52532]] Subscribing on topic persistent://public/test/__change_events / reader-aa6c5c7168. consumerId: 3
2024-02-05T18:12:18,295 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:12:18,298 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:12:18,307 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:12:18,308 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:12:18,313 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:12:18,318 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:12:18,325 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:12:18,327 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:12:18,330 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:42987, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149538320, versionId=3]. totalHandledRequests:1
2024-02-05T18:12:18,333 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:12:18,337 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:12:18,340 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:12:18,342 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:12:18,343 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:12:18,359 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:12:18,364 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:12:18,367 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 35.0 ms
2024-02-05T18:12:18,375 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:42987, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538331, versionId=4]. totalHandledRequests:1
2024-02-05T18:12:18,377 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42987. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:12:18,377 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:52532][persistent://public/test/__change_events][reader-aa6c5c7168] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42987. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:12:18,380 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:12:18,381 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:12:18,381 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xbcac4a3c, L:/127.0.0.1:52532 - R:localhost/127.0.0.1:34503] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42987. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:12:18,382 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 104
2024-02-05T18:12:18,382 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:12:18,383 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-aa6c5c7168] Failed to subscribe to topic on localhost/127.0.0.1:34503
2024-02-05T18:12:18,384 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-aa6c5c7168] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42987. Please redo the lookup. Request is denied: namespace=public/test","reqId":2997591408115822703, "remote":"localhost/127.0.0.1:34503", "local":"/127.0.0.1:52532"}
2024-02-05T18:12:18,384 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:12:18 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 272
2024-02-05T18:12:18,384 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-aa6c5c7168] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:42987. Please redo the lookup. Request is denied: namespace=public/test","reqId":2997591408115822703, "remote":"localhost/127.0.0.1:34503", "local":"/127.0.0.1:52532"} -- Will try again in 0.1 s
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5032aa01], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@338de28e] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5032aa01, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76cef968], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@338de28e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3285d9bd] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5032aa01, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76cef968, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77a21f4e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@338de28e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3285d9bd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b671aa6] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5032aa01, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76cef968, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77a21f4e, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2ae3a31b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@338de28e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3285d9bd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b671aa6, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36b7cfcb] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4849c7eb, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@325efb0c, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5032aa01, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@76cef968, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77a21f4e, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2ae3a31b, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5188ee3c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@22e83687, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564259bd, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@338de28e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3285d9bd, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2b671aa6, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@36b7cfcb, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@42296c81] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:12:18,486 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-aa6c5c7168] Reconnecting after connection was closed
2024-02-05T18:12:18,493 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:12:18,495 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:42987. Skipping this broker. Phase one
2024-02-05T18:12:18,496 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:39293. Skipping this broker. Phase one
2024-02-05T18:12:18,496 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:39293 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:12:18,501 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@45dc4d1a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:12:18,503 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@60a98fa6{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:12:18,505 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:12:18,506 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:39293, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538496, versionId=5]. totalHandledRequests:8
2024-02-05T18:12:18,507 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@554f6e30{/static,null,STOPPED}
2024-02-05T18:12:18,508 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/metrics,null,STOPPED}
2024-02-05T18:12:18,518 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:39293, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538507, versionId=6]. totalHandledRequests:6
2024-02-05T18:12:18,519 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-aa6c5c7168] Subscribing to topic on cnx [id: 0x03b33b0b, L:/127.0.0.1:52464 - R:localhost/127.0.0.1:36289], consumerId 3
2024-02-05T18:12:18,521 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:12:18,522 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x15a4b7a8, L:/127.0.0.1:36289 - R:/127.0.0.1:52464]] Subscribing on topic persistent://public/test/__change_events / reader-aa6c5c7168. consumerId: 3
2024-02-05T18:12:18,524 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:12:18,528 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:12:18,530 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/topics,null,STOPPED}
2024-02-05T18:12:18,533 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/lookup,null,STOPPED}
2024-02-05T18:12:18,533 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:12:18,536 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin/v3,null,STOPPED}
2024-02-05T18:12:18,539 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin/v2,null,STOPPED}
2024-02-05T18:12:18,540 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:12:18,541 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:12:18,546 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:12:18,550 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/admin,null,STOPPED}
2024-02-05T18:12:18,551 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:12:18,552 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:12:18,563 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:12:18,563 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:12:18,564 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:12:18,566 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@45ec9b22{/,null,STOPPED}
2024-02-05T18:12:18,566 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:12:18,569 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:12:18,570 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-df167330d2] Subscribing to topic on cnx [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289], consumerId 4
2024-02-05T18:12:18,573 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:12:18,573 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x27254967, L:/127.0.0.1:36289 - R:/127.0.0.1:52454]] Subscribing on topic persistent://public/test/__change_events / reader-df167330d2. consumerId: 4
2024-02-05T18:12:18,577 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:12:18,577 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:12:18,578 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42987
2024-02-05T18:12:18,580 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-aa6c5c7168] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:18,581 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:12:18,581 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-aa6c5c7168, ackPos=13:-1, readPos=13:0}
2024-02-05T18:12:18,583 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52464] Created subscription on topic persistent://public/test/__change_events / reader-aa6c5c7168
2024-02-05T18:12:18,584 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-aa6c5c7168] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 3
2024-02-05T18:12:18,585 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-df167330d2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:12:18,585 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:12:18,586 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-df167330d2, ackPos=13:-1, readPos=13:0}
2024-02-05T18:12:18,587 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:52454] Created subscription on topic persistent://public/test/__change_events / reader-df167330d2
2024-02-05T18:12:18,590 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:12:18,591 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:52464] Closing consumer: consumerId=3
2024-02-05T18:12:18,591 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-aa6c5c7168}, consumerId=3, consumerName=ef585, address=/127.0.0.1:52464}
2024-02-05T18:12:18,592 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-aa6c5c7168] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-aa6c5c7168, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:12:18,593 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-aa6c5c7168] Successfully closed dispatcher for reader
2024-02-05T18:12:18,595 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:42987 was invalidated. state Releasing
2024-02-05T18:12:18,595 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-df167330d2] Subscribed to topic on localhost/127.0.0.1:36289 -- consumer: 4
2024-02-05T18:12:18,596 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:42987. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:12:18,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:42987 registry has been deleted.
2024-02-05T18:12:18,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:42987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:12:18,599 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:42987
2024-02-05T18:12:18,601 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:42987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:12:18,601 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:42987
2024-02-05T18:12:18,603 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:52464] Closed consumer, consumerId=3
2024-02-05T18:12:18,603 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:42987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:12:18,604 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-aa6c5c7168] Closed consumer
2024-02-05T18:12:18,606 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:12:18,615 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:42987/0x00000000_0xffffffff.
2024-02-05T18:12:18,618 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:42987/0x00000000_0xffffffff.
2024-02-05T18:12:18,620 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:42987/0x00000000_0xffffffff.
2024-02-05T18:12:18,620 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.021 seconds
2024-02-05T18:12:18,626 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:12:18,633 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] Disconnected
2024-02-05T18:12:18,637 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xbcac4a3c, L:/127.0.0.1:52532 ! R:localhost/127.0.0.1:34503] Disconnected
2024-02-05T18:12:18,637 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:18,637 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:42987/__change_events] [reader-63392ad28c] Closed connection [id: 0xbcac4a3c, L:/127.0.0.1:52532 ! R:localhost/127.0.0.1:34503] -- Will try again in 0.1 s
2024-02-05T18:12:18,638 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:52464
2024-02-05T18:12:18,638 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:12:18,639 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:42987/persistent/__change_events] Closing managed ledger
2024-02-05T18:12:18,639 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-11f7c227ff}, consumerId=0, consumerName=e1ab1, address=/127.0.0.1:52464}
2024-02-05T18:12:18,640 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-11f7c227ff] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-11f7c227ff, ackPos=3:5, readPos=3:6}]
2024-02-05T18:12:18,640 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-11f7c227ff] Successfully closed dispatcher for reader
2024-02-05T18:12:18,640 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:52532
2024-02-05T18:12:18,640 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:42987/__change_events, name=reader-63392ad28c}, consumerId=2, consumerName=b3e0d, address=/127.0.0.1:52532}
2024-02-05T18:12:18,641 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:42987/__change_events][reader-63392ad28c] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:42987/persistent/__change_events, cursor=reader-63392ad28c, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:12:18,641 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:42987/__change_events][reader-63392ad28c] Successfully closed dispatcher for reader
2024-02-05T18:12:18,641 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:18,641 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:18,641 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-11f7c227ff] Closed connection [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:18,642 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3cf4dd63d9] Closed connection [id: 0x03b33b0b, L:/127.0.0.1:52464 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:18,642 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-3cf4dd63d9}, consumerId=1, consumerName=134bd, address=/127.0.0.1:52464}
2024-02-05T18:12:18,644 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:42987/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:12:18,648 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:12:18,651 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:12:18,652 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:12:18,658 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34503
2024-02-05T18:12:18,659 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:12:18,660 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:12:18,660 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:12:18,661 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-11f7c227ff] Closed Consumer (not connected)
2024-02-05T18:12:18,662 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-11f7c227ff was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-11f7c227ff was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:18,662 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:42987/__change_events] [reader-63392ad28c] Closed Consumer (not connected)
2024-02-05T18:12:18,663 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-3cf4dd63d9] Closed Consumer (not connected)
2024-02-05T18:12:18,663 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42987/__change_events with subscription name reader-63392ad28c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:42987/__change_events with subscription name reader-63392ad28c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:18,664 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3cf4dd63d9 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-3cf4dd63d9 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:18,669 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:12:18,669 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:12:18,673 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:12:18,674 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:18,687 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:12:18,688 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:18,942 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:12:18,943 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 45.51%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 45.51%, msgThroughputEMA= 0.00, updatedAt= 1707149538942, reportedAt= 0
2024-02-05T18:12:19,071 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:19,072 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:12:19,952 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:12:19,953 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:12:19,955 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:12:19,955 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:19,956 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:12:19,956 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:12:20,073 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:20,073 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:12:21,074 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:12:21,074 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:12:21,973 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:12:21,974 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:12:21,975 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:12:21,975 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:12:21,975 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:12:21,975 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:12:21,977 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:12:21,979 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:12:21,980 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:12:21,982 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:12:21,984 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:12:21,985 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:12:21,986 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:12:21,987 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:12:21,987 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:12:21,988 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:39293
2024-02-05T18:12:21,989 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:39293, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149538507, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:12:27,000 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:39293 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:12:27,006 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:39293 was invalidated. state Releasing
2024-02-05T18:12:27,007 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:39293. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:12:27,007 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:39293
2024-02-05T18:12:27,010 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:39293/0x00000000_0xffffffff.
2024-02-05T18:12:27,011 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:39293/0x00000000_0xffffffff.
2024-02-05T18:12:27,018 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:39293, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149547011, versionId=7]. totalHandledRequests:10
2024-02-05T18:12:27,019 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:12:27,019 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:12:27,020 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:12:27,020 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-df167330d2}, consumerId=4, consumerName=27401, address=/127.0.0.1:52454}
2024-02-05T18:12:27,021 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-df167330d2}, consumerId=4, consumerName=27401, address=/127.0.0.1:52454}
2024-02-05T18:12:27,021 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:36289] Broker notification of Closed consumer: 4
2024-02-05T18:12:27,021 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-df167330d2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-df167330d2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:12:27,022 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-df167330d2] Successfully closed dispatcher for reader
2024-02-05T18:12:27,022 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-df167330d2] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 - R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,022 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-df167330d2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-df167330d2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:12:27,023 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-df167330d2] Successfully disconnected and closed subscription
2024-02-05T18:12:27,023 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:12:27,026 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:12:27,028 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:12:27,028 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-df167330d2] Closed Consumer (not connected)
2024-02-05T18:12:27,028 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:12:27,028 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-df167330d2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-df167330d2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:27,035 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:39293 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:39293, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149547018, versionId=8]. totalHandledRequests:4
2024-02-05T18:12:27,036 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:12:27,037 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:39293/0x00000000_0xffffffff.
2024-02-05T18:12:27,038 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.03 seconds
2024-02-05T18:12:27,038 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:12:27,039 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:52454
2024-02-05T18:12:27,039 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:12:27,039 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] Disconnected
2024-02-05T18:12:27,039 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-9d37187f02}, consumerId=0, consumerName=1aa4c, address=/127.0.0.1:52454}
2024-02-05T18:12:27,039 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:12:27,040 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d37187f02] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-9d37187f02, ackPos=3:7, readPos=3:8}]
2024-02-05T18:12:27,040 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:39293/persistent/__change_events] Closing managed ledger
2024-02-05T18:12:27,040 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-9d37187f02] Successfully closed dispatcher for reader
2024-02-05T18:12:27,040 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:39293/__change_events, name=reader-f71e6c3679}, consumerId=3, consumerName=cf120, address=/127.0.0.1:52454}
2024-02-05T18:12:27,040 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,041 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:39293/__change_events][reader-f71e6c3679] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:39293/persistent/__change_events, cursor=reader-f71e6c3679, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:12:27,041 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,041 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:39293/__change_events][reader-f71e6c3679] Successfully closed dispatcher for reader
2024-02-05T18:12:27,041 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,041 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9d37187f02] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,042 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-0c2ec9f27f}, consumerId=2, consumerName=9898c, address=/127.0.0.1:52454}
2024-02-05T18:12:27,042 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6e91f43c0a] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,042 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:39293/__change_events] [reader-f71e6c3679] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,042 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-6e91f43c0a}, consumerId=1, consumerName=94cf7, address=/127.0.0.1:52454}
2024-02-05T18:12:27,042 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-0c2ec9f27f] Closed connection [id: 0xe7eaa4c5, L:/127.0.0.1:52454 ! R:localhost/127.0.0.1:36289] -- Will try again in 0.1 s
2024-02-05T18:12:27,044 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:12:27,044 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:39293/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:12:27,044 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:12:27,045 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:12:27,046 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:12:27,050 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:36289
2024-02-05T18:12:27,050 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:12:27,051 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:12:27,051 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:12:27,051 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:39293/__change_events] [reader-f71e6c3679] Closed Consumer (not connected)
2024-02-05T18:12:27,052 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-6e91f43c0a] Closed Consumer (not connected)
2024-02-05T18:12:27,052 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-0c2ec9f27f] Closed Consumer (not connected)
2024-02-05T18:12:27,052 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39293/__change_events with subscription name reader-f71e6c3679 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:39293/__change_events with subscription name reader-f71e6c3679 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:27,052 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-9d37187f02] Closed Consumer (not connected)
2024-02-05T18:12:27,052 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6e91f43c0a was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-6e91f43c0a was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:27,053 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-0c2ec9f27f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-0c2ec9f27f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:27,054 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9d37187f02 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-9d37187f02 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:12:27,057 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:12:27,057 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:12:27,057 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:12:27,057 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:12:27,058 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:12:27,058 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:27,059 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:12:27,060 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:28,443 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:12:28,443 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:12:28,445 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:12:28,445 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:28,446 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:12:28,446 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:12:28,453 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:12:28,453 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:12:28,457 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:12:28,457 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:12:28,458 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:12:28,458 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:12:28,458 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:12:28,458 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:12:28,459 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:12:28,459 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:12:28,459 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:12:28,459 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:12:28,459 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:12:28,460 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:12:28,460 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@279063c7
2024-02-05T18:12:28,460 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:12:28,461 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:12:28,461 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.008 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  54.330 s
[INFO] Finished at: 2024-02-05T18:12:28+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 5 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:12:57,979 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:12:58,921 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:12:58,922 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:12:59,420 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:12:59,421 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:12:59,422 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:12:59,423 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:12:59,423 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:12:59,424 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:12:59,456 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:12:59,456 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:12:59,457 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:12:59,458 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:12:59,458 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:12:59,459 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:12:59,459 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:12:59,460 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:12:59,464 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:12:59,464 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:12:59,465 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:12:59,465 - INFO  - [main:Environment@98] - Client environment:os.memory.total=128MB
2024-02-05T18:13:01,254 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:13:01,255 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:13:01,255 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:13:01,256 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:13:01,618 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:13:01,620 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:13:01,715 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:13:01,812 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:13:01,815 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:13:01,830 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:13:01,945 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:13:01,993 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:13:02,042 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:13:02,378 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:13:02,383 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:13:02,421 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:13:02,502 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:35459, TLS: (none), listener: (none)
2024-02-05T18:13:02,775 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37613, TLS: OPENSSL, listener: (none)
2024-02-05T18:13:02,796 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:13:02,800 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:13:02,800 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:13:02,825 - INFO  - [main:Log@170] - Logging initialized @7067ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:13:03,567 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:13:03,608 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:13:03,609 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:13:03,612 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:13:04,425 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:13:05,596 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:13:06,899 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:13:07,296 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:13:07,450 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:13:07,568 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:13:07,569 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:13:07,572 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:13:07,593 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:33529}
2024-02-05T18:13:07,760 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:45093}
2024-02-05T18:13:07,760 - INFO  - [main:Server@415] - Started @12003ms
2024-02-05T18:13:07,760 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:33529
2024-02-05T18:13:07,764 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45093
2024-02-05T18:13:07,772 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:13:07,773 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:13:07,980 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:33529
2024-02-05T18:13:07,999 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:13:08,003 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:33529 is changing the role from null to Leader
2024-02-05T18:13:08,006 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33529).
2024-02-05T18:13:08,318 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:33529 
2024-02-05T18:13:08,751 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:13:08,776 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:08,884 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:13:08,889 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:13:08,901 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:13:08,904 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:13:08,942 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:13:08,974 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:13:08,999 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:13:09,062 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:13:09,084 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:13:09,095 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:13:09,098 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:13:09,127 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:13:09,131 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:08 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 495
2024-02-05T18:13:09,284 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]] Connected to server
2024-02-05T18:13:09,318 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:37120] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:13:09,367 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,374 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,423 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:13:09,453 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37120] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:37120, producerName=test-0-0, producerId=0}
2024-02-05T18:13:09,461 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,463 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:13:09,521 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,523 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c2e26dfcc] Subscribing to topic on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459], consumerId 0
2024-02-05T18:13:09,533 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7e41f9ee, L:/127.0.0.1:35459 - R:/127.0.0.1:37120]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4c2e26dfcc. consumerId: 0
2024-02-05T18:13:09,564 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c2e26dfcc] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:09,566 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:13:09,566 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4c2e26dfcc, ackPos=3:-1, readPos=3:0}
2024-02-05T18:13:09,584 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37120] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4c2e26dfcc
2024-02-05T18:13:09,590 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c2e26dfcc] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 0
2024-02-05T18:13:09,602 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:13:09,603 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:13:09,605 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:13:09,605 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:13:09,650 - INFO  - [pulsar-web-30-2:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,672 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:13:09,674 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:13:09,676 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:13:09,678 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 59
2024-02-05T18:13:09,689 - INFO  - [pulsar-web-30-7:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,698 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:13:09,700 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:13:09,701 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:09 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:13:09,702 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:13:09,727 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,729 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,740 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:13:09,747 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37120] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:37120, producerName=test-0-1, producerId=1}
2024-02-05T18:13:09,748 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,765 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,767 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d7473a21d3] Subscribing to topic on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459], consumerId 1
2024-02-05T18:13:09,771 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7e41f9ee, L:/127.0.0.1:35459 - R:/127.0.0.1:37120]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d7473a21d3. consumerId: 1
2024-02-05T18:13:09,794 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d7473a21d3] Created new subscription for 1
2024-02-05T18:13:09,796 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37120] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-d7473a21d3
2024-02-05T18:13:09,797 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-d7473a21d3] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 1
2024-02-05T18:13:09,819 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,821 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,829 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:13:09,838 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:37120] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:37120, producerName=test-0-2, producerId=2}
2024-02-05T18:13:09,839 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:09,858 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:13:09,885 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:13:09,893 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:33529 started the ownership monitor.
2024-02-05T18:13:09,912 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:09,914 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-aa5479a72c] Subscribing to topic on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459], consumerId 2
2024-02-05T18:13:09,916 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7e41f9ee, L:/127.0.0.1:35459 - R:/127.0.0.1:37120]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-aa5479a72c. consumerId: 2
2024-02-05T18:13:09,932 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-aa5479a72c] Created new subscription for 2
2024-02-05T18:13:09,933 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37120] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-aa5479a72c
2024-02-05T18:13:09,934 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-aa5479a72c] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 2
2024-02-05T18:13:09,935 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:33529 plays the leader now.
2024-02-05T18:13:09,943 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.49%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.49%, msgThroughputEMA= 0.00, updatedAt= 1707149589942, reportedAt= 0
2024-02-05T18:13:09,947 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:33529/__change_events
2024-02-05T18:13:09,964 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:13:09,973 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:09,974 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:13:10,047 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:33529/0x00000000_0xffffffff - localhost:33529.
2024-02-05T18:13:10,050 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:33529
2024-02-05T18:13:10,051 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:33529/0x00000000_0xffffffff - localhost:33529.
2024-02-05T18:13:10,051 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:33529/0x00000000_0xffffffff
2024-02-05T18:13:10,052 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:33529
2024-02-05T18:13:10,053 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:33529/0x00000000_0xffffffff
2024-02-05T18:13:10,060 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:33529/__change_events][reader-f792ac4208] Subscribing to topic on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459], consumerId 3
2024-02-05T18:13:10,063 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7e41f9ee, L:/127.0.0.1:35459 - R:/127.0.0.1:37120]] Subscribing on topic persistent://sla-monitor/test/localhost:33529/__change_events / reader-f792ac4208. consumerId: 3
2024-02-05T18:13:10,073 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:33529 doesn't exist.
2024-02-05T18:13:10,086 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:33529/persistent/__change_events
2024-02-05T18:13:10,089 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:33529/persistent/__change_events'
2024-02-05T18:13:10,097 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:13:10,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:33529/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:13:10,109 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:33529/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:13:10,115 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:33529/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:13:10,120 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:33529/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:33529/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:13:10,121 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:33529/__change_events - dedup is disabled
2024-02-05T18:13:10,129 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:13:10,146 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:33529/__change_events][reader-f792ac4208] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:10,147 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:33529/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:13:10,147 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:33529/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33529/persistent/__change_events, cursor=reader-f792ac4208, ackPos=7:-1, readPos=7:0}
2024-02-05T18:13:10,155 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:37120] Created subscription on topic persistent://sla-monitor/test/localhost:33529/__change_events / reader-f792ac4208
2024-02-05T18:13:10,156 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:33529/__change_events][reader-f792ac4208] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 3
2024-02-05T18:13:10,092 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 33529, tls-port = Optional[45093], broker url= pulsar://localhost:35459, broker tls url= pulsar+ssl://localhost:37613, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[35459], brokerServicePortTls=Optional[37613], webServicePort=Optional[33529], webServicePortTls=Optional[45093], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:13:10,745 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:13:10,745 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:13:10,745 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:13:10,746 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:13:10,751 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:13:10,751 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:13:10,756 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:13:10,762 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:13:10,773 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:13:10,774 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:13:10,782 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:13:10,789 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:13:10,792 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:13:10,799 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:13:10,800 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:13:10,807 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:13:10,811 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46699, TLS: (none), listener: (none)
2024-02-05T18:13:10,813 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:46455, TLS: OPENSSL, listener: (none)
2024-02-05T18:13:10,817 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:13:10,818 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:13:10,819 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:13:10,833 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:13:10,836 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:13:10,836 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:13:10,837 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:13:10,918 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/,null,AVAILABLE}
2024-02-05T18:13:10,975 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:10,976 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:13:11,598 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin,null,AVAILABLE}
2024-02-05T18:13:11,976 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:11,977 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:13:12,962 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,AVAILABLE}
2024-02-05T18:13:12,978 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:12,978 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:13:13,186 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,AVAILABLE}
2024-02-05T18:13:13,264 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,AVAILABLE}
2024-02-05T18:13:13,356 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/topics,null,AVAILABLE}
2024-02-05T18:13:13,357 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,AVAILABLE}
2024-02-05T18:13:13,357 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@328446e1{/static,null,AVAILABLE}
2024-02-05T18:13:13,359 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:40987}
2024-02-05T18:13:13,376 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:44555}
2024-02-05T18:13:13,377 - INFO  - [main:Server@415] - Started @17620ms
2024-02-05T18:13:13,377 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:40987
2024-02-05T18:13:13,379 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44555
2024-02-05T18:13:13,382 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:13:13,382 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:13:13,397 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:40987
2024-02-05T18:13:13,400 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:40987 registry has been created.
2024-02-05T18:13:13,400 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:40987. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:13:13,404 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:40987 is changing the role from null to Follower
2024-02-05T18:13:13,409 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:33529).
2024-02-05T18:13:13,423 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:13:13,447 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:40987 
2024-02-05T18:13:13,550 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 46
2024-02-05T18:13:13,564 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:13,566 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:13:13,567 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:13:13,579 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:13:13,583 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40987/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:13:13,591 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xb34c8af1, L:/127.0.0.1:35462 - R:localhost/127.0.0.1:46699]] Connected to server
2024-02-05T18:13:13,596 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:35462] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:13:13,611 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]] Connected to server
2024-02-05T18:13:13,614 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:54136] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:13:13,614 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,625 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:54136] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:54136, producerName=test-0-3, producerId=0}
2024-02-05T18:13:13,627 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,639 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-15bbaf18ba] Subscribing to topic on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459], consumerId 0
2024-02-05T18:13:13,641 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x02eef959, L:/127.0.0.1:35459 - R:/127.0.0.1:54136]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-15bbaf18ba. consumerId: 0
2024-02-05T18:13:13,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-15bbaf18ba] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:13,645 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:13:13,646 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-15bbaf18ba, ackPos=3:-1, readPos=3:0}
2024-02-05T18:13:13,648 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54136] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-15bbaf18ba
2024-02-05T18:13:13,649 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-15bbaf18ba] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 0
2024-02-05T18:13:13,651 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.001 seconds
2024-02-05T18:13:13,652 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:13:13,670 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:13:13,679 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:13,684 - ERROR - [pulsar-web-30-6:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:13:13,685 - ERROR - [pulsar-web-30-6:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:13:13,690 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40987/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:13:13,691 - INFO  - [pulsar-web-30-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:13:13,701 - INFO  - [pulsar-web-84-4:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:13:13,708 - INFO  - [pulsar-web-30-2:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:13,710 - ERROR - [pulsar-web-30-2:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:13:13,711 - ERROR - [pulsar-web-30-2:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:13:13,714 - INFO  - [pulsar-web-30-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:13:13,715 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:40987/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:13:13,729 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,736 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:54136] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:54136, producerName=test-0-4, producerId=1}
2024-02-05T18:13:13,738 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,749 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-95854cb61c] Subscribing to topic on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459], consumerId 1
2024-02-05T18:13:13,751 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x02eef959, L:/127.0.0.1:35459 - R:/127.0.0.1:54136]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-95854cb61c. consumerId: 1
2024-02-05T18:13:13,760 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-95854cb61c] Created new subscription for 1
2024-02-05T18:13:13,760 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:54136] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-95854cb61c
2024-02-05T18:13:13,761 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-95854cb61c] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 1
2024-02-05T18:13:13,775 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,783 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:54136] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:54136, producerName=test-0-5, producerId=2}
2024-02-05T18:13:13,784 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0xd7687cd7, L:/127.0.0.1:54136 - R:localhost/127.0.0.1:35459]
2024-02-05T18:13:13,785 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:13:13,788 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:13:13,790 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:40987 plays a follower now.
2024-02-05T18:13:13,809 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:40987/__change_events
2024-02-05T18:13:13,828 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:40987/0x00000000_0xffffffff - localhost:40987.
2024-02-05T18:13:13,829 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:40987
2024-02-05T18:13:13,829 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:40987/0x00000000_0xffffffff
2024-02-05T18:13:13,830 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:40987/0x00000000_0xffffffff - localhost:40987.
2024-02-05T18:13:13,831 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:40987
2024-02-05T18:13:13,831 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:40987/0x00000000_0xffffffff
2024-02-05T18:13:13,834 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:40987 doesn't exist.
2024-02-05T18:13:13,839 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:40987/__change_events][reader-0abfbcf130] Subscribing to topic on cnx [id: 0xb34c8af1, L:/127.0.0.1:35462 - R:localhost/127.0.0.1:46699], consumerId 2
2024-02-05T18:13:13,841 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xea3013d8, L:/127.0.0.1:46699 - R:/127.0.0.1:35462]] Subscribing on topic persistent://sla-monitor/test/localhost:40987/__change_events / reader-0abfbcf130. consumerId: 2
2024-02-05T18:13:13,839 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 40987, tls-port = Optional[44555], broker url= pulsar://localhost:46699, broker tls url= pulsar+ssl://localhost:46455, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[46699], brokerServicePortTls=Optional[46455], webServicePort=Optional[40987], webServicePortTls=Optional[44555], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:13:13,854 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:40987/persistent/__change_events
2024-02-05T18:13:13,856 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:40987/persistent/__change_events'
2024-02-05T18:13:13,866 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:13:13,868 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:40987/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:13:13,872 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:40987/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:13:13,877 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:40987/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:13:13,896 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:40987/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:40987/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:13:13,897 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:40987/__change_events - dedup is disabled
2024-02-05T18:13:13,904 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:13:13,979 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:13:13,980 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:13:13,982 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:40987/__change_events][reader-0abfbcf130] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:13,983 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:40987/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:13:13,983 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:40987/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40987/persistent/__change_events, cursor=reader-0abfbcf130, ackPos=9:-1, readPos=9:0}
2024-02-05T18:13:13,985 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:35462] Created subscription on topic persistent://sla-monitor/test/localhost:40987/__change_events / reader-0abfbcf130
2024-02-05T18:13:13,986 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:40987/__change_events][reader-0abfbcf130] Subscribed to topic on localhost/127.0.0.1:46699 -- consumer: 2
2024-02-05T18:13:14,049 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:13:14,050 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:13:14,079 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:13:14,081 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:13:14,104 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:13:14,104 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:13:14,109 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:13:14,114 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:13:14,140 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:13:14,140 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:13:14,141 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:13:14,142 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:13:14,144 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:13:14,144 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:13:14,154 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:13:14,154 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:13:14,159 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:13:14,160 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:13:14,171 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:13:14,172 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:13:14,173 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:13:14,174 - INFO  - [pulsar-62-1:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:13:14,176 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 11
2024-02-05T18:13:14,179 - INFO  - [pulsar-7-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:13:14,216 - INFO  - [pulsar-web-30-8:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:13:14,229 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:13:14,229 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:13:14,242 - INFO  - [pulsar-web-30-6:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:13:14,252 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:14,267 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:33529 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:13:14,316 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:33529, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594268, versionId=1]. totalHandledRequests:1
2024-02-05T18:13:14,348 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33529, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594334, versionId=2]. totalHandledRequests:1
2024-02-05T18:13:14,351 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:14,371 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:13:14,379 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:13:14,387 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:13:14,408 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33529, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149594360, versionId=3]. totalHandledRequests:1
2024-02-05T18:13:14,414 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:14,416 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:13:14,427 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33529, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594408, versionId=4]. totalHandledRequests:1
2024-02-05T18:13:14,428 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:13:14,429 - INFO  - [broker-client-shared-internal-executor-11-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:13:14,430 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 191
2024-02-05T18:13:14,430 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33529. Skipping this broker. Phase one
2024-02-05T18:13:14,431 - WARN  - [ForkJoinPool.commonPool-worker-2:LeastResourceUsageWithWeight@126] - There is no broker load data for broker:localhost:33529. Skipping this broker. Phase two
2024-02-05T18:13:14,431 - INFO  - [ForkJoinPool.commonPool-worker-2:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:40987 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:13:14,431 - INFO  - [AsyncHttpClient-37-1:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:13:14,432 - INFO  - [AsyncHttpClient-37-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:13:14 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 220
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:13:14,444 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:40987, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594431, versionId=5]. totalHandledRequests:2
2024-02-05T18:13:14,458 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:13:14,465 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:40987, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594444, versionId=6]. totalHandledRequests:2
2024-02-05T18:13:14,511 - INFO  - [pulsar-io-9-1:ConnectionPool@265] - [[id: 0xf32a4f27, L:/127.0.0.1:35464 - R:localhost/127.0.0.1:46699]] Connected to server
2024-02-05T18:13:14,515 - INFO  - [pulsar-io-64-2:ServerCnx@724] - [/127.0.0.1:35464] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:13:14,516 - INFO  - [pulsar-io-9-1:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-26aac2835a] Subscribing to topic on cnx [id: 0xf32a4f27, L:/127.0.0.1:35464 - R:localhost/127.0.0.1:46699], consumerId 4
2024-02-05T18:13:14,521 - INFO  - [pulsar-io-64-2:ServerCnx@1173] - [[id: 0x18d5bdc4, L:/127.0.0.1:46699 - R:/127.0.0.1:35464]] Subscribing on topic persistent://public/test/__change_events / reader-26aac2835a. consumerId: 4
2024-02-05T18:13:14,534 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24] 
2024-02-05T18:13:14,536 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447] 
2024-02-05T18:13:14,542 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:13:14,543 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@457a6aff], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7eb07cb4] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@6eb65486, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@186a914b, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1315bb5e, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4725aac4, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@68bc3947, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@457a6aff, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@77cf0424], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@707d0f24, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4fdbc447, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b898237, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@564da79b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2f63865d, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7eb07cb4, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@442d35ee] 
2024-02-05T18:13:14,551 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:13:14,555 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:13:14,557 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:13:14,558 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-719ec470cd] Subscribing to topic on cnx [id: 0xb34c8af1, L:/127.0.0.1:35462 - R:localhost/127.0.0.1:46699], consumerId 3
2024-02-05T18:13:14,560 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0xea3013d8, L:/127.0.0.1:46699 - R:/127.0.0.1:35462]] Subscribing on topic persistent://public/test/__change_events / reader-719ec470cd. consumerId: 3
2024-02-05T18:13:14,560 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:13:14,570 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:13:14,578 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-26aac2835a] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:14,583 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:13:14,584 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-26aac2835a, ackPos=11:-1, readPos=11:0}
2024-02-05T18:13:14,589 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:35464] Created subscription on topic persistent://public/test/__change_events / reader-26aac2835a
2024-02-05T18:13:14,592 - INFO  - [pulsar-io-9-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-26aac2835a] Subscribed to topic on localhost/127.0.0.1:46699 -- consumer: 4
2024-02-05T18:13:14,595 - INFO  - [pulsar-io-64-2:ServerCnx@2007] - [/127.0.0.1:35464] Closing consumer: consumerId=4
2024-02-05T18:13:14,596 - INFO  - [pulsar-io-64-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-26aac2835a}, consumerId=4, consumerName=42fec, address=/127.0.0.1:35464}
2024-02-05T18:13:14,597 - INFO  - [pulsar-io-64-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-26aac2835a] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-26aac2835a, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:13:14,598 - INFO  - [pulsar-io-64-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-26aac2835a] Successfully closed dispatcher for reader
2024-02-05T18:13:14,607 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-719ec470cd] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:14,608 - INFO  - [pulsar-io-64-2:ServerCnx@2043] - [/127.0.0.1:35464] Closed consumer, consumerId=4
2024-02-05T18:13:14,615 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:13:14,615 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:13:14,616 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-719ec470cd, ackPos=11:-1, readPos=11:0}
2024-02-05T18:13:14,618 - INFO  - [pulsar-io-9-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-26aac2835a] Closed consumer
2024-02-05T18:13:14,618 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:35462] Created subscription on topic persistent://public/test/__change_events / reader-719ec470cd
2024-02-05T18:13:14,620 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-719ec470cd] Subscribed to topic on localhost/127.0.0.1:46699 -- consumer: 3
2024-02-05T18:13:14,620 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:13:14,627 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2b7b6f58{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:13:14,628 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@44cd3ea9{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:13:14,629 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:13:14,630 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@328446e1{/static,null,STOPPED}
2024-02-05T18:13:14,631 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/metrics,null,STOPPED}
2024-02-05T18:13:14,638 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/topics,null,STOPPED}
2024-02-05T18:13:14,641 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/lookup,null,STOPPED}
2024-02-05T18:13:14,646 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3f96ef2{/admin/v3,null,STOPPED}
2024-02-05T18:13:14,649 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/admin/v2,null,STOPPED}
2024-02-05T18:13:14,652 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin,null,STOPPED}
2024-02-05T18:13:14,654 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/,null,STOPPED}
2024-02-05T18:13:14,659 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:13:14,661 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:13:14,661 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:13:14,663 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:14,669 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:33529. Skipping this broker. Phase one
2024-02-05T18:13:14,669 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:40987, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149594444, versionId=6] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33529, sourceBroker=localhost:40987, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149594669, versionId=7]
2024-02-05T18:13:14,680 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:33529, sourceBroker=localhost:40987, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149594669, versionId=7]. totalHandledRequests:6
2024-02-05T18:13:14,680 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:33529 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:33529, sourceBroker=localhost:40987, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149594669, versionId=7], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:13:14,681 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:13:14,683 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:13:14,685 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:13:14,686 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:13:14,687 - INFO  - [broker-client-shared-internal-executor-65-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-719ec470cd}, consumerId=3, consumerName=5f060, address=/127.0.0.1:35462}
2024-02-05T18:13:14,688 - INFO  - [broker-client-shared-internal-executor-65-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-719ec470cd}, consumerId=3, consumerName=5f060, address=/127.0.0.1:35462}
2024-02-05T18:13:14,689 - INFO  - [pulsar-io-64-2:ClientCnx@816] - [localhost/127.0.0.1:46699] Broker notification of Closed consumer: 3
2024-02-05T18:13:14,689 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-719ec470cd] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-719ec470cd, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:13:14,689 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-719ec470cd] Successfully closed dispatcher for reader
2024-02-05T18:13:14,689 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-719ec470cd] Closed connection [id: 0xb34c8af1, L:/127.0.0.1:35462 - R:localhost/127.0.0.1:46699] -- Will try again in 0.1 s
2024-02-05T18:13:14,690 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-719ec470cd] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-719ec470cd, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:13:14,690 - INFO  - [broker-client-shared-internal-executor-65-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-719ec470cd] Successfully disconnected and closed subscription
2024-02-05T18:13:14,693 - INFO  - [broker-client-shared-internal-executor-65-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:13:14,702 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:13:14,710 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:13:14,711 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-719ec470cd] Closed Consumer (not connected)
2024-02-05T18:13:14,712 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-719ec470cd was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-719ec470cd was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:14,722 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:13:14,722 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 39.0 ms
2024-02-05T18:13:14,724 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-7fb4d43d49] Subscribing to topic on cnx [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459], consumerId 5
2024-02-05T18:13:14,725 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x7e41f9ee, L:/127.0.0.1:35459 - R:/127.0.0.1:37120]] Subscribing on topic persistent://public/test/__change_events / reader-7fb4d43d49. consumerId: 5
2024-02-05T18:13:14,736 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:13:14,743 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:13:14,743 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:13:14,753 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:13:14,759 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:13:14,760 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:13:14,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:13:14,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:13:14,764 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:13:14,770 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:13:14,777 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-7fb4d43d49] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:13:14,778 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:13:14,778 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7fb4d43d49, ackPos=13:-1, readPos=13:0}
2024-02-05T18:13:14,780 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:37120] Created subscription on topic persistent://public/test/__change_events / reader-7fb4d43d49
2024-02-05T18:13:14,781 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-7fb4d43d49] Subscribed to topic on localhost/127.0.0.1:35459 -- consumer: 5
2024-02-05T18:13:14,791 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://public/test/__change_events] [reader-719ec470cd] Reconnecting after timeout
2024-02-05T18:13:14,792 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@83] - [persistent://public/test/__change_events] [reader-719ec470cd] Ignoring reconnection request (state: Closed)
2024-02-05T18:13:14,880 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:13:14,881 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 41.41%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 41.41%, msgThroughputEMA= 0.00, updatedAt= 1707149594880, reportedAt= 0
2024-02-05T18:13:14,980 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:13:14,981 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:13:15,981 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:13:15,982 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:13:16,982 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:13:16,983 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:13:17,782 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 3117.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:13:17,788 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:40987 was invalidated. state Releasing
2024-02-05T18:13:17,788 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:40987 registry has been deleted.
2024-02-05T18:13:17,788 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:13:17,793 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:40987. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:13:17,793 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:13:17,794 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:17,794 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:40987
2024-02-05T18:13:17,795 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:13:17,803 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:40987/0x00000000_0xffffffff.
2024-02-05T18:13:17,805 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:40987/0x00000000_0xffffffff.
2024-02-05T18:13:17,806 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:40987/0x00000000_0xffffffff.
2024-02-05T18:13:17,806 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.012 seconds
2024-02-05T18:13:17,808 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:13:17,812 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:35462
2024-02-05T18:13:17,813 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] Disconnected
2024-02-05T18:13:17,813 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:40987/__change_events, name=reader-0abfbcf130}, consumerId=2, consumerName=a01e4, address=/127.0.0.1:35462}
2024-02-05T18:13:17,813 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xb34c8af1, L:/127.0.0.1:35462 ! R:localhost/127.0.0.1:46699] Disconnected
2024-02-05T18:13:17,813 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:40987/__change_events][reader-0abfbcf130] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40987/persistent/__change_events, cursor=reader-0abfbcf130, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:13:17,814 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:40987/__change_events][reader-0abfbcf130] Successfully closed dispatcher for reader
2024-02-05T18:13:17,815 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:17,816 - INFO  - [pulsar-io-9-1:ClientCnx@308] - [id: 0xf32a4f27, L:/127.0.0.1:35464 ! R:localhost/127.0.0.1:46699] Disconnected
2024-02-05T18:13:17,816 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:40987/__change_events] [reader-0abfbcf130] Closed connection [id: 0xb34c8af1, L:/127.0.0.1:35462 ! R:localhost/127.0.0.1:46699] -- Will try again in 0.1 s
2024-02-05T18:13:17,817 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:54136
2024-02-05T18:13:17,818 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-15bbaf18ba}, consumerId=0, consumerName=4408c, address=/127.0.0.1:54136}
2024-02-05T18:13:17,819 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-15bbaf18ba] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-15bbaf18ba, ackPos=3:6, readPos=3:7}]
2024-02-05T18:13:17,819 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-15bbaf18ba] Successfully closed dispatcher for reader
2024-02-05T18:13:17,820 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-95854cb61c}, consumerId=1, consumerName=1c2fc, address=/127.0.0.1:54136}
2024-02-05T18:13:17,821 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:35464
2024-02-05T18:13:17,818 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:17,822 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:17,823 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-15bbaf18ba] Closed connection [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:17,823 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:13:17,823 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-95854cb61c] Closed connection [id: 0xd7687cd7, L:/127.0.0.1:54136 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:17,823 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:40987/persistent/__change_events] Closing managed ledger
2024-02-05T18:13:17,826 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:40987/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:13:17,827 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:13:17,828 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:13:17,830 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:13:17,837 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:46699
2024-02-05T18:13:17,838 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:13:17,840 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:13:17,840 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:13:17,841 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-15bbaf18ba] Closed Consumer (not connected)
2024-02-05T18:13:17,842 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-95854cb61c] Closed Consumer (not connected)
2024-02-05T18:13:17,842 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-15bbaf18ba was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-15bbaf18ba was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:17,843 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:40987/__change_events] [reader-0abfbcf130] Closed Consumer (not connected)
2024-02-05T18:13:17,843 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-95854cb61c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-95854cb61c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:17,843 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40987/__change_events with subscription name reader-0abfbcf130 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40987/__change_events with subscription name reader-0abfbcf130 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:17,850 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:13:17,850 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:13:17,853 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:13:17,853 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:17,860 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:13:17,860 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:17,989 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:17,989 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:13:17,990 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:13:17,990 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40987]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:13:17,990 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:17,991 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:13:18,991 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:18,991 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:13:18,992 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:13:18,992 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40987]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:13:18,992 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:18,993 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:13:19,127 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:13:19,128 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:13:19,131 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:13:19,131 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:19,131 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:13:19,132 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:13:19,880 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 42.97%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 41.56%, msgThroughputEMA= 0.00, updatedAt= 1707149599879, reportedAt= 1707149594886
2024-02-05T18:13:19,992 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:19,993 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:13:19,993 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:13:19,993 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40987]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:13:19,994 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:19,995 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:13:20,994 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:13:20,994 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:40987 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:13:20,995 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:40987 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:13:20,995 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:40987]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:13:20,995 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40987
2024-02-05T18:13:20,996 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40987 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:13:21,145 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:13:21,146 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:13:21,146 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:13:21,146 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:13:21,147 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:13:21,147 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:13:21,148 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:13:21,149 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:13:21,151 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:13:21,152 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:13:21,153 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:13:21,155 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:13:21,157 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:13:21,157 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:13:21,157 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:13:21,158 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:33529
2024-02-05T18:13:21,160 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:33529, sourceBroker=localhost:40987, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149594669, versionId=7]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:13:26,170 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:33529 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt10, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:13:26,179 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:33529 was invalidated. state Releasing
2024-02-05T18:13:26,179 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:33529. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:13:26,180 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:33529
2024-02-05T18:13:26,183 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:33529/0x00000000_0xffffffff.
2024-02-05T18:13:26,192 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:33529, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149606184, versionId=8]. totalHandledRequests:10
2024-02-05T18:13:26,192 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:13:26,193 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7fb4d43d49}, consumerId=5, consumerName=e3f7a, address=/127.0.0.1:37120}
2024-02-05T18:13:26,193 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-7fb4d43d49}, consumerId=5, consumerName=e3f7a, address=/127.0.0.1:37120}
2024-02-05T18:13:26,193 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7fb4d43d49] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7fb4d43d49, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:13:26,193 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:35459] Broker notification of Closed consumer: 5
2024-02-05T18:13:26,193 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-7fb4d43d49] Successfully closed dispatcher for reader
2024-02-05T18:13:26,193 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-7fb4d43d49] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 - R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-7fb4d43d49] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-7fb4d43d49, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:13:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-7fb4d43d49] Successfully disconnected and closed subscription
2024-02-05T18:13:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:13:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:13:26,194 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:13:26,199 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:13:26,200 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:13:26,200 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-7fb4d43d49] Closed Consumer (not connected)
2024-02-05T18:13:26,201 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 8.0 ms
2024-02-05T18:13:26,201 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7fb4d43d49 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-7fb4d43d49 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:26,209 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:33529 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:33529, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149606192, versionId=9]. totalHandledRequests:4
2024-02-05T18:13:26,209 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:13:26,209 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:13:26,211 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:33529/0x00000000_0xffffffff.
2024-02-05T18:13:26,211 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:13:26,212 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:33529/0x00000000_0xffffffff.
2024-02-05T18:13:26,212 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.032 seconds
2024-02-05T18:13:26,213 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:13:26,213 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:37120
2024-02-05T18:13:26,214 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-4c2e26dfcc}, consumerId=0, consumerName=34386, address=/127.0.0.1:37120}
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] Disconnected
2024-02-05T18:13:26,214 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c2e26dfcc] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4c2e26dfcc, ackPos=3:6, readPos=3:9}]
2024-02-05T18:13:26,214 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:33529/persistent/__change_events] Closing managed ledger
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4c2e26dfcc] Successfully closed dispatcher for reader
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,214 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4c2e26dfcc] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d7473a21d3] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:33529/__change_events, name=reader-f792ac4208}, consumerId=3, consumerName=5678f, address=/127.0.0.1:37120}
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:33529/__change_events] [reader-f792ac4208] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-aa5479a72c] Closed connection [id: 0xe750a771, L:/127.0.0.1:37120 ! R:localhost/127.0.0.1:35459] -- Will try again in 0.1 s
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:33529/__change_events][reader-f792ac4208] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:33529/persistent/__change_events, cursor=reader-f792ac4208, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:13:26,215 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:33529/__change_events][reader-f792ac4208] Successfully closed dispatcher for reader
2024-02-05T18:13:26,216 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-aa5479a72c}, consumerId=2, consumerName=a2d2b, address=/127.0.0.1:37120}
2024-02-05T18:13:26,216 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-d7473a21d3}, consumerId=1, consumerName=20fd0, address=/127.0.0.1:37120}
2024-02-05T18:13:26,219 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:13:26,219 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:33529/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:13:26,219 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:13:26,219 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:13:26,220 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:13:26,224 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:35459
2024-02-05T18:13:26,224 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:13:26,224 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:13:26,224 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:13:26,224 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-aa5479a72c] Closed Consumer (not connected)
2024-02-05T18:13:26,225 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:33529/__change_events] [reader-f792ac4208] Closed Consumer (not connected)
2024-02-05T18:13:26,225 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4c2e26dfcc] Closed Consumer (not connected)
2024-02-05T18:13:26,225 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-d7473a21d3] Closed Consumer (not connected)
2024-02-05T18:13:26,225 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-aa5479a72c was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-aa5479a72c was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:26,225 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33529/__change_events with subscription name reader-f792ac4208 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:33529/__change_events with subscription name reader-f792ac4208 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:26,226 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4c2e26dfcc was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4c2e26dfcc was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:26,226 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d7473a21d3 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-d7473a21d3 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:13:26,230 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:13:26,230 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:13:26,230 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:13:26,231 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:13:26,232 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:13:26,232 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:26,234 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:13:26,234 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:27,620 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:13:27,620 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:13:27,621 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:13:27,622 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:27,622 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:13:27,622 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:13:27,630 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:13:27,630 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:13:27,634 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:13:27,634 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-2,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:13:27,634 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:13:27,635 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 9 new threads
2024-02-05T18:13:27,635 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:13:27,635 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@279063c7
2024-02-05T18:13:27,635 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:13:27,635 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:13:27,635 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.453 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  55.881 s
[INFO] Finished at: 2024-02-05T18:13:28+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 6 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:13:57,521 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:13:58,519 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:13:58,521 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:13:58,938 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:13:58,939 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:13:58,940 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:13:58,940 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:13:58,941 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:13:58,942 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:13:58,956 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:13:58,957 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:13:58,958 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:13:58,958 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:13:58,959 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:13:58,960 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:13:58,960 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:13:58,961 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:13:58,961 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:13:58,962 - INFO  - [main:Environment@98] - Client environment:os.memory.free=24MB
2024-02-05T18:13:58,962 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:13:58,962 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:14:00,480 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:14:00,481 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:14:00,482 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:14:00,482 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:14:00,800 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:14:00,802 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:14:00,887 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:14:00,973 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:14:00,975 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:14:00,991 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:14:01,096 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:14:01,144 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:14:01,187 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:14:01,542 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:14:01,543 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:14:01,578 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:14:01,639 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45357, TLS: (none), listener: (none)
2024-02-05T18:14:01,932 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45707, TLS: OPENSSL, listener: (none)
2024-02-05T18:14:01,951 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:14:01,956 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:14:01,957 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:14:01,983 - INFO  - [main:Log@170] - Logging initialized @6542ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:14:02,935 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:14:02,965 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:14:02,966 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:14:02,968 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:14:03,693 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1978b0d5{/,null,AVAILABLE}
2024-02-05T18:14:04,860 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7c200e57{/admin,null,AVAILABLE}
2024-02-05T18:14:06,106 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,AVAILABLE}
2024-02-05T18:14:06,493 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,AVAILABLE}
2024-02-05T18:14:06,611 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,AVAILABLE}
2024-02-05T18:14:06,769 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/topics,null,AVAILABLE}
2024-02-05T18:14:06,771 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,AVAILABLE}
2024-02-05T18:14:06,773 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@6556471b{/static,null,AVAILABLE}
2024-02-05T18:14:06,794 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:45463}
2024-02-05T18:14:06,959 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:43173}
2024-02-05T18:14:06,960 - INFO  - [main:Server@415] - Started @11519ms
2024-02-05T18:14:06,960 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:45463
2024-02-05T18:14:06,961 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43173
2024-02-05T18:14:06,969 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:14:06,970 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:14:07,155 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:45463
2024-02-05T18:14:07,174 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:14:07,180 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:45463 is changing the role from null to Leader
2024-02-05T18:14:07,181 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45463).
2024-02-05T18:14:07,518 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:45463 
2024-02-05T18:14:07,911 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:14:07,939 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:08,042 - INFO  - [configuration-metadata-store-4-1:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:14:08,049 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:14:08,062 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:14:08,064 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:14:08,117 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:14:08,152 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:14:08,185 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:14:08,258 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:14:08,280 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:14:08,294 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:14:08,297 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:14:08,332 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:14:08,333 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:07 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 540
2024-02-05T18:14:08,500 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]] Connected to server
2024-02-05T18:14:08,537 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:50902] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:14:08,611 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:08,623 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:08,690 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:14:08,722 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50902] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50902, producerName=test-0-0, producerId=0}
2024-02-05T18:14:08,731 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:08,733 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:14:08,798 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:08,801 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4ce4a5d990] Subscribing to topic on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357], consumerId 0
2024-02-05T18:14:08,814 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf752ac75, L:/127.0.0.1:45357 - R:/127.0.0.1:50902]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4ce4a5d990. consumerId: 0
2024-02-05T18:14:08,854 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4ce4a5d990] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:08,855 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:14:08,856 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4ce4a5d990, ackPos=3:-1, readPos=3:0}
2024-02-05T18:14:08,881 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50902] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4ce4a5d990
2024-02-05T18:14:08,890 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4ce4a5d990] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 0
2024-02-05T18:14:08,906 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.015 seconds
2024-02-05T18:14:08,908 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:14:08,909 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:14:08,909 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:14:08,955 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:08,976 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:14:08,977 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:14:08,979 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 54
2024-02-05T18:14:08,979 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:14:08,992 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:09,000 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:14:09,001 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:14:09,002 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:08 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:14:09,003 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:14:09,026 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:09,028 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:09,035 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:14:09,042 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50902] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50902, producerName=test-0-1, producerId=1}
2024-02-05T18:14:09,044 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:09,062 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:09,064 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43161f7ec8] Subscribing to topic on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357], consumerId 1
2024-02-05T18:14:09,066 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf752ac75, L:/127.0.0.1:45357 - R:/127.0.0.1:50902]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-43161f7ec8. consumerId: 1
2024-02-05T18:14:09,091 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43161f7ec8] Created new subscription for 1
2024-02-05T18:14:09,092 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50902] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-43161f7ec8
2024-02-05T18:14:09,093 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-43161f7ec8] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 1
2024-02-05T18:14:09,112 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:09,113 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:09,120 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:14:09,128 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50902] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50902, producerName=test-0-2, producerId=2}
2024-02-05T18:14:09,129 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:09,144 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:14:09,161 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:14:09,165 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:45463 started the ownership monitor.
2024-02-05T18:14:09,182 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:09,184 - INFO  - [pulsar-load-manager-6-1:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79718fb625] Subscribing to topic on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357], consumerId 2
2024-02-05T18:14:09,186 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf752ac75, L:/127.0.0.1:45357 - R:/127.0.0.1:50902]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-79718fb625. consumerId: 2
2024-02-05T18:14:09,200 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79718fb625] Created new subscription for 2
2024-02-05T18:14:09,201 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50902] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-79718fb625
2024-02-05T18:14:09,202 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-79718fb625] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 2
2024-02-05T18:14:09,203 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:45463 plays the leader now.
2024-02-05T18:14:09,209 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.52%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.52%, msgThroughputEMA= 0.00, updatedAt= 1707149649208, reportedAt= 0
2024-02-05T18:14:09,229 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:45463/__change_events
2024-02-05T18:14:09,247 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:14:09,253 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:09,254 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:14:09,321 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:45463/0x00000000_0xffffffff - localhost:45463.
2024-02-05T18:14:09,324 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:45463/0x00000000_0xffffffff
2024-02-05T18:14:09,330 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:45463/__change_events][reader-6c1326556e] Subscribing to topic on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357], consumerId 3
2024-02-05T18:14:09,333 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf752ac75, L:/127.0.0.1:45357 - R:/127.0.0.1:50902]] Subscribing on topic persistent://sla-monitor/test/localhost:45463/__change_events / reader-6c1326556e. consumerId: 3
2024-02-05T18:14:09,333 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:45463
2024-02-05T18:14:09,335 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:45463/0x00000000_0xffffffff - localhost:45463.
2024-02-05T18:14:09,338 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:45463/0x00000000_0xffffffff
2024-02-05T18:14:09,339 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:45463
2024-02-05T18:14:09,343 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:45463/persistent/__change_events
2024-02-05T18:14:09,344 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:45463/persistent/__change_events'
2024-02-05T18:14:09,352 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:14:09,352 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:45463/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:14:09,359 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:45463/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:14:09,360 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:45463 doesn't exist.
2024-02-05T18:14:09,365 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:45463/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:14:09,370 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:45463/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:45463/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:14:09,371 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:45463/__change_events - dedup is disabled
2024-02-05T18:14:09,386 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:14:09,391 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:45463/__change_events][reader-6c1326556e] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:09,392 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:45463/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:14:09,392 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:45463/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45463/persistent/__change_events, cursor=reader-6c1326556e, ackPos=7:-1, readPos=7:0}
2024-02-05T18:14:09,394 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50902] Created subscription on topic persistent://sla-monitor/test/localhost:45463/__change_events / reader-6c1326556e
2024-02-05T18:14:09,395 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:45463/__change_events][reader-6c1326556e] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 3
2024-02-05T18:14:09,380 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 45463, tls-port = Optional[43173], broker url= pulsar://localhost:45357, broker tls url= pulsar+ssl://localhost:45707, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[45357], brokerServicePortTls=Optional[45707], webServicePort=Optional[45463], webServicePortTls=Optional[43173], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:14:09,952 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:14:09,952 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:14:09,952 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:14:09,953 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:14:09,958 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:14:09,958 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:14:09,965 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:14:09,971 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:14:09,977 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:14:09,977 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:14:09,984 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:14:09,991 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:14:09,995 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:14:10,001 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:14:10,001 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:14:10,006 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:14:10,009 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:43643, TLS: (none), listener: (none)
2024-02-05T18:14:10,011 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:42225, TLS: OPENSSL, listener: (none)
2024-02-05T18:14:10,014 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:14:10,016 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:14:10,016 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:14:10,043 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:14:10,050 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:14:10,050 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:14:10,051 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:14:10,181 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:14:10,255 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:10,255 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:14:10,747 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:14:11,257 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:11,257 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:14:11,838 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:14:12,070 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:14:12,153 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:14:12,239 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:14:12,241 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:14:12,241 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:14:12,243 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:36479}
2024-02-05T18:14:12,258 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:12,259 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:45451}
2024-02-05T18:14:12,259 - INFO  - [main:Server@415] - Started @16818ms
2024-02-05T18:14:12,259 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:14:12,259 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36479
2024-02-05T18:14:12,262 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:45451
2024-02-05T18:14:12,269 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:14:12,270 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:14:12,286 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36479
2024-02-05T18:14:12,288 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:36479 registry has been created.
2024-02-05T18:14:12,289 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:36479. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:14:12,292 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:36479 is changing the role from null to Follower
2024-02-05T18:14:12,296 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:45463).
2024-02-05T18:14:12,301 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:14:12,319 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36479 
2024-02-05T18:14:12,465 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 65
2024-02-05T18:14:12,489 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:12,491 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:14:12,493 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:14:12,506 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 35
2024-02-05T18:14:12,512 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36479/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:14:12,524 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x6074733a, L:/127.0.0.1:37250 - R:localhost/127.0.0.1:43643]] Connected to server
2024-02-05T18:14:12,529 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:37250] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:14:12,543 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]] Connected to server
2024-02-05T18:14:12,546 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:58006] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:14:12,547 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,558 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:58006] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:58006, producerName=test-0-3, producerId=0}
2024-02-05T18:14:12,560 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,573 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bca3229d17] Subscribing to topic on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357], consumerId 0
2024-02-05T18:14:12,575 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x34294b77, L:/127.0.0.1:45357 - R:/127.0.0.1:58006]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-bca3229d17. consumerId: 0
2024-02-05T18:14:12,581 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bca3229d17] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:12,581 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:14:12,582 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-bca3229d17, ackPos=3:-1, readPos=3:0}
2024-02-05T18:14:12,584 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58006] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-bca3229d17
2024-02-05T18:14:12,585 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bca3229d17] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 0
2024-02-05T18:14:12,588 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:14:12,589 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:14:12,608 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 15
2024-02-05T18:14:12,617 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:12,620 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:14:12,620 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:14:12,624 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:14:12,624 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36479/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:14:12,636 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:14:12,643 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:12,646 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:14:12,646 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:14:12,651 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36479/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:14:12,652 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:14:12,666 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,675 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:58006] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:58006, producerName=test-0-4, producerId=1}
2024-02-05T18:14:12,677 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,689 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-622678b655] Subscribing to topic on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357], consumerId 1
2024-02-05T18:14:12,691 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x34294b77, L:/127.0.0.1:45357 - R:/127.0.0.1:58006]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-622678b655. consumerId: 1
2024-02-05T18:14:12,701 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-622678b655] Created new subscription for 1
2024-02-05T18:14:12,701 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58006] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-622678b655
2024-02-05T18:14:12,702 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-622678b655] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 1
2024-02-05T18:14:12,718 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,726 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:58006] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:58006, producerName=test-0-5, producerId=2}
2024-02-05T18:14:12,727 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357]
2024-02-05T18:14:12,728 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:14:12,731 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:14:12,732 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:36479 plays a follower now.
2024-02-05T18:14:12,762 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36479/__change_events
2024-02-05T18:14:12,793 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36479/0x00000000_0xffffffff - localhost:36479.
2024-02-05T18:14:12,794 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36479/0x00000000_0xffffffff
2024-02-05T18:14:12,794 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36479
2024-02-05T18:14:12,795 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36479/0x00000000_0xffffffff - localhost:36479.
2024-02-05T18:14:12,796 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36479/0x00000000_0xffffffff
2024-02-05T18:14:12,797 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36479
2024-02-05T18:14:12,800 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36479 doesn't exist.
2024-02-05T18:14:12,803 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36479/__change_events][reader-28d5cb67ba] Subscribing to topic on cnx [id: 0x6074733a, L:/127.0.0.1:37250 - R:localhost/127.0.0.1:43643], consumerId 2
2024-02-05T18:14:12,805 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x267ae612, L:/127.0.0.1:43643 - R:/127.0.0.1:37250]] Subscribing on topic persistent://sla-monitor/test/localhost:36479/__change_events / reader-28d5cb67ba. consumerId: 2
2024-02-05T18:14:12,803 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 36479, tls-port = Optional[45451], broker url= pulsar://localhost:43643, broker tls url= pulsar+ssl://localhost:42225, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[43643], brokerServicePortTls=Optional[42225], webServicePort=Optional[36479], webServicePortTls=Optional[45451], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:14:12,812 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36479/persistent/__change_events
2024-02-05T18:14:12,815 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36479/persistent/__change_events'
2024-02-05T18:14:12,824 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:14:12,825 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36479/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:14:12,835 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36479/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:14:12,842 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36479/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:14:12,845 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36479/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36479/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:14:12,847 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36479/__change_events - dedup is disabled
2024-02-05T18:14:12,854 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:14:12,861 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36479/__change_events][reader-28d5cb67ba] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:12,861 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36479/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:14:12,862 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36479/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36479/persistent/__change_events, cursor=reader-28d5cb67ba, ackPos=9:-1, readPos=9:0}
2024-02-05T18:14:12,863 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:37250] Created subscription on topic persistent://sla-monitor/test/localhost:36479/__change_events / reader-28d5cb67ba
2024-02-05T18:14:12,864 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36479/__change_events][reader-28d5cb67ba] Subscribed to topic on localhost/127.0.0.1:43643 -- consumer: 2
2024-02-05T18:14:13,001 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:14:13,002 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:12 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:14:13,031 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:14:13,033 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 23
2024-02-05T18:14:13,051 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:14:13,051 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:14:13,056 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:14:13,060 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:14:13,082 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:14:13,082 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:14:13,082 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:14:13,084 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:14:13,086 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:14:13,088 - INFO  - [pulsar-7-5:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:14:13,096 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:14:13,096 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:14:13,101 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:14:13,102 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:14:13,113 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:14:13,114 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:14:13,114 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:14:13,115 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 7
2024-02-05T18:14:13,120 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:14:13,120 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:14:13,159 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:14:13,169 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:14:13,169 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:14:13,185 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:14:13,198 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:13,218 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36479 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:14:13,260 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:14:13,260 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:14:13,301 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:14:13,267 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36479, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653220, versionId=1]. totalHandledRequests:1
2024-02-05T18:14:13,311 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36479, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653267, versionId=2]. totalHandledRequests:1
2024-02-05T18:14:13,316 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:13,326 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 144
2024-02-05T18:14:13,345 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:14:13,347 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Subscribing to topic on cnx [id: 0x6074733a, L:/127.0.0.1:37250 - R:localhost/127.0.0.1:43643], consumerId 3
2024-02-05T18:14:13,349 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x267ae612, L:/127.0.0.1:43643 - R:/127.0.0.1:37250]] Subscribing on topic persistent://public/test/__change_events / reader-8b2f7f50ec. consumerId: 3
2024-02-05T18:14:13,356 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:14:13,360 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:14:13,369 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:14:13,370 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:14:13,376 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:14:13,380 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:14:13,383 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:14:13,383 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36479, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149653371, versionId=3]. totalHandledRequests:1
2024-02-05T18:14:13,387 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:14:13,387 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:14:13,389 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:14:13,390 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:14:13,392 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:14:13,404 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:14:13,404 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:14:13,411 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:14:13,414 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 28.0 ms
2024-02-05T18:14:13,424 - WARN  - [broker-client-shared-internal-executor-65-1:BrokerService@2212] - Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36479. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:14:13,424 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36479, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653385, versionId=4]. totalHandledRequests:1
2024-02-05T18:14:13,425 - WARN  - [broker-client-shared-internal-executor-65-1:ServerCnx@1299] - [/127.0.0.1:37250][persistent://public/test/__change_events][reader-8b2f7f50ec] Failed to create consumer: consumerId=3, Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36479. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:14:13,428 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:14:13,428 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x6074733a, L:/127.0.0.1:37250 - R:localhost/127.0.0.1:43643] Received error from server: Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36479. Please redo the lookup. Request is denied: namespace=public/test
2024-02-05T18:14:13,428 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:14:13,430 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:14:13,430 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Failed to subscribe to topic on localhost/127.0.0.1:43643
2024-02-05T18:14:13,431 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-8b2f7f50ec] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36479. Please redo the lookup. Request is denied: namespace=public/test","reqId":2579530239972164519, "remote":"localhost/127.0.0.1:43643", "local":"/127.0.0.1:37250"}
2024-02-05T18:14:13,432 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 277
2024-02-05T18:14:13,432 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-8b2f7f50ec] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Namespace bundle for topic (persistent://public/test/__change_events) not served by this instance:localhost:36479. Please redo the lookup. Request is denied: namespace=public/test","reqId":2579530239972164519, "remote":"localhost/127.0.0.1:43643", "local":"/127.0.0.1:37250"} -- Will try again in 0.1 s
2024-02-05T18:14:13,433 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:14:13 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 95
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@790fa53, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@195c5bb2, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@875b318, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2347d83c, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@329d9c00, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1bc54ac7, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7a88e52f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@48c31b67, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@837822f, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@58bd9952, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@17550081, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@65ee408, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242b0036, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8720d2] 
2024-02-05T18:14:13,535 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-8b2f7f50ec] Reconnecting after connection was closed
2024-02-05T18:14:13,547 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:36479. Skipping this broker. Phase one
2024-02-05T18:14:13,547 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:45463. Skipping this broker. Phase one
2024-02-05T18:14:13,547 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:45463 for bundle: public/test/0x00000000_0xffffffff.
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:14:13,555 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:45463, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653547, versionId=5]. totalHandledRequests:8
2024-02-05T18:14:13,565 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:14:13,570 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:45463, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653556, versionId=6]. totalHandledRequests:6
2024-02-05T18:14:13,573 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:14:13,573 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:14:13,573 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:14:13,574 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:14:13,575 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:14:13,578 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Subscribing to topic on cnx [id: 0x84dcdff5, L:/127.0.0.1:58006 - R:localhost/127.0.0.1:45357], consumerId 3
2024-02-05T18:14:13,579 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:14:13,583 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x34294b77, L:/127.0.0.1:45357 - R:/127.0.0.1:58006]] Subscribing on topic persistent://public/test/__change_events / reader-8b2f7f50ec. consumerId: 3
2024-02-05T18:14:13,589 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:14:13,592 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:14:13,592 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:14:13,593 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:14:13,595 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:14:13,598 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:14:13,601 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:14:13,604 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:14:13,606 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:14:13,608 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:14:13,610 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:14:13,611 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:14:13,613 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:14:13,614 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:14:13,615 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36479
2024-02-05T18:14:13,618 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36479 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:14:13,623 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:14:13,624 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:14:13,626 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36479 was invalidated. state Releasing
2024-02-05T18:14:13,627 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:14:13,628 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:36479 registry has been deleted.
2024-02-05T18:14:13,628 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36479 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:14:13,629 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:14:13,629 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:14:13,630 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:14:13,631 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36479 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:14:13,633 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36479
2024-02-05T18:14:13,633 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36479. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:14:13,638 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36479 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:14:13,640 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:14:13,643 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:14:13,645 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-227133a4a2] Subscribing to topic on cnx [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357], consumerId 4
2024-02-05T18:14:13,646 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36479
2024-02-05T18:14:13,648 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xf752ac75, L:/127.0.0.1:45357 - R:/127.0.0.1:50902]] Subscribing on topic persistent://public/test/__change_events / reader-227133a4a2. consumerId: 4
2024-02-05T18:14:13,655 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:13,655 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36479/0x00000000_0xffffffff.
2024-02-05T18:14:13,655 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:14:13,656 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8b2f7f50ec, ackPos=13:-1, readPos=13:0}
2024-02-05T18:14:13,657 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:58006] Created subscription on topic persistent://public/test/__change_events / reader-8b2f7f50ec
2024-02-05T18:14:13,660 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 3
2024-02-05T18:14:13,660 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-227133a4a2] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:14:13,661 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:14:13,661 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-227133a4a2, ackPos=13:-1, readPos=13:0}
2024-02-05T18:14:13,664 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:58006] Closing consumer: consumerId=3
2024-02-05T18:14:13,665 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-8b2f7f50ec}, consumerId=3, consumerName=82f1a, address=/127.0.0.1:58006}
2024-02-05T18:14:13,665 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-8b2f7f50ec, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:14:13,666 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36479/0x00000000_0xffffffff.
2024-02-05T18:14:13,668 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-8b2f7f50ec] Successfully closed dispatcher for reader
2024-02-05T18:14:13,668 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36479/0x00000000_0xffffffff.
2024-02-05T18:14:13,671 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:58006] Closed consumer, consumerId=3
2024-02-05T18:14:13,672 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50902] Created subscription on topic persistent://public/test/__change_events / reader-227133a4a2
2024-02-05T18:14:13,673 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-227133a4a2] Subscribed to topic on localhost/127.0.0.1:45357 -- consumer: 4
2024-02-05T18:14:13,674 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-8b2f7f50ec] Closed consumer
2024-02-05T18:14:13,675 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.022 seconds
2024-02-05T18:14:13,676 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:14:13,677 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:14:13,681 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x6074733a, L:/127.0.0.1:37250 ! R:localhost/127.0.0.1:43643] Disconnected
2024-02-05T18:14:13,683 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:14:13,684 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] Disconnected
2024-02-05T18:14:13,684 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:37250
2024-02-05T18:14:13,685 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36479/__change_events, name=reader-28d5cb67ba}, consumerId=2, consumerName=6953f, address=/127.0.0.1:37250}
2024-02-05T18:14:13,686 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:58006
2024-02-05T18:14:13,686 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36479/__change_events][reader-28d5cb67ba] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36479/persistent/__change_events, cursor=reader-28d5cb67ba, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:14:13,686 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36479/__change_events][reader-28d5cb67ba] Successfully closed dispatcher for reader
2024-02-05T18:14:13,687 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36479/persistent/__change_events] Closing managed ledger
2024-02-05T18:14:13,687 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-bca3229d17}, consumerId=0, consumerName=c9995, address=/127.0.0.1:58006}
2024-02-05T18:14:13,688 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bca3229d17] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-bca3229d17, ackPos=3:5, readPos=3:6}]
2024-02-05T18:14:13,688 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-bca3229d17] Successfully closed dispatcher for reader
2024-02-05T18:14:13,689 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36479/__change_events] [reader-28d5cb67ba] Closed connection [id: 0x6074733a, L:/127.0.0.1:37250 ! R:localhost/127.0.0.1:43643] -- Will try again in 0.1 s
2024-02-05T18:14:13,689 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-622678b655}, consumerId=1, consumerName=bf8f8, address=/127.0.0.1:58006}
2024-02-05T18:14:13,690 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36479/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:14:13,691 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:14:13,691 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:13,692 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:13,693 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:13,693 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:14:13,693 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-bca3229d17] Closed connection [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:13,694 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-622678b655] Closed connection [id: 0x84dcdff5, L:/127.0.0.1:58006 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:13,694 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:14:13,701 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:43643
2024-02-05T18:14:13,702 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:14:13,704 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:14:13,705 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:14:13,706 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36479/__change_events] [reader-28d5cb67ba] Closed Consumer (not connected)
2024-02-05T18:14:13,706 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36479/__change_events with subscription name reader-28d5cb67ba was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36479/__change_events with subscription name reader-28d5cb67ba was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:13,707 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-bca3229d17] Closed Consumer (not connected)
2024-02-05T18:14:13,709 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-622678b655] Closed Consumer (not connected)
2024-02-05T18:14:13,709 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-bca3229d17 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-bca3229d17 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:13,709 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-622678b655 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-622678b655 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:13,716 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:14:13,716 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:14:13,719 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:14:13,720 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:13,729 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:14:13,730 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:14,158 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:14:14,159 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 48.05%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 48.05%, msgThroughputEMA= 0.00, updatedAt= 1707149654157, reportedAt= 0
2024-02-05T18:14:14,261 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:14,261 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:14:15,003 - INFO  - [globalEventExecutor-10-2:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:14:15,003 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:14:15,005 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:14:15,005 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:15,006 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:14:15,006 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:14:15,262 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:15,262 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:14:16,263 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:14:16,264 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:14:17,020 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:14:17,022 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@74e2cfc5{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:14:17,023 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@6549ce71{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:14:17,023 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:14:17,023 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@6556471b{/static,null,STOPPED}
2024-02-05T18:14:17,024 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@d0e4972{/metrics,null,STOPPED}
2024-02-05T18:14:17,026 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/topics,null,STOPPED}
2024-02-05T18:14:17,028 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1d0f7bcf{/lookup,null,STOPPED}
2024-02-05T18:14:17,030 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/admin/v3,null,STOPPED}
2024-02-05T18:14:17,032 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/admin/v2,null,STOPPED}
2024-02-05T18:14:17,034 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7c200e57{/admin,null,STOPPED}
2024-02-05T18:14:17,036 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1978b0d5{/,null,STOPPED}
2024-02-05T18:14:17,037 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:14:17,038 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:14:17,038 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:14:17,039 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:45463
2024-02-05T18:14:17,041 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:45463, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149653556, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:14:22,051 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:45463 in 5010.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:14:22,059 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:45463 was invalidated. state Releasing
2024-02-05T18:14:22,059 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:45463. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:14:22,059 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:45463
2024-02-05T18:14:22,063 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:45463/0x00000000_0xffffffff.
2024-02-05T18:14:22,064 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:45463/0x00000000_0xffffffff.
2024-02-05T18:14:22,071 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:45463, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149662065, versionId=7]. totalHandledRequests:10
2024-02-05T18:14:22,073 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:14:22,073 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-227133a4a2}, consumerId=4, consumerName=1447f, address=/127.0.0.1:50902}
2024-02-05T18:14:22,074 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-227133a4a2}, consumerId=4, consumerName=1447f, address=/127.0.0.1:50902}
2024-02-05T18:14:22,075 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:45357] Broker notification of Closed consumer: 4
2024-02-05T18:14:22,075 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-227133a4a2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-227133a4a2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:14:22,075 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-227133a4a2] Successfully closed dispatcher for reader
2024-02-05T18:14:22,075 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-227133a4a2] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 - R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,076 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-227133a4a2] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-227133a4a2, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:14:22,076 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-227133a4a2] Successfully disconnected and closed subscription
2024-02-05T18:14:22,077 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:14:22,077 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:14:22,077 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:14:22,079 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:14:22,081 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:14:22,082 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-227133a4a2] Closed Consumer (not connected)
2024-02-05T18:14:22,082 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-227133a4a2 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-227133a4a2 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:22,083 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 11.0 ms
2024-02-05T18:14:22,092 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:45463 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:45463, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149662071, versionId=8]. totalHandledRequests:4
2024-02-05T18:14:22,092 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:14:22,093 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:45463/0x00000000_0xffffffff.
2024-02-05T18:14:22,094 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.034 seconds
2024-02-05T18:14:22,094 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:14:22,095 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:50902
2024-02-05T18:14:22,095 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:14:22,095 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-4ce4a5d990}, consumerId=0, consumerName=e150f, address=/127.0.0.1:50902}
2024-02-05T18:14:22,095 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:14:22,095 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4ce4a5d990] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4ce4a5d990, ackPos=3:5, readPos=3:8}]
2024-02-05T18:14:22,096 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4ce4a5d990] Successfully closed dispatcher for reader
2024-02-05T18:14:22,096 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:45463/persistent/__change_events] Closing managed ledger
2024-02-05T18:14:22,096 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:45463/__change_events, name=reader-6c1326556e}, consumerId=3, consumerName=b3a13, address=/127.0.0.1:50902}
2024-02-05T18:14:22,096 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:45463/__change_events][reader-6c1326556e] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:45463/persistent/__change_events, cursor=reader-6c1326556e, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:14:22,097 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:45463/__change_events][reader-6c1326556e] Successfully closed dispatcher for reader
2024-02-05T18:14:22,097 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-79718fb625}, consumerId=2, consumerName=f31e8, address=/127.0.0.1:50902}
2024-02-05T18:14:22,097 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-43161f7ec8}, consumerId=1, consumerName=8f1ad, address=/127.0.0.1:50902}
2024-02-05T18:14:22,098 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] Disconnected
2024-02-05T18:14:22,099 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,099 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,099 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:45463/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:14:22,099 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,100 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4ce4a5d990] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,100 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-43161f7ec8] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,100 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:14:22,100 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:45463/__change_events] [reader-6c1326556e] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,100 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:14:22,100 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-79718fb625] Closed connection [id: 0x7b5596ef, L:/127.0.0.1:50902 ! R:localhost/127.0.0.1:45357] -- Will try again in 0.1 s
2024-02-05T18:14:22,102 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:14:22,102 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:14:22,106 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:45357
2024-02-05T18:14:22,106 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:14:22,107 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:14:22,107 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:14:22,107 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4ce4a5d990] Closed Consumer (not connected)
2024-02-05T18:14:22,107 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-43161f7ec8] Closed Consumer (not connected)
2024-02-05T18:14:22,107 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:45463/__change_events] [reader-6c1326556e] Closed Consumer (not connected)
2024-02-05T18:14:22,108 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-79718fb625] Closed Consumer (not connected)
2024-02-05T18:14:22,107 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4ce4a5d990 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4ce4a5d990 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:22,108 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-43161f7ec8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-43161f7ec8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:22,108 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45463/__change_events with subscription name reader-6c1326556e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:45463/__change_events with subscription name reader-6c1326556e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:22,109 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-79718fb625 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-79718fb625 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:14:22,111 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:14:22,111 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:14:22,111 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:14:22,111 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:14:22,112 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:14:22,112 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:22,113 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:14:22,113 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:23,498 - INFO  - [globalEventExecutor-10-7:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:14:23,499 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:14:23,500 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:14:23,501 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:23,501 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:14:23,501 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:14:23,510 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:14:23,510 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:14:23,516 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:14:23,516 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:14:23,516 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:14:23,516 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 190 with name 'Thread[globalEventExecutor-10-7,5,main]'
2024-02-05T18:14:23,517 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:14:23,517 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:14:23,518 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6636e1dd
2024-02-05T18:14:23,518 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:14:23,518 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:14:23,518 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 27.663 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  52.426 s
[INFO] Finished at: 2024-02-05T18:14:23+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 7 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:14:55,053 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:14:56,097 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:14:56,098 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:14:56,701 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:14:56,702 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:14:56,703 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:14:56,703 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:14:56,704 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:14:56,704 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:14:56,717 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:14:56,718 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:14:56,718 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:14:56,718 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:14:56,719 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:14:56,719 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:14:56,720 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:14:56,720 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:14:56,721 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:14:56,721 - INFO  - [main:Environment@98] - Client environment:os.memory.free=28MB
2024-02-05T18:14:56,721 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:14:56,722 - INFO  - [main:Environment@98] - Client environment:os.memory.total=124MB
2024-02-05T18:14:58,583 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:14:58,584 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:14:58,584 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:14:58,585 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:14:58,934 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:14:58,937 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:14:59,029 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:14:59,109 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:14:59,112 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:14:59,129 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:14:59,239 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:14:59,285 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:14:59,341 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:14:59,760 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:14:59,760 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:14:59,797 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:14:59,869 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:38791, TLS: (none), listener: (none)
2024-02-05T18:15:00,248 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34823, TLS: OPENSSL, listener: (none)
2024-02-05T18:15:00,274 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:15:00,279 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:15:00,280 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:15:00,312 - INFO  - [main:Log@170] - Logging initialized @7645ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:15:01,249 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:15:01,277 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:15:01,278 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:15:01,280 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:15:02,134 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:15:03,239 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:15:04,447 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:15:04,784 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:15:04,885 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:15:05,043 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:15:05,044 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:15:05,046 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:15:05,058 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:40225}
2024-02-05T18:15:05,202 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:43617}
2024-02-05T18:15:05,203 - INFO  - [main:Server@415] - Started @12537ms
2024-02-05T18:15:05,203 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:40225
2024-02-05T18:15:05,204 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:43617
2024-02-05T18:15:05,211 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:15:05,212 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:15:05,394 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:40225
2024-02-05T18:15:05,414 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:15:05,418 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:40225 is changing the role from null to Leader
2024-02-05T18:15:05,421 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:40225).
2024-02-05T18:15:05,761 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:40225 
2024-02-05T18:15:06,246 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:15:06,276 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:06,380 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:15:06,383 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:15:06,391 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:15:06,393 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:15:06,437 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:15:06,469 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:15:06,505 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:15:06,579 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:15:06,599 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:15:06,609 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:15:06,612 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:15:06,641 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:06 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 551
2024-02-05T18:15:06,656 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:15:06,840 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]] Connected to server
2024-02-05T18:15:06,891 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:56196] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:15:06,950 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:06,967 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,053 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:15:07,092 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56196] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:56196, producerName=test-0-0, producerId=0}
2024-02-05T18:15:07,107 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,110 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:15:07,174 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,176 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-699657eb1f] Subscribing to topic on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791], consumerId 0
2024-02-05T18:15:07,186 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbb59e762, L:/127.0.0.1:38791 - R:/127.0.0.1:56196]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-699657eb1f. consumerId: 0
2024-02-05T18:15:07,218 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-699657eb1f] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:15:07,219 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:15:07,220 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-699657eb1f, ackPos=3:-1, readPos=3:0}
2024-02-05T18:15:07,240 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56196] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-699657eb1f
2024-02-05T18:15:07,246 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-699657eb1f] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 0
2024-02-05T18:15:07,260 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.013 seconds
2024-02-05T18:15:07,262 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:15:07,263 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:15:07,263 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:15:07,309 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,331 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:15:07,332 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:15:07,334 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:07 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 55
2024-02-05T18:15:07,334 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:15:07,346 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,354 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:15:07,355 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:15:07,356 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:07 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:15:07,357 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:15:07,372 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,374 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,379 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:15:07,385 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56196] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:56196, producerName=test-0-1, producerId=1}
2024-02-05T18:15:07,386 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,401 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,403 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-547a822f1e] Subscribing to topic on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791], consumerId 1
2024-02-05T18:15:07,405 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbb59e762, L:/127.0.0.1:38791 - R:/127.0.0.1:56196]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-547a822f1e. consumerId: 1
2024-02-05T18:15:07,427 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-547a822f1e] Created new subscription for 1
2024-02-05T18:15:07,428 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56196] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-547a822f1e
2024-02-05T18:15:07,429 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-547a822f1e] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 1
2024-02-05T18:15:07,442 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,444 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,449 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:15:07,456 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:56196] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:56196, producerName=test-0-2, producerId=2}
2024-02-05T18:15:07,457 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:07,468 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:15:07,482 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:15:07,487 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:40225 started the ownership monitor.
2024-02-05T18:15:07,502 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:07,504 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5e906c674d] Subscribing to topic on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791], consumerId 2
2024-02-05T18:15:07,506 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbb59e762, L:/127.0.0.1:38791 - R:/127.0.0.1:56196]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-5e906c674d. consumerId: 2
2024-02-05T18:15:07,525 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:40225/__change_events
2024-02-05T18:15:07,521 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5e906c674d] Created new subscription for 2
2024-02-05T18:15:07,528 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56196] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-5e906c674d
2024-02-05T18:15:07,529 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-5e906c674d] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 2
2024-02-05T18:15:07,530 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:40225 plays the leader now.
2024-02-05T18:15:07,536 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 53.91%, directMemory= 2.73%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 2.73%, weightedMaxEMA= 53.91%, msgThroughputEMA= 0.00, updatedAt= 1707149707534, reportedAt= 0
2024-02-05T18:15:07,559 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:15:07,564 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:07,566 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:07,613 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:40225/0x00000000_0xffffffff - localhost:40225.
2024-02-05T18:15:07,615 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:40225
2024-02-05T18:15:07,615 - INFO  - [pulsar-7-5:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:40225/0x00000000_0xffffffff
2024-02-05T18:15:07,616 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:40225/0x00000000_0xffffffff - localhost:40225.
2024-02-05T18:15:07,617 - INFO  - [pulsar-7-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:40225/0x00000000_0xffffffff
2024-02-05T18:15:07,619 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:40225
2024-02-05T18:15:07,636 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:40225 doesn't exist.
2024-02-05T18:15:07,648 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:40225/__change_events][reader-48986fa7e8] Subscribing to topic on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791], consumerId 3
2024-02-05T18:15:07,653 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbb59e762, L:/127.0.0.1:38791 - R:/127.0.0.1:56196]] Subscribing on topic persistent://sla-monitor/test/localhost:40225/__change_events / reader-48986fa7e8. consumerId: 3
2024-02-05T18:15:07,661 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:40225/persistent/__change_events
2024-02-05T18:15:07,663 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:40225/persistent/__change_events'
2024-02-05T18:15:07,672 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:15:07,673 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:40225/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:15:07,683 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:40225/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:15:07,691 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:40225/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:15:07,695 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:40225/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:40225/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:15:07,697 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:40225/__change_events - dedup is disabled
2024-02-05T18:15:07,708 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:15:07,715 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:40225/__change_events][reader-48986fa7e8] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:15:07,715 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:40225/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:15:07,716 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:40225/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40225/persistent/__change_events, cursor=reader-48986fa7e8, ackPos=7:-1, readPos=7:0}
2024-02-05T18:15:07,718 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:56196] Created subscription on topic persistent://sla-monitor/test/localhost:40225/__change_events / reader-48986fa7e8
2024-02-05T18:15:07,722 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:40225/__change_events][reader-48986fa7e8] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 3
2024-02-05T18:15:07,657 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=9, bootstrap service port = 40225, tls-port = Optional[43617], broker url= pulsar://localhost:38791, broker tls url= pulsar+ssl://localhost:34823, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[38791], brokerServicePortTls=Optional[34823], webServicePort=Optional[40225], webServicePortTls=Optional[43617], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:15:08,271 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:15:08,271 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:15:08,272 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:15:08,272 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:15:08,279 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:15:08,280 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:15:08,285 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:15:08,289 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:15:08,295 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:15:08,296 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:15:08,302 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:15:08,309 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:15:08,311 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:15:08,321 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:15:08,322 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:15:08,330 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:15:08,333 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:37687, TLS: (none), listener: (none)
2024-02-05T18:15:08,334 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:45683, TLS: OPENSSL, listener: (none)
2024-02-05T18:15:08,337 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:15:08,338 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:15:08,338 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:15:08,349 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:15:08,356 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:15:08,358 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:15:08,358 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 660000ms
2024-02-05T18:15:08,443 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/,null,AVAILABLE}
2024-02-05T18:15:08,567 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:08,568 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:09,069 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/admin,null,AVAILABLE}
2024-02-05T18:15:09,568 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:09,569 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:10,195 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v2,null,AVAILABLE}
2024-02-05T18:15:10,406 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@12039ae0{/admin/v3,null,AVAILABLE}
2024-02-05T18:15:10,462 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/lookup,null,AVAILABLE}
2024-02-05T18:15:10,547 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1fb320de{/topics,null,AVAILABLE}
2024-02-05T18:15:10,549 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/metrics,null,AVAILABLE}
2024-02-05T18:15:10,550 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@584f12eb{/static,null,AVAILABLE}
2024-02-05T18:15:10,554 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@2dc4b58a{HTTP/1.1, (http/1.1)}{0.0.0.0:36581}
2024-02-05T18:15:10,565 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{SSL, (ssl, http/1.1)}{0.0.0.0:33635}
2024-02-05T18:15:10,565 - INFO  - [main:Server@415] - Started @17900ms
2024-02-05T18:15:10,565 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:36581
2024-02-05T18:15:10,567 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:33635
2024-02-05T18:15:10,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:10,570 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:10,572 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:15:10,573 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:15:10,584 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:36581
2024-02-05T18:15:10,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:36581 registry has been created.
2024-02-05T18:15:10,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:36581. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:15:10,590 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:36581 is changing the role from null to Follower
2024-02-05T18:15:10,598 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:40225).
2024-02-05T18:15:10,600 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:15:10,629 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:36581 
2024-02-05T18:15:10,734 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 50
2024-02-05T18:15:10,753 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:10,757 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:15:10,758 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:15:10,773 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 34
2024-02-05T18:15:10,776 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36581/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:15:10,786 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xc165b2e0, L:/127.0.0.1:36102 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:10,792 - INFO  - [pulsar-io-64-3:ServerCnx@724] - [/127.0.0.1:36102] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:15:10,810 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]] Connected to server
2024-02-05T18:15:10,813 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:56204] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:15:10,814 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:10,825 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:56204] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:56204, producerName=test-0-3, producerId=0}
2024-02-05T18:15:10,826 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:10,839 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4d92630dfa] Subscribing to topic on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791], consumerId 0
2024-02-05T18:15:10,841 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x70e345e6, L:/127.0.0.1:38791 - R:/127.0.0.1:56204]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4d92630dfa. consumerId: 0
2024-02-05T18:15:10,846 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4d92630dfa] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:15:10,846 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:15:10,847 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4d92630dfa, ackPos=3:-1, readPos=3:0}
2024-02-05T18:15:10,849 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56204] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-4d92630dfa
2024-02-05T18:15:10,850 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4d92630dfa] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 0
2024-02-05T18:15:10,853 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:15:10,854 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:15:10,881 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:15:10,891 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:10,896 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:15:10,896 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:15:10,903 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36581/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:15:10,903 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:15:10,917 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 10
2024-02-05T18:15:10,922 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:10,925 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:15:10,926 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:15:10,929 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:10 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:15:10,930 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:36581/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:15:10,947 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:10,956 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:56204] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:56204, producerName=test-0-4, producerId=1}
2024-02-05T18:15:10,957 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:10,970 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c0b1cf239b] Subscribing to topic on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791], consumerId 1
2024-02-05T18:15:10,972 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x70e345e6, L:/127.0.0.1:38791 - R:/127.0.0.1:56204]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c0b1cf239b. consumerId: 1
2024-02-05T18:15:10,983 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c0b1cf239b] Created new subscription for 1
2024-02-05T18:15:10,983 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56204] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-c0b1cf239b
2024-02-05T18:15:10,984 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-c0b1cf239b] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 1
2024-02-05T18:15:11,001 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:11,009 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:56204] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:56204, producerName=test-0-5, producerId=2}
2024-02-05T18:15:11,010 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x199c32a1, L:/127.0.0.1:56204 - R:localhost/127.0.0.1:38791]
2024-02-05T18:15:11,012 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:15:11,016 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:15:11,017 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:36581 plays a follower now.
2024-02-05T18:15:11,041 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:36581/__change_events
2024-02-05T18:15:11,063 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:36581/0x00000000_0xffffffff - localhost:36581.
2024-02-05T18:15:11,064 - INFO  - [pulsar-62-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:36581/0x00000000_0xffffffff
2024-02-05T18:15:11,067 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:36581
2024-02-05T18:15:11,067 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:36581/0x00000000_0xffffffff - localhost:36581.
2024-02-05T18:15:11,069 - INFO  - [pulsar-62-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:36581/0x00000000_0xffffffff
2024-02-05T18:15:11,070 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:36581
2024-02-05T18:15:11,071 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:36581 doesn't exist.
2024-02-05T18:15:11,071 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:36581/__change_events][reader-34a438c136] Subscribing to topic on cnx [id: 0xc165b2e0, L:/127.0.0.1:36102 - R:localhost/127.0.0.1:37687], consumerId 2
2024-02-05T18:15:11,074 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x2883a835, L:/127.0.0.1:37687 - R:/127.0.0.1:36102]] Subscribing on topic persistent://sla-monitor/test/localhost:36581/__change_events / reader-34a438c136. consumerId: 2
2024-02-05T18:15:11,074 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=2, bootstrap service port = 36581, tls-port = Optional[33635], broker url= pulsar://localhost:37687, broker tls url= pulsar+ssl://localhost:45683, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[37687], brokerServicePortTls=Optional[45683], webServicePort=Optional[36581], webServicePortTls=Optional[33635], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:15:11,080 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:36581/persistent/__change_events
2024-02-05T18:15:11,084 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:36581/persistent/__change_events'
2024-02-05T18:15:11,099 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:15:11,100 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:36581/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:15:11,108 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:36581/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:15:11,113 - INFO  - [broker-topic-workers-OrderedExecutor-1-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:36581/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:15:11,119 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:36581/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:36581/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:15:11,121 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:36581/__change_events - dedup is disabled
2024-02-05T18:15:11,133 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:15:11,143 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:36581/__change_events][reader-34a438c136] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:15:11,143 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:36581/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:15:11,144 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:36581/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36581/persistent/__change_events, cursor=reader-34a438c136, ackPos=9:-1, readPos=9:0}
2024-02-05T18:15:11,149 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:36102] Created subscription on topic persistent://sla-monitor/test/localhost:36581/__change_events / reader-34a438c136
2024-02-05T18:15:11,150 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:36581/__change_events][reader-34a438c136] Subscribed to topic on localhost/127.0.0.1:37687 -- consumer: 2
2024-02-05T18:15:11,317 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:15:11,318 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 28
2024-02-05T18:15:11,347 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:15:11,348 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:15:11,372 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:15:11,372 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:15:11,377 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:15:11,378 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 26
2024-02-05T18:15:11,408 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:15:11,408 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:15:11,409 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:15:11,410 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 21
2024-02-05T18:15:11,411 - INFO  - [pulsar-62-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:15:11,413 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:15:11,422 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:15:11,423 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:15:11,427 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:15:11,428 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 13
2024-02-05T18:15:11,442 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:15:11,443 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:15:11,444 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:15:11,446 - INFO  - [pulsar-62-5:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:15:11,447 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 14
2024-02-05T18:15:11,450 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:15:11,486 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:15:11,499 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:15:11,500 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:15:11,517 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:15:11,535 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:11,568 - INFO  - [pulsar-web-30-5:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:36581 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:15:11,571 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:11,572 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:11,623 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149711570, versionId=1]. totalHandledRequests:1
2024-02-05T18:15:11,653 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149711638, versionId=2]. totalHandledRequests:1
2024-02-05T18:15:11,656 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:15:11,670 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:11,677 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 164
2024-02-05T18:15:11,692 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:15:11,721 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-983bf15ba5] Subscribing to topic on cnx [id: 0xc165b2e0, L:/127.0.0.1:36102 - R:localhost/127.0.0.1:37687], consumerId 3
2024-02-05T18:15:11,723 - INFO  - [pulsar-io-64-3:ServerCnx@1173] - [[id: 0x2883a835, L:/127.0.0.1:37687 - R:/127.0.0.1:36102]] Subscribing on topic persistent://public/test/__change_events / reader-983bf15ba5. consumerId: 3
2024-02-05T18:15:11,726 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149711713, versionId=3]. totalHandledRequests:1
2024-02-05T18:15:11,728 - INFO  - [broker-client-shared-internal-executor-65-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:15:12,481 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 45.90%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 53.11%, msgThroughputEMA= 0.00, updatedAt= 1707149712480, reportedAt= 1707149707626
2024-02-05T18:15:12,572 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:12,573 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:13,573 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:13,574 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:14,575 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:14,575 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:15,576 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:15,576 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:16,577 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:16,578 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:17,481 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@126] - skipping load report:cpu= 0.00%, memory= 46.09%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 52.40%, msgThroughputEMA= 0.00, updatedAt= 1707149717480, reportedAt= 1707149707626
2024-02-05T18:15:17,578 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:17,579 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1441] - Overriding in-flight state ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149711713, versionId=3] to overrideData:Optional[ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717579, versionId=4]]
2024-02-05T18:15:17,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 6.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:1. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:15:17,588 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717579, versionId=4]. totalHandledRequests:2
2024-02-05T18:15:17,588 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:15:17,589 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:15:17,590 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 5909
2024-02-05T18:15:17,590 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:15:17,592 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:15:11 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 6112
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:15:17,595 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:15:17,598 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:15:17,606 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:15:17,607 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:15:17,613 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:15:17,652 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:15:17,659 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:15:17,662 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:15:17,672 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:15:17,673 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:15:17,674 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:15:17,676 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1f1d97c4], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3d12f869] 
2024-02-05T18:15:17,680 - WARN  - [metadata-store-57-1:PersistentTopic@877] - [persistent://public/test/__change_events] Attempting to subscribe to a fenced topic
2024-02-05T18:15:17,680 - WARN  - [metadata-store-57-1:ServerCnx@1299] - [/127.0.0.1:36102][persistent://public/test/__change_events][reader-983bf15ba5] Failed to create consumer: consumerId=3, Topic is temporarily unavailable
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1f1d97c4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@106b2533], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3d12f869, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4ad7c81b] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1f1d97c4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@106b2533, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3987d532], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3d12f869, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4ad7c81b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13fca3db] 
2024-02-05T18:15:17,686 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0xc165b2e0, L:/127.0.0.1:36102 - R:localhost/127.0.0.1:37687] Received error from server: Topic is temporarily unavailable
2024-02-05T18:15:17,688 - WARN  - [pulsar-io-64-2:ConsumerImpl@873] - [persistent://public/test/__change_events][reader-983bf15ba5] Failed to subscribe to topic on localhost/127.0.0.1:37687
2024-02-05T18:15:17,688 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":3256575189863647915, "remote":"localhost/127.0.0.1:37687", "local":"/127.0.0.1:36102"}
2024-02-05T18:15:17,689 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Topic is temporarily unavailable","reqId":3256575189863647915, "remote":"localhost/127.0.0.1:37687", "local":"/127.0.0.1:36102"} -- Will try again in 0.1 s
2024-02-05T18:15:17,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1f1d97c4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@106b2533, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3987d532, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a775e2a], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3d12f869, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4ad7c81b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13fca3db, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e14c26f] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7e5c0e9b, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3023bef6, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1f1d97c4, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@106b2533, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3987d532, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5a775e2a, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@29bdacda], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@be5390f, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1ab79bc, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3d12f869, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4ad7c81b, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@13fca3db, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@2e14c26f, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5fa9204d] 
------- SUCCESS -- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:15:17,715 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:15:17,726 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 6002.0 ms
2024-02-05T18:15:17,742 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149711724, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717579, versionId=4]
2024-02-05T18:15:17,744 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@198] - Skipped the message from topic persistent://pulsar/system/loadbalancer-service-unit-state. key=public/test/0x00000000_0xffffffff value=ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149711724, versionId=4] prev=ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717579, versionId=4]
2024-02-05T18:15:17,790 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:15:17,791 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-983bf15ba5] Reconnecting after connection was closed
2024-02-05T18:15:17,794 - ERROR - [pulsar-io-64-2:ClientCnx@1196] - [id: 0xc165b2e0, L:/127.0.0.1:36102 - R:localhost/127.0.0.1:37687] Close connection because received internal-server error Failed due to pulsar service is not ready
2024-02-05T18:15:17,795 - WARN  - [pulsar-io-64-2:BinaryProtoLookupService@158] - [persistent://public/test/__change_events] failed to send lookup request : {"errorMsg":"Failed due to pulsar service is not ready","reqId":3256575189863647916, "remote":"localhost/127.0.0.1:37687", "local":"/127.0.0.1:36102"}
2024-02-05T18:15:17,796 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":3256575189863647916, "remote":"localhost/127.0.0.1:37687", "local":"/127.0.0.1:36102"}
2024-02-05T18:15:17,796 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException$LookupException: {"errorMsg":"Failed due to pulsar service is not ready","reqId":3256575189863647916, "remote":"localhost/127.0.0.1:37687", "local":"/127.0.0.1:36102"} -- Will try again in 0.19 s
2024-02-05T18:15:17,796 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xc165b2e0, L:/127.0.0.1:36102 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:17,800 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:36102
2024-02-05T18:15:17,803 - INFO  - [pulsar-io-64-3:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:36581/__change_events, name=reader-34a438c136}, consumerId=2, consumerName=05c47, address=/127.0.0.1:36102}
2024-02-05T18:15:17,804 - INFO  - [pulsar-io-64-3:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:36581/__change_events][reader-34a438c136] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:36581/persistent/__change_events, cursor=reader-34a438c136, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:15:17,805 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Closed connection [id: 0xc165b2e0, L:/127.0.0.1:36102 ! R:localhost/127.0.0.1:37687] -- Will try again in 0.1 s
2024-02-05T18:15:17,807 - INFO  - [pulsar-io-64-3:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:36581/__change_events][reader-34a438c136] Successfully closed dispatcher for reader
2024-02-05T18:15:17,827 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@2dc4b58a{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:15:17,828 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:15:17,828 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:15:17,830 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@584f12eb{/static,null,STOPPED}
2024-02-05T18:15:17,832 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/metrics,null,STOPPED}
2024-02-05T18:15:17,844 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1fb320de{/topics,null,STOPPED}
2024-02-05T18:15:17,846 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/lookup,null,STOPPED}
2024-02-05T18:15:17,848 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@12039ae0{/admin/v3,null,STOPPED}
2024-02-05T18:15:17,851 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v2,null,STOPPED}
2024-02-05T18:15:17,854 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/admin,null,STOPPED}
2024-02-05T18:15:17,856 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/,null,STOPPED}
2024-02-05T18:15:17,860 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:15:17,862 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:15:17,862 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:15:17,863 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36581
2024-02-05T18:15:17,871 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:40225. Skipping this broker. Phase one
2024-02-05T18:15:17,871 - INFO  - [main:ServiceUnitStateChannelImpl@1187] - Overriding ownership serviceUnit:public/test/0x00000000_0xffffffff from orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:36581, sourceBroker=null, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717579, versionId=4] to overrideData:ServiceUnitStateData[state=Owned, dstBroker=localhost:40225, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717871, versionId=5]
2024-02-05T18:15:17,878 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:40225, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717871, versionId=5]. totalHandledRequests:6
2024-02-05T18:15:17,881 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@697] - localhost:40225 handled Transfer:Owned event for serviceUnit:public/test/0x00000000_0xffffffff, cur:ServiceUnitStateData[state=Owned, dstBroker=localhost:40225, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717871, versionId=5], next:, totalHandledRequests:6, totalFailedRequests:6
2024-02-05T18:15:17,881 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 2.0 ms
2024-02-05T18:15:17,882 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:15:17,887 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:15:17,889 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:15:17,907 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@167] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Reconnecting after timeout
2024-02-05T18:15:17,908 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x5f6b8619, L:/127.0.0.1:51118 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:17,911 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x5f6b8619, L:/127.0.0.1:51118 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:17,911 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:51118
2024-02-05T18:15:17,911 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x5f6b8619, L:/127.0.0.1:51118 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:17,912 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x5f6b8619, L:/127.0.0.1:51118 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:17,912 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x5f6b8619, L:/127.0.0.1:51118 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:17,912 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:17,913 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.19 s
2024-02-05T18:15:17,916 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:15:17,918 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-d0e8ac9015] Subscribing to topic on cnx [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791], consumerId 4
2024-02-05T18:15:17,919 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0xbb59e762, L:/127.0.0.1:38791 - R:/127.0.0.1:56196]] Subscribing on topic persistent://public/test/__change_events / reader-d0e8ac9015. consumerId: 4
2024-02-05T18:15:17,925 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:15:17,931 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:15:17,932 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 13 after closed null
2024-02-05T18:15:17,936 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl$2@501] - [public/test/persistent/__change_events] Deleted empty ledger ledgerId=11 rc=0
2024-02-05T18:15:17,938 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3@580] - [public/test/persistent/__change_events] Loading cursor __compaction
2024-02-05T18:15:17,939 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@466] - [public/test/persistent/__change_events] Recovering from bookkeeper ledger cursor: __compaction
2024-02-05T18:15:17,956 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 13:-1
2024-02-05T18:15:17,956 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$3$1@587] - [public/test/persistent/__change_events] Recovery for cursor __compaction completed. pos=13:-1 -- todo=0
2024-02-05T18:15:17,956 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:15:17,960 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
2024-02-05T18:15:17,966 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-d0e8ac9015] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:15:17,967 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=13:0 mark-delete-position=13:-1
2024-02-05T18:15:17,967 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d0e8ac9015, ackPos=13:-1, readPos=13:0}
2024-02-05T18:15:17,968 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:56196] Created subscription on topic persistent://public/test/__change_events / reader-d0e8ac9015
2024-02-05T18:15:17,969 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-d0e8ac9015] Subscribed to topic on localhost/127.0.0.1:38791 -- consumer: 4
2024-02-05T18:15:17,987 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-983bf15ba5] Reconnecting after connection was closed
2024-02-05T18:15:17,989 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xd6346dda, L:/127.0.0.1:51130 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:17,991 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:51130
2024-02-05T18:15:17,992 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xd6346dda, L:/127.0.0.1:51130 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:17,992 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xd6346dda, L:/127.0.0.1:51130 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:17,993 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xd6346dda, L:/127.0.0.1:51130 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:17,993 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xd6346dda, L:/127.0.0.1:51130 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:17,993 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:17,993 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.362 s
2024-02-05T18:15:18,104 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Reconnecting after connection was closed
2024-02-05T18:15:18,106 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0x7b91b6b1, L:/127.0.0.1:51136 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:18,110 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:51136
2024-02-05T18:15:18,110 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0x7b91b6b1, L:/127.0.0.1:51136 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:18,110 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0x7b91b6b1, L:/127.0.0.1:51136 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:18,111 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0x7b91b6b1, L:/127.0.0.1:51136 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:18,111 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0x7b91b6b1, L:/127.0.0.1:51136 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,111 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,112 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.373 s
2024-02-05T18:15:18,357 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-983bf15ba5] Reconnecting after connection was closed
2024-02-05T18:15:18,359 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x65398cb4, L:/127.0.0.1:51140 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:18,362 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:51140
2024-02-05T18:15:18,362 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x65398cb4, L:/127.0.0.1:51140 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:18,362 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x65398cb4, L:/127.0.0.1:51140 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:18,363 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x65398cb4, L:/127.0.0.1:51140 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:18,363 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x65398cb4, L:/127.0.0.1:51140 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,363 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,363 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.785 s
2024-02-05T18:15:18,487 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Reconnecting after connection was closed
2024-02-05T18:15:18,489 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x2f0c9154, L:/127.0.0.1:51142 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:18,491 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:51142
2024-02-05T18:15:18,491 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x2f0c9154, L:/127.0.0.1:51142 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:18,491 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x2f0c9154, L:/127.0.0.1:51142 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:18,492 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x2f0c9154, L:/127.0.0.1:51142 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:18,492 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x2f0c9154, L:/127.0.0.1:51142 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,492 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:18,493 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 0.729 s
2024-02-05T18:15:18,587 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:18,587 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:15:19,149 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-983bf15ba5] Reconnecting after connection was closed
2024-02-05T18:15:19,150 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0xdc5b112d, L:/127.0.0.1:51158 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:19,153 - WARN  - [pulsar-io-64-1:ClientCnx@776] - [id: 0xdc5b112d, L:/127.0.0.1:51158 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:19,153 - INFO  - [pulsar-io-64-2:ServerCnx@343] - Closed connection from /127.0.0.1:51158
2024-02-05T18:15:19,153 - WARN  - [pulsar-io-64-1:ClientCnx@798] - [id: 0xdc5b112d, L:/127.0.0.1:51158 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:19,154 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0xdc5b112d, L:/127.0.0.1:51158 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:19,154 - WARN  - [pulsar-io-64-1:ConnectionPool@292] - [[id: 0xdc5b112d, L:/127.0.0.1:51158 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:19,154 - WARN  - [pulsar-io-64-1:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:19,154 - WARN  - [pulsar-io-64-1:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.508 s
2024-02-05T18:15:19,223 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Reconnecting after connection was closed
2024-02-05T18:15:19,224 - INFO  - [pulsar-io-64-4:ConnectionPool@265] - [[id: 0xa2d6b5d6, L:/127.0.0.1:51170 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:19,226 - WARN  - [pulsar-io-64-4:ClientCnx@776] - [id: 0xa2d6b5d6, L:/127.0.0.1:51170 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:19,226 - INFO  - [pulsar-io-64-1:ServerCnx@343] - Closed connection from /127.0.0.1:51170
2024-02-05T18:15:19,226 - WARN  - [pulsar-io-64-4:ClientCnx@798] - [id: 0xa2d6b5d6, L:/127.0.0.1:51170 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:19,226 - INFO  - [pulsar-io-64-4:ClientCnx@308] - [id: 0xa2d6b5d6, L:/127.0.0.1:51170 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:19,227 - WARN  - [pulsar-io-64-4:ConnectionPool@292] - [[id: 0xa2d6b5d6, L:/127.0.0.1:51170 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:19,227 - WARN  - [pulsar-io-64-4:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:19,227 - WARN  - [pulsar-io-64-4:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 1.527 s
2024-02-05T18:15:19,588 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:19,589 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:15:20,589 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:15:20,590 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt5, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:15:20,663 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://public/test/__change_events] [reader-983bf15ba5] Reconnecting after connection was closed
2024-02-05T18:15:20,665 - INFO  - [pulsar-io-64-3:ConnectionPool@265] - [[id: 0x8aa0892c, L:/127.0.0.1:51186 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:20,667 - WARN  - [pulsar-io-64-3:ClientCnx@776] - [id: 0x8aa0892c, L:/127.0.0.1:51186 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:20,667 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:51186
2024-02-05T18:15:20,667 - WARN  - [pulsar-io-64-3:ClientCnx@798] - [id: 0x8aa0892c, L:/127.0.0.1:51186 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:20,668 - INFO  - [pulsar-io-64-3:ClientCnx@308] - [id: 0x8aa0892c, L:/127.0.0.1:51186 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:20,668 - WARN  - [pulsar-io-64-3:ConnectionPool@292] - [[id: 0x8aa0892c, L:/127.0.0.1:51186 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:20,668 - WARN  - [pulsar-io-64-3:ConnectionHandler@110] - [persistent://public/test/__change_events] [reader-983bf15ba5] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:20,668 - WARN  - [pulsar-io-64-3:ConnectionHandler@137] - [persistent://public/test/__change_events] [reader-983bf15ba5] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.093 s
2024-02-05T18:15:20,756 - INFO  - [broker-client-shared-timer-68-1:ConnectionHandler@142] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Reconnecting after connection was closed
2024-02-05T18:15:20,758 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0x576d5bb9, L:/127.0.0.1:51188 - R:localhost/127.0.0.1:37687]] Connected to server
2024-02-05T18:15:20,760 - WARN  - [pulsar-io-64-2:ClientCnx@776] - [id: 0x576d5bb9, L:/127.0.0.1:51188 - R:localhost/127.0.0.1:37687] Received error from server: Failed due to pulsar service is not ready
2024-02-05T18:15:20,760 - INFO  - [pulsar-io-64-3:ServerCnx@343] - Closed connection from /127.0.0.1:51188
2024-02-05T18:15:20,760 - WARN  - [pulsar-io-64-2:ClientCnx@798] - [id: 0x576d5bb9, L:/127.0.0.1:51188 - R:localhost/127.0.0.1:37687] Received unknown request id from server: -1
2024-02-05T18:15:20,761 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0x576d5bb9, L:/127.0.0.1:51188 ! R:localhost/127.0.0.1:37687] Disconnected
2024-02-05T18:15:20,761 - WARN  - [pulsar-io-64-2:ConnectionPool@292] - [[id: 0x576d5bb9, L:/127.0.0.1:51188 ! R:localhost/127.0.0.1:37687]] Connection handshake failed: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:20,762 - WARN  - [pulsar-io-64-2:ConnectionHandler@110] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Error connecting to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed
2024-02-05T18:15:20,762 - WARN  - [pulsar-io-64-2:ConnectionHandler@137] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Could not get connection to broker: org.apache.pulsar.client.api.PulsarClientException: Connection already closed -- Will try again in 3.045 s
2024-02-05T18:15:20,979 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36581 in 3114.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:1, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:15:20,985 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:36581 registry has been deleted.
2024-02-05T18:15:20,985 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:36581 was invalidated. state Releasing
2024-02-05T18:15:20,985 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36581 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:15:20,987 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:36581. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:15:20,988 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:36581
2024-02-05T18:15:20,988 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36581 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:15:20,988 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36581
2024-02-05T18:15:20,989 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36581 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:15:20,997 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:36581/0x00000000_0xffffffff.
2024-02-05T18:15:20,998 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:36581/0x00000000_0xffffffff.
2024-02-05T18:15:21,000 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:36581/0x00000000_0xffffffff.
2024-02-05T18:15:21,000 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.012 seconds
2024-02-05T18:15:21,002 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:15:21,006 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] Disconnected
2024-02-05T18:15:21,006 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:21,006 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:21,006 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:21,007 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4d92630dfa] Closed connection [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:21,007 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c0b1cf239b] Closed connection [id: 0x199c32a1, L:/127.0.0.1:56204 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:21,008 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:56204
2024-02-05T18:15:21,009 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-4d92630dfa}, consumerId=0, consumerName=3ca78, address=/127.0.0.1:56204}
2024-02-05T18:15:21,009 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4d92630dfa] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-4d92630dfa, ackPos=3:5, readPos=3:6}]
2024-02-05T18:15:21,010 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-4d92630dfa] Successfully closed dispatcher for reader
2024-02-05T18:15:21,010 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-c0b1cf239b}, consumerId=1, consumerName=fcd70, address=/127.0.0.1:56204}
2024-02-05T18:15:21,010 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:15:21,012 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:36581/persistent/__change_events] Closing managed ledger
2024-02-05T18:15:21,013 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:36581/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:15:21,015 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:15:21,016 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:15:21,018 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:15:21,030 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:37687
2024-02-05T18:15:21,031 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:15:21,033 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:15:21,034 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:15:21,035 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-4d92630dfa] Closed Consumer (not connected)
2024-02-05T18:15:21,038 - INFO  - [main:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-983bf15ba5] Closed Consumer (not connected)
2024-02-05T18:15:21,038 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4d92630dfa was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-4d92630dfa was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:21,038 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:36581/__change_events] [reader-34a438c136] Closed Consumer (not connected)
2024-02-05T18:15:21,038 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-c0b1cf239b] Closed Consumer (not connected)
2024-02-05T18:15:21,039 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36581/__change_events with subscription name reader-34a438c136 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:36581/__change_events with subscription name reader-34a438c136 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:21,040 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c0b1cf239b was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-c0b1cf239b was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:21,053 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:15:21,054 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:15:21,060 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:15:21,061 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:21,070 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:15:21,071 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:21,593 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:21,593 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36581 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:15:21,594 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36581 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:15:21,594 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36581]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:15:21,594 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36581
2024-02-05T18:15:21,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36581 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt7, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:15:22,315 - INFO  - [globalEventExecutor-10-3:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:15:22,316 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:15:22,318 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:15:22,318 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:22,319 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:15:22,319 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:15:22,480 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:15:22,481 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 48.63%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 48.63%, msgThroughputEMA= 0.00, updatedAt= 1707149722480, reportedAt= 0
2024-02-05T18:15:22,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:22,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36581 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:15:22,595 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36581 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:15:22,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36581]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:15:22,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36581
2024-02-05T18:15:22,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36581 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt8, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:15:23,596 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:15:23,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:36581 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:15:23,597 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:36581 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:15:23,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[localhost:36581]. inactiveBrokerCount:1. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1}. 
2024-02-05T18:15:23,598 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:36581
2024-02-05T18:15:23,599 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:36581 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:15:24,332 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:15:24,333 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:15:24,334 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:15:24,334 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:15:24,335 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:15:24,335 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:15:24,337 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:15:24,339 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:15:24,340 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:15:24,341 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:15:24,343 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:15:24,344 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:15:24,345 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:15:24,346 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:15:24,346 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:15:24,347 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:40225
2024-02-05T18:15:24,348 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:40225, sourceBroker=localhost:36581, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149717871, versionId=5]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:15:29,361 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:40225 in 5012.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt9, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:15:29,369 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:40225 was invalidated. state Releasing
2024-02-05T18:15:29,369 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:40225. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:15:29,370 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:40225
2024-02-05T18:15:29,372 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:40225/0x00000000_0xffffffff.
2024-02-05T18:15:29,373 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:40225/0x00000000_0xffffffff.
2024-02-05T18:15:29,381 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:40225, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149729374, versionId=6]. totalHandledRequests:10
2024-02-05T18:15:29,382 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:15:29,383 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-d0e8ac9015}, consumerId=4, consumerName=6bc4a, address=/127.0.0.1:56196}
2024-02-05T18:15:29,384 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-d0e8ac9015}, consumerId=4, consumerName=6bc4a, address=/127.0.0.1:56196}
2024-02-05T18:15:29,384 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:38791] Broker notification of Closed consumer: 4
2024-02-05T18:15:29,384 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-d0e8ac9015] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d0e8ac9015, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:15:29,384 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-d0e8ac9015] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 - R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,384 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-d0e8ac9015] Successfully closed dispatcher for reader
2024-02-05T18:15:29,385 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-d0e8ac9015] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-d0e8ac9015, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:15:29,385 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-d0e8ac9015] Successfully disconnected and closed subscription
2024-02-05T18:15:29,385 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=13:-1, readPos=13:0}]
2024-02-05T18:15:29,385 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:15:29,385 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:15:29,389 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=13:-1
2024-02-05T18:15:29,390 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:15:29,391 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-d0e8ac9015] Closed Consumer (not connected)
2024-02-05T18:15:29,391 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 9.0 ms
2024-02-05T18:15:29,391 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-d0e8ac9015 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-d0e8ac9015 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:29,398 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:40225 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:40225, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149729381, versionId=7]. totalHandledRequests:4
2024-02-05T18:15:29,398 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:15:29,399 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:15:29,399 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:40225/0x00000000_0xffffffff.
2024-02-05T18:15:29,400 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.029 seconds
2024-02-05T18:15:29,400 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:15:29,401 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:15:29,401 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] Disconnected
2024-02-05T18:15:29,401 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:15:29,401 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,401 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:40225/persistent/__change_events] Closing managed ledger
2024-02-05T18:15:29,401 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,401 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,401 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:56196
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-699657eb1f] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-699657eb1f}, consumerId=0, consumerName=284af, address=/127.0.0.1:56196}
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-547a822f1e] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:40225/__change_events] [reader-48986fa7e8] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-699657eb1f] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-699657eb1f, ackPos=3:6, readPos=3:8}]
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-5e906c674d] Closed connection [id: 0xa1613dff, L:/127.0.0.1:56196 ! R:localhost/127.0.0.1:38791] -- Will try again in 0.1 s
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-699657eb1f] Successfully closed dispatcher for reader
2024-02-05T18:15:29,402 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:40225/__change_events, name=reader-48986fa7e8}, consumerId=3, consumerName=a26fb, address=/127.0.0.1:56196}
2024-02-05T18:15:29,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:40225/__change_events][reader-48986fa7e8] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:40225/persistent/__change_events, cursor=reader-48986fa7e8, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:15:29,403 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:40225/__change_events][reader-48986fa7e8] Successfully closed dispatcher for reader
2024-02-05T18:15:29,403 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-5e906c674d}, consumerId=2, consumerName=b4461, address=/127.0.0.1:56196}
2024-02-05T18:15:29,403 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:15:29,404 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-0-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:40225/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:15:29,404 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-547a822f1e}, consumerId=1, consumerName=b6dc8, address=/127.0.0.1:56196}
2024-02-05T18:15:29,404 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:15:29,404 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:15:29,405 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:15:29,411 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:38791
2024-02-05T18:15:29,411 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:15:29,411 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:15:29,412 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:15:29,412 - ERROR - [main:TopBundleLoadDataReporter@112] - Failed to clean broker load data.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:708) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$1.sendComplete(ProducerImpl.java:362) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsg.sendComplete(ProducerImpl.java:1517) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.lambda$failPendingMessages$18(ProducerImpl.java:2061) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.ArrayDeque.forEach(ArrayDeque.java:888) ~[?:?]
	at org.apache.pulsar.client.impl.ProducerImpl$OpSendMsgQueue.forEach(ProducerImpl.java:1608) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.failPendingMessages(ProducerImpl.java:2051) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1104) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ProducerImpl.closeAsync(ProducerImpl.java:1071) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4706) ~[?:?]
	at java.util.Collections$SetFromMap.forEach(Collections.java:5700) ~[?:?]
	at org.apache.pulsar.client.impl.PulsarClientImpl.closeAsync(PulsarClientImpl.java:744) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.PulsarClientImpl.close(PulsarClientImpl.java:720) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:532) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$MtoZBsSc.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.closeAsync(PulsarService.java:419) ~[classes/:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor$Dispatcher$ByteBuddy$MtoZBsSc.invokeWithArguments(Unknown Source) ~[?:?]
	at org.mockito.internal.util.reflection.InstrumentationMemberAccessor.invoke(InstrumentationMemberAccessor.java:239) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.util.reflection.ModuleMemberAccessor.invoke(ModuleMemberAccessor.java:55) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.tryInvoke(MockMethodAdvice.java:333) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.access$500(MockMethodAdvice.java:60) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice$RealMethodCall.invoke(MockMethodAdvice.java:253) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.invocation.InterceptedInvocation.callRealMethod(InterceptedInvocation.java:142) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:45) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.Answers.answer(Answers.java:99) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:110) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82) ~[mockito-core-3.12.4.jar:?]
	at org.mockito.internal.creation.bytebuddy.MockMethodAdvice.handle(MockMethodAdvice.java:151) ~[mockito-core-3.12.4.jar:?]
	at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:398) ~[classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext$StartableCustomBuilder.lambda$initializePulsarServices$0(PulsarTestContext.java:664) ~[test-classes/:?]
	at org.apache.pulsar.broker.testcontext.PulsarTestContext.close(PulsarTestContext.java:194) ~[test-classes/:?]
	at org.apache.pulsar.broker.auth.MockedPulsarServiceBaseTest.internalCleanup(MockedPulsarServiceBaseTest.java:247) ~[test-classes/:?]
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.cleanup(ExtensibleLoadManagerImplTest.java:197) ~[test-classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.invokeAfterClassMethods(TestMethodWorker.java:222) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:131) ~[testng-7.7.1.jar:7.7.1]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at org.testng.TestRunner.privateRun(TestRunner.java:829) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestRunner.run(TestRunner.java:602) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:437) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:431) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:391) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunner.run(SuiteRunner.java:330) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1256) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1176) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.runSuites(TestNG.java:1099) ~[testng-7.7.1.jar:7.7.1]
	at org.testng.TestNG.run(TestNG.java:1067) ~[testng-7.7.1.jar:7.7.1]
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:155) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:102) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeLazy(TestNGDirectoryTestSuite.java:117) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:86) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:137) ~[surefire-testng-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.1.0.jar:3.1.0]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.1.0.jar:3.1.0]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The producer test-0-2 of the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was already closed when closing the producers
	at org.apache.pulsar.client.impl.ProducerImpl.closeAndClearPendingMessages(ProducerImpl.java:1101) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 76 more
2024-02-05T18:15:29,414 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-547a822f1e] Closed Consumer (not connected)
2024-02-05T18:15:29,415 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-5e906c674d] Closed Consumer (not connected)
2024-02-05T18:15:29,415 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-699657eb1f] Closed Consumer (not connected)
2024-02-05T18:15:29,415 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:40225/__change_events] [reader-48986fa7e8] Closed Consumer (not connected)
2024-02-05T18:15:29,415 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-547a822f1e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-547a822f1e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:29,415 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-5e906c674d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-5e906c674d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:29,416 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-699657eb1f was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-699657eb1f was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:29,417 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40225/__change_events with subscription name reader-48986fa7e8 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:40225/__change_events with subscription name reader-48986fa7e8 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:15:29,419 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:15:29,419 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:15:29,419 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:15:29,419 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:15:29,420 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:15:29,420 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:29,421 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:15:29,421 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:30,806 - INFO  - [globalEventExecutor-10-8:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:15:30,807 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:15:30,808 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:15:30,808 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:30,809 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:15:30,809 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:15:30,816 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:15:30,816 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:15:30,821 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:15:30,821 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:15:30,821 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:15:30,821 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:15:30,821 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:15:30,821 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:15:30,821 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:15:30,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 185 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:15:30,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 186 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:15:30,822 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 191 with name 'Thread[globalEventExecutor-10-8,5,main]'
2024-02-05T18:15:30,822 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:15:30,822 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:15:30,822 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@11efc5da
2024-02-05T18:15:30,822 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:15:30,822 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:15:30,822 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.637 s - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:04 min
[INFO] Finished at: 2024-02-05T18:15:31+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
----------- LOOP 8 ---------------
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Detecting the operating system and CPU architecture
[INFO] ------------------------------------------------------------------------
[INFO] os.detected.name: linux
[INFO] os.detected.arch: x86_64
[INFO] os.detected.bitness: 64
[INFO] os.detected.version: 6.5
[INFO] os.detected.version.major: 6
[INFO] os.detected.version.minor: 5
[INFO] os.detected.release: ubuntu
[INFO] os.detected.release.version: 22.04
[INFO] os.detected.release.like.ubuntu: true
[INFO] os.detected.release.like.debian: true
[INFO] os.detected.classifier: linux-x86_64
[WARNING] This build will only read from the build cache, since the clean lifecycle is not part of the build invocation.
[INFO] 
[INFO] ------------------< org.apache.pulsar:pulsar-broker >-------------------
[INFO] Building Pulsar Broker 3.0.2
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-java-version) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] 
[INFO] --- enforcer:3.3.0:enforce (enforce-maven) @ pulsar-broker ---
[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed
[INFO] Rule 1: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed
[INFO] 
[INFO] --- directory:1.0:directory-of (directories) @ pulsar-broker ---
[INFO] Directory of org.apache.pulsar:pulsar set to: /home/maxmirelli/Dev/apache/pulsar/fix-21556
[INFO] 
[INFO] --- git-commit-id:4.9.10:revision (git-info) @ pulsar-broker ---
[INFO] 
[INFO] --- properties:1.1.0:set-system-properties (default) @ pulsar-broker ---
[INFO] Set 2 system properties
[INFO] 
[INFO] --- protobuf:0.6.1:compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- protobuf:0.6.1:test-compile (default) @ pulsar-broker ---
[INFO] Skipping compilation because target directory newer than sources.
[INFO] 
[INFO] --- lightproto:0.4:generate (default) @ pulsar-broker ---
[INFO] LightProto generated enum /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckOp.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadata.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/PendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/transaction/pendingack/proto/BatchedPendingAckMetadataEntry.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/NetworkUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/StorageUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsage.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/service/resource/usage/ResourceUsageInfo.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/DelayedIndex.java
[INFO] LightProto generated class /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/generated-sources/lightproto/java/org/apache/pulsar/broker/delayed/proto/SnapshotSegment.java
[INFO] 
[INFO] --- remote-resources:1.7.0:process (process-resource-bundles) @ pulsar-broker ---
[INFO] Preparing remote bundle org.apache:apache-jar-resource-bundle:1.4
[INFO] Copying 3 resources from 1 bundle.
[INFO] 
[INFO] --- resources:3.3.0:resources (default-resources) @ pulsar-broker ---
[INFO] skip non existing resourceDirectory /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/src/main/resources
[INFO] Copying 3 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ pulsar-broker ---
[INFO] Compiling 13 source files with javac [debug deprecation release 17] to target/classes
[INFO] 
[INFO] --- dependency:3.5.0:copy (copy-pulsar-io-connectors) @ pulsar-broker ---
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-io-batch-data-generator:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples:3.0.2:jar
[INFO] Configured Artifact: org.apache.pulsar:pulsar-functions-api-examples-builtin:3.0.2:jar
[INFO] Copying pulsar-io-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-data-generator.nar
[INFO] Copying pulsar-io-batch-data-generator-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-io-batch-data-generator.nar
[INFO] Copying pulsar-functions-api-examples-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.jar
[INFO] Copying pulsar-functions-api-examples-builtin-3.0.2.jar to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/pulsar-functions-api-examples.nar
[INFO] 
[INFO] --- resources:3.3.0:testResources (default-testResources) @ pulsar-broker ---
[INFO] Copying 43 resources
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ pulsar-broker ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.0:copy-resources (copy-resources) @ pulsar-broker ---
[INFO] Copying 53 resources
[INFO] 
[INFO] --- surefire:3.1.0:test (default-test) @ pulsar-broker ---
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] Using configured provider org.apache.maven.surefire.testng.TestNGProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
Created annotation listener
2024-02-05T18:16:01,803 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:16:02,917 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:16:02,919 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:16:03,383 - INFO  - [main:Environment@98] - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC
2024-02-05T18:16:03,384 - INFO  - [main:Environment@98] - Client environment:host.name=maxmirelli-UX305FA
2024-02-05T18:16:03,385 - INFO  - [main:Environment@98] - Client environment:java.version=17.0.9
2024-02-05T18:16:03,385 - INFO  - [main:Environment@98] - Client environment:java.vendor=Eclipse Adoptium
2024-02-05T18:16:03,386 - INFO  - [main:Environment@98] - Client environment:java.home=/home/maxmirelli/.sdkman/candidates/java/17.0.9-tem
2024-02-05T18:16:03,387 - INFO  - [main:Environment@98] - Client environment:java.class.path=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/test-classes:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/classes:/home/maxmirelli/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-lang3/3.11/commons-lang3-3.11.jar:/home/maxmirelli/.m2/repository/org/slf4j/slf4j-api/1.7.32/slf4j-api-1.7.32.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport/4.1.100.Final/netty-transport-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-common/4.1.100.Final/netty-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-buffer/4.1.100.Final/netty-buffer-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver/4.1.100.Final/netty-resolver-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java/3.19.6/protobuf-java-3.19.6.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-original/3.0.2/pulsar-client-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-api/3.0.2/pulsar-client-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-common/3.0.2/pulsar-common-3.0.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.14.2/jackson-module-parameter-names-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.14.2/jackson-datatype-jsr310-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.14.2/jackson-datatype-jdk8-2.14.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/airlift/aircompressor/0.20/aircompressor-0.20.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-classes-io_uring/0.0.21.Final/netty-incubator-transport-classes-io_uring-0.0.21.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-haproxy/4.1.100.Final/netty-codec-haproxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/bouncy-castle-bc/3.0.2/bouncy-castle-bc-3.0.2-pkg.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.69/bcpkix-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.69/bcprov-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.69/bcutil-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/org/bouncycastle/bcprov-ext-jdk15on/1.69/bcprov-ext-jdk15on-1.69.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http/4.1.100.Final/netty-codec-http-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec/4.1.100.Final/netty-codec-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler-proxy/4.1.100.Final/netty-handler-proxy-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-socks/4.1.100.Final/netty-codec-socks-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns/4.1.100.Final/netty-resolver-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-dns/4.1.100.Final/netty-codec-dns-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-classes-macos/4.1.100.Final/netty-resolver-dns-classes-macos-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-resolver-dns-native-macos/4.1.100.Final/netty-resolver-dns-native-macos-4.1.100.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/maxmirelli/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/maxmirelli/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/maxmirelli/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.6/netty-reactive-streams-2.0.6.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/sketches-core/0.8.3/sketches-core-0.8.3.jar:/home/maxmirelli/.m2/repository/com/yahoo/datasketches/memory/0.8.3/memory-0.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro-protobuf/1.11.3/avro-protobuf-1.11.3.jar:/home/maxmirelli/.m2/repository/net/jcip/jcip-annotations/1.0/jcip-annotations-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-websocket/3.0.2/pulsar-websocket-3.0.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-api/9.4.53.v20231009/websocket-api-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-server/9.4.53.v20231009/websocket-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-common/9.4.53.v20231009/websocket-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-client/9.4.53.v20231009/websocket-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/9.4.53.v20231009/websocket-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/websocket/javax-websocket-client-impl/9.4.53.v20231009/javax-websocket-client-impl-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/javax/websocket/javax.websocket-client-api/1.0/javax.websocket-client-api-1.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-original/3.0.2/pulsar-client-admin-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-admin-api/3.0.2/pulsar-client-admin-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-client/2.34/jersey-client-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-multipart/2.34/jersey-media-multipart-2.34.jar:/home/maxmirelli/.m2/repository/org/jvnet/mimepull/mimepull/1.9.13/mimepull-1.9.13.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/prometheus-metrics-provider/4.16.3/prometheus-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet/0.16.0/simpleclient_servlet-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_common/0.16.0/simpleclient_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_servlet_common/0.16.0/simpleclient_servlet_common-0.16.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/codahale-metrics-provider/4.16.3/codahale-metrics-provider-4.16.3.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jmx/4.1.12.1/metrics-jmx-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-jvm/4.1.12.1/metrics-jvm-4.1.12.1.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-graphite/4.1.12.1/metrics-graphite-4.1.12.1.jar:/home/maxmirelli/.m2/repository/com/rabbitmq/amqp-client/5.5.3/amqp-client-5.5.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-server/4.16.3/stream-storage-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-impl/4.16.3/stream-storage-service-impl-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-service-api/4.16.3/stream-storage-service-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-proto/4.16.3/stream-storage-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client-base/4.16.3/stream-storage-java-client-base-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-api/4.16.3/stream-storage-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/statelib/4.16.3/statelib-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-common/4.16.3/stream-storage-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stream-storage-java-client/4.16.3/stream-storage-java-client-4.16.3.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.100.Final/netty-transport-native-unix-common-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-api/1.55.3/grpc-api-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-auth/1.55.3/grpc-auth-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-credentials/1.4.0/google-auth-library-credentials-1.4.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-context/1.55.3/grpc-context-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/android/annotations/4.1.1.4/annotations-4.1.1.4.jar:/home/maxmirelli/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.21/animal-sniffer-annotations-1.21.jar:/home/maxmirelli/.m2/repository/com/google/protobuf/protobuf-java-util/3.19.6/protobuf-java-util-3.19.6.jar:/home/maxmirelli/.m2/repository/io/netty/netty-codec-http2/4.1.100.Final/netty-codec-http2-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/com/google/api/grpc/proto-google-common-protos/2.9.0/proto-google-common-protos-2.9.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf-lite/1.55.3/grpc-protobuf-lite-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-rls/1.55.3/grpc-rls-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auto/value/auto-value-annotations/1.9/auto-value-annotations-1.9.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-services/1.55.3/grpc-services-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-xds/1.55.3/grpc-xds-1.55.3.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-proto/0.2.0/opencensus-proto-0.2.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-alts/1.55.3/grpc-alts-1.55.3.jar:/home/maxmirelli/.m2/repository/com/google/auth/google-auth-library-oauth2-http/1.4.0/google-auth-library-oauth2-http-1.4.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client/1.41.0/google-http-client-1.41.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-api/0.28.0/opencensus-api-0.28.0.jar:/home/maxmirelli/.m2/repository/io/opencensus/opencensus-contrib-http-util/0.28.0/opencensus-contrib-http-util-0.28.0.jar:/home/maxmirelli/.m2/repository/com/google/http-client/google-http-client-gson/1.41.0/google-http-client-gson-1.41.0.jar:/home/maxmirelli/.m2/repository/com/google/re2j/re2j/1.6/re2j-1.6.jar:/home/maxmirelli/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/maxmirelli/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/vertx-http-server/4.16.3/vertx-http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-core/4.3.8/vertx-core-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web/4.3.8/vertx-web-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-web-common/4.3.8/vertx-web-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-auth-common/4.3.8/vertx-auth-common-4.3.8.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-bridge-common/4.3.8/vertx-bridge-common-4.3.8.jar:/home/maxmirelli/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-tools-framework/4.16.3/bookkeeper-tools-framework-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-broker-common/3.0.2/pulsar-broker-common-3.0.2.jar:/home/maxmirelli/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/maxmirelli/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-impl/0.11.1/jjwt-impl-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-api/0.11.1/jjwt-api-0.11.1.jar:/home/maxmirelli/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.11.1/jjwt-jackson-0.11.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-common/3.0.2/pulsar-transaction-common-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-batch-discovery-triggerers/3.0.2/pulsar-io-batch-discovery-triggerers-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-io-core/3.0.2/pulsar-io-core-3.0.2.jar:/home/maxmirelli/.m2/repository/com/cronutils/cron-utils/9.1.6/cron-utils-9.1.6.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-context/5.3.27/spring-context-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-aop/5.3.27/spring-aop-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-beans/5.3.27/spring-beans-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-core/5.3.27/spring-core-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-jcl/5.3.27/spring-jcl-5.3.27.jar:/home/maxmirelli/.m2/repository/org/springframework/spring-expression/5.3.27/spring-expression-5.3.27.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/testmocks/3.0.2/testmocks-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper/3.8.3/zookeeper-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.8.3/zookeeper-jute-3.8.3.jar:/home/maxmirelli/.m2/repository/org/apache/yetus/audience-annotations/0.12.0/audience-annotations-0.12.0.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/maxmirelli/.m2/repository/com/github/tomakehurst/wiremock-jre8/2.33.2/wiremock-jre8-2.33.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.53.v20231009/jetty-webapp-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.53.v20231009/jetty-xml-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-proxy/9.4.53.v20231009/jetty-proxy-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-client/9.4.53.v20231009/jetty-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-server/9.4.53.v20231009/http2-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-common/9.4.53.v20231009/http2-common-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/http2/http2-hpack/9.4.53.v20231009/http2-hpack-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-server/9.4.53.v20231009/jetty-alpn-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-server/9.4.53.v20231009/jetty-alpn-java-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-server/9.4.53.v20231009/jetty-alpn-openjdk8-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-java-client/9.4.53.v20231009/jetty-alpn-java-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-client/9.4.53.v20231009/jetty-alpn-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-openjdk8-client/9.4.53.v20231009/jetty-alpn-openjdk8-client-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.14.2/jackson-core-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.14.2/jackson-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.14.2/jackson-databind-2.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/client5/httpclient5/5.1.3/httpclient5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5/5.1.3/httpcore5-5.1.3.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/core5/httpcore5-h2/5.1.3/httpcore5-h2-5.1.3.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-core/2.9.0/xmlunit-core-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-legacy/2.9.0/xmlunit-legacy-2.9.0.jar:/home/maxmirelli/.m2/repository/org/xmlunit/xmlunit-placeholders/2.9.0/xmlunit-placeholders-2.9.0.jar:/home/maxmirelli/.m2/repository/net/javacrumbs/json-unit/json-unit-core/2.33.0/json-unit-core-2.33.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest-core/2.2/hamcrest-core-2.2.jar:/home/maxmirelli/.m2/repository/com/jayway/jsonpath/json-path/2.7.0/json-path-2.7.0.jar:/home/maxmirelli/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/maxmirelli/.m2/repository/org/ow2/asm/asm/9.3/asm-9.3.jar:/home/maxmirelli/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.4/jopt-simple-5.0.4.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars/4.3.0/handlebars-4.3.0.jar:/home/maxmirelli/.m2/repository/com/github/jknack/handlebars-helpers/4.3.0/handlebars-helpers-4.3.0.jar:/home/maxmirelli/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/home/maxmirelli/.m2/repository/commons-io/commons-io/2.8.0/commons-io-2.8.0.jar:/home/maxmirelli/.m2/repository/io/dropwizard/metrics/metrics-core/4.1.12.1/metrics-core-4.1.12.1.jar:/home/maxmirelli/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-worker/3.0.2/pulsar-functions-worker-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-runtime/3.0.2/pulsar-functions-runtime-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-instance/3.0.2/pulsar-functions-instance-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-utils/3.0.2/pulsar-functions-utils-3.0.2.jar:/home/maxmirelli/.m2/repository/net/jodah/typetools/0.5.0/typetools-0.5.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_httpserver/0.16.0/simpleclient_httpserver-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/jmx/collector/0.16.1/collector-0.16.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-secrets/3.0.2/pulsar-functions-secrets-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-proto/3.0.2/pulsar-functions-proto-3.0.2.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java/18.0.0/client-java-18.0.0.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-api/18.0.0/client-java-api-18.0.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/okhttp/4.9.3/okhttp-4.9.3.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio/3.4.0/okio-3.4.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okio/okio-jvm/3.4.0/okio-jvm-3.4.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.0/kotlin-stdlib-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.0/kotlin-stdlib-common-1.6.0.jar:/home/maxmirelli/.m2/repository/com/squareup/okhttp3/logging-interceptor/4.9.3/logging-interceptor-4.9.3.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.6.0/kotlin-stdlib-jdk8-1.6.0.jar:/home/maxmirelli/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-jdk7/1.6.0/kotlin-stdlib-jdk7-1.6.0.jar:/home/maxmirelli/.m2/repository/io/gsonfire/gson-fire/1.8.5/gson-fire-1.8.5.jar:/home/maxmirelli/.m2/repository/io/kubernetes/client-java-proto/18.0.0/client-java-proto-18.0.0.jar:/home/maxmirelli/.m2/repository/org/bitbucket/b_c/jose4j/0.9.3/jose4j-0.9.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-core/4.16.3/distributedlog-core-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-protocol/4.16.3/distributedlog-protocol-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/distributedlog/distributedlog-common/4.16.3/distributedlog-common-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/thrift/libthrift/0.14.2/libthrift-0.14.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-local-runner-original/3.0.2/pulsar-functions-local-runner-original-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.18.0/log4j-slf4j-impl-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-api/2.18.0/log4j-api-2.18.0.jar:/home/maxmirelli/.m2/repository/org/apache/logging/log4j/log4j-core/2.18.0/log4j-core-2.18.0.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-all/1.55.3/grpc-all-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet/1.55.3/grpc-servlet-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-servlet-jakarta/1.55.3/grpc-servlet-jakarta-1.55.3.jar:/home/maxmirelli/.m2/repository/io/perfmark/perfmark-api/0.26.0/perfmark-api-0.26.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-client-messagecrypto-bc/3.0.2/pulsar-client-messagecrypto-bc-3.0.2.jar:/home/maxmirelli/.m2/repository/org/awaitility/awaitility/4.2.0/awaitility-4.2.0.jar:/home/maxmirelli/.m2/repository/org/hamcrest/hamcrest/2.2/hamcrest-2.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-server/9.4.53.v20231009/jetty-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-http/9.4.53.v20231009/jetty-http-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-io/9.4.53.v20231009/jetty-io-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-alpn-conscrypt-server/9.4.53.v20231009/jetty-alpn-conscrypt-server-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/conscrypt/conscrypt-openjdk-uber/2.5.2/conscrypt-openjdk-uber-2.5.2.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.53.v20231009/jetty-servlet-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-security/9.4.53.v20231009/jetty-security-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.53.v20231009/jetty-util-ajax-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-servlets/9.4.53.v20231009/jetty-servlets-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-continuation/9.4.53.v20231009/jetty-continuation-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/eclipse/jetty/jetty-util/9.4.53.v20231009/jetty-util-9.4.53.v20231009.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-server/2.34/jersey-server-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/core/jersey-common/2.34/jersey-common-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.3/osgi-resource-locator-1.0.3.jar:/home/maxmirelli/.m2/repository/jakarta/ws/rs/jakarta.ws.rs-api/2.1.6/jakarta.ws.rs-api-2.1.6.jar:/home/maxmirelli/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.6.1/jakarta.inject-2.6.1.jar:/home/maxmirelli/.m2/repository/jakarta/validation/jakarta.validation-api/2.0.2/jakarta.validation-api-2.0.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.34/jersey-container-servlet-core-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.34/jersey-container-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.34/jersey-media-json-jackson-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.34/jersey-entity-filtering-2.34.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.14.2/jackson-module-jaxb-annotations-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/jersey-test-framework-core/2.34/jersey-test-framework-core-2.34.jar:/home/maxmirelli/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.3/jakarta.xml.bind-api-2.3.3.jar:/home/maxmirelli/.m2/repository/jakarta/servlet/jakarta.servlet-api/4.0.3/jakarta.servlet-api-4.0.3.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.34/jersey-media-jaxb-2.34.jar:/home/maxmirelli/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/test-framework/providers/jersey-test-framework-provider-grizzly2/2.34/jersey-test-framework-provider-grizzly2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-http/2.34/jersey-container-grizzly2-http-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-server/2.4.4/grizzly-http-server-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http/2.4.4/grizzly-http-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-framework/2.4.4/grizzly-framework-2.4.4.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/containers/jersey-container-grizzly2-servlet/2.34/jersey-container-grizzly2-servlet-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/grizzly/grizzly-http-servlet/2.4.4/grizzly-http-servlet-2.4.4.jar:/home/maxmirelli/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.2/jakarta.activation-api-1.2.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.14.2/jackson-jaxrs-json-provider-2.14.2.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.14.2/jackson-jaxrs-base-2.14.2.jar:/home/maxmirelli/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.34/jersey-hk2-2.34.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-locator/2.6.1/hk2-locator-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.6.1/aopalliance-repackaged-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-api/2.6.1/hk2-api-2.6.1.jar:/home/maxmirelli/.m2/repository/org/glassfish/hk2/hk2-utils/2.6.1/hk2-utils-2.6.1.jar:/home/maxmirelli/.m2/repository/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/module/jackson-module-jsonSchema/2.14.2/jackson-module-jsonSchema-2.14.2.jar:/home/maxmirelli/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/maxmirelli/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.32/jcl-over-slf4j-1.7.32.jar:/home/maxmirelli/.m2/repository/com/google/guava/guava/32.1.1-jre/guava-32.1.1-jre.jar:/home/maxmirelli/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/maxmirelli/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/maxmirelli/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/maxmirelli/.m2/repository/org/checkerframework/checker-qual/3.33.0/checker-qual-3.33.0.jar:/home/maxmirelli/.m2/repository/com/google/errorprone/error_prone_annotations/2.5.1/error_prone_annotations-2.5.1.jar:/home/maxmirelli/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/maxmirelli/.m2/repository/com/beust/jcommander/1.82/jcommander-1.82.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-annotations/1.6.10/swagger-annotations-1.6.10.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar:/home/maxmirelli/.m2/repository/io/prometheus/simpleclient_caffeine/0.16.0/simpleclient_caffeine-0.16.0.jar:/home/maxmirelli/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.9.1/caffeine-2.9.1.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-core/1.6.10/swagger-core-1.6.10.jar:/home/maxmirelli/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.14.2/jackson-dataformat-yaml-2.14.2.jar:/home/maxmirelli/.m2/repository/io/swagger/swagger-models/1.6.10/swagger-models-1.6.10.jar:/home/maxmirelli/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar:/home/maxmirelli/.m2/repository/org/hdrhistogram/HdrHistogram/2.1.9/HdrHistogram-2.1.9.jar:/home/maxmirelli/.m2/repository/com/google/code/gson/gson/2.8.9/gson-2.8.9.jar:/home/maxmirelli/.m2/repository/com/github/zafarkhaja/java-semver/0.9.0/java-semver-0.9.0.jar:/home/maxmirelli/.m2/repository/org/apache/avro/avro/1.11.3/avro-1.11.3.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/maxmirelli/.m2/repository/com/carrotsearch/hppc/0.9.1/hppc-0.9.1.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/RoaringBitmap/0.9.44/RoaringBitmap-0.9.44.jar:/home/maxmirelli/.m2/repository/org/roaringbitmap/shims/0.9.44/shims-0.9.44.jar:/home/maxmirelli/.m2/repository/com/github/oshi/oshi-core-java11/6.4.0/oshi-core-java11-6.4.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-jpms/5.12.1/jna-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna-platform-jpms/5.12.1/jna-platform-jpms-5.12.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api/3.0.2/pulsar-functions-api-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-functions-api-examples/3.0.2/pulsar-functions-api-examples-3.0.2.jar:/home/maxmirelli/.m2/repository/io/codearte/jfairy/jfairy/0.5.9/jfairy-0.5.9.jar:/home/maxmirelli/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/maxmirelli/.m2/repository/com/google/inject/extensions/guice-assistedinject/5.1.0/guice-assistedinject-5.1.0.jar:/home/maxmirelli/.m2/repository/joda-time/joda-time/2.10.10/joda-time-2.10.10.jar:/home/maxmirelli/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/maxmirelli/.m2/repository/org/iban4j/iban4j/3.2.1/iban4j-3.2.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-config-validation/3.0.2/pulsar-config-validation-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-metadata/3.0.2/pulsar-metadata-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-core/0.7.5/jetcd-core-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-grpc/0.7.5/jetcd-grpc-0.7.5.jar:/home/maxmirelli/.m2/repository/io/vertx/vertx-grpc/4.3.5/vertx-grpc-4.3.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-common/0.7.5/jetcd-common-0.7.5.jar:/home/maxmirelli/.m2/repository/net/jodah/failsafe/2.4.4/failsafe-2.4.4.jar:/home/maxmirelli/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar:/home/maxmirelli/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-transaction-coordinator/3.0.2/pulsar-transaction-coordinator-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-test/0.7.5/jetcd-test-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-api/0.7.5/jetcd-api-0.7.5.jar:/home/maxmirelli/.m2/repository/io/etcd/jetcd-launcher/0.7.5/jetcd-launcher-0.7.5.jar:/home/maxmirelli/.m2/repository/org/testcontainers/testcontainers/1.18.3/testcontainers-1.18.3.jar:/home/maxmirelli/.m2/repository/org/rnorth/duct-tape/duct-tape/1.0.8/duct-tape-1.0.8.jar:/home/maxmirelli/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-api/3.3.0/docker-java-api-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport-zerodep/3.3.0/docker-java-transport-zerodep-3.3.0.jar:/home/maxmirelli/.m2/repository/com/github/docker-java/docker-java-transport/3.3.0/docker-java-transport-3.3.0.jar:/home/maxmirelli/.m2/repository/net/java/dev/jna/jna/5.12.1/jna-5.12.1.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-core/1.55.3/grpc-core-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-netty/1.55.3/grpc-netty-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-protobuf/1.55.3/grpc-protobuf-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-stub/1.55.3/grpc-stub-1.55.3.jar:/home/maxmirelli/.m2/repository/io/grpc/grpc-grpclb/1.55.3/grpc-grpclb-1.55.3.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter/5.9.1/junit-jupiter-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.9.1/junit-jupiter-api-5.9.1.jar:/home/maxmirelli/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-commons/1.9.1/junit-platform-commons-1.9.1.jar:/home/maxmirelli/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.9.1/junit-jupiter-params-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.9.1/junit-jupiter-engine-5.9.1.jar:/home/maxmirelli/.m2/repository/org/junit/platform/junit-platform-engine/1.9.1/junit-platform-engine-1.9.1.jar:/home/maxmirelli/.m2/repository/com/google/auto/service/auto-service-annotations/1.0.1/auto-service-annotations-1.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-filesystem-storage/3.0.2/pulsar-package-filesystem-storage-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/managed-ledger/3.0.2/managed-ledger-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/pulsar-package-core/3.0.2/pulsar-package-core-3.0.2-tests.jar:/home/maxmirelli/.m2/repository/org/apache/pulsar/buildtools/3.0.2/buildtools-3.0.2.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant/1.10.12/ant-1.10.12.jar:/home/maxmirelli/.m2/repository/org/apache/ant/ant-launcher/1.10.12/ant-launcher-1.10.12.jar:/home/maxmirelli/.m2/repository/com/google/inject/guice/5.1.0/guice-5.1.0.jar:/home/maxmirelli/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/maxmirelli/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/maxmirelli/.m2/repository/org/webjars/jquery/3.6.1/jquery-3.6.1.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy/1.11.13/byte-buddy-1.11.13.jar:/home/maxmirelli/.m2/repository/net/bytebuddy/byte-buddy-agent/1.11.13/byte-buddy-agent-1.11.13.jar:/home/maxmirelli/.m2/repository/org/testng/testng/7.7.1/testng-7.7.1.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-core/3.12.4/mockito-core-3.12.4.jar:/home/maxmirelli/.m2/repository/org/mockito/mockito-inline/3.12.4/mockito-inline-3.12.4.jar:/home/maxmirelli/.m2/repository/com/github/stefanbirkner/system-lambda/1.2.1/system-lambda-1.2.1.jar:/home/maxmirelli/.m2/repository/org/assertj/assertj-core/3.24.2/assertj-core-3.24.2.jar:/home/maxmirelli/.m2/repository/org/projectlombok/lombok/1.18.30/lombok-1.18.30.jar:/home/maxmirelli/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-server/4.16.3/bookkeeper-server-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common-allocator/4.16.3/bookkeeper-common-allocator-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-proto/4.16.3/bookkeeper-proto-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-slf4j/4.16.3/bookkeeper-slogger-slf4j-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-slogger-api/4.16.3/bookkeeper-slogger-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/native-io/4.16.3/native-io-4.16.3.jar:/home/maxmirelli/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/maxmirelli/.m2/repository/io/netty/netty-handler/4.1.100.Final/netty-handler-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-native-epoll/4.1.100.Final/netty-transport-native-epoll-4.1.100.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-transport-classes-epoll/4.1.100.Final/netty-transport-classes-epoll-4.1.100.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-classes/2.0.61.Final/netty-tcnative-classes-2.0.61.Final.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-linux-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-osx-aarch_64.jar:/home/maxmirelli/.m2/repository/io/netty/netty-tcnative-boringssl-static/2.0.61.Final/netty-tcnative-boringssl-static-2.0.61.Final-windows-x86_64.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/http/http-server/4.16.3/http-server-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/circe-checksum/4.16.3/circe-checksum-4.16.3.jar:/home/maxmirelli/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/maxmirelli/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/maxmirelli/.m2/repository/io/reactivex/rxjava3/rxjava/3.0.1/rxjava-3.0.1.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/bookkeeper-common/4.16.3/bookkeeper-common-4.16.3-tests.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/stats/bookkeeper-stats-api/4.16.3/bookkeeper-stats-api-4.16.3.jar:/home/maxmirelli/.m2/repository/org/apache/bookkeeper/cpu-affinity/4.16.3/cpu-affinity-4.16.3.jar:/home/maxmirelli/.m2/repository/org/jctools/jctools-core/2.1.2/jctools-core-2.1.2.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-x86_64.jar:/home/maxmirelli/.m2/repository/io/netty/incubator/netty-incubator-transport-native-io_uring/0.0.21.Final/netty-incubator-transport-native-io_uring-0.0.21.Final-linux-aarch_64.jar:/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/gradle-enterprise/test-listeners.jar:
2024-02-05T18:16:03,409 - INFO  - [main:Environment@98] - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib
2024-02-05T18:16:03,409 - INFO  - [main:Environment@98] - Client environment:java.io.tmpdir=/tmp
2024-02-05T18:16:03,410 - INFO  - [main:Environment@98] - Client environment:java.compiler=<NA>
2024-02-05T18:16:03,411 - INFO  - [main:Environment@98] - Client environment:os.name=Linux
2024-02-05T18:16:03,411 - INFO  - [main:Environment@98] - Client environment:os.arch=amd64
2024-02-05T18:16:03,412 - INFO  - [main:Environment@98] - Client environment:os.version=6.5.0-15-generic
2024-02-05T18:16:03,412 - INFO  - [main:Environment@98] - Client environment:user.name=maxmirelli
2024-02-05T18:16:03,413 - INFO  - [main:Environment@98] - Client environment:user.home=/home/maxmirelli
2024-02-05T18:16:03,413 - INFO  - [main:Environment@98] - Client environment:user.dir=/home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:16:03,413 - INFO  - [main:Environment@98] - Client environment:os.memory.free=34MB
2024-02-05T18:16:03,414 - INFO  - [main:Environment@98] - Client environment:os.memory.max=1024MB
2024-02-05T18:16:03,414 - INFO  - [main:Environment@98] - Client environment:os.memory.total=128MB
2024-02-05T18:16:05,035 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:16:05,036 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:16:05,036 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:16:05,037 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:16:05,410 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:16:05,411 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:16:05,506 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:16:05,586 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:16:05,589 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:16:05,606 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:16:05,731 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:16:05,777 - INFO  - [main:ByteBufAllocatorImpl@110] - Setting Netty allocator leak detector to Advanced
2024-02-05T18:16:05,834 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:16:06,295 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:16:06,296 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:16:06,331 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-0
2024-02-05T18:16:06,392 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:34941, TLS: (none), listener: (none)
2024-02-05T18:16:06,719 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:36273, TLS: OPENSSL, listener: (none)
2024-02-05T18:16:06,738 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:16:06,743 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:16:06,744 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:16:06,777 - INFO  - [main:Log@170] - Logging initialized @7319ms to org.eclipse.jetty.util.log.Slf4jLog
2024-02-05T18:16:07,572 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:16:07,602 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:16:07,602 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:16:07,605 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:16:08,398 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@332fa1c{/,null,AVAILABLE}
2024-02-05T18:16:09,474 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,AVAILABLE}
2024-02-05T18:16:10,573 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,AVAILABLE}
2024-02-05T18:16:10,955 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,AVAILABLE}
2024-02-05T18:16:11,089 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,AVAILABLE}
2024-02-05T18:16:11,208 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,AVAILABLE}
2024-02-05T18:16:11,210 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,AVAILABLE}
2024-02-05T18:16:11,214 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@7c200e57{/static,null,AVAILABLE}
2024-02-05T18:16:11,237 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:46117}
2024-02-05T18:16:11,387 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:42673}
2024-02-05T18:16:11,387 - INFO  - [main:Server@415] - Started @11931ms
2024-02-05T18:16:11,388 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:46117
2024-02-05T18:16:11,389 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:42673
2024-02-05T18:16:11,397 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:16:11,398 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:16:11,583 - INFO  - [metadata-store-2-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:46117
2024-02-05T18:16:11,598 - INFO  - [metadata-store-2-1:LeaderElectionImpl@184] - Acquired leadership on /loadbalance/extension/leader
2024-02-05T18:16:11,602 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@744] - This broker:localhost:46117 is changing the role from null to Leader
2024-02-05T18:16:11,605 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:46117).
2024-02-05T18:16:11,919 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:46117 
2024-02-05T18:16:12,312 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[pulsar/system], refreshing the bundle cache.
2024-02-05T18:16:12,342 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:12,456 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:16:12,463 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:16:12,474 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger pulsar/system/persistent/loadbalancer-service-unit-state
2024-02-05T18:16:12,478 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/pulsar/system/persistent/loadbalancer-service-unit-state'
2024-02-05T18:16:12,524 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 3
2024-02-05T18:16:12,562 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created ledger 3 after closed null
2024-02-05T18:16:12,598 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [pulsar/system/persistent/loadbalancer-service-unit-state] Successfully initialize managed ledger
2024-02-05T18:16:12,666 - INFO  - [broker-topic-workers-OrderedExecutor-0-0:ManagedCursorImpl@692] - [pulsar/system/persistent/loadbalancer-service-unit-state] Cursor __compaction recovered to position 3:-1
2024-02-05T18:16:12,689 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: ManagedCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, name=__compaction, ackPos=3:-1, readPos=3:0}
2024-02-05T18:16:12,698 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state - dedup is disabled
2024-02-05T18:16:12,701 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
2024-02-05T18:16:12,730 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic persistent://pulsar/system/loadbalancer-service-unit-state.
2024-02-05T18:16:12,734 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:12 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 542
2024-02-05T18:16:12,908 - INFO  - [pulsar-io-9-4:ConnectionPool@265] - [[id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]] Connected to server
2024-02-05T18:16:12,946 - INFO  - [pulsar-io-9-1:ServerCnx@724] - [/127.0.0.1:50684] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:16:13,013 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,020 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,074 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 4
2024-02-05T18:16:13,095 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50684] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50684, producerName=test-0-0, producerId=0}
2024-02-05T18:16:13,103 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Created producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,104 - INFO  - [main:ServiceUnitStateChannelImpl@321] - Successfully started the channel producer.
2024-02-05T18:16:13,156 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,158 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2bc3e56286] Subscribing to topic on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941], consumerId 0
2024-02-05T18:16:13,169 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x07a8d3ef, L:/127.0.0.1:34941 - R:/127.0.0.1:50684]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-2bc3e56286. consumerId: 0
2024-02-05T18:16:13,207 - INFO  - [pulsar-io-9-1:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2bc3e56286] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:13,208 - INFO  - [pulsar-io-9-1:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:16:13,209 - INFO  - [pulsar-io-9-1:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-2bc3e56286, ackPos=3:-1, readPos=3:0}
2024-02-05T18:16:13,228 - INFO  - [pulsar-io-9-1:ServerCnx@1263] - [/127.0.0.1:50684] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-2bc3e56286
2024-02-05T18:16:13,232 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2bc3e56286] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 0
2024-02-05T18:16:13,243 - INFO  - [broker-client-shared-internal-executor-11-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.011 seconds
2024-02-05T18:16:13,246 - INFO  - [main:ServiceUnitStateChannelImpl@345] - Successfully started the channel tableview.
2024-02-05T18:16:13,247 - INFO  - [main:ServiceUnitStateChannelImpl@349] - Successfully registered the handleMetadataSessionEvent
2024-02-05T18:16:13,247 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:16:13,282 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,303 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}
2024-02-05T18:16:13,304 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
2024-02-05T18:16:13,307 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 46
2024-02-05T18:16:13,307 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-broker-load-data.
2024-02-05T18:16:13,319 - INFO  - [pulsar-web-30-6:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,331 - INFO  - [configuration-metadata-store-4-1:BrokerService@1306] - Created topic NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}
2024-02-05T18:16:13,332 - INFO  - [configuration-metadata-store-4-1:PersistentTopicsBase@406] - [null] Successfully created non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
2024-02-05T18:16:13,334 - INFO  - [main:ExtensibleLoadManagerImpl@279] - Created topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data.
2024-02-05T18:16:13,335 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:13 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 24
2024-02-05T18:16:13,355 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,358 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,369 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 5
2024-02-05T18:16:13,376 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50684] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50684, producerName=test-0-1, producerId=1}
2024-02-05T18:16:13,378 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Created producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,398 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,400 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ee919ff907] Subscribing to topic on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941], consumerId 1
2024-02-05T18:16:13,402 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x07a8d3ef, L:/127.0.0.1:34941 - R:/127.0.0.1:50684]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ee919ff907. consumerId: 1
2024-02-05T18:16:13,423 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ee919ff907] Created new subscription for 1
2024-02-05T18:16:13,424 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50684] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-ee919ff907
2024-02-05T18:16:13,428 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-ee919ff907] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 1
2024-02-05T18:16:13,452 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,453 - INFO  - [pulsar-io-9-4:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,458 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 6
2024-02-05T18:16:13,465 - INFO  - [metadata-store-2-1:ServerCnx@1606] - [/127.0.0.1:50684] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50684, producerName=test-0-2, producerId=2}
2024-02-05T18:16:13,467 - INFO  - [pulsar-io-9-4:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Created producer on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:13,482 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:16:13,506 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:16:13,513 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@262] - This leader broker:localhost:46117 started the ownership monitor.
2024-02-05T18:16:13,528 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:13,530 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-84b92e60dc] Subscribing to topic on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941], consumerId 2
2024-02-05T18:16:13,532 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x07a8d3ef, L:/127.0.0.1:34941 - R:/127.0.0.1:50684]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-84b92e60dc. consumerId: 2
2024-02-05T18:16:13,544 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-84b92e60dc] Created new subscription for 2
2024-02-05T18:16:13,545 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50684] Created subscription on topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data / reader-84b92e60dc
2024-02-05T18:16:13,546 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data][reader-84b92e60dc] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 2
2024-02-05T18:16:13,547 - INFO  - [pulsar-load-manager-6-1:ExtensibleLoadManagerImpl@765] - This broker:localhost:46117 plays the leader now.
2024-02-05T18:16:13,548 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:46117/__change_events
2024-02-05T18:16:13,551 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 54.30%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 54.30%, msgThroughputEMA= 0.00, updatedAt= 1707149773550, reportedAt= 0
2024-02-05T18:16:13,569 - INFO  - [pulsar-load-manager-6-1:TopBundleLoadDataReporter@89] - Reporting TopBundlesLoadData:TopBundlesLoadData(topBundlesLoadData=[])
2024-02-05T18:16:13,573 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:13,574 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:16:13,623 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:46117/0x00000000_0xffffffff - localhost:46117.
2024-02-05T18:16:13,626 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:46117
2024-02-05T18:16:13,626 - INFO  - [pulsar-7-1:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:46117/0x00000000_0xffffffff
2024-02-05T18:16:13,627 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:46117/0x00000000_0xffffffff - localhost:46117.
2024-02-05T18:16:13,630 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:46117
2024-02-05T18:16:13,630 - INFO  - [pulsar-7-2:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:46117/0x00000000_0xffffffff
2024-02-05T18:16:13,634 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:46117/__change_events][reader-917e27e71b] Subscribing to topic on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941], consumerId 3
2024-02-05T18:16:13,636 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x07a8d3ef, L:/127.0.0.1:34941 - R:/127.0.0.1:50684]] Subscribing on topic persistent://sla-monitor/test/localhost:46117/__change_events / reader-917e27e71b. consumerId: 3
2024-02-05T18:16:13,643 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:46117 doesn't exist.
2024-02-05T18:16:13,645 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:46117/persistent/__change_events
2024-02-05T18:16:13,647 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:46117/persistent/__change_events'
2024-02-05T18:16:13,657 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 7
2024-02-05T18:16:13,658 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:46117/persistent/__change_events] Created ledger 7 after closed null
2024-02-05T18:16:13,663 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:46117/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:16:13,669 - INFO  - [broker-topic-workers-OrderedExecutor-3-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:46117/persistent/__change_events] Cursor __compaction recovered to position 7:-1
2024-02-05T18:16:13,674 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:46117/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:46117/persistent/__change_events, name=__compaction, ackPos=7:-1, readPos=7:0}
2024-02-05T18:16:13,675 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:46117/__change_events - dedup is disabled
2024-02-05T18:16:13,690 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 8
2024-02-05T18:16:13,695 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:46117/__change_events][reader-917e27e71b] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:13,696 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:46117/persistent/__change_events] Created non-durable cursor read-position=7:0 mark-delete-position=7:-1
2024-02-05T18:16:13,696 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:46117/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:46117/persistent/__change_events, cursor=reader-917e27e71b, ackPos=7:-1, readPos=7:0}
2024-02-05T18:16:13,705 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50684] Created subscription on topic persistent://sla-monitor/test/localhost:46117/__change_events / reader-917e27e71b
2024-02-05T18:16:13,706 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:46117/__change_events][reader-917e27e71b] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 3
2024-02-05T18:16:13,671 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=8, bootstrap service port = 46117, tls-port = Optional[42673], broker url= pulsar://localhost:34941, broker tls url= pulsar+ssl://localhost:36273, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[34941], brokerServicePortTls=Optional[36273], webServicePort=Optional[46117], webServicePortTls=Optional[42673], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=true, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=true, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:16:14,209 - INFO  - [main:PulsarService@686] - Starting Pulsar Broker service; version: '3.0.2'
2024-02-05T18:16:14,210 - INFO  - [main:PulsarService@688] - Git Revision 12c92fed7847965e3bc3769a91c866b2f0ec2e44(dirty)
2024-02-05T18:16:14,210 - INFO  - [main:PulsarService@689] - Git Branch branch-3.0
2024-02-05T18:16:14,211 - INFO  - [main:PulsarService@690] - Built by fengyubiao <yubiao.feng@streamnative.io> on fengyubiaodeMacBook-Pro.local at 2023-11-17T15:50:55+0800
2024-02-05T18:16:14,217 - INFO  - [main:ProtocolHandlerUtils@79] - Searching for protocol handlers in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./protocols
2024-02-05T18:16:14,217 - WARN  - [main:ProtocolHandlerUtils@83] - Protocol handler directory not found
2024-02-05T18:16:14,223 - INFO  - [main:RangeEntryCacheManagerImpl@69] - Initialized managed-ledger entry cache of 8.0 Mb
2024-02-05T18:16:14,227 - WARN  - [main:DimensionStats@67] - topic_load_times is already registred Failed to register Collector of type Summary: topic_load_times_count is already in use by another Collector of type Summary
2024-02-05T18:16:14,232 - INFO  - [main:AuthorizationService@68] - org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider has been loaded.
2024-02-05T18:16:14,232 - INFO  - [main:EntryFilterProvider@126] - Searching for entry filters in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker
2024-02-05T18:16:14,240 - INFO  - [main:AuthenticationService@93] - Authentication is disabled
2024-02-05T18:16:14,247 - INFO  - [main:BrokerService@392] - Disabling per broker unack-msg blocking due invalid unAckMsgSubscriptionPercentageLimitOnBrokerBlocked 0.16 
2024-02-05T18:16:14,251 - INFO  - [main:PulsarService@1221] - Starting name space service, bootstrap namespaces=[]
2024-02-05T18:16:14,258 - INFO  - [main:BrokerInterceptorUtils@79] - Searching for broker interceptors in /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/./interceptors
2024-02-05T18:16:14,258 - WARN  - [main:BrokerInterceptorUtils@83] - Pulsar broker interceptors directory not found
2024-02-05T18:16:14,262 - INFO  - [main:DistributedIdGenerator@55] - Broker distributed id generator started with instance id test-1
2024-02-05T18:16:14,265 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:44631, TLS: (none), listener: (none)
2024-02-05T18:16:14,266 - INFO  - [main:BrokerService@552] - Started Pulsar Broker service on /[0:0:0:0:0:0:0:0%0]:33613, TLS: OPENSSL, listener: (none)
2024-02-05T18:16:14,269 - INFO  - [main:BrokerService@662] - Scheduling a thread to check backlog quota after [60] seconds in background
2024-02-05T18:16:14,271 - INFO  - [main:DispatchRateLimiter@193] - configured broker message-dispatch rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:16:14,271 - INFO  - [main:DispatchRateLimiter@226] - setting message-dispatch-rate DispatchRateImpl(dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, relativeToPublishRate=false, ratePeriodInSecond=1)
2024-02-05T18:16:14,285 - INFO  - [main:Server@375] - jetty-9.4.53.v20231009; built: 2023-10-09T12:29:09.265Z; git: 27bde00a0b95a1d5bbee0eae7984f891d2d0f8c9; jvm 17.0.9+9
2024-02-05T18:16:14,288 - INFO  - [main:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2024-02-05T18:16:14,289 - INFO  - [main:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2024-02-05T18:16:14,289 - INFO  - [main:HouseKeeper@132] - node0 Scavenging every 600000ms
2024-02-05T18:16:14,375 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@6eda3ade{/,null,AVAILABLE}
2024-02-05T18:16:14,575 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:14,576 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:16:15,069 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@23110196{/admin,null,AVAILABLE}
2024-02-05T18:16:15,577 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:15,577 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:16:16,324 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,AVAILABLE}
2024-02-05T18:16:16,558 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,AVAILABLE}
2024-02-05T18:16:16,578 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:16,579 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:16:16,626 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@328446e1{/lookup,null,AVAILABLE}
2024-02-05T18:16:16,716 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,AVAILABLE}
2024-02-05T18:16:16,718 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,AVAILABLE}
2024-02-05T18:16:16,718 - INFO  - [main:ContextHandler@921] - Started o.e.j.s.h.ContextHandler@45ec9b22{/static,null,AVAILABLE}
2024-02-05T18:16:16,720 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:35385}
2024-02-05T18:16:16,754 - INFO  - [main:AbstractConnector@333] - Started ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:44473}
2024-02-05T18:16:16,754 - INFO  - [main:Server@415] - Started @17298ms
2024-02-05T18:16:16,755 - INFO  - [main:WebService@314] - HTTP Service started at http://0.0.0.0:35385
2024-02-05T18:16:16,757 - INFO  - [main:WebService@321] - HTTPS Service started at https://0.0.0.0:44473
2024-02-05T18:16:16,760 - INFO  - [main:PulsarService@1121] - The load manager extension is enabled. Skipping PulsarService LeaderElectionService.
2024-02-05T18:16:16,760 - INFO  - [main:PulsarService@1231] - Starting load management service ...
2024-02-05T18:16:16,777 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1079] - BrokerRegistry detected the broker:localhost:35385 registry has been created.
2024-02-05T18:16:16,777 - INFO  - [metadata-store-57-1:ResourceLockImpl@178] - Acquired resource lock on /loadbalance/brokers/localhost:35385
2024-02-05T18:16:16,778 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1108] - No needs to cancel the ownership cleanup for broker:localhost:35385. There was no scheduled cleanup job. Active cleanup job count:0
2024-02-05T18:16:16,783 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@780] - This broker:localhost:35385 is changing the role from null to Follower
2024-02-05T18:16:16,787 - INFO  - [main:ServiceUnitStateChannelImpl@294] - Successfully found the channel leader:LeaderBroker(serviceUrl=http://localhost:46117).
2024-02-05T18:16:16,792 - INFO  - [main:PulsarClusterMetadataSetup@387] - Namespace pulsar/system already exists.
2024-02-05T18:16:16,807 - INFO  - [main:PulsarService@1655] - created admin with url http://localhost:35385 
2024-02-05T18:16:16,921 - INFO  - [metadata-store-57-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 49
2024-02-05T18:16:16,948 - INFO  - [metadata-store-2-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:16,951 - ERROR - [metadata-store-2-1:PersistentTopicsBase@401] - [null] Topic persistent://pulsar/system/loadbalancer-service-unit-state already exists
2024-02-05T18:16:16,953 - ERROR - [metadata-store-2-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic persistent://pulsar/system/loadbalancer-service-unit-state
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1159) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.handleGetResult(ZKMetadataStore.java:275) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at org.apache.pulsar.metadata.impl.ZKMetadataStore.lambda$batchOperation$5(ZKMetadataStore.java:219) ~[pulsar-metadata-3.0.2.jar:3.0.2]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[?:?]
	... 11 more
2024-02-05T18:16:16,967 - INFO  - [metadata-store-2-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:16 +0200] "PUT /admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 37
2024-02-05T18:16:16,972 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35385/admin/v2/persistent/pulsar/system/loadbalancer-service-unit-state] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:16:16,983 - INFO  - [pulsar-io-64-2:ConnectionPool@265] - [[id: 0xfa31b5ec, L:/127.0.0.1:43588 - R:localhost/127.0.0.1:44631]] Connected to server
2024-02-05T18:16:16,991 - INFO  - [pulsar-io-64-4:ServerCnx@724] - [/127.0.0.1:43588] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:16:17,011 - INFO  - [pulsar-io-64-1:ConnectionPool@265] - [[id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]] Connected to server
2024-02-05T18:16:17,015 - INFO  - [pulsar-io-9-2:ServerCnx@724] - [/127.0.0.1:50690] connected with clientVersion=Pulsar-Java-v3.0.2, clientProtocolVersion=21, proxyVersion=null
2024-02-05T18:16:17,016 - INFO  - [pulsar-io-64-1:ProducerImpl@1677] - [persistent://pulsar/system/loadbalancer-service-unit-state] [null] Creating producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,031 - INFO  - [pulsar-io-9-2:ServerCnx@1606] - [/127.0.0.1:50690] Created new producer: Producer{topic=SystemTopic{topic=persistent://pulsar/system/loadbalancer-service-unit-state}, client=/127.0.0.1:50690, producerName=test-0-3, producerId=0}
2024-02-05T18:16:17,033 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Created producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,046 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-75d7ead6ac] Subscribing to topic on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941], consumerId 0
2024-02-05T18:16:17,048 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x33d3050f, L:/127.0.0.1:34941 - R:/127.0.0.1:50690]] Subscribing on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-75d7ead6ac. consumerId: 0
2024-02-05T18:16:17,055 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-75d7ead6ac] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:17,055 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [pulsar/system/persistent/loadbalancer-service-unit-state] Created non-durable cursor read-position=3:0 mark-delete-position=3:-1
2024-02-05T18:16:17,056 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [pulsar/system/persistent/loadbalancer-service-unit-state] Opened new cursor: NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-75d7ead6ac, ackPos=3:-1, readPos=3:0}
2024-02-05T18:16:17,059 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50690] Created subscription on topic persistent://pulsar/system/loadbalancer-service-unit-state / reader-75d7ead6ac
2024-02-05T18:16:17,060 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-75d7ead6ac] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 0
2024-02-05T18:16:17,063 - INFO  - [broker-client-shared-internal-executor-65-1:TableViewImpl@267] - Started table view for topic persistent://pulsar/system/loadbalancer-service-unit-state - Replayed 0 messages in 0.002 seconds
2024-02-05T18:16:17,064 - INFO  - [main:ServiceUnitStateChannelImpl@353] - Successfully started the channel.
2024-02-05T18:16:17,097 - INFO  - [pulsar-web-84-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 27
2024-02-05T18:16:17,103 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:17,106 - ERROR - [pulsar-web-30-5:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-broker-load-data already exists
2024-02-05T18:16:17,106 - ERROR - [pulsar-web-30-5:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-broker-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:16:17,111 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35385/admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:16:17,114 - INFO  - [pulsar-web-30-5:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-broker-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:16:17,125 - INFO  - [pulsar-web-84-6:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 8
2024-02-05T18:16:17,132 - INFO  - [pulsar-web-30-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:17,135 - ERROR - [pulsar-web-30-1:PersistentTopicsBase@401] - [null] Topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data already exists
2024-02-05T18:16:17,136 - ERROR - [pulsar-web-30-1:PersistentTopics@337] - [null] Failed to create non-partitioned topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data
java.util.concurrent.CompletionException: org.apache.pulsar.broker.web.RestException: This topic already exists
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1194) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2309) ~[?:?]
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalCreateNonPartitionedTopicAsync(PersistentTopicsBase.java:399) ~[classes/:?]
	at org.apache.pulsar.broker.admin.v2.PersistentTopics.createNonPartitionedTopic(PersistentTopics.java:333) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:475) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:397) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:255) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:292) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:274) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.internal.Errors.process(Errors.java:244) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265) ~[jersey-common-2.34.jar:?]
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680) ~[jersey-server-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205) ~[jersey-container-servlet-core-2.34.jar:?]
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlets.QoSFilter.doFilter(QoSFilter.java:202) ~[jetty-servlets-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[jetty-servlet-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:234) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.53.v20231009.jar:9.4.53.v20231009]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.broker.web.RestException: This topic already exists
	at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.lambda$internalCreateNonPartitionedTopicAsync$41(PersistentTopicsBase.java:402) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1187) ~[?:?]
	... 66 more
2024-02-05T18:16:17,139 - INFO  - [pulsar-web-30-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data?authoritative=true HTTP/1.1" 409 38 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:16:17,140 - WARN  - [AsyncHttpClient-91-2:BaseResource$1@135] - [http://localhost:35385/admin/v2/non-persistent/pulsar/system/loadbalancer-top-bundles-load-data] Failed to perform http put request: javax.ws.rs.ClientErrorException: HTTP 409 {"reason":"This topic already exists"}
2024-02-05T18:16:17,158 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [null] Creating producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,166 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50690] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data}, client=/127.0.0.1:50690, producerName=test-0-4, producerId=1}
2024-02-05T18:16:17,168 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Created producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,184 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-633380f30e] Subscribing to topic on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941], consumerId 1
2024-02-05T18:16:17,186 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x33d3050f, L:/127.0.0.1:34941 - R:/127.0.0.1:50690]] Subscribing on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-633380f30e. consumerId: 1
2024-02-05T18:16:17,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonPersistentTopic@364] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-633380f30e] Created new subscription for 1
2024-02-05T18:16:17,198 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50690] Created subscription on topic non-persistent://pulsar/system/loadbalancer-broker-load-data / reader-633380f30e
2024-02-05T18:16:17,199 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [non-persistent://pulsar/system/loadbalancer-broker-load-data][reader-633380f30e] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 1
2024-02-05T18:16:17,216 - INFO  - [pulsar-io-64-2:ProducerImpl@1677] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [null] Creating producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,225 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1606] - [/127.0.0.1:50690] Created new producer: Producer{topic=NonPersistentTopic{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data}, client=/127.0.0.1:50690, producerName=test-0-5, producerId=2}
2024-02-05T18:16:17,226 - INFO  - [pulsar-io-64-1:ProducerImpl@1735] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Created producer on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941]
2024-02-05T18:16:17,229 - INFO  - [main:LinuxInfoUtils@100] - [LinuxInfo] The system metrics provider is: cgroupv2
2024-02-05T18:16:17,233 - INFO  - [main:UnloadScheduler@220] - Created namespace unload strategy:org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder
2024-02-05T18:16:17,234 - INFO  - [pulsar-load-manager-61-1:ExtensibleLoadManagerImpl@801] - This broker:localhost:35385 plays a follower now.
2024-02-05T18:16:17,254 - INFO  - [main:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://sla-monitor/test/localhost:35385/__change_events
2024-02-05T18:16:17,279 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/test/localhost:35385/0x00000000_0xffffffff - localhost:35385.
2024-02-05T18:16:17,282 - INFO  - [main:NamespaceService@339] - added heartbeat namespace name in local cache: ns=pulsar/test/localhost:35385
2024-02-05T18:16:17,282 - INFO  - [pulsar-62-3:PulsarService@1253] - Loading all topics on bundle: pulsar/test/localhost:35385/0x00000000_0xffffffff
2024-02-05T18:16:17,282 - INFO  - [main:ExtensibleLoadManagerImpl@494] - Try acquiring ownership for bundle: pulsar/localhost:35385/0x00000000_0xffffffff - localhost:35385.
2024-02-05T18:16:17,288 - INFO  - [pulsar-62-4:PulsarService@1253] - Loading all topics on bundle: pulsar/localhost:35385/0x00000000_0xffffffff
2024-02-05T18:16:17,289 - INFO  - [main:NamespaceService@345] - added heartbeat namespace name in local cache: ns=pulsar/localhost:35385
2024-02-05T18:16:17,292 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://sla-monitor/test/localhost:35385/__change_events][reader-af6a34659d] Subscribing to topic on cnx [id: 0xfa31b5ec, L:/127.0.0.1:43588 - R:localhost/127.0.0.1:44631], consumerId 2
2024-02-05T18:16:17,294 - INFO  - [pulsar-io-64-4:ServerCnx@1173] - [[id: 0xa33339a1, L:/127.0.0.1:44631 - R:/127.0.0.1:43588]] Subscribing on topic persistent://sla-monitor/test/localhost:35385/__change_events / reader-af6a34659d. consumerId: 2
2024-02-05T18:16:17,294 - INFO  - [main:PulsarService@1174] - SLA Namespace = sla-monitor/test/localhost:35385 doesn't exist.
2024-02-05T18:16:17,300 - INFO  - [main:PulsarService@925] - messaging service is ready, bootstrap_seconds=3, bootstrap service port = 35385, tls-port = Optional[44473], broker url= pulsar://localhost:44631, broker tls url= pulsar+ssl://localhost:33613, cluster=test, configs=ServiceConfiguration(zookeeperServers=null, metadataStoreUrl=zk:localhost:2181, globalZookeeperServers=null, configurationStoreServers=null, configurationMetadataStoreUrl=zk:localhost:3181, brokerServicePort=Optional[44631], brokerServicePortTls=Optional[33613], webServicePort=Optional[35385], webServicePortTls=Optional[44473], webServiceTlsProvider=Conscrypt, webServiceTlsProtocols=[], webServiceTlsCiphers=[], bindAddress=0.0.0.0, advertisedAddress=localhost, advertisedListeners=null, internalListenerName=null, bindAddresses=null, haProxyProtocolEnabled=false, numAcceptorThreads=1, numIOThreads=4, numOrderedExecutorThreads=1, numHttpServerThreads=8, numExecutorThreadPoolSize=5, numCacheExecutorThreadPoolSize=2, enableBusyWait=false, maxConcurrentHttpRequests=1024, httpServerThreadPoolQueueSize=8192, httpServerAcceptQueueSize=8192, maxHttpServerConnections=2048, delayedDeliveryEnabled=true, delayedDeliveryTrackerFactoryClassName=org.apache.pulsar.broker.delayed.InMemoryDelayedDeliveryTrackerFactory, delayedDeliveryTickTimeMillis=1000, isDelayedDeliveryDeliverAtTimeStrict=false, delayedDeliveryMinIndexCountPerBucket=50000, delayedDeliveryMaxTimeStepPerBucketSnapshotSegmentSeconds=300, delayedDeliveryMaxIndexesPerBucketSnapshotSegment=5000, delayedDeliveryMaxNumBuckets=-1, delayedDeliveryFixedDelayDetectionLookahead=50000, acknowledgmentAtBatchIndexLevelEnabled=false, webSocketServiceEnabled=false, isRunningStandalone=false, clusterName=test, maxTenants=0, failureDomainsEnabled=false, metadataStoreSessionTimeoutMillis=30000, metadataStoreOperationTimeoutSeconds=30, metadataStoreCacheExpirySeconds=300, metadataStoreAllowReadOnlyOperations=false, zooKeeperSessionTimeoutMillis=-1, zooKeeperOperationTimeoutSeconds=-1, zooKeeperCacheExpirySeconds=-1, zooKeeperAllowReadOnlyOperations=false, brokerShutdownTimeoutMs=5000, skipBrokerShutdownOnOOM=false, topicLoadTimeoutSeconds=10, metadataStoreBatchingEnabled=true, metadataStoreBatchingMaxDelayMillis=5, metadataStoreBatchingMaxOperations=1000, metadataStoreBatchingMaxSizeKb=128, metadataStoreConfigPath=null, metadataSyncEventTopic=null, configurationMetadataSyncEventTopic=null, topicFactoryClassName=null, backlogQuotaCheckEnabled=true, preciseTimeBasedBacklogQuotaCheck=false, backlogQuotaCheckIntervalInSeconds=60, backlogQuotaDefaultLimitGB=-1.0, backlogQuotaDefaultLimitBytes=-1, backlogQuotaDefaultLimitSecond=-1, backlogQuotaDefaultRetentionPolicy=producer_request_hold, ttlDurationDefaultInSeconds=0, brokerDeleteInactiveTopicsEnabled=true, brokerDeleteInactivePartitionedTopicMetadataEnabled=false, brokerDeleteInactiveTopicsFrequencySeconds=60, brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions, brokerDeleteInactiveTopicsMaxInactiveDurationSeconds=60, forceDeleteTenantAllowed=false, forceDeleteNamespaceAllowed=true, maxPendingPublishRequestsPerConnection=1000, messageExpiryCheckIntervalInMinutes=5, activeConsumerFailoverDelayTimeMillis=0, subscriptionBacklogScanMaxTimeMs=120000, subscriptionBacklogScanMaxEntries=10000, subscriptionExpirationTimeMinutes=0, subscriptionRedeliveryTrackerEnabled=true, subscriptionExpiryCheckIntervalInMinutes=5, subscriptionTypesEnabled=[Failover, Shared, Key_Shared, Exclusive], subscriptionKeySharedEnable=true, subscriptionKeySharedUseConsistentHashing=true, subscriptionKeySharedConsistentHashingReplicaPoints=100, brokerDeduplicationEnabled=false, brokerDeduplicationMaxNumberOfProducers=10000, brokerDeduplicationSnapshotFrequencyInSeconds=120, brokerDeduplicationSnapshotIntervalSeconds=120, brokerDeduplicationEntriesInterval=1000, brokerDeduplicationProducerInactivityTimeoutMinutes=360, defaultNumberOfNamespaceBundles=1, maxNamespacesPerTenant=0, maxTopicsPerNamespace=0, brokerMaxConnections=0, brokerMaxConnectionsPerIp=0, isAllowAutoUpdateSchemaEnabled=true, autoShrinkForConsumerPendingAcksMap=false, clientLibraryVersionCheckEnabled=false, statusFilePath=null, maxUnackedMessagesPerConsumer=50000, maxUnackedMessagesPerSubscription=200000, maxUnackedMessagesPerBroker=0, maxUnackedMessagesPerSubscriptionOnBrokerBlocked=0.16, maxConsumerMetadataSize=1024, unblockStuckSubscriptionEnabled=false, topicPublisherThrottlingTickTimeMillis=10, preciseTopicPublishRateLimiterEnable=false, brokerPublisherThrottlingTickTimeMillis=50, brokerPublisherThrottlingMaxMessageRate=0, brokerPublisherThrottlingMaxByteRate=0, dispatchThrottlingRateInMsg=0, dispatchThrottlingRateInByte=0, maxPublishRatePerTopicInMessages=0, maxPublishRatePerTopicInBytes=0, subscribeThrottlingRatePerConsumer=0, subscribeRatePeriodPerConsumerInSecond=30, dispatchThrottlingRatePerTopicInMsg=0, dispatchThrottlingRatePerTopicInByte=0, dispatchThrottlingOnBatchMessageEnabled=false, dispatchThrottlingRatePerSubscriptionInMsg=0, dispatchThrottlingRatePerSubscriptionInByte=0, dispatchThrottlingRatePerReplicatorInMsg=0, dispatchThrottlingRatePerReplicatorInByte=0, dispatchThrottlingRateRelativeToPublishRate=false, dispatchThrottlingOnNonBacklogConsumerEnabled=true, resourceUsageTransportClassName=, resourceUsageTransportPublishIntervalInSecs=60, enableBrokerSideSubscriptionPatternEvaluation=true, subscriptionPatternMaxLength=50, dispatcherMaxReadBatchSize=100, dispatcherDispatchMessagesInSubscriptionThread=true, dispatchThrottlingForFilteredEntriesEnabled=false, dispatcherMaxReadSizeBytes=5242880, dispatcherMinReadBatchSize=1, dispatcherReadFailureBackoffInitialTimeInMs=15000, dispatcherReadFailureBackoffMaxTimeInMs=60000, dispatcherReadFailureBackoffMandatoryStopTimeInMs=0, dispatcherEntryFilterRescheduledMessageDelay=1000, dispatcherMaxRoundRobinBatchSize=20, preciseDispatcherFlowControl=false, entryFilterNames=[], entryFiltersDirectory=, allowOverrideEntryFilters=false, streamingDispatch=false, maxConcurrentLookupRequest=50000, maxConcurrentTopicLoadRequest=5000, maxConcurrentNonPersistentMessagePerConnection=1000, numWorkerThreadsForNonPersistentTopic=4, enablePersistentTopics=true, enableNonPersistentTopics=true, enableRunBookieTogether=false, enableRunBookieAutoRecoveryTogether=false, maxProducersPerTopic=0, maxSameAddressProducersPerTopic=0, encryptionRequireOnProducer=false, maxConsumersPerTopic=0, maxSameAddressConsumersPerTopic=0, maxSubscriptionsPerTopic=0, maxConsumersPerSubscription=0, maxMessageSize=5242880, enableReplicatedSubscriptions=true, replicatedSubscriptionsSnapshotFrequencyMillis=1000, replicatedSubscriptionsSnapshotTimeoutSeconds=30, replicatedSubscriptionsSnapshotMaxCachedPerSubscription=10, maxMessagePublishBufferSizeInMB=512, messagePublishBufferCheckIntervalInMillis=100, lazyCursorRecovery=false, retentionCheckIntervalInSeconds=120, maxNumPartitionsPerPartitionedTopic=0, brokerInterceptorsDirectory=./interceptors, brokerInterceptors=[], disableBrokerInterceptors=true, brokerEntryPayloadProcessors=[], zookeeperSessionExpiredPolicy=reconnect, topicFencingTimeoutSeconds=0, protocolHandlerDirectory=./protocols, useSeparateThreadPoolForProtocolHandlers=true, messagingProtocols=[], systemTopicEnabled=true, strictTopicNameEnabled=false, systemTopicSchemaCompatibilityStrategy=ALWAYS_COMPATIBLE, topicLevelPoliciesEnabled=true, brokerEntryMetadataInterceptors=[], exposingBrokerEntryMetadataToClientEnabled=false, enableNamespaceIsolationUpdateOnTime=false, strictBookieAffinityEnabled=false, tlsEnabled=false, tlsCertRefreshCheckDurationSec=300, tlsCertificateFilePath=null, tlsKeyFilePath=null, tlsTrustCertsFilePath=, tlsAllowInsecureConnection=false, tlsHostnameVerificationEnabled=false, tlsProtocols=[], tlsCiphers=[], tlsRequireTrustedClientCertOnConnect=false, authenticationEnabled=false, authenticationProviders=[], authenticationRefreshCheckSeconds=60, authorizationEnabled=false, authorizationProvider=org.apache.pulsar.broker.authorization.PulsarAuthorizationProvider, superUserRoles=[], proxyRoles=[], authenticateOriginalAuthData=false, authorizationAllowWildcardsMatching=false, anonymousUserRole=null, httpMaxRequestSize=-1, httpMaxRequestHeaderSize=8192, disableHttpDebugMethods=false, httpRequestsLimitEnabled=false, httpRequestsMaxPerSecond=100.0, httpRequestsFailOnUnknownPropertiesEnabled=false, saslJaasClientAllowedIds=.*pulsar.*, saslJaasServerSectionName=PulsarBroker, saslJaasServerRoleTokenSignerSecretPath=null, kinitCommand=/usr/bin/kinit, bookkeeperMetadataServiceUri=null, bookkeeperClientAuthenticationPlugin=null, bookkeeperClientAuthenticationParametersName=null, bookkeeperClientAuthenticationParameters=null, bookkeeperClientTimeoutInSeconds=30, bookkeeperClientSpeculativeReadTimeoutInMillis=0, bookkeeperNumberOfChannelsPerBookie=16, bookkeeperUseV2WireProtocol=true, bookkeeperClientHealthCheckEnabled=true, bookkeeperClientHealthCheckIntervalSeconds=60, bookkeeperClientHealthCheckErrorThresholdPerInterval=5, bookkeeperClientHealthCheckQuarantineTimeInSeconds=1800, bookkeeperClientQuarantineRatio=1.0, bookkeeperClientRackawarePolicyEnabled=true, bookkeeperClientRegionawarePolicyEnabled=false, bookkeeperClientMinNumRacksPerWriteQuorum=2, bookkeeperClientEnforceMinNumRacksPerWriteQuorum=false, bookkeeperClientReorderReadSequenceEnabled=false, bookkeeperClientIsolationGroups=null, bookkeeperClientSecondaryIsolationGroups=null, bookkeeperClientGetBookieInfoIntervalSeconds=86400, bookkeeperClientGetBookieInfoRetryIntervalSeconds=60, bookkeeperEnableStickyReads=true, bookkeeperTLSProviderFactoryClass=org.apache.bookkeeper.tls.TLSContextFactory, bookkeeperTLSClientAuthentication=false, bookkeeperTLSKeyFileType=PEM, bookkeeperTLSTrustCertTypes=PEM, bookkeeperTLSKeyStorePasswordPath=null, bookkeeperTLSTrustStorePasswordPath=null, bookkeeperTLSKeyFilePath=null, bookkeeperTLSCertificateFilePath=null, bookkeeperTLSTrustCertsFilePath=null, bookkeeperTlsCertFilesRefreshDurationSeconds=300, bookkeeperDiskWeightBasedPlacementEnabled=false, bookkeeperExplicitLacIntervalInMills=0, bookkeeperClientExposeStatsToPrometheus=true, bookkeeperClientLimitStatsLogging=false, bookkeeperClientThrottleValue=0, bookkeeperClientNumWorkerThreads=4, bookkeeperClientNumIoThreads=8, bookkeeperClientSeparatedIoThreadsEnabled=false, managedLedgerDefaultEnsembleSize=2, managedLedgerDefaultWriteQuorum=2, managedLedgerDefaultAckQuorum=2, managedLedgerCursorPositionFlushSeconds=60, managedLedgerStatsPeriodSeconds=60, managedLedgerDigestType=CRC32C, managedLedgerMaxEnsembleSize=5, managedLedgerMaxWriteQuorum=5, managedLedgerMaxAckQuorum=5, managedLedgerCacheSizeMB=8, managedLedgerCacheCopyEntries=false, managedLedgerMaxReadsInFlightSizeInMB=0, managedLedgerCacheEvictionWatermark=0.9, managedLedgerCacheEvictionFrequency=0.0, managedLedgerCacheEvictionIntervalMs=10, managedLedgerCacheEvictionTimeThresholdMillis=1000, managedLedgerCursorBackloggedThreshold=1000, managedLedgerDefaultMarkDeleteRateLimit=1.0, allowAutoTopicCreation=true, allowAutoTopicCreationType=non-partitioned, allowAutoSubscriptionCreation=true, defaultNumPartitions=1, managedLedgerStorageClassName=org.apache.pulsar.broker.ManagedLedgerClientFactory, managedLedgerNumSchedulerThreads=4, managedLedgerMaxEntriesPerLedger=50000, managedLedgerMinLedgerRolloverTimeMinutes=10, managedLedgerMaxLedgerRolloverTimeMinutes=240, managedLedgerMaxSizePerLedgerMbytes=2048, managedLedgerOffloadDeletionLagMs=14400000, managedLedgerOffloadAutoTriggerSizeThresholdBytes=-1, managedLedgerOffloadThresholdInSeconds=-1, managedLedgerCursorMaxEntriesPerLedger=50000, managedLedgerCursorRolloverTimeInSeconds=14400, managedLedgerMaxUnackedRangesToPersist=10000, persistentUnackedRangesWithMultipleEntriesEnabled=false, managedLedgerMaxUnackedRangesToPersistInZooKeeper=-1, managedLedgerMaxUnackedRangesToPersistInMetadataStore=1000, managedLedgerUnackedRangesOpenCacheSetEnabled=true, autoSkipNonRecoverableData=false, managedLedgerMetadataOperationsTimeoutSeconds=60, managedLedgerReadEntryTimeoutSeconds=0, managedLedgerAddEntryTimeoutSeconds=0, managedLedgerPrometheusStatsLatencyRolloverSeconds=60, managedLedgerTraceTaskExecution=true, managedLedgerNewEntriesCheckDelayInMillis=10, managedLedgerDataReadPriority=tiered-storage-first, managedLedgerInfoCompressionType=NONE, managedCursorInfoCompressionType=NONE, managedLedgerMinimumBacklogCursorsForCaching=0, managedLedgerMinimumBacklogEntriesForCaching=1000, managedLedgerMaxBacklogBetweenCursorsForCaching=1000, loadBalancerEnabled=true, loadBalancerPlacementStrategy=leastLoadedServer, loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.extensions.scheduler.TransferShedder, lowerBoundarySheddingEnabled=false, loadBalancerLoadPlacementStrategy=org.apache.pulsar.broker.loadbalance.impl.LeastLongTermMessageRate, loadBalancerReportUpdateThresholdPercentage=10, loadBalancerReportUpdateMinIntervalMillis=5000, loadBalancerReportUpdateMaxIntervalMinutes=15, loadBalancerHostUsageCheckIntervalMinutes=1, loadBalancerSheddingEnabled=false, loadBalancerSheddingIntervalMinutes=1, loadBalancerDistributeBundlesEvenlyEnabled=true, loadBalancerSheddingGracePeriodMinutes=30, loadBalancerBrokerUnderloadedThresholdPercentage=50, loadBalancerBrokerMaxTopics=50000, loadBalancerBrokerOverloadedThresholdPercentage=85, loadBalancerBrokerThresholdShedderPercentage=10, loadBalancerAverageResourceUsageDifferenceThresholdPercentage=10, flowOrQpsDifferenceThresholdPercentage=10, minUnloadMessage=1000, minUnloadMessageThroughput=1048576, maxUnloadPercentage=0.2, loadBalancerMsgRateDifferenceShedderThreshold=50.0, loadBalancerMsgThroughputMultiplierDifferenceShedderThreshold=4.0, maxUnloadBundleNumPerShedding=-1, loadBalancerHistoryResourcePercentage=0.9, loadBalancerBandwithInResourceWeight=1.0, loadBalancerBandwithOutResourceWeight=1.0, loadBalancerCPUResourceWeight=1.0, loadBalancerMemoryResourceWeight=1.0, loadBalancerDirectMemoryResourceWeight=1.0, loadBalancerBundleUnloadMinThroughputThreshold=10.0, loadBalancerResourceQuotaUpdateIntervalMinutes=15, loadBalancerBrokerComfortLoadLevelPercentage=65, loadBalancerAutoBundleSplitEnabled=true, loadBalancerAutoUnloadSplitBundlesEnabled=true, loadBalancerNamespaceBundleMaxTopics=1000, loadBalancerNamespaceBundleMaxSessions=1000, loadBalancerNamespaceBundleMaxMsgRate=30000, loadBalancerNamespaceBundleMaxBandwidthMbytes=100, loadBalancerNamespaceMaximumBundles=128, loadManagerClassName=org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl, supportedNamespaceBundleSplitAlgorithms=[range_equally_divide, topic_count_equally_divide, specified_positions_divide, flow_or_qps_equally_divide], defaultNamespaceBundleSplitAlgorithm=range_equally_divide, loadBalancerOverrideBrokerNicSpeedGbps=Optional[1.0], namespaceBundleUnloadingTimeoutMs=60000, loadBalancerDebugModeEnabled=false, loadBalancerBrokerLoadTargetStd=0.25, loadBalancerSheddingConditionHitCountThreshold=3, loadBalancerTransferEnabled=true, loadBalancerMaxNumberOfBrokerSheddingPerCycle=3, loadBalanceSheddingDelayInSeconds=180, loadBalancerBrokerLoadDataTTLInSeconds=1800, loadBalancerMaxNumberOfBundlesInBundleLoadReport=10, loadBalancerSplitIntervalMinutes=1, loadBalancerMaxNumberOfBundlesToSplitPerCycle=10, loadBalancerNamespaceBundleSplitConditionHitCountThreshold=3, loadBalancerServiceUnitStateTombstoneDelayTimeInSeconds=3600, loadBalancerSheddingBundlesWithPoliciesEnabled=false, replicationMetricsEnabled=true, replicationConnectionsPerBroker=16, replicatorPrefix=pulsar.repl, replicationProducerQueueSize=1000, replicationPolicyCheckDurationSeconds=600, replicationTlsEnabled=false, defaultRetentionTimeInMinutes=0, defaultRetentionSizeInMB=0, keepAliveIntervalSeconds=30, connectionLivenessCheckTimeoutMillis=5000, brokerServicePurgeInactiveFrequencyInSeconds=60, bootstrapNamespaces=[], preferLaterVersions=false, brokerServiceCompactionMonitorIntervalInSeconds=60, brokerServiceCompactionThresholdInBytes=0, brokerServiceCompactionPhaseOneLoopTimeInSeconds=30, clusterMigrationCheckDurationSeconds=0, isSchemaValidationEnforced=false, schemaRegistryStorageClassName=org.apache.pulsar.broker.service.schema.BookkeeperSchemaStorageFactory, schemaRegistryCompatibilityCheckers=[org.apache.pulsar.broker.service.schema.ProtobufNativeSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.JsonSchemaCompatibilityCheck, org.apache.pulsar.broker.service.schema.AvroSchemaCompatibilityCheck], schemaCompatibilityStrategy=FULL, webSocketNumIoThreads=4, webSocketNumServiceThreads=20, webSocketConnectionsPerBroker=4, webSocketSessionIdleTimeoutMillis=300000, webSocketPingDurationSeconds=-1, webSocketMaxTextFrameSize=1048576, authenticateMetricsEndpoint=false, exposeTopicLevelMetricsInPrometheus=true, metricsBufferResponse=false, exposeConsumerLevelMetricsInPrometheus=false, exposeProducerLevelMetricsInPrometheus=false, exposeManagedLedgerMetricsInPrometheus=true, exposeManagedCursorMetricsInPrometheus=false, jvmGCMetricsLoggerClassName=null, exposePreciseBacklogInPrometheus=false, metricsServletTimeoutMs=30000, exposeSubscriptionBacklogSizeInPrometheus=false, splitTopicAndPartitionLabelInPrometheus=false, exposeBundlesMetricsInPrometheus=false, functionsWorkerEnabled=false, functionsWorkerServiceNarPackage=, functionsWorkerEnablePackageManagement=false, exposePublisherStats=true, statsUpdateFrequencyInSecs=60, statsUpdateInitialDelayInSecs=60, aggregatePublisherStatsByProducerName=false, offloadersDirectory=./offloaders, managedLedgerOffloadDriver=null, managedLedgerOffloadMaxThreads=2, narExtractionDirectory=/tmp, managedLedgerOffloadPrefetchRounds=1, managedLedgerInactiveLedgerRolloverTimeSeconds=0, cacheEvictionByMarkDeletedPosition=false, transactionCoordinatorEnabled=false, transactionMetadataStoreProviderClassName=org.apache.pulsar.transaction.coordinator.impl.MLTransactionMetadataStoreProvider, transactionBufferProviderClassName=org.apache.pulsar.broker.transaction.buffer.impl.TopicTransactionBufferProvider, transactionPendingAckStoreProviderClassName=org.apache.pulsar.broker.transaction.pendingack.impl.MLPendingAckStoreProvider, numTransactionReplayThreadPoolSize=4, transactionBufferSnapshotMaxTransactionCount=1000, transactionBufferSnapshotMinTimeInMillis=5000, transactionBufferSnapshotSegmentSize=262144, transactionBufferSegmentedSnapshotEnabled=false, transactionBufferClientMaxConcurrentRequests=1000, transactionBufferClientOperationTimeoutInMills=3000, maxActiveTransactionsPerCoordinator=0, transactionPendingAckLogIndexMinLag=500, transactionLogBatchedWriteEnabled=false, transactionLogBatchedWriteMaxRecords=512, transactionLogBatchedWriteMaxSize=4194304, transactionLogBatchedWriteMaxDelayInMillis=1, transactionPendingAckBatchedWriteEnabled=false, transactionPendingAckBatchedWriteMaxRecords=512, transactionPendingAckBatchedWriteMaxSize=4194304, transactionPendingAckBatchedWriteMaxDelayInMillis=1, tlsEnabledWithKeyStore=false, tlsProvider=null, tlsKeyStoreType=JKS, tlsKeyStore=null, tlsTrustStoreType=JKS, tlsTrustStore=null, brokerClientAuthenticationPlugin=org.apache.pulsar.client.impl.auth.AuthenticationDisabled, brokerClientAuthenticationParameters=, brokerClientTlsEnabled=false, brokerClientTlsEnabledWithKeyStore=false, brokerClientSslProvider=null, brokerClientTrustCertsFilePath=, brokerClientKeyFilePath=, brokerClientCertificateFilePath=, brokerClientTlsTrustStoreType=JKS, brokerClientTlsTrustStore=null, brokerClientTlsKeyStoreType=JKS, brokerClientTlsKeyStore=null, brokerClientTlsCiphers=[], brokerClientTlsProtocols=[], enablePackagesManagement=false, packagesManagementStorageProvider=org.apache.pulsar.packages.management.storage.bookkeeper.BookKeeperPackagesStorageProvider, packagesReplicas=1, packagesManagementLedgerRootPath=/ledgers, additionalServletDirectory=./brokerAdditionalServlet, additionalServlets=[])
2024-02-05T18:16:17,304 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl@378] - Opening managed ledger sla-monitor/test/localhost:35385/persistent/__change_events
2024-02-05T18:16:17,306 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:MetaStoreImpl@128] - Creating '/managed-ledgers/sla-monitor/test/localhost:35385/persistent/__change_events'
2024-02-05T18:16:17,319 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 9
2024-02-05T18:16:17,320 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [sla-monitor/test/localhost:35385/persistent/__change_events] Created ledger 9 after closed null
2024-02-05T18:16:17,331 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerFactoryImpl$2@385] - [sla-monitor/test/localhost:35385/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:16:17,337 - INFO  - [broker-topic-workers-OrderedExecutor-2-0:ManagedCursorImpl@692] - [sla-monitor/test/localhost:35385/persistent/__change_events] Cursor __compaction recovered to position 9:-1
2024-02-05T18:16:17,342 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedLedgerImpl$7@1002] - [sla-monitor/test/localhost:35385/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=sla-monitor/test/localhost:35385/persistent/__change_events, name=__compaction, ackPos=9:-1, readPos=9:0}
2024-02-05T18:16:17,343 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:BrokerService$2@1752] - Created topic persistent://sla-monitor/test/localhost:35385/__change_events - dedup is disabled
2024-02-05T18:16:17,350 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 10
2024-02-05T18:16:17,358 - INFO  - [metadata-store-57-1:PersistentTopic@1039] - [persistent://sla-monitor/test/localhost:35385/__change_events][reader-af6a34659d] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:17,358 - INFO  - [metadata-store-57-1:NonDurableCursorImpl@66] - [sla-monitor/test/localhost:35385/persistent/__change_events] Created non-durable cursor read-position=9:0 mark-delete-position=9:-1
2024-02-05T18:16:17,359 - INFO  - [metadata-store-57-1:ManagedLedgerImpl@1131] - [sla-monitor/test/localhost:35385/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35385/persistent/__change_events, cursor=reader-af6a34659d, ackPos=9:-1, readPos=9:0}
2024-02-05T18:16:17,361 - INFO  - [metadata-store-57-1:ServerCnx@1263] - [/127.0.0.1:43588] Created subscription on topic persistent://sla-monitor/test/localhost:35385/__change_events / reader-af6a34659d
2024-02-05T18:16:17,363 - INFO  - [pulsar-io-64-2:ConsumerImpl@925] - [persistent://sla-monitor/test/localhost:35385/__change_events][reader-af6a34659d] Subscribed to topic on localhost/127.0.0.1:44631 -- consumer: 2
2024-02-05T18:16:17,530 - INFO  - [configuration-metadata-store-4-1:ClustersBase@180] - [null] Created cluster test
2024-02-05T18:16:17,535 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/clusters/test HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 29
2024-02-05T18:16:17,560 - INFO  - [configuration-metadata-store-4-1:TenantsBase@144] - [null] Created tenant public
2024-02-05T18:16:17,561 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/tenants/public HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 22
2024-02-05T18:16:17,580 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:2
2024-02-05T18:16:17,580 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0}. 
2024-02-05T18:16:17,590 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:16:17,590 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Created
2024-02-05T18:16:17,595 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/default
2024-02-05T18:16:17,597 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/namespaces/public/default HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 30
2024-02-05T18:16:17,621 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:16:17,622 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/default
2024-02-05T18:16:17,623 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "POST /admin/v2/namespaces/public/default/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 19
2024-02-05T18:16:17,624 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/default, Type Modified
2024-02-05T18:16:17,626 - INFO  - [pulsar-62-2:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:16:17,629 - INFO  - [pulsar-7-4:BrokerService@2449] - [public/default] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:16:17,640 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:16:17,640 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Created
2024-02-05T18:16:17,645 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@163] - [null] Created namespace public/test
2024-02-05T18:16:17,647 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/namespaces/public/test HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 17
2024-02-05T18:16:17,658 - INFO  - [configuration-metadata-store-59-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:16:17,659 - INFO  - [pulsar-62-3:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:16:17,660 - INFO  - [configuration-metadata-store-4-1:ResourceGroupNamespaceConfigListener@147] - Metadata store notification: Path /admin/policies/public/test, Type Modified
2024-02-05T18:16:17,662 - INFO  - [configuration-metadata-store-4-1:NamespacesBase@2478] - [null] Successfully updated the policies on namespace public/test
2024-02-05T18:16:17,663 - INFO  - [configuration-metadata-store-4-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "POST /admin/v2/namespaces/public/test/replication HTTP/1.1" 200 0 "-" "Pulsar-Java-v3.0.2" 12
2024-02-05T18:16:17,666 - INFO  - [pulsar-7-2:BrokerService@2449] - [public/test] updating with Policies(auth_policies=AuthPoliciesImpl(namespaceAuthentication={}, topicAuthentication={}, subscriptionAuthentication={}), replication_clusters=[test], bundles=BundlesDataImpl(boundaries=[0x00000000, 0xffffffff], numBundles=1), backlog_quota_map={}, clusterDispatchRate={}, topicDispatchRate={}, subscriptionDispatchRate={}, replicatorDispatchRate={}, clusterSubscribeRate={}, persistence=null, deduplicationEnabled=null, autoTopicCreationOverride=null, autoSubscriptionCreationOverride=null, publishMaxMessageRate={}, latency_stats_sample_rate={}, message_ttl_in_seconds=null, subscription_expiration_time_minutes=null, retention_policies=null, deleted=false, encryption_required=false, delayed_delivery_policies=null, inactive_topic_policies=null, subscription_auth_mode=None, max_producers_per_topic=null, max_consumers_per_topic=null, max_consumers_per_subscription=null, max_unacked_messages_per_consumer=null, max_unacked_messages_per_subscription=null, max_subscriptions_per_topic=null, compaction_threshold=null, offload_threshold=-1, offload_threshold_in_seconds=-1, offload_deletion_lag_ms=null, max_topics_per_namespace=null, schema_auto_update_compatibility_strategy=null, schema_compatibility_strategy=UNDEFINED, is_allow_auto_update_schema=null, schema_validation_enforced=false, offload_policies=null, deduplicationSnapshotIntervalSeconds=null, subscription_types_enabled=[], properties={}, resource_group_name=null, entryFilters=null)
2024-02-05T18:16:17,706 - INFO  - [pulsar-web-30-7:NamespacesBase@838] - [null] Unloading namespace public/test
2024-02-05T18:16:17,718 - INFO  - [metadata-store-57-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:16:17,718 - INFO  - [metadata-store-2-1:NamespaceBundleFactory@183] - Policy updated for namespace Optional[public/test], refreshing the bundle cache.
2024-02-05T18:16:17,732 - INFO  - [pulsar-web-30-5:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:16:17,744 - INFO  - [pulsar-web-30-5:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:17,763 - INFO  - [configuration-metadata-store-4-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:35385 for bundle: public/test/0x00000000_0xffffffff.
2024-02-05T18:16:17,836 - INFO  - [broker-client-shared-internal-executor-65-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:16:17,816 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:35385, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777765, versionId=1]. totalHandledRequests:1
2024-02-05T18:16:17,846 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:35385, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777814, versionId=2]. totalHandledRequests:1
2024-02-05T18:16:17,850 - INFO  - [broker-client-shared-internal-executor-11-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:17,869 - INFO  - [broker-client-shared-internal-executor-11-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload HTTP/1.1" 307 0 "-" "Pulsar-Java-v3.0.2" 139
2024-02-05T18:16:17,880 - INFO  - [pulsar-web-84-8:NamespacesBase@1014] - [null] Unloading namespace bundle public/test/0x00000000_0xffffffff
2024-02-05T18:16:17,909 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:35385, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149777900, versionId=3]. totalHandledRequests:1
2024-02-05T18:16:17,919 - INFO  - [broker-client-shared-internal-executor-65-1:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 0 topics completed in 7.0 ms
2024-02-05T18:16:17,927 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:35385, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777911, versionId=4]. totalHandledRequests:1
2024-02-05T18:16:17,929 - INFO  - [broker-client-shared-internal-executor-65-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:16:17,930 - INFO  - [broker-client-shared-internal-executor-65-1:Namespaces@813] - [null] Successfully unloaded namespace bundle 0x00000000_0xffffffff
2024-02-05T18:16:17,931 - INFO  - [broker-client-shared-internal-executor-65-1:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/namespaces/public/test/0x00000000_0xffffffff/unload?authoritative=true HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 60
2024-02-05T18:16:17,931 - INFO  - [AsyncHttpClient-37-2:Namespaces@785] - [null] Successfully unloaded all the bundles in namespace public/test
2024-02-05T18:16:17,933 - INFO  - [AsyncHttpClient-37-2:Slf4jRequestLogWriter@62] - 127.0.0.1 - - [05/Feb/2024:18:16:17 +0200] "PUT /admin/v2/namespaces/public/test/unload HTTP/1.1" 204 0 "-" "Pulsar-Java-v3.0.2" 231
2024-02-05T18:16:17,933 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:46117. Skipping this broker. Phase one
2024-02-05T18:16:17,933 - WARN  - [configuration-metadata-store-59-1:LeastResourceUsageWithWeight@104] - There is no broker load data for broker:localhost:35385. Skipping this broker. Phase one
2024-02-05T18:16:17,934 - INFO  - [configuration-metadata-store-59-1:ExtensibleLoadManagerImpl@450] - Selected new owner broker: localhost:46117 for bundle: public/test/0x00000000_0xffffffff.
------- Starting test [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:16:17,944 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Assigning, dstBroker=localhost:46117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777934, versionId=5]. totalHandledRequests:2
2024-02-05T18:16:18,015 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Owned, dstBroker=localhost:46117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777945, versionId=6]. totalHandledRequests:2
2024-02-05T18:16:18,017 - INFO  - [pulsar-io-64-2:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-193307ec84] Subscribing to topic on cnx [id: 0x1076ab04, L:/127.0.0.1:50690 - R:localhost/127.0.0.1:34941], consumerId 3
2024-02-05T18:16:18,018 - INFO  - [broker-client-shared-internal-executor-11-1:NamespaceEventsSystemTopicFactory@42] - Create topic policies system topic client persistent://public/test/__change_events
2024-02-05T18:16:18,019 - INFO  - [pulsar-io-9-2:ServerCnx@1173] - [[id: 0x33d3050f, L:/127.0.0.1:34941 - R:/127.0.0.1:50690]] Subscribing on topic persistent://public/test/__change_events / reader-193307ec84. consumerId: 3
2024-02-05T18:16:18,023 - INFO  - [pulsar-io-9-4:BrokerLoadDataReporter@196] - Cleaned broker load data.
2024-02-05T18:16:18,025 - INFO  - [pulsar-io-9-4:TopBundleLoadDataReporter@117] - Cleaned broker load data.
2024-02-05T18:16:18,030 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl@378] - Opening managed ledger public/test/persistent/__change_events
2024-02-05T18:16:18,032 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:MetaStoreImpl@128] - Creating '/managed-ledgers/public/test/persistent/__change_events'
2024-02-05T18:16:18,042 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 11
2024-02-05T18:16:18,043 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@531] - [public/test/persistent/__change_events] Created ledger 11 after closed null
2024-02-05T18:16:18,048 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerFactoryImpl$2@385] - [public/test/persistent/__change_events] Successfully initialize managed ledger
2024-02-05T18:16:18,054 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl@692] - [public/test/persistent/__change_events] Cursor __compaction recovered to position 11:-1
2024-02-05T18:16:18,055 - INFO  - [pulsar-io-9-1:RedirectManager@103] - No need to redirect, current load manager class name: org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImpl
2024-02-05T18:16:18,058 - INFO  - [pulsar-io-9-4:ConsumerImpl@777] - [persistent://public/test/__change_events][reader-a979936101] Subscribing to topic on cnx [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941], consumerId 4
2024-02-05T18:16:18,059 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedLedgerImpl$7@1002] - [public/test/persistent/__change_events] Opened new cursor: ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}
2024-02-05T18:16:18,060 - INFO  - [pulsar-io-9-1:ServerCnx@1173] - [[id: 0x07a8d3ef, L:/127.0.0.1:34941 - R:/127.0.0.1:50684]] Subscribing on topic persistent://public/test/__change_events / reader-a979936101. consumerId: 4
2024-02-05T18:16:18,064 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:BrokerService$2@1752] - Created topic persistent://public/test/__change_events - dedup is disabled
Debug testGetMetrics: j=0, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467] 
Debug testGetMetrics: j=2, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276] 
Debug testGetMetrics: j=4, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8] 
Debug testGetMetrics: j=6, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d] 
Debug testGetMetrics: j=8, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59d4d0e6] 
Debug testGetMetrics: j=10, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1db474f], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59d4d0e6, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7752e392] 
Debug testGetMetrics: j=12, ownerLookUpCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10174792, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@5609a2eb, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@242acff6, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@10091bc8, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@35c10148, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@1db474f, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@4a247771], handlerCounters=[Init=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7baa8467, Free=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@e2b3276, Owned=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@b8cfea8, Assigning=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@47e6333d, Releasing=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@59d4d0e6, Splitting=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@7752e392, Deleted=org.apache.pulsar.broker.loadbalance.extensions.channel.ServiceUnitStateChannelImpl$Counters@3508cd33] 
2024-02-05T18:16:18,072 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 12
2024-02-05T18:16:18,078 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PulsarMockBookKeeper@123] - Creating ledger 13
2024-02-05T18:16:18,085 - INFO  - [metadata-store-2-1:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-a979936101] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:18,086 - INFO  - [metadata-store-2-1:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:16:18,086 - INFO  - [metadata-store-2-1:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a979936101, ackPos=11:-1, readPos=11:0}
2024-02-05T18:16:18,088 - INFO  - [metadata-store-2-1:ServerCnx@1263] - [/127.0.0.1:50684] Created subscription on topic persistent://public/test/__change_events / reader-a979936101
2024-02-05T18:16:18,090 - INFO  - [pulsar-io-9-4:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-a979936101] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 4
!!!!!!!!! FAILURE-- [TestClass name=class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest].testGetMetrics([])-------
2024-02-05T18:16:18,108 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:PersistentTopic@1039] - [persistent://public/test/__change_events][reader-193307ec84] Creating non-durable subscription at msg id -1:-1:-1:-1 - {}
2024-02-05T18:16:18,109 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:NonDurableCursorImpl@66] - [public/test/persistent/__change_events] Created non-durable cursor read-position=11:0 mark-delete-position=11:-1
2024-02-05T18:16:18,109 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ManagedLedgerImpl@1131] - [public/test/persistent/__change_events] Opened new cursor: NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-193307ec84, ackPos=11:-1, readPos=11:0}
2024-02-05T18:16:18,117 - INFO  - [PulsarTestContext-executor-OrderedExecutor-0-0:ServerCnx@1263] - [/127.0.0.1:50690] Created subscription on topic persistent://public/test/__change_events / reader-193307ec84
2024-02-05T18:16:18,118 - INFO  - [pulsar-io-64-1:ConsumerImpl@925] - [persistent://public/test/__change_events][reader-193307ec84] Subscribed to topic on localhost/127.0.0.1:34941 -- consumer: 3
2024-02-05T18:16:18,123 - INFO  - [main:TestRetrySupport@70] - Detected test failure in test ExtensibleLoadManagerImplTest.testGetMetrics, currentSetupNumber=1
2024-02-05T18:16:18,123 - INFO  - [pulsar-io-9-2:ServerCnx@2007] - [/127.0.0.1:50690] Closing consumer: consumerId=3
2024-02-05T18:16:18,124 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-193307ec84}, consumerId=3, consumerName=1e1dc, address=/127.0.0.1:50690}
2024-02-05T18:16:18,125 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-193307ec84] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-193307ec84, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:16:18,126 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-193307ec84] Successfully closed dispatcher for reader
2024-02-05T18:16:18,135 - INFO  - [pulsar-io-9-2:ServerCnx@2043] - [/127.0.0.1:50690] Closed consumer, consumerId=3
2024-02-05T18:16:18,136 - INFO  - [pulsar-io-64-1:ConsumerImpl@1082] - [persistent://public/test/__change_events] [reader-193307ec84] Closed consumer
2024-02-05T18:16:18,139 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:674) ~[?:?]
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:662) ~[?:?]
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2168) ~[?:?]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:187) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.broker.systopic.TopicPoliciesSystemTopicClient$TopicPolicyReader.readNextAsync(TopicPoliciesSystemTopicClient.java:176) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.readMorePoliciesAsync(SystemTopicBasedTopicPoliciesService.java:469) ~[classes/:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$prepareInitPoliciesCacheAsync$9(SystemTopicBasedTopicPoliciesService.java:329) ~[classes/:?]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:718) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.broker.service.SystemTopicBasedTopicPoliciesService.lambda$initPolicesCache$16(SystemTopicBasedTopicPoliciesService.java:437) ~[classes/:?]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerImpl.lambda$completehasMessageAvailableWithValue$60(ConsumerImpl.java:2415) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: Consumer already closed
	at org.apache.pulsar.client.impl.ConsumerBase.verifyConsumerState(ConsumerBase.java:926) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.receiveAsync(ConsumerBase.java:261) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ReaderImpl.readNextAsync(ReaderImpl.java:186) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 16 more
2024-02-05T18:16:18,151 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:16:18,158 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@352df548{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:16:18,159 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@4dbcc8ce{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:16:18,159 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:16:18,160 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@45ec9b22{/static,null,STOPPED}
2024-02-05T18:16:18,161 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@584f12eb{/metrics,null,STOPPED}
2024-02-05T18:16:18,173 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@2bf83b29{/topics,null,STOPPED}
2024-02-05T18:16:18,175 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@328446e1{/lookup,null,STOPPED}
2024-02-05T18:16:18,177 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@633e4742{/admin/v3,null,STOPPED}
2024-02-05T18:16:18,179 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@25a2702c{/admin/v2,null,STOPPED}
2024-02-05T18:16:18,182 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@23110196{/admin,null,STOPPED}
2024-02-05T18:16:18,184 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@6eda3ade{/,null,STOPPED}
2024-02-05T18:16:18,188 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:16:18,191 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:16:18,191 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:16:18,192 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35385
2024-02-05T18:16:18,195 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35385 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:0, totalServiceUnitTombstoneCleanupCnt:0, totalOrphanServiceUnitCleanupCnt:0, totalCleanupErrorCnt:0, totalInactiveBrokerCleanupScheduledCnt0, totalInactiveBrokerCleanupIgnoredCnt:0, totalInactiveBrokerCleanupCancelledCnt:0,   activeCleanupJobs:0} 
2024-02-05T18:16:18,203 - INFO  - [metadata-store-57-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:35385 was invalidated. state Releasing
2024-02-05T18:16:18,205 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1082] - BrokerRegistry detected the broker:localhost:35385 registry has been deleted.
2024-02-05T18:16:18,206 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1121] - Handling broker:localhost:35385 ownership cleanup based on metadata connection state:Stable, event:SessionReestablished, event_ts:0:
2024-02-05T18:16:18,207 - WARN  - [metadata-store-57-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:35385. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:16:18,208 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1164] - Scheduled ownership cleanup for broker:localhost:35385 with delay:0 secs. Pending clean jobs:1.
2024-02-05T18:16:18,209 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:35385
2024-02-05T18:16:18,209 - INFO  - [metadata-store-57-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:35385
2024-02-05T18:16:18,211 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:35385 in 0.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:0, approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:1} 
2024-02-05T18:16:18,222 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:35385/0x00000000_0xffffffff.
2024-02-05T18:16:18,224 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:35385/0x00000000_0xffffffff.
2024-02-05T18:16:18,226 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:35385/0x00000000_0xffffffff.
2024-02-05T18:16:18,227 - INFO  - [main:BrokerService@997] - Unloading 3 namespace-bundles completed in 0.017 seconds
2024-02-05T18:16:18,229 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:16:18,234 - INFO  - [pulsar-io-64-2:ClientCnx@308] - [id: 0xfa31b5ec, L:/127.0.0.1:43588 ! R:localhost/127.0.0.1:44631] Disconnected
2024-02-05T18:16:18,237 - INFO  - [pulsar-io-64-4:ServerCnx@343] - Closed connection from /127.0.0.1:43588
2024-02-05T18:16:18,237 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 1 ledgers
2024-02-05T18:16:18,238 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:35385/persistent/__change_events] Closing managed ledger
2024-02-05T18:16:18,238 - INFO  - [pulsar-io-64-4:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:35385/__change_events, name=reader-af6a34659d}, consumerId=2, consumerName=19361, address=/127.0.0.1:43588}
2024-02-05T18:16:18,239 - INFO  - [pulsar-io-64-4:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:35385/__change_events][reader-af6a34659d] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:35385/persistent/__change_events, cursor=reader-af6a34659d, ackPos=9:-1, readPos=9:0}]
2024-02-05T18:16:18,239 - INFO  - [pulsar-io-64-4:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:35385/__change_events][reader-af6a34659d] Successfully closed dispatcher for reader
2024-02-05T18:16:18,246 - INFO  - [pulsar-io-64-1:ClientCnx@308] - [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] Disconnected
2024-02-05T18:16:18,247 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-1-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:35385/persistent/__change_events][__compaction] Closed cursor at md-position=9:-1
2024-02-05T18:16:18,247 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed connection [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:18,248 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed connection [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:18,249 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed connection [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:18,249 - INFO  - [pulsar-io-64-2:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:35385/__change_events] [reader-af6a34659d] Closed connection [id: 0xfa31b5ec, L:/127.0.0.1:43588 ! R:localhost/127.0.0.1:44631] -- Will try again in 0.1 s
2024-02-05T18:16:18,249 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-75d7ead6ac] Closed connection [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:18,249 - INFO  - [pulsar-io-64-1:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-633380f30e] Closed connection [id: 0x1076ab04, L:/127.0.0.1:50690 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:18,244 - INFO  - [pulsar-io-9-2:ServerCnx@343] - Closed connection from /127.0.0.1:50690
2024-02-05T18:16:18,251 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-75d7ead6ac}, consumerId=0, consumerName=3623a, address=/127.0.0.1:50690}
2024-02-05T18:16:18,251 - INFO  - [pulsar-io-9-2:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-75d7ead6ac] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-75d7ead6ac, ackPos=3:5, readPos=3:6}]
2024-02-05T18:16:18,252 - INFO  - [pulsar-io-9-2:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-75d7ead6ac] Successfully closed dispatcher for reader
2024-02-05T18:16:18,253 - INFO  - [pulsar-io-9-2:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-633380f30e}, consumerId=1, consumerName=a7055, address=/127.0.0.1:50690}
2024-02-05T18:16:18,255 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 1 ledgers closed
2024-02-05T18:16:18,257 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:16:18,259 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:16:18,266 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:44631
2024-02-05T18:16:18,267 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-3] Closed Producer (not connected)
2024-02-05T18:16:18,269 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-4] Closed Producer (not connected)
2024-02-05T18:16:18,270 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-5] Closed Producer (not connected)
2024-02-05T18:16:18,271 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-75d7ead6ac] Closed Consumer (not connected)
2024-02-05T18:16:18,272 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-75d7ead6ac was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-75d7ead6ac was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:18,273 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-633380f30e] Closed Consumer (not connected)
2024-02-05T18:16:18,273 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:35385/__change_events] [reader-af6a34659d] Closed Consumer (not connected)
2024-02-05T18:16:18,273 - ERROR - [broker-client-shared-internal-executor-65-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-633380f30e was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-633380f30e was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:18,274 - WARN  - [broker-client-shared-internal-executor-65-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35385/__change_events with subscription name reader-af6a34659d was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:35385/__change_events with subscription name reader-af6a34659d was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:18,284 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:16:18,285 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:16:18,287 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:16:18,288 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:18,295 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:16:18,295 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:18,501 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@141] - Writing local data to metadata store because time since last update exceeded threshold of 15 minutes
2024-02-05T18:16:18,502 - INFO  - [pulsar-load-manager-6-1:BrokerLoadDataReporter@111] - publishing load report:cpu= 0.00%, memory= 41.21%, directMemory= 3.13%, bandwithIn= 0.00%, bandwithOut= 0.00%, cpuWeight= 1.000000, memoryWeight= 1.000000, directMemoryWeight= 1.000000, bandwithInResourceWeight= 1.000000, bandwithOutResourceWeight= 1.000000, msgThroughputIn= 0.00, msgThroughputOut= 0.00, msgRateIn= 0.00, msgRateOut= 0.00, bundleCount= 0, maxResourceUsage= 3.13%, weightedMaxEMA= 41.21%, msgThroughputEMA= 0.00, updatedAt= 1707149778500, reportedAt= 0
2024-02-05T18:16:18,582 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:18,583 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:16:19,560 - INFO  - [globalEventExecutor-10-1:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:16:19,560 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:16:19,562 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:16:19,562 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:19,563 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:16:19,563 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:16:19,583 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:19,584 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:16:20,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:20,585 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:16:21,578 - INFO  - [main:PulsarService@424] - Closing PulsarService
2024-02-05T18:16:21,580 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@3835b281{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2024-02-05T18:16:21,581 - INFO  - [main:AbstractConnector@383] - Stopped ServerConnector@126a9a77{SSL, (ssl, http/1.1)}{0.0.0.0:0}
2024-02-05T18:16:21,581 - INFO  - [main:HouseKeeper@149] - node0 Stopped scavenging
2024-02-05T18:16:21,581 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.h.ContextHandler@7c200e57{/static,null,STOPPED}
2024-02-05T18:16:21,582 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1610c03c{/metrics,null,STOPPED}
2024-02-05T18:16:21,584 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@3117ac8d{/topics,null,STOPPED}
2024-02-05T18:16:21,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1382] - Started the ownership monitor run for activeBrokerCount:1
2024-02-05T18:16:21,586 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@1aef7428{/lookup,null,STOPPED}
2024-02-05T18:16:21,586 - INFO  - [pulsar-load-manager-6-1:ServiceUnitStateChannelImpl@1483] - Completed the ownership monitor run in 0.0 ms. Scheduled cleanups for inactive brokers:[]. inactiveBrokerCount:0. Published cleanups for orphan service units, orphanServiceUnitCleanupCnt:0. Tombstoned semi-terminal state service units, serviceUnitTombstoneCleanupCnt:0. Approximate cleanupErrorCnt:0, metrics:{totalInactiveBrokerCleanupCnt:1, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:3, totalCleanupErrorCnt:4, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0}. 
2024-02-05T18:16:21,587 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@77226121{/admin/v3,null,STOPPED}
2024-02-05T18:16:21,589 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@760c777d{/admin/v2,null,STOPPED}
2024-02-05T18:16:21,590 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@7ea039b4{/admin,null,STOPPED}
2024-02-05T18:16:21,591 - INFO  - [main:ContextHandler@1159] - Stopped o.e.j.s.ServletContextHandler@332fa1c{/,null,STOPPED}
2024-02-05T18:16:21,593 - INFO  - [main:WebService@350] - Web service closed
2024-02-05T18:16:21,593 - INFO  - [main:BrokerService@794] - Shutting down Pulsar Broker service
2024-02-05T18:16:21,593 - INFO  - [main:BrokerService@958] - Unloading namespace-bundles...
2024-02-05T18:16:21,595 - INFO  - [main:ServiceUnitStateChannelImpl@1241] - Started ownership cleanup for the inactive broker:localhost:46117
2024-02-05T18:16:21,598 - ERROR - [main:ServiceUnitStateChannelImpl@1198] - Failed to override the ownership serviceUnit:public/test/0x00000000_0xffffffff orphanData:ServiceUnitStateData[state=Owned, dstBroker=localhost:46117, sourceBroker=null, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149777945, versionId=6]. Empty selected broker. totalCleanupErrorCnt:5
2024-02-05T18:16:26,608 - INFO  - [main:ServiceUnitStateChannelImpl@1297] - Completed a cleanup for the inactive broker:localhost:46117 in 5011.0 ms. Cleaned up orphan service units: orphanServiceUnitCleanupCnt:1, approximate cleanupErrorCnt:-1, metrics:{totalInactiveBrokerCleanupCnt:2, totalServiceUnitTombstoneCleanupCnt:2, totalOrphanServiceUnitCleanupCnt:4, totalCleanupErrorCnt:5, totalInactiveBrokerCleanupScheduledCnt6, totalInactiveBrokerCleanupIgnoredCnt:6, totalInactiveBrokerCleanupCancelledCnt:7,   activeCleanupJobs:0} 
2024-02-05T18:16:26,618 - INFO  - [metadata-store-2-1:ResourceLockImpl@194] - Lock on resource /loadbalance/brokers/localhost:46117 was invalidated. state Releasing
2024-02-05T18:16:26,618 - WARN  - [metadata-store-2-1:ResourceLockImpl@228] - Failed to revalidate the lock at /loadbalance/brokers/localhost:46117. Retrying later on reconnection Lock was not in valid state: Releasing
2024-02-05T18:16:26,619 - INFO  - [metadata-store-2-1:LockManagerImpl@94] - Released resource lock on /loadbalance/brokers/localhost:46117
2024-02-05T18:16:26,624 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: sla-monitor/test/localhost:46117/0x00000000_0xffffffff.
2024-02-05T18:16:26,625 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/test/localhost:46117/0x00000000_0xffffffff.
2024-02-05T18:16:26,627 - INFO  - [main:ExtensibleLoadManagerImpl@605] - Skip unloading namespace bundle: pulsar/localhost:46117/0x00000000_0xffffffff.
2024-02-05T18:16:26,636 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Releasing, dstBroker=null, sourceBroker=localhost:46117, splitServiceUnitToDestBroker=null, force=true, timestamp=1707149786629, versionId=7]. totalHandledRequests:10
2024-02-05T18:16:26,637 - INFO  - [broker-client-shared-internal-executor-11-1:BrokerService@2248] - [persistent://public/test/__change_events] Unloading topic
2024-02-05T18:16:26,638 - INFO  - [broker-client-shared-internal-executor-11-1:Consumer@409] - Disconnecting consumer: Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a979936101}, consumerId=4, consumerName=bab42, address=/127.0.0.1:50684}
2024-02-05T18:16:26,639 - INFO  - [broker-client-shared-internal-executor-11-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://public/test/__change_events, name=reader-a979936101}, consumerId=4, consumerName=bab42, address=/127.0.0.1:50684}
2024-02-05T18:16:26,639 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a979936101] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a979936101, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:16:26,639 - INFO  - [pulsar-io-9-4:ClientCnx@816] - [localhost/127.0.0.1:34941] Broker notification of Closed consumer: 4
2024-02-05T18:16:26,639 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@323] - [persistent://public/test/__change_events][reader-a979936101] Successfully closed dispatcher for reader
2024-02-05T18:16:26,640 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://public/test/__change_events] [reader-a979936101] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 - R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,641 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][reader-a979936101] Successfully closed subscription [NonDurableCursorImpl{ledger=public/test/persistent/__change_events, cursor=reader-a979936101, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:16:26,642 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][reader-a979936101] Successfully disconnected and closed subscription
2024-02-05T18:16:26,642 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@897] - [persistent://public/test/__change_events][__compaction] Successfully closed subscription [ManagedCursorImpl{ledger=public/test/persistent/__change_events, name=__compaction, ackPos=11:-1, readPos=11:0}]
2024-02-05T18:16:26,642 - INFO  - [broker-client-shared-internal-executor-11-1:PersistentSubscription@919] - [persistent://public/test/__change_events][__compaction] Successfully disconnected and closed subscription
2024-02-05T18:16:26,643 - INFO  - [broker-client-shared-internal-executor-11-1:ManagedLedgerImpl@1481] - [public/test/persistent/__change_events] Closing managed ledger
2024-02-05T18:16:26,648 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [public/test/persistent/__change_events][__compaction] Closed cursor at md-position=11:-1
2024-02-05T18:16:26,652 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:PersistentTopic@1524] - [persistent://public/test/__change_events] Topic closed
2024-02-05T18:16:26,653 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ConsumerImpl@1029] - [persistent://public/test/__change_events] [reader-a979936101] Closed Consumer (not connected)
2024-02-05T18:16:26,654 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ServiceUnitStateChannelImpl@887] - Unloading bundle:public/test/0x00000000_0xffffffff with 1 topics completed in 17.0 ms
2024-02-05T18:16:26,655 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a979936101 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://public/test/__change_events with subscription name reader-a979936101 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:26,662 - INFO  - [broker-client-shared-internal-executor-11-1:ServiceUnitStateChannelImpl@634] - localhost:46117 received a handle request for serviceUnit:public/test/0x00000000_0xffffffff, data:ServiceUnitStateData[state=Free, dstBroker=null, sourceBroker=localhost:46117, splitServiceUnitToDestBroker=null, force=false, timestamp=1707149786636, versionId=8]. totalHandledRequests:4
2024-02-05T18:16:26,662 - INFO  - [broker-client-shared-internal-executor-11-1:UnloadManager@84] - Complete unload bundle: public/test/0x00000000_0xffffffff
2024-02-05T18:16:26,663 - INFO  - [main:BrokerService@997] - Unloading 4 namespace-bundles completed in 0.043 seconds
2024-02-05T18:16:26,663 - INFO  - [main:BrokerService@823] - Event loops shutting down gracefully...
2024-02-05T18:16:26,664 - INFO  - [main:ManagedLedgerFactoryImpl@630] - Closing 2 ledgers
2024-02-05T18:16:26,665 - INFO  - [main:ManagedLedgerImpl@1481] - [pulsar/system/persistent/loadbalancer-service-unit-state] Closing managed ledger
2024-02-05T18:16:26,665 - INFO  - [main:ManagedLedgerImpl@1481] - [sla-monitor/test/localhost:46117/persistent/__change_events] Closing managed ledger
2024-02-05T18:16:26,665 - INFO  - [pulsar-io-9-4:ClientCnx@308] - [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] Disconnected
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-1:ServerCnx@343] - Closed connection from /127.0.0.1:50684
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-2bc3e56286] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ee919ff907] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,666 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://pulsar/system/loadbalancer-service-unit-state, name=reader-2bc3e56286}, consumerId=0, consumerName=f1b04, address=/127.0.0.1:50684}
2024-02-05T18:16:26,667 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [persistent://sla-monitor/test/localhost:46117/__change_events] [reader-917e27e71b] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,667 - INFO  - [pulsar-io-9-4:ConnectionHandler@163] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-84b92e60dc] Closed connection [id: 0x65f233f4, L:/127.0.0.1:50684 ! R:localhost/127.0.0.1:34941] -- Will try again in 0.1 s
2024-02-05T18:16:26,667 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2bc3e56286] Successfully closed subscription [NonDurableCursorImpl{ledger=pulsar/system/persistent/loadbalancer-service-unit-state, cursor=reader-2bc3e56286, ackPos=3:6, readPos=3:8}]
2024-02-05T18:16:26,668 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-2-0:ManagedCursorImpl$24@2625] - [sla-monitor/test/localhost:46117/persistent/__change_events][__compaction] Closed cursor at md-position=7:-1
2024-02-05T18:16:26,668 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://pulsar/system/loadbalancer-service-unit-state][reader-2bc3e56286] Successfully closed dispatcher for reader
2024-02-05T18:16:26,669 - INFO  - [bookkeeper-ml-scheduler-OrderedScheduler-3-0:ManagedCursorImpl$24@2625] - [pulsar/system/persistent/loadbalancer-service-unit-state][__compaction] Closed cursor at md-position=3:-1
2024-02-05T18:16:26,669 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=PersistentSubscription{topic=persistent://sla-monitor/test/localhost:46117/__change_events, name=reader-917e27e71b}, consumerId=3, consumerName=f243e, address=/127.0.0.1:50684}
2024-02-05T18:16:26,670 - INFO  - [pulsar-io-9-1:PersistentSubscription@897] - [persistent://sla-monitor/test/localhost:46117/__change_events][reader-917e27e71b] Successfully closed subscription [NonDurableCursorImpl{ledger=sla-monitor/test/localhost:46117/persistent/__change_events, cursor=reader-917e27e71b, ackPos=7:-1, readPos=7:0}]
2024-02-05T18:16:26,670 - INFO  - [pulsar-io-9-1:PersistentSubscription@323] - [persistent://sla-monitor/test/localhost:46117/__change_events][reader-917e27e71b] Successfully closed dispatcher for reader
2024-02-05T18:16:26,670 - INFO  - [main:ManagedLedgerFactoryImpl@654] - 2 ledgers closed
2024-02-05T18:16:26,671 - INFO  - [main:ManagedLedgerClientFactory@137] - Closed managed ledger factory
2024-02-05T18:16:26,671 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-top-bundles-load-data, name=reader-84b92e60dc}, consumerId=2, consumerName=3017e, address=/127.0.0.1:50684}
2024-02-05T18:16:26,672 - INFO  - [pulsar-io-9-1:AbstractDispatcherSingleActiveConsumer@226] - Removing consumer Consumer{subscription=NonPersistentSubscription{topic=non-persistent://pulsar/system/loadbalancer-broker-load-data, name=reader-ee919ff907}, consumerId=1, consumerName=89cf7, address=/127.0.0.1:50684}
2024-02-05T18:16:26,672 - INFO  - [main:ManagedLedgerClientFactory@168] - Closed BookKeeper client
2024-02-05T18:16:26,681 - INFO  - [main:PulsarClientImpl@736] - Client closing. URL: pulsar://localhost:34941
2024-02-05T18:16:26,683 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [test-0-2] Closed Producer (not connected)
2024-02-05T18:16:26,684 - INFO  - [main:ProducerImpl@1070] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [test-0-1] Closed Producer (not connected)
2024-02-05T18:16:26,684 - INFO  - [main:ProducerImpl@1070] - [persistent://pulsar/system/loadbalancer-service-unit-state] [test-0-0] Closed Producer (not connected)
2024-02-05T18:16:26,684 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-broker-load-data] [reader-ee919ff907] Closed Consumer (not connected)
2024-02-05T18:16:26,685 - INFO  - [main:ConsumerImpl@1029] - [persistent://pulsar/system/loadbalancer-service-unit-state] [reader-2bc3e56286] Closed Consumer (not connected)
2024-02-05T18:16:26,685 - INFO  - [main:ConsumerImpl@1029] - [non-persistent://pulsar/system/loadbalancer-top-bundles-load-data] [reader-84b92e60dc] Closed Consumer (not connected)
2024-02-05T18:16:26,685 - INFO  - [main:ConsumerImpl@1029] - [persistent://sla-monitor/test/localhost:46117/__change_events] [reader-917e27e71b] Closed Consumer (not connected)
2024-02-05T18:16:26,685 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-broker-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ee919ff907 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-broker-load-data with subscription name reader-ee919ff907 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:26,686 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader persistent://pulsar/system/loadbalancer-service-unit-state was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-2bc3e56286 was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://pulsar/system/loadbalancer-service-unit-state with subscription name reader-2bc3e56286 was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:26,687 - ERROR - [broker-client-shared-internal-executor-11-1:TableViewImpl@284] - Reader non-persistent://pulsar/system/loadbalancer-top-bundles-load-data was closed while reading tail messages.
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-84b92e60dc was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic non-persistent://pulsar/system/loadbalancer-top-bundles-load-data with subscription name reader-84b92e60dc was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:26,688 - WARN  - [broker-client-shared-internal-executor-11-1:SystemTopicBasedTopicPoliciesService@480] - Read more topic policies exception, close the read now!
java.util.concurrent.CompletionException: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:46117/__change_events with subscription name reader-917e27e71b was already closed when cleaning and closing the consumers
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:358) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at org.apache.pulsar.client.impl.ConsumerBase.lambda$failPendingReceive$1(ConsumerBase.java:341) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.100.Final.jar:4.1.100.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: org.apache.pulsar.client.api.PulsarClientException$AlreadyClosedException: The consumer which subscribes the topic persistent://sla-monitor/test/localhost:46117/__change_events with subscription name reader-917e27e71b was already closed when cleaning and closing the consumers
	at org.apache.pulsar.client.impl.ConsumerBase.failPendingReceives(ConsumerBase.java:360) ~[pulsar-client-original-3.0.2.jar:3.0.2]
	... 5 more
2024-02-05T18:16:26,690 - INFO  - [main:ServiceUnitStateChannelImpl@393] - Successfully closed the channel tableview.
2024-02-05T18:16:26,691 - INFO  - [main:ServiceUnitStateChannelImpl@400] - Successfully closed the channel producer.
2024-02-05T18:16:26,691 - INFO  - [main:ServiceUnitStateChannelImpl@410] - Successfully cancelled the cleanup tasks
2024-02-05T18:16:26,691 - INFO  - [main:ServiceUnitStateChannelImpl@417] - Successfully closed the channel.
2024-02-05T18:16:26,691 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:16:26,692 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:26,693 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 5 executors.
2024-02-05T18:16:26,693 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:28,071 - INFO  - [globalEventExecutor-10-6:BrokerService@837] - Event loops shutdown completed.
2024-02-05T18:16:28,072 - INFO  - [BrokerService-shutdown-phase2:BrokerService@842] - Continuing to second phase in shutdown.
2024-02-05T18:16:28,073 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 7 executors.
2024-02-05T18:16:28,073 - INFO  - [BrokerService-shutdown-phase2:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:28,074 - INFO  - [BrokerService-shutdown-phase2:BrokerService@893] - Broker service completely shut down
2024-02-05T18:16:28,074 - INFO  - [BrokerService-shutdown-phase2:PulsarService@601] - Closed
2024-02-05T18:16:28,081 - INFO  - [main:GracefulExecutorServicesTerminationHandler@53] - Starting termination handler for 1 executors.
2024-02-05T18:16:28,082 - INFO  - [main:GracefulExecutorServicesTerminationHandler@91] - Shutdown completed.
2024-02-05T18:16:28,086 - INFO  - [main:ThreadLeakDetectorListener@40] - Capturing identifiers of running threads.
2024-02-05T18:16:28,086 - INFO  - [main:ThreadLeakDetectorListener@51] - Checking for new threads created by org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.
2024-02-05T18:16:28,086 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 153 with name 'Thread[CompletableFutureDelayScheduler,5,main]'
2024-02-05T18:16:28,086 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 179 with name 'Thread[AsyncHttpClient-37-3,5,main]'
2024-02-05T18:16:28,086 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 180 with name 'Thread[AsyncHttpClient-37-4,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 181 with name 'Thread[AsyncHttpClient-34-1,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 182 with name 'Thread[AsyncHttpClient-34-2,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 183 with name 'Thread[AsyncHttpClient-34-3,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 184 with name 'Thread[AsyncHttpClient-34-4,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@55] - Tests in class ExtensibleLoadManagerImplTest created thread id 189 with name 'Thread[globalEventExecutor-10-6,5,main]'
2024-02-05T18:16:28,087 - WARN  - [main:ThreadLeakDetectorListener@60] - Summary: Tests in class org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest created 8 new threads
2024-02-05T18:16:28,087 - INFO  - [main:FastThreadLocalCleanupListener@53] - Cleaning up FastThreadLocal thread local state.
2024-02-05T18:16:28,088 - INFO  - [main:FastThreadLocalCleanupListener@55] - Cleaning FastThreadLocal state for thread Thread[main,5,main], instance of class org.apache.pulsar.common.api.proto.BaseCommand, value is org.apache.pulsar.common.api.proto.BaseCommand@6e28a726
2024-02-05T18:16:28,088 - INFO  - [main:MockitoCleanupListener@46] - Cleaning up Mockito's ThreadSafeMockingProgress.MOCKING_PROGRESS_PROVIDER thread local state.
2024-02-05T18:16:28,088 - INFO  - [main:MockitoThreadLocalStateCleaner@67] - Removing org.mockito.internal.progress.MockingProgressImpl instance from thread Thread[main,5,main]
2024-02-05T18:16:28,088 - INFO  - [main:MockitoThreadLocalStateCleaner@68] - Calling MockingProgress.validateState() method on instance (toString=ongoingStubbing: null, verificationMode: null, stubbingInProgress: null)
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 28.177 s <<< FAILURE! - in org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest
[ERROR] org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics  Time elapsed: 0.162 s  <<< FAILURE!
java.lang.AssertionError: Sets differ: expected [dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
	at org.testng.Assert.fail(Assert.java:110)
	at org.testng.Assert.assertEquals(Assert.java:2036)
	at org.testng.Assert.assertEquals(Assert.java:1963)
	at org.apache.pulsar.broker.loadbalance.extensions.ExtensibleLoadManagerImplTest.testGetMetrics(ExtensibleLoadManagerImplTest.java:1018)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)
	at org.testng.internal.invokers.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:47)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:76)
	at org.testng.internal.invokers.InvokeMethodRunnable.call(InvokeMethodRunnable.java:11)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   ExtensibleLoadManagerImplTest.testGetMetrics:1018 Sets differ: expected [dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=3}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}]] but got [dimensions=[{broker=localhost, metric=bundleUnloading, reason=Underloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Overloaded, result=Success}], metrics=[{brk_lb_unload_broker_breakdown_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=CoolDown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=5}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBundles, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=4}], dimensions=[{broker=localhost, metric=bundleUnloading}], metrics=[{brk_lb_unload_broker_total=2, brk_lb_unload_bundle_total=3}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=avg}], metrics=[{brk_lb_resource_usage_stats=1.5}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Sessions, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=2}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=1}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Failure}], metrics=[{brk_lb_unload_broker_breakdown_total=10}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=MsgRate, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=8}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Owned}], metrics=[{brk_sunit_state_chn_owner_lookup_total=5}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=2}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoLoadData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=7}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Unknown, result=Failure}], metrics=[{brk_lb_bundles_split_breakdown_total=6}], dimensions=[{broker=localhost, event=Assign, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=10}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=NoBrokers, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=8}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=8}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=12}], dimensions=[{broker=localhost, feature=max_ema, metric=bundleUnloading, stat=std}], metrics=[{brk_lb_resource_usage_stats=0.3}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=6}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Cancel}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=7}], dimensions=[{broker=localhost, metric=sunitStateChn}], metrics=[{brk_sunit_state_chn_orphan_su_cleanup_ops_total=3, brk_sunit_state_chn_owned_su_total=10, brk_sunit_state_chn_su_tombstone_cleanup_ops_total=2}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Releasing}], metrics=[{brk_sunit_state_chn_owner_lookup_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=11}], dimensions=[{broker=localhost, metric=assign, result=Success}], metrics=[{brk_lb_assign_broker_breakdown_total=1}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=10}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Success}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=1}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Schedule}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Bandwidth, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=4}], dimensions=[{broker=localhost, event=Override, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=7}], dimensions=[{broker=localhost, metric=loadBalancing}], metrics=[{brk_lb_bandwidth_in_usage=3.0, brk_lb_bandwidth_out_usage=4.0, brk_lb_cpu_usage=1.0, brk_lb_directMemory_usage=2.0, brk_lb_memory_usage=400.0}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=1}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=3}], dimensions=[{broker=localhost, event=Init, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=2}], dimensions=[{broker=localhost, event=Splitting, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=11}], dimensions=[{broker=localhost, event=Owned, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=5}], dimensions=[{broker=localhost, event=Releasing, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=9}], dimensions=[{broker=localhost, metric=assign, result=Skip}], metrics=[{brk_lb_assign_broker_breakdown_total=4}], dimensions=[{broker=localhost, event=Split, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=4}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=13}], dimensions=[{broker=localhost, feature=max_ema, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=4.0}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Admin, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=5}], dimensions=[{broker=localhost, feature=max, metric=loadBalancing}], metrics=[{brk_lb_resource_usage=0.04}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=OutDatedData, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=6}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Splitting}], metrics=[{brk_sunit_state_chn_owner_lookup_total=12}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Skip}], metrics=[{brk_sunit_state_chn_inactive_broker_cleanup_ops_total=6}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=Unknown, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=9}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Init}], metrics=[{brk_sunit_state_chn_owner_lookup_total=2}], dimensions=[{broker=localhost, event=Assigning, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=7}], dimensions=[{broker=localhost, event=Free, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=3}], dimensions=[{broker=localhost, metric=bundleUnloading, reason=HitCount, result=Skip}], metrics=[{brk_lb_unload_broker_breakdown_total=3}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=13}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Assigning}], metrics=[{brk_sunit_state_chn_owner_lookup_total=8}], dimensions=[{broker=localhost, event=Deleted, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_subscribe_ops_total=14}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure}], metrics=[{brk_sunit_state_chn_cleanup_ops_total=4}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Failure, state=Deleted}], metrics=[{brk_sunit_state_chn_owner_lookup_total=14}], dimensions=[{broker=localhost, metric=assign, result=Failure}], metrics=[{brk_lb_assign_broker_breakdown_total=2}], dimensions=[{broker=localhost, event=Unload, metric=sunitStateChn, result=Total}], metrics=[{brk_sunit_state_chn_event_publish_ops_total=5}], dimensions=[{broker=localhost, metric=bundlesSplit}], metrics=[{brk_lb_bundles_split_total=35}], dimensions=[{broker=localhost, metric=sunitStateChn, result=Total, state=Free}], metrics=[{brk_sunit_state_chn_owner_lookup_total=3}], dimensions=[{broker=localhost, metric=bundlesSplit, reason=Topics, result=Success}], metrics=[{brk_lb_bundles_split_breakdown_total=1}]]
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  54.171 s
[INFO] Finished at: 2024-02-05T18:16:28+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 17 goals, 17 executed
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.1.0:test (default-test) on project pulsar-broker: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/maxmirelli/Dev/apache/pulsar/fix-21556/pulsar-broker/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
Exited after loop #9
